import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as de,g as Nt,q as $,u as P,i as F,m as q,j as a,v as Ge,f as pe,c as ae,r as se,t as we,w as D,l as Ce,a as j,b as ue,e as Ve,n as re,k as me,s as rt,A as Hn,a7 as Y,B as Le,z as ki,aU as yt,aW as Q,bq as it,aX as Et,b4 as Xt,o as Zt,y as wt,aT as no,aM as sn,d as at,M as mt,bw as tt,bo as Pi,x as Ci}from"./0WpKKl27.js";import{i as fe}from"./C3k0oZ3o.js";import{p as d,l as Oe,s as Bt}from"./DpN1w328.js";import{i as Ae}from"./Cmf4RC8y.js";import{a as W,s as Ye,d as Qt,b as Ei}from"./BVrWTcfB.js";import{q as Mi,J as oo,a as zi,u as Si}from"./PCOILo-8.js";import{c as nt,a as le,s as Qe,f as lt,g as On,S as To}from"./CZ1y6KaE.js";import{a as jt}from"./DLhnqOlE.js";import{P as io}from"./DLQ8GCeM.js";import{T as Ni}from"./Db0gdTVr.js";import{H as Ti}from"./B3Vrv829.js";import{s as Ue,a as Ii}from"./3-JilrU5.js";import{s as st,i as Dn,T as mn,a as yn,t as Hi}from"./CxNpLfvs.js";import{g as Io}from"./4JkFaImo.js";import{i as Oi}from"./C-V_EQOO.js";import{a as qe}from"./BtReZMDb.js";import{b as ro}from"./Cb8_Fw4l.js";import{b as An}from"./Bo3ZTtFv.js";import{b as ve}from"./CbBS0GYN.js";import{e as Vn}from"./u5Cnd4mY.js";import{c as Ho}from"./Q6Bnvzbc.js";import{X as Di}from"./CZmZoefv.js";function Te(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,o;n<t.length;n++)(o=Te(t[n]))!==""&&(e+=(e&&" ")+o);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}function Ai(t){let e;for(;e=t.sourceEvent;)t=e;return t}function ct(t,e){if(t=Ai(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=t.clientX,o.y=t.clientY,o=o.matrixTransform(e.getScreenCTM().inverse()),[o.x,o.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const Vi={passive:!1},Rt={capture:!0,passive:!1};function vn(t){t.stopImmediatePropagation()}function Mt(t){t.preventDefault(),t.stopImmediatePropagation()}function Oo(t){var e=t.document.documentElement,n=st(t).on("dragstart.drag",Mt,Rt);"onselectstart"in e?n.on("selectstart.drag",Mt,Rt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Do(t,e){var n=t.document.documentElement,o=st(t).on("dragstart.drag",null);e&&(o.on("click.drag",Mt,Rt),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ut=t=>()=>t;function Cn(t,{sourceEvent:e,subject:n,target:o,identifier:r,active:l,x:i,y:s,dx:u,dy:h,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:c}})}Cn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Li(t){return!t.ctrlKey&&!t.button}function Yi(){return this.parentNode}function Bi(t,e){return e??{x:t.x,y:t.y}}function Xi(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ri(){var t=Li,e=Yi,n=Bi,o=Xi,r={},l=Io("start","drag","end"),i=0,s,u,h,c,m=0;function g(p){p.on("mousedown.drag",y).filter(o).on("touchstart.drag",C).on("touchmove.drag",E,Vi).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(p,_){if(!(c||!t.call(this,p,_))){var z=v(this,e.call(this,p,_),p,_,"mouse");z&&(st(p.view).on("mousemove.drag",M,Rt).on("mouseup.drag",N,Rt),Oo(p.view),vn(p),h=!1,s=p.clientX,u=p.clientY,z("start",p))}}function M(p){if(Mt(p),!h){var _=p.clientX-s,z=p.clientY-u;h=_*_+z*z>m}r.mouse("drag",p)}function N(p){st(p.view).on("mousemove.drag mouseup.drag",null),Do(p.view,h),Mt(p),r.mouse("end",p)}function C(p,_){if(t.call(this,p,_)){var z=p.changedTouches,k=e.call(this,p,_),H=z.length,A,O;for(A=0;A<H;++A)(O=v(this,k,p,_,z[A].identifier,z[A]))&&(vn(p),O("start",p,z[A]))}}function E(p){var _=p.changedTouches,z=_.length,k,H;for(k=0;k<z;++k)(H=r[_[k].identifier])&&(Mt(p),H("drag",p,_[k]))}function b(p){var _=p.changedTouches,z=_.length,k,H;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),k=0;k<z;++k)(H=r[_[k].identifier])&&(vn(p),H("end",p,_[k]))}function v(p,_,z,k,H,A){var O=l.copy(),X=ct(A||z,_),T,V,f;if((f=n.call(p,new Cn("beforestart",{sourceEvent:z,target:g,identifier:H,active:i,x:X[0],y:X[1],dx:0,dy:0,dispatch:O}),k))!=null)return T=f.x-X[0]||0,V=f.y-X[1]||0,function x(w,S,I){var B=X,L;switch(w){case"start":r[H]=x,L=i++;break;case"end":delete r[H],--i;case"drag":X=ct(I||S,_),L=i;break}O.call(w,p,new Cn(w,{sourceEvent:S,subject:f,target:g,identifier:H,active:L,x:X[0]+T,y:X[1]+V,dx:X[0]-B[0],dy:X[1]-B[1],dispatch:O}),k)}}return g.filter=function(p){return arguments.length?(t=typeof p=="function"?p:Ut(!!p),g):t},g.container=function(p){return arguments.length?(e=typeof p=="function"?p:Ut(p),g):e},g.subject=function(p){return arguments.length?(n=typeof p=="function"?p:Ut(p),g):n},g.touchable=function(p){return arguments.length?(o=typeof p=="function"?p:Ut(!!p),g):o},g.on=function(){var p=l.on.apply(l,arguments);return p===l?g:p},g.clickDistance=function(p){return arguments.length?(m=(p=+p)*p,g):Math.sqrt(m)},g}const qt=t=>()=>t;function Wi(t,{sourceEvent:e,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function bn(t){t.stopImmediatePropagation()}function Yt(t){t.preventDefault(),t.stopImmediatePropagation()}function Ki(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Zi(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function so(){return this.__zoom||Dn}function Fi(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Gi(){return navigator.maxTouchPoints||"ontouchstart"in this}function ji(t,e,n){var o=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],l=t.invertY(e[0][1])-n[0][1],i=t.invertY(e[1][1])-n[1][1];return t.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),i>l?(l+i)/2:Math.min(0,l)||Math.max(0,i))}function Ui(){var t=Ki,e=Zi,n=ji,o=Fi,r=Gi,l=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,u=Oi,h=Io("start","zoom","end"),c,m,g,y=500,M=150,N=0,C=10;function E(f){f.property("__zoom",so).on("wheel.zoom",H,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",O).filter(r).on("touchstart.zoom",X).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",V).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}E.transform=function(f,x,w,S){var I=f.selection?f.selection():f;I.property("__zoom",so),f!==I?_(f,x,w,S):I.interrupt().each(function(){z(this,arguments).event(S).start().zoom(null,typeof x=="function"?x.apply(this,arguments):x).end()})},E.scaleBy=function(f,x,w,S){E.scaleTo(f,function(){var I=this.__zoom.k,B=typeof x=="function"?x.apply(this,arguments):x;return I*B},w,S)},E.scaleTo=function(f,x,w,S){E.transform(f,function(){var I=e.apply(this,arguments),B=this.__zoom,L=w==null?p(I):typeof w=="function"?w.apply(this,arguments):w,R=B.invert(L),K=typeof x=="function"?x.apply(this,arguments):x;return n(v(b(B,K),L,R),I,i)},w,S)},E.translateBy=function(f,x,w,S){E.transform(f,function(){return n(this.__zoom.translate(typeof x=="function"?x.apply(this,arguments):x,typeof w=="function"?w.apply(this,arguments):w),e.apply(this,arguments),i)},null,S)},E.translateTo=function(f,x,w,S,I){E.transform(f,function(){var B=e.apply(this,arguments),L=this.__zoom,R=S==null?p(B):typeof S=="function"?S.apply(this,arguments):S;return n(Dn.translate(R[0],R[1]).scale(L.k).translate(typeof x=="function"?-x.apply(this,arguments):-x,typeof w=="function"?-w.apply(this,arguments):-w),B,i)},S,I)};function b(f,x){return x=Math.max(l[0],Math.min(l[1],x)),x===f.k?f:new mn(x,f.x,f.y)}function v(f,x,w){var S=x[0]-w[0]*f.k,I=x[1]-w[1]*f.k;return S===f.x&&I===f.y?f:new mn(f.k,S,I)}function p(f){return[(+f[0][0]+ +f[1][0])/2,(+f[0][1]+ +f[1][1])/2]}function _(f,x,w,S){f.on("start.zoom",function(){z(this,arguments).event(S).start()}).on("interrupt.zoom end.zoom",function(){z(this,arguments).event(S).end()}).tween("zoom",function(){var I=this,B=arguments,L=z(I,B).event(S),R=e.apply(I,B),K=w==null?p(R):typeof w=="function"?w.apply(I,B):w,G=Math.max(R[1][0]-R[0][0],R[1][1]-R[0][1]),Z=I.__zoom,J=typeof x=="function"?x.apply(I,B):x,oe=u(Z.invert(K).concat(G/Z.k),J.invert(K).concat(G/J.k));return function(ee){if(ee===1)ee=J;else{var te=oe(ee),ge=G/te[2];ee=new mn(ge,K[0]-te[0]*ge,K[1]-te[1]*ge)}L.zoom(null,ee)}})}function z(f,x,w){return!w&&f.__zooming||new k(f,x)}function k(f,x){this.that=f,this.args=x,this.active=0,this.sourceEvent=null,this.extent=e.apply(f,x),this.taps=0}k.prototype={event:function(f){return f&&(this.sourceEvent=f),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(f,x){return this.mouse&&f!=="mouse"&&(this.mouse[1]=x.invert(this.mouse[0])),this.touch0&&f!=="touch"&&(this.touch0[1]=x.invert(this.touch0[0])),this.touch1&&f!=="touch"&&(this.touch1[1]=x.invert(this.touch1[0])),this.that.__zoom=x,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(f){var x=st(this.that).datum();h.call(f,this.that,new Wi(f,{sourceEvent:this.sourceEvent,target:E,transform:this.that.__zoom,dispatch:h}),x)}};function H(f,...x){if(!t.apply(this,arguments))return;var w=z(this,x).event(f),S=this.__zoom,I=Math.max(l[0],Math.min(l[1],S.k*Math.pow(2,o.apply(this,arguments)))),B=ct(f);if(w.wheel)(w.mouse[0][0]!==B[0]||w.mouse[0][1]!==B[1])&&(w.mouse[1]=S.invert(w.mouse[0]=B)),clearTimeout(w.wheel);else{if(S.k===I)return;w.mouse=[B,S.invert(B)],yn(this),w.start()}Yt(f),w.wheel=setTimeout(L,M),w.zoom("mouse",n(v(b(S,I),w.mouse[0],w.mouse[1]),w.extent,i));function L(){w.wheel=null,w.end()}}function A(f,...x){if(g||!t.apply(this,arguments))return;var w=f.currentTarget,S=z(this,x,!0).event(f),I=st(f.view).on("mousemove.zoom",K,!0).on("mouseup.zoom",G,!0),B=ct(f,w),L=f.clientX,R=f.clientY;Oo(f.view),bn(f),S.mouse=[B,this.__zoom.invert(B)],yn(this),S.start();function K(Z){if(Yt(Z),!S.moved){var J=Z.clientX-L,oe=Z.clientY-R;S.moved=J*J+oe*oe>N}S.event(Z).zoom("mouse",n(v(S.that.__zoom,S.mouse[0]=ct(Z,w),S.mouse[1]),S.extent,i))}function G(Z){I.on("mousemove.zoom mouseup.zoom",null),Do(Z.view,S.moved),Yt(Z),S.event(Z).end()}}function O(f,...x){if(t.apply(this,arguments)){var w=this.__zoom,S=ct(f.changedTouches?f.changedTouches[0]:f,this),I=w.invert(S),B=w.k*(f.shiftKey?.5:2),L=n(v(b(w,B),S,I),e.apply(this,x),i);Yt(f),s>0?st(this).transition().duration(s).call(_,L,S,f):st(this).call(E.transform,L,S,f)}}function X(f,...x){if(t.apply(this,arguments)){var w=f.touches,S=w.length,I=z(this,x,f.changedTouches.length===S).event(f),B,L,R,K;for(bn(f),L=0;L<S;++L)R=w[L],K=ct(R,this),K=[K,this.__zoom.invert(K),R.identifier],I.touch0?!I.touch1&&I.touch0[2]!==K[2]&&(I.touch1=K,I.taps=0):(I.touch0=K,B=!0,I.taps=1+!!c);c&&(c=clearTimeout(c)),B&&(I.taps<2&&(m=K[0],c=setTimeout(function(){c=null},y)),yn(this),I.start())}}function T(f,...x){if(this.__zooming){var w=z(this,x).event(f),S=f.changedTouches,I=S.length,B,L,R,K;for(Yt(f),B=0;B<I;++B)L=S[B],R=ct(L,this),w.touch0&&w.touch0[2]===L.identifier?w.touch0[0]=R:w.touch1&&w.touch1[2]===L.identifier&&(w.touch1[0]=R);if(L=w.that.__zoom,w.touch1){var G=w.touch0[0],Z=w.touch0[1],J=w.touch1[0],oe=w.touch1[1],ee=(ee=J[0]-G[0])*ee+(ee=J[1]-G[1])*ee,te=(te=oe[0]-Z[0])*te+(te=oe[1]-Z[1])*te;L=b(L,Math.sqrt(ee/te)),R=[(G[0]+J[0])/2,(G[1]+J[1])/2],K=[(Z[0]+oe[0])/2,(Z[1]+oe[1])/2]}else if(w.touch0)R=w.touch0[0],K=w.touch0[1];else return;w.zoom("touch",n(v(L,R,K),w.extent,i))}}function V(f,...x){if(this.__zooming){var w=z(this,x).event(f),S=f.changedTouches,I=S.length,B,L;for(bn(f),g&&clearTimeout(g),g=setTimeout(function(){g=null},y),B=0;B<I;++B)L=S[B],w.touch0&&w.touch0[2]===L.identifier?delete w.touch0:w.touch1&&w.touch1[2]===L.identifier&&delete w.touch1;if(w.touch1&&!w.touch0&&(w.touch0=w.touch1,delete w.touch1),w.touch0)w.touch0[1]=this.__zoom.invert(w.touch0[0]);else if(w.end(),w.taps===2&&(L=ct(L,this),Math.hypot(m[0]-L[0],m[1]-L[1])<C)){var R=st(this).on("dblclick.zoom");R&&R.apply(this,arguments)}}}return E.wheelDelta=function(f){return arguments.length?(o=typeof f=="function"?f:qt(+f),E):o},E.filter=function(f){return arguments.length?(t=typeof f=="function"?f:qt(!!f),E):t},E.touchable=function(f){return arguments.length?(r=typeof f=="function"?f:qt(!!f),E):r},E.extent=function(f){return arguments.length?(e=typeof f=="function"?f:qt([[+f[0][0],+f[0][1]],[+f[1][0],+f[1][1]]]),E):e},E.scaleExtent=function(f){return arguments.length?(l[0]=+f[0],l[1]=+f[1],E):[l[0],l[1]]},E.translateExtent=function(f){return arguments.length?(i[0][0]=+f[0][0],i[1][0]=+f[1][0],i[0][1]=+f[0][1],i[1][1]=+f[1][1],E):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},E.constrain=function(f){return arguments.length?(n=f,E):n},E.duration=function(f){return arguments.length?(s=+f,E):s},E.interpolate=function(f){return arguments.length?(u=f,E):u},E.on=function(){var f=h.on.apply(h,arguments);return f===h?E:f},E.clickDistance=function(f){return arguments.length?(N=(f=+f)*f,E):Math.sqrt(N)},E.tapDistance=function(f){return arguments.length?(C=+f,E):C},E}const Tt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${t} handle id: "${t==="source"?n:o}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},$t=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]];var bt;(function(t){t.Strict="strict",t.Loose="loose"})(bt||(bt={}));var gt;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(gt||(gt={}));var en;(function(t){t.Partial="partial",t.Full="full"})(en||(en={}));const En={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var zt;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(zt||(zt={}));var kt;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(kt||(kt={}));var ne;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(ne||(ne={}));const lo={[ne.Left]:ne.Right,[ne.Right]:ne.Left,[ne.Top]:ne.Bottom,[ne.Bottom]:ne.Top};function qi(t,e){if(!t&&!e)return!0;if(!t||!e||t.size!==e.size)return!1;if(!t.size&&!e.size)return!0;for(const n of t.keys())if(!e.has(n))return!1;return!0}function ao(t,e,n){if(!n)return;const o=[];t.forEach((r,l)=>{e!=null&&e.has(l)||o.push(r)}),o.length&&n(o)}function co(t){return t===null?null:t?"valid":"invalid"}const Ji=t=>"id"in t&&"source"in t&&"target"in t,Qi=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),Ln=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),Ft=(t,e=[0,0])=>{const{width:n,height:o}=pt(t),r=t.origin??e,l=n*r[0],i=o*r[1];return{x:t.position.x-l,y:t.position.y-i}},$i=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((o,r)=>{const l=typeof r=="string";let i=!e.nodeLookup&&!l?r:void 0;e.nodeLookup&&(i=l?e.nodeLookup.get(r):Ln(r)?r:e.nodeLookup.get(r.id));const s=i?tn(i,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return an(o,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return cn(n)},ln=(t,e={})=>{if(t.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return t.forEach(o=>{if(e.filter===void 0||e.filter(o)){const r=tn(o);n=an(n,r)}}),cn(n)},Ao=(t,e,[n,o,r]=[0,0,1],l=!1,i=!1)=>{const s={...Gt(e,[n,o,r]),width:e.width/r,height:e.height/r},u=[];for(const h of t.values()){const{measured:c,selectable:m=!0,hidden:g=!1}=h;if(i&&!m||g)continue;const y=c.width??h.width??h.initialWidth??null,M=c.height??h.height??h.initialHeight??null,N=Wt(s,Ht(h)),C=(y??0)*(M??0),E=l&&N>0;(!h.internals.handleBounds||E||N>=C||h.dragging)&&u.push(h)}return u},Mn=(t,e)=>{const n=new Set;return t.forEach(o=>{n.add(o.id)}),e.filter(o=>n.has(o.source)||n.has(o.target))};function er(t,e){const n=new Map,o=e!=null&&e.nodes?new Set(e.nodes.map(r=>r.id)):null;return t.forEach(r=>{r.measured.width&&r.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function tr({nodes:t,width:e,height:n,panZoom:o,minZoom:r,maxZoom:l},i){if(t.size===0)return Promise.resolve(!0);const s=er(t,i),u=ln(s),h=Bn(u,e,n,(i==null?void 0:i.minZoom)??r,(i==null?void 0:i.maxZoom)??l,(i==null?void 0:i.padding)??.1);return await o.setViewport(h,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function nr({nodeId:t,nextPosition:e,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:l}){const i=n.get(t),s=i.parentId?n.get(i.parentId):void 0,{x:u,y:h}=s?s.internals.positionAbsolute:{x:0,y:0},c=i.origin??o;let m=r;if(i.extent==="parent"&&!i.expandParent)if(!s)l==null||l("005",Tt.error005());else{const y=s.measured.width,M=s.measured.height;y&&M&&(m=[[u,h],[u+y,h+M]])}else s&&Ot(i.extent)&&(m=[[i.extent[0][0]+u,i.extent[0][1]+h],[i.extent[1][0]+u,i.extent[1][1]+h]]);const g=Ot(m)?xt(e,m,i.measured):e;return(i.measured.width===void 0||i.measured.height===void 0)&&(l==null||l("015",Tt.error015())),{position:{x:g.x-u+(i.measured.width??0)*c[0],y:g.y-h+(i.measured.height??0)*c[1]},positionAbsolute:g}}async function Vo({nodesToRemove:t=[],edgesToRemove:e=[],nodes:n,edges:o,onBeforeDelete:r}){const l=new Set(t.map(g=>g.id)),i=[];for(const g of n){if(g.deletable===!1)continue;const y=l.has(g.id),M=!y&&g.parentId&&i.find(N=>N.id===g.parentId);(y||M)&&i.push(g)}const s=new Set(e.map(g=>g.id)),u=o.filter(g=>g.deletable!==!1),c=Mn(i,u);for(const g of u)s.has(g.id)&&!c.find(M=>M.id===g.id)&&c.push(g);if(!r)return{edges:c,nodes:i};const m=await r({nodes:i,edges:c});return typeof m=="boolean"?m?{edges:c,nodes:i}:{edges:[],nodes:[]}:m}const It=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),xt=(t={x:0,y:0},e,n)=>({x:It(t.x,e[0][0],e[1][0]-((n==null?void 0:n.width)??0)),y:It(t.y,e[0][1],e[1][1]-((n==null?void 0:n.height)??0))});function Lo(t,e,n){const{width:o,height:r}=pt(n),{x:l,y:i}=n.internals.positionAbsolute;return xt(t,[[l,i],[l+o,i+r]],e)}const uo=(t,e,n)=>t<e?It(Math.abs(t-e),1,e)/e:t>n?-It(Math.abs(t-n),1,e)/e:0,Yo=(t,e,n=15,o=40)=>{const r=uo(t.x,o,e.width-o)*n,l=uo(t.y,o,e.height-o)*n;return[r,l]},an=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),zn=({x:t,y:e,width:n,height:o})=>({x:t,y:e,x2:t+n,y2:e+o}),cn=({x:t,y:e,x2:n,y2:o})=>({x:t,y:e,width:n-t,height:o-e}),Ht=(t,e=[0,0])=>{var r,l;const{x:n,y:o}=Ln(t)?t.internals.positionAbsolute:Ft(t,e);return{x:n,y:o,width:((r=t.measured)==null?void 0:r.width)??t.width??t.initialWidth??0,height:((l=t.measured)==null?void 0:l.height)??t.height??t.initialHeight??0}},tn=(t,e=[0,0])=>{var r,l;const{x:n,y:o}=Ln(t)?t.internals.positionAbsolute:Ft(t,e);return{x:n,y:o,x2:n+(((r=t.measured)==null?void 0:r.width)??t.width??t.initialWidth??0),y2:o+(((l=t.measured)==null?void 0:l.height)??t.height??t.initialHeight??0)}},or=(t,e)=>cn(an(zn(t),zn(e))),Wt=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),o=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*o)},fo=t=>dt(t.width)&&dt(t.height)&&dt(t.x)&&dt(t.y),dt=t=>!isNaN(t)&&isFinite(t),ir=(t,e)=>{},Yn=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),Gt=({x:t,y:e},[n,o,r],l=!1,i=[1,1])=>{const s={x:(t-n)/r,y:(e-o)/r};return l?Yn(s,i):s},nn=({x:t,y:e},[n,o,r])=>({x:t*r+n,y:e*r+o});function _t(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(n)}if(typeof t=="string"&&t.endsWith("%")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(e*n*.01)}return`${t}`,0}function rr(t,e,n){if(typeof t=="string"||typeof t=="number"){const o=_t(t,n),r=_t(t,e);return{top:o,right:r,bottom:o,left:r,x:r*2,y:o*2}}if(typeof t=="object"){const o=_t(t.top??t.y??0,n),r=_t(t.bottom??t.y??0,n),l=_t(t.left??t.x??0,e),i=_t(t.right??t.x??0,e);return{top:o,right:i,bottom:r,left:l,x:l+i,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function sr(t,e,n,o,r,l){const{x:i,y:s}=nn(t,[e,n,o]),{x:u,y:h}=nn({x:t.x+t.width,y:t.y+t.height},[e,n,o]),c=r-u,m=l-h;return{left:Math.floor(i),top:Math.floor(s),right:Math.floor(c),bottom:Math.floor(m)}}const Bn=(t,e,n,o,r,l)=>{const i=rr(l,e,n),s=(e-i.x)/t.width,u=(n-i.y)/t.height,h=Math.min(s,u),c=It(h,o,r),m=t.x+t.width/2,g=t.y+t.height/2,y=e/2-m*c,M=n/2-g*c,N=sr(t,y,M,c,e,n),C={left:Math.min(N.left-i.left,0),top:Math.min(N.top-i.top,0),right:Math.min(N.right-i.right,0),bottom:Math.min(N.bottom-i.bottom,0)};return{x:y-C.left+C.right,y:M-C.top+C.bottom,zoom:c}},on=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0};function Ot(t){return t!==void 0&&t!=="parent"}function pt(t){var e,n;return{width:((e=t.measured)==null?void 0:e.width)??t.width??t.initialWidth??0,height:((n=t.measured)==null?void 0:n.height)??t.height??t.initialHeight??0}}function go(t){var e,n;return(((e=t.measured)==null?void 0:e.width)??t.width??t.initialWidth)!==void 0&&(((n=t.measured)==null?void 0:n.height)??t.height??t.initialHeight)!==void 0}function lr(t,e={width:0,height:0},n,o,r){const l={...t},i=o.get(n);if(i){const s=i.origin||r;l.x+=i.internals.positionAbsolute.x-(e.width??0)*s[0],l.y+=i.internals.positionAbsolute.y-(e.height??0)*s[1]}return l}function ar(){let t,e;return{promise:new Promise((o,r)=>{t=o,e=r}),resolve:t,reject:e}}function xn(t,{snapGrid:e=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:l,y:i}=ht(t),s=Gt({x:l-((r==null?void 0:r.left)??0),y:i-((r==null?void 0:r.top)??0)},o),{x:u,y:h}=n?Yn(s,e):s;return{xSnapped:u,ySnapped:h,...s}}const Bo=t=>({width:t.offsetWidth,height:t.offsetHeight}),cr=t=>{var e;return((e=t==null?void 0:t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},dr=["INPUT","SELECT","TEXTAREA"];function ur(t){var o,r;const e=((r=(o=t.composedPath)==null?void 0:o.call(t))==null?void 0:r[0])||t.target;return(e==null?void 0:e.nodeType)!==1?!1:dr.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const Xo=t=>"clientX"in t,ht=(t,e)=>{var l,i;const n=Xo(t),o=n?t.clientX:(l=t.touches)==null?void 0:l[0].clientX,r=n?t.clientY:(i=t.touches)==null?void 0:i[0].clientY;return{x:o-((e==null?void 0:e.left)??0),y:r-((e==null?void 0:e.top)??0)}},ho=(t,e,n,o,r)=>{const l=e.querySelectorAll(`.${t}`);return!l||!l.length?null:Array.from(l).map(i=>{const s=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:t,nodeId:r,position:i.getAttribute("data-handlepos"),x:(s.left-n.left)/o,y:(s.top-n.top)/o,...Bo(i)}})};function fr({sourceX:t,sourceY:e,targetX:n,targetY:o,sourceControlX:r,sourceControlY:l,targetControlX:i,targetControlY:s}){const u=t*.125+r*.375+i*.375+n*.125,h=e*.125+l*.375+s*.375+o*.125,c=Math.abs(u-t),m=Math.abs(h-e);return[u,h,c,m]}function Jt(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function mo({pos:t,x1:e,y1:n,x2:o,y2:r,c:l}){switch(t){case ne.Left:return[e-Jt(e-o,l),n];case ne.Right:return[e+Jt(o-e,l),n];case ne.Top:return[e,n-Jt(n-r,l)];case ne.Bottom:return[e,n+Jt(r-n,l)]}}function Ro({sourceX:t,sourceY:e,sourcePosition:n=ne.Bottom,targetX:o,targetY:r,targetPosition:l=ne.Top,curvature:i=.25}){const[s,u]=mo({pos:n,x1:t,y1:e,x2:o,y2:r,c:i}),[h,c]=mo({pos:l,x1:o,y1:r,x2:t,y2:e,c:i}),[m,g,y,M]=fr({sourceX:t,sourceY:e,targetX:o,targetY:r,sourceControlX:s,sourceControlY:u,targetControlX:h,targetControlY:c});return[`M${t},${e} C${s},${u} ${h},${c} ${o},${r}`,m,g,y,M]}function Wo({sourceX:t,sourceY:e,targetX:n,targetY:o}){const r=Math.abs(n-t)/2,l=n<t?n+r:n-r,i=Math.abs(o-e)/2,s=o<e?o+i:o-i;return[l,s,r,i]}function gr({sourceNode:t,targetNode:e,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1}){if(!r)return o;const l=n||e.selected||t.selected,i=Math.max(t.internals.z||0,e.internals.z||0,1e3);return o+(l?i:0)}function hr({sourceNode:t,targetNode:e,width:n,height:o,transform:r}){const l=an(tn(t),tn(e));l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const i={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return Wt(i,cn(l))>0}const mr=({source:t,sourceHandle:e,target:n,targetHandle:o})=>`xy-edge__${t}${e||""}-${n}${o||""}`,yr=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),vr=(t,e)=>{if(!t.source||!t.target)return e;let n;return Ji(t)?n={...t}:n={...t,id:mr(t)},yr(n,e)?e:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,e.concat(n))};function Sn({sourceX:t,sourceY:e,targetX:n,targetY:o}){const[r,l,i,s]=Wo({sourceX:t,sourceY:e,targetX:n,targetY:o});return[`M ${t},${e}L ${n},${o}`,r,l,i,s]}const yo={[ne.Left]:{x:-1,y:0},[ne.Right]:{x:1,y:0},[ne.Top]:{x:0,y:-1},[ne.Bottom]:{x:0,y:1}},br=({source:t,sourcePosition:e=ne.Bottom,target:n})=>e===ne.Left||e===ne.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},vo=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function xr({source:t,sourcePosition:e=ne.Bottom,target:n,targetPosition:o=ne.Top,center:r,offset:l}){const i=yo[e],s=yo[o],u={x:t.x+i.x*l,y:t.y+i.y*l},h={x:n.x+s.x*l,y:n.y+s.y*l},c=br({source:u,sourcePosition:e,target:h}),m=c.x!==0?"x":"y",g=c[m];let y=[],M,N;const C={x:0,y:0},E={x:0,y:0},[b,v,p,_]=Wo({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(i[m]*s[m]===-1){M=r.x??b,N=r.y??v;const k=[{x:M,y:u.y},{x:M,y:h.y}],H=[{x:u.x,y:N},{x:h.x,y:N}];i[m]===g?y=m==="x"?k:H:y=m==="x"?H:k}else{const k=[{x:u.x,y:h.y}],H=[{x:h.x,y:u.y}];if(m==="x"?y=i.x===g?H:k:y=i.y===g?k:H,e===o){const V=Math.abs(t[m]-n[m]);if(V<=l){const f=Math.min(l-1,l-V);i[m]===g?C[m]=(u[m]>t[m]?-1:1)*f:E[m]=(h[m]>n[m]?-1:1)*f}}if(e!==o){const V=m==="x"?"y":"x",f=i[m]===s[V],x=u[V]>h[V],w=u[V]<h[V];(i[m]===1&&(!f&&x||f&&w)||i[m]!==1&&(!f&&w||f&&x))&&(y=m==="x"?k:H)}const A={x:u.x+C.x,y:u.y+C.y},O={x:h.x+E.x,y:h.y+E.y},X=Math.max(Math.abs(A.x-y[0].x),Math.abs(O.x-y[0].x)),T=Math.max(Math.abs(A.y-y[0].y),Math.abs(O.y-y[0].y));X>=T?(M=(A.x+O.x)/2,N=y[0].y):(M=y[0].x,N=(A.y+O.y)/2)}return[[t,{x:u.x+C.x,y:u.y+C.y},...y,{x:h.x+E.x,y:h.y+E.y},n],M,N,p,_]}function wr(t,e,n,o){const r=Math.min(vo(t,e)/2,vo(e,n)/2,o),{x:l,y:i}=e;if(t.x===l&&l===n.x||t.y===i&&i===n.y)return`L${l} ${i}`;if(t.y===i){const h=t.x<n.x?-1:1,c=t.y<n.y?1:-1;return`L ${l+r*h},${i}Q ${l},${i} ${l},${i+r*c}`}const s=t.x<n.x?1:-1,u=t.y<n.y?-1:1;return`L ${l},${i+r*u}Q ${l},${i} ${l+r*s},${i}`}function rn({sourceX:t,sourceY:e,sourcePosition:n=ne.Bottom,targetX:o,targetY:r,targetPosition:l=ne.Top,borderRadius:i=5,centerX:s,centerY:u,offset:h=20}){const[c,m,g,y,M]=xr({source:{x:t,y:e},sourcePosition:n,target:{x:o,y:r},targetPosition:l,center:{x:s,y:u},offset:h});return[c.reduce((C,E,b)=>{let v="";return b>0&&b<c.length-1?v=wr(c[b-1],E,c[b+1],i):v=`${b===0?"M":"L"}${E.x} ${E.y}`,C+=v,C},""),m,g,y,M]}function bo(t){var e;return t&&!!(t.internals.handleBounds||(e=t.handles)!=null&&e.length)&&!!(t.measured.width||t.width||t.initialWidth)}function pr(t){var m;const{sourceNode:e,targetNode:n}=t;if(!bo(e)||!bo(n))return null;const o=e.internals.handleBounds||xo(e.handles),r=n.internals.handleBounds||xo(n.handles),l=wo((o==null?void 0:o.source)??[],t.sourceHandle),i=wo(t.connectionMode===bt.Strict?(r==null?void 0:r.target)??[]:((r==null?void 0:r.target)??[]).concat((r==null?void 0:r.source)??[]),t.targetHandle);if(!l||!i)return(m=t.onError)==null||m.call(t,"008",Tt.error008(l?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const s=(l==null?void 0:l.position)||ne.Bottom,u=(i==null?void 0:i.position)||ne.Top,h=Kt(e,l,s),c=Kt(n,i,u);return{sourceX:h.x,sourceY:h.y,targetX:c.x,targetY:c.y,sourcePosition:s,targetPosition:u}}function xo(t){if(!t)return null;const e=[],n=[];for(const o of t)o.width=o.width??1,o.height=o.height??1,o.type==="source"?e.push(o):o.type==="target"&&n.push(o);return{source:e,target:n}}function Kt(t,e,n=ne.Left,o=!1){const r=((e==null?void 0:e.x)??0)+t.internals.positionAbsolute.x,l=((e==null?void 0:e.y)??0)+t.internals.positionAbsolute.y,{width:i,height:s}=e??pt(t);if(o)return{x:r+i/2,y:l+s/2};switch((e==null?void 0:e.position)??n){case ne.Top:return{x:r+i/2,y:l};case ne.Right:return{x:r+i,y:l+s/2};case ne.Bottom:return{x:r+i/2,y:l+s};case ne.Left:return{x:r,y:l+s/2}}}function wo(t,e){return t&&(e?t.find(n=>n.id===e):t[0])||null}function Nn(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(o=>`${o}=${t[o]}`).join("&")}`:""}function _r(t,{id:e,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const l=new Set;return t.reduce((i,s)=>([s.markerStart||o,s.markerEnd||r].forEach(u=>{if(u&&typeof u=="object"){const h=Nn(u,e);l.has(h)||(i.push({id:h,color:u.color||n,...u}),l.add(h))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))}const Xn={nodeOrigin:[0,0],nodeExtent:$t,elevateNodesOnSelect:!0,defaults:{}},kr={...Xn,checkEquality:!0};function Rn(t,e){const n={...t};for(const o in e)e[o]!==void 0&&(n[o]=e[o]);return n}function Pr(t,e,n){const o=Rn(Xn,n);for(const r of t.values())if(r.parentId)Wn(r,t,e,o);else{const l=Ft(r,o.nodeOrigin),i=Ot(r.extent)?r.extent:o.nodeExtent,s=xt(l,i,pt(r));r.internals.positionAbsolute=s}}function Ko(t,e,n,o){var u,h;const r=Rn(kr,o);let l=t.length>0;const i=new Map(e),s=r!=null&&r.elevateNodesOnSelect?1e3:0;e.clear(),n.clear();for(const c of t){let m=i.get(c.id);if(r.checkEquality&&c===(m==null?void 0:m.internals.userNode))e.set(c.id,m);else{const g=Ft(c,r.nodeOrigin),y=Ot(c.extent)?c.extent:r.nodeExtent,M=xt(g,y,pt(c));m={...r.defaults,...c,measured:{width:(u=c.measured)==null?void 0:u.width,height:(h=c.measured)==null?void 0:h.height},internals:{positionAbsolute:M,handleBounds:c.measured?m==null?void 0:m.internals.handleBounds:void 0,z:Zo(c,s),userNode:c}},e.set(c.id,m)}(m.measured===void 0||m.measured.width===void 0||m.measured.height===void 0)&&!m.hidden&&(l=!1),c.parentId&&Wn(m,e,n,o)}return l}function Cr(t,e){if(!t.parentId)return;const n=e.get(t.parentId);n?n.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function Wn(t,e,n,o){const{elevateNodesOnSelect:r,nodeOrigin:l,nodeExtent:i}=Rn(Xn,o),s=t.parentId,u=e.get(s);if(!u){console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Cr(t,n);const h=r?1e3:0,{x:c,y:m,z:g}=Er(t,u,l,i,h),{positionAbsolute:y}=t.internals,M=c!==y.x||m!==y.y;(M||g!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:M?{x:c,y:m}:y,z:g}})}function Zo(t,e){return(dt(t.zIndex)?t.zIndex:0)+(t.selected?e:0)}function Er(t,e,n,o,r){const{x:l,y:i}=e.internals.positionAbsolute,s=pt(t),u=Ft(t,n),h=Ot(t.extent)?xt(u,t.extent,s):u;let c=xt({x:l+h.x,y:i+h.y},o,s);t.extent==="parent"&&(c=Lo(c,s,e));const m=Zo(t,r),g=e.internals.z??0;return{x:c.x,y:c.y,z:g>m?g:m}}function Mr(t,e,n,o=[0,0]){var i;const r=[],l=new Map;for(const s of t){const u=e.get(s.parentId);if(!u)continue;const h=((i=l.get(s.parentId))==null?void 0:i.expandedRect)??Ht(u),c=or(h,s.rect);l.set(s.parentId,{expandedRect:c,parent:u})}return l.size>0&&l.forEach(({expandedRect:s,parent:u},h)=>{var v;const c=u.internals.positionAbsolute,m=pt(u),g=u.origin??o,y=s.x<c.x?Math.round(Math.abs(c.x-s.x)):0,M=s.y<c.y?Math.round(Math.abs(c.y-s.y)):0,N=Math.max(m.width,Math.round(s.width)),C=Math.max(m.height,Math.round(s.height)),E=(N-m.width)*g[0],b=(C-m.height)*g[1];(y>0||M>0||E||b)&&(r.push({id:h,type:"position",position:{x:u.position.x-y+E,y:u.position.y-M+b}}),(v=n.get(h))==null||v.forEach(p=>{t.some(_=>_.id===p.id)||r.push({id:p.id,type:"position",position:{x:p.position.x+y,y:p.position.y+M}})})),(m.width<s.width||m.height<s.height||y||M)&&r.push({id:h,type:"dimensions",setAttributes:!0,dimensions:{width:N+(y?g[0]*y-E:0),height:C+(M?g[1]*M-b:0)}})}),r}function zr(t,e,n,o,r,l){const i=o==null?void 0:o.querySelector(".xyflow__viewport");let s=!1;if(!i)return{changes:[],updatedInternals:s};const u=[],h=window.getComputedStyle(i),{m22:c}=new window.DOMMatrixReadOnly(h.transform),m=[];for(const g of t.values()){const y=e.get(g.id);if(!y)continue;if(y.hidden){e.set(y.id,{...y,internals:{...y.internals,handleBounds:void 0}}),s=!0;continue}const M=Bo(g.nodeElement),N=y.measured.width!==M.width||y.measured.height!==M.height;if(!!(M.width&&M.height&&(N||!y.internals.handleBounds||g.force))){const E=g.nodeElement.getBoundingClientRect(),b=Ot(y.extent)?y.extent:l;let{positionAbsolute:v}=y.internals;y.parentId&&y.extent==="parent"?v=Lo(v,M,e.get(y.parentId)):b&&(v=xt(v,b,M));const p={...y,measured:M,internals:{...y.internals,positionAbsolute:v,handleBounds:{source:ho("source",g.nodeElement,E,c,y.id),target:ho("target",g.nodeElement,E,c,y.id)}}};e.set(y.id,p),y.parentId&&Wn(p,e,n,{nodeOrigin:r}),s=!0,N&&(u.push({id:y.id,type:"dimensions",dimensions:M}),y.expandParent&&y.parentId&&m.push({id:y.id,parentId:y.parentId,rect:Ht(p,r)}))}}if(m.length>0){const g=Mr(m,e,n,r);u.push(...g)}return{changes:u,updatedInternals:s}}async function Sr({delta:t,panZoom:e,transform:n,translateExtent:o,width:r,height:l}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const i=await e.setViewportConstrained({x:n[0]+t.x,y:n[1]+t.y,zoom:n[2]},[[0,0],[r,l]],o),s=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(s)}function po(t,e,n,o,r,l){let i=r;const s=o.get(i)||new Map;o.set(i,s.set(n,e)),i=`${r}-${t}`;const u=o.get(i)||new Map;if(o.set(i,u.set(n,e)),l){i=`${r}-${t}-${l}`;const h=o.get(i)||new Map;o.set(i,h.set(n,e))}}function Fo(t,e,n){t.clear(),e.clear();for(const o of n){const{source:r,target:l,sourceHandle:i=null,targetHandle:s=null}=o,u={edgeId:o.id,source:r,target:l,sourceHandle:i,targetHandle:s},h=`${r}-${i}--${l}-${s}`,c=`${l}-${s}--${r}-${i}`;po("source",u,c,t,r,i),po("target",u,h,t,l,s),e.set(o.id,o)}}function Go(t,e){if(!t.parentId)return!1;const n=e.get(t.parentId);return n?n.selected?!0:Go(n,e):!1}function _o(t,e,n){var r;let o=t;do{if((r=o==null?void 0:o.matches)!=null&&r.call(o,e))return!0;if(o===n)return!1;o=o==null?void 0:o.parentElement}while(o);return!1}function Nr(t,e,n,o){const r=new Map;for(const[l,i]of t)if((i.selected||i.id===o)&&(!i.parentId||!Go(i,t))&&(i.draggable||e&&typeof i.draggable>"u")){const s=t.get(l);s&&r.set(l,{id:l,position:s.position||{x:0,y:0},distance:{x:n.x-s.internals.positionAbsolute.x,y:n.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return r}function wn({nodeId:t,dragItems:e,nodeLookup:n,dragging:o=!0}){var i,s,u;const r=[];for(const[h,c]of e){const m=(i=n.get(h))==null?void 0:i.internals.userNode;m&&r.push({...m,position:c.position,dragging:o})}if(!t)return[r[0],r];const l=(s=n.get(t))==null?void 0:s.internals.userNode;return[l?{...l,position:((u=e.get(t))==null?void 0:u.position)||l.position,dragging:o}:r[0],r]}function Tr({onNodeMouseDown:t,getStoreItems:e,onDragStart:n,onDrag:o,onDragStop:r}){let l={x:null,y:null},i=0,s=new Map,u=!1,h={x:0,y:0},c=null,m=!1,g=null,y=!1;function M({noDragClassName:C,handleSelector:E,domNode:b,isSelectable:v,nodeId:p,nodeClickDistance:_=0}){g=st(b);function z({x:O,y:X},T){const{nodeLookup:V,nodeExtent:f,snapGrid:x,snapToGrid:w,nodeOrigin:S,onNodeDrag:I,onSelectionDrag:B,onError:L,updateNodePositions:R}=e();l={x:O,y:X};let K=!1,G={x:0,y:0,x2:0,y2:0};if(s.size>1&&f){const Z=ln(s);G=zn(Z)}for(const[Z,J]of s){if(!V.has(Z))continue;let oe={x:O-J.distance.x,y:X-J.distance.y};w&&(oe=Yn(oe,x));let ee=[[f[0][0],f[0][1]],[f[1][0],f[1][1]]];if(s.size>1&&f&&!J.extent){const{positionAbsolute:be}=J.internals,ye=be.x-G.x+f[0][0],U=be.x+J.measured.width-G.x2+f[1][0],ie=be.y-G.y+f[0][1],_e=be.y+J.measured.height-G.y2+f[1][1];ee=[[ye,ie],[U,_e]]}const{position:te,positionAbsolute:ge}=nr({nodeId:Z,nextPosition:oe,nodeLookup:V,nodeExtent:ee,nodeOrigin:S,onError:L});K=K||J.position.x!==te.x||J.position.y!==te.y,J.position=te,J.internals.positionAbsolute=ge}if(K&&(R(s,!0),T&&(o||I||!p&&B))){const[Z,J]=wn({nodeId:p,dragItems:s,nodeLookup:V});o==null||o(T,s,Z,J),I==null||I(T,Z,J),p||B==null||B(T,J)}}async function k(){if(!c)return;const{transform:O,panBy:X,autoPanSpeed:T,autoPanOnNodeDrag:V}=e();if(!V){u=!1,cancelAnimationFrame(i);return}const[f,x]=Yo(h,c,T);(f!==0||x!==0)&&(l.x=(l.x??0)-f/O[2],l.y=(l.y??0)-x/O[2],await X({x:f,y:x})&&z(l,null)),i=requestAnimationFrame(k)}function H(O){var K;const{nodeLookup:X,multiSelectionActive:T,nodesDraggable:V,transform:f,snapGrid:x,snapToGrid:w,selectNodesOnDrag:S,onNodeDragStart:I,onSelectionDragStart:B,unselectNodesAndEdges:L}=e();m=!0,(!S||!v)&&!T&&p&&((K=X.get(p))!=null&&K.selected||L()),v&&S&&p&&(t==null||t(p));const R=xn(O.sourceEvent,{transform:f,snapGrid:x,snapToGrid:w,containerBounds:c});if(l=R,s=Nr(X,V,R,p),s.size>0&&(n||I||!p&&B)){const[G,Z]=wn({nodeId:p,dragItems:s,nodeLookup:X});n==null||n(O.sourceEvent,s,G,Z),I==null||I(O.sourceEvent,G,Z),p||B==null||B(O.sourceEvent,Z)}}const A=Ri().clickDistance(_).on("start",O=>{const{domNode:X,nodeDragThreshold:T,transform:V,snapGrid:f,snapToGrid:x}=e();c=(X==null?void 0:X.getBoundingClientRect())||null,y=!1,T===0&&H(O),l=xn(O.sourceEvent,{transform:V,snapGrid:f,snapToGrid:x,containerBounds:c}),h=ht(O.sourceEvent,c)}).on("drag",O=>{const{autoPanOnNodeDrag:X,transform:T,snapGrid:V,snapToGrid:f,nodeDragThreshold:x,nodeLookup:w}=e(),S=xn(O.sourceEvent,{transform:T,snapGrid:V,snapToGrid:f,containerBounds:c});if((O.sourceEvent.type==="touchmove"&&O.sourceEvent.touches.length>1||p&&!w.has(p))&&(y=!0),!y){if(!u&&X&&m&&(u=!0,k()),!m){const I=S.xSnapped-(l.x??0),B=S.ySnapped-(l.y??0);Math.sqrt(I*I+B*B)>x&&H(O)}(l.x!==S.xSnapped||l.y!==S.ySnapped)&&s&&m&&(h=ht(O.sourceEvent,c),z(S,O.sourceEvent))}}).on("end",O=>{if(!(!m||y)&&(u=!1,m=!1,cancelAnimationFrame(i),s.size>0)){const{nodeLookup:X,updateNodePositions:T,onNodeDragStop:V,onSelectionDragStop:f}=e();if(T(s,!1),r||V||!p&&f){const[x,w]=wn({nodeId:p,dragItems:s,nodeLookup:X,dragging:!1});r==null||r(O.sourceEvent,s,x,w),V==null||V(O.sourceEvent,x,w),p||f==null||f(O.sourceEvent,w)}}}).filter(O=>{const X=O.target;return!O.button&&(!C||!_o(X,`.${C}`,b))&&(!E||_o(X,E,b))});g.call(A)}function N(){g==null||g.on(".drag",null)}return{update:M,destroy:N}}function Ir(t,e,n){const o=[],r={x:t.x-n,y:t.y-n,width:n*2,height:n*2};for(const l of e.values())Wt(r,Ht(l))>0&&o.push(l);return o}const Hr=250;function Or(t,e,n,o){var s,u;let r=[],l=1/0;const i=Ir(t,n,e+Hr);for(const h of i){const c=[...((s=h.internals.handleBounds)==null?void 0:s.source)??[],...((u=h.internals.handleBounds)==null?void 0:u.target)??[]];for(const m of c){if(o.nodeId===m.nodeId&&o.type===m.type&&o.id===m.id)continue;const{x:g,y}=Kt(h,m,m.position,!0),M=Math.sqrt(Math.pow(g-t.x,2)+Math.pow(y-t.y,2));M>e||(M<l?(r=[{...m,x:g,y}],l=M):M===l&&r.push({...m,x:g,y}))}}if(!r.length)return null;if(r.length>1){const h=o.type==="source"?"target":"source";return r.find(c=>c.type===h)??r[0]}return r[0]}function jo(t,e,n,o,r,l=!1){var h,c,m;const i=o.get(t);if(!i)return null;const s=r==="strict"?(h=i.internals.handleBounds)==null?void 0:h[e]:[...((c=i.internals.handleBounds)==null?void 0:c.source)??[],...((m=i.internals.handleBounds)==null?void 0:m.target)??[]],u=(n?s==null?void 0:s.find(g=>g.id===n):s==null?void 0:s[0])??null;return u&&l?{...u,...Kt(i,u,u.position,!0)}:u}function Uo(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Dr(t,e){let n=null;return e?n=!0:t&&!e&&(n=!1),n}const qo=()=>!0;function Ar(t,{connectionMode:e,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:l,isTarget:i,domNode:s,nodeLookup:u,lib:h,autoPanOnConnect:c,flowId:m,panBy:g,cancelConnection:y,onConnectStart:M,onConnect:N,onConnectEnd:C,isValidConnection:E=qo,onReconnectEnd:b,updateConnection:v,getTransform:p,getFromHandle:_,autoPanSpeed:z}){const k=cr(t.target);let H=0,A;const{x:O,y:X}=ht(t),T=k==null?void 0:k.elementFromPoint(O,X),V=Uo(l,T),f=s==null?void 0:s.getBoundingClientRect();if(!f||!V)return;const x=jo(r,V,o,u,e);if(!x)return;let w=ht(t,f),S=!1,I=null,B=!1,L=null;function R(){if(!c||!f)return;const[ge,be]=Yo(w,f,z);g({x:ge,y:be}),H=requestAnimationFrame(R)}const K={...x,nodeId:r,type:V,position:x.position},G=u.get(r),J={inProgress:!0,isValid:null,from:Kt(G,K,ne.Left,!0),fromHandle:K,fromPosition:K.position,fromNode:G,to:w,toHandle:null,toPosition:lo[K.position],toNode:null};v(J);let oe=J;M==null||M(t,{nodeId:r,handleId:o,handleType:V});function ee(ge){if(!_()||!K){te(ge);return}const be=p();w=ht(ge,f),A=Or(Gt(w,be,!1,[1,1]),n,u,K),S||(R(),S=!0);const ye=Jo(ge,{handle:A,connectionMode:e,fromNodeId:r,fromHandleId:o,fromType:i?"target":"source",isValidConnection:E,doc:k,lib:h,flowId:m,nodeLookup:u});L=ye.handleDomNode,I=ye.connection,B=Dr(!!A,ye.isValid);const U={...oe,isValid:B,to:A&&B?nn({x:A.x,y:A.y},be):w,toHandle:ye.toHandle,toPosition:B&&ye.toHandle?ye.toHandle.position:lo[K.position],toNode:ye.toHandle?u.get(ye.toHandle.nodeId):null};B&&A&&oe.toHandle&&U.toHandle&&oe.toHandle.type===U.toHandle.type&&oe.toHandle.nodeId===U.toHandle.nodeId&&oe.toHandle.id===U.toHandle.id&&oe.to.x===U.to.x&&oe.to.y===U.to.y||(v(U),oe=U)}function te(ge){(A||L)&&I&&B&&(N==null||N(I));const{inProgress:be,...ye}=oe,U={...ye,toPosition:oe.toHandle?oe.toPosition:null};C==null||C(ge,U),l&&(b==null||b(ge,U)),y(),cancelAnimationFrame(H),S=!1,B=!1,I=null,L=null,k.removeEventListener("mousemove",ee),k.removeEventListener("mouseup",te),k.removeEventListener("touchmove",ee),k.removeEventListener("touchend",te)}k.addEventListener("mousemove",ee),k.addEventListener("mouseup",te),k.addEventListener("touchmove",ee),k.addEventListener("touchend",te)}function Jo(t,{handle:e,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:l,doc:i,lib:s,flowId:u,isValidConnection:h=qo,nodeLookup:c}){const m=l==="target",g=e?i.querySelector(`.${s}-flow__handle[data-id="${u}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:y,y:M}=ht(t),N=i.elementFromPoint(y,M),C=N!=null&&N.classList.contains(`${s}-flow__handle`)?N:g,E={handleDomNode:C,isValid:!1,connection:null,toHandle:null};if(C){const b=Uo(void 0,C),v=C.getAttribute("data-nodeid"),p=C.getAttribute("data-handleid"),_=C.classList.contains("connectable"),z=C.classList.contains("connectableend");if(!v||!b)return E;const k={source:m?v:o,sourceHandle:m?p:r,target:m?o:v,targetHandle:m?r:p};E.connection=k;const A=_&&z&&(n===bt.Strict?m&&b==="source"||!m&&b==="target":v!==o||p!==r);E.isValid=A&&h(k),E.toHandle=jo(v,b,p,c,n,!1)}return E}const Vr={onPointerDown:Ar,isValid:Jo},Lr=(t,e)=>t.x!==e.x||t.y!==e.y||t.zoom!==e.k,dn=t=>({x:t.x,y:t.y,zoom:t.k}),pn=({x:t,y:e,zoom:n})=>Dn.translate(t,e).scale(n),Pt=(t,e)=>t.target.closest(`.${e}`),Qo=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),_n=(t,e=0,n=()=>{})=>{const o=typeof e=="number"&&e>0;return o||n(),o?t.transition().duration(e).on("end",n):t},$o=t=>{const e=t.ctrlKey&&on()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function Yr({zoomPanValues:t,noWheelClassName:e,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:l,zoomOnPinch:i,onPanZoomStart:s,onPanZoom:u,onPanZoomEnd:h}){return c=>{if(Pt(c,e))return!1;c.preventDefault(),c.stopImmediatePropagation();const m=n.property("__zoom").k||1;if(c.ctrlKey&&i){const C=ct(c),E=$o(c),b=m*Math.pow(2,E);o.scaleTo(n,b,C,c);return}const g=c.deltaMode===1?20:1;let y=r===gt.Vertical?0:c.deltaX*g,M=r===gt.Horizontal?0:c.deltaY*g;!on()&&c.shiftKey&&r!==gt.Vertical&&(y=c.deltaY*g,M=0),o.translateBy(n,-(y/m)*l,-(M/m)*l,{internal:!0});const N=dn(n.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling||(t.isPanScrolling=!0,s==null||s(c,N)),t.isPanScrolling&&(u==null||u(c,N),t.panScrollTimeout=setTimeout(()=>{h==null||h(c,N),t.isPanScrolling=!1},150))}}function Br({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:n}){return function(o,r){const l=o.type==="wheel",i=!e&&l&&!o.ctrlKey,s=Pt(o,t);if(o.ctrlKey&&l&&s&&o.preventDefault(),i||s)return null;o.preventDefault(),n.call(this,o,r)}}function Xr({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:n}){return o=>{var l,i,s;if((l=o.sourceEvent)!=null&&l.internal)return;const r=dn(o.transform);t.mouseButton=((i=o.sourceEvent)==null?void 0:i.button)||0,t.isZoomingOrPanning=!0,t.prevViewport=r,((s=o.sourceEvent)==null?void 0:s.type)==="mousedown"&&e(!0),n&&(n==null||n(o.sourceEvent,r))}}function Rr({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return l=>{var i,s;t.usedRightMouseButton=!!(n&&Qo(e,t.mouseButton??0)),(i=l.sourceEvent)!=null&&i.sync||o([l.transform.x,l.transform.y,l.transform.k]),r&&!((s=l.sourceEvent)!=null&&s.internal)&&(r==null||r(l.sourceEvent,dn(l.transform)))}}function Wr({zoomPanValues:t,panOnDrag:e,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:l}){return i=>{var s;if(!((s=i.sourceEvent)!=null&&s.internal)&&(t.isZoomingOrPanning=!1,l&&Qo(e,t.mouseButton??0)&&!t.usedRightMouseButton&&i.sourceEvent&&l(i.sourceEvent),t.usedRightMouseButton=!1,o(!1),r&&Lr(t.prevViewport,i.transform))){const u=dn(i.transform);t.prevViewport=u,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{r==null||r(i.sourceEvent,u)},n?150:0)}}}function Kr({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:l,userSelectionActive:i,noWheelClassName:s,noPanClassName:u,lib:h}){return c=>{var M;const m=t||e,g=n&&c.ctrlKey;if(c.button===1&&c.type==="mousedown"&&(Pt(c,`${h}-flow__node`)||Pt(c,`${h}-flow__edge`)))return!0;if(!o&&!m&&!r&&!l&&!n||i||Pt(c,s)&&c.type==="wheel"||Pt(c,u)&&(c.type!=="wheel"||r&&c.type==="wheel"&&!t)||!n&&c.ctrlKey&&c.type==="wheel")return!1;if(!n&&c.type==="touchstart"&&((M=c.touches)==null?void 0:M.length)>1)return c.preventDefault(),!1;if(!m&&!r&&!g&&c.type==="wheel"||!o&&(c.type==="mousedown"||c.type==="touchstart")||Array.isArray(o)&&!o.includes(c.button)&&c.type==="mousedown")return!1;const y=Array.isArray(o)&&o.includes(c.button)||!c.button||c.button<=1;return(!c.ctrlKey||c.type==="wheel")&&y}}function Zr({domNode:t,minZoom:e,maxZoom:n,paneClickDistance:o,translateExtent:r,viewport:l,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:u,onDraggingChange:h}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},m=t.getBoundingClientRect(),g=Ui().clickDistance(!dt(o)||o<0?0:o).scaleExtent([e,n]).translateExtent(r),y=st(t).call(g);v({x:l.x,y:l.y,zoom:It(l.zoom,e,n)},[[0,0],[m.width,m.height]],r);const M=y.on("wheel.zoom"),N=y.on("dblclick.zoom");g.wheelDelta($o);function C(T,V){return y?new Promise(f=>{g==null||g.transform(_n(y,V==null?void 0:V.duration,()=>f(!0)),T)}):Promise.resolve(!1)}function E({noWheelClassName:T,noPanClassName:V,onPaneContextMenu:f,userSelectionActive:x,panOnScroll:w,panOnDrag:S,panOnScrollMode:I,panOnScrollSpeed:B,preventScrolling:L,zoomOnPinch:R,zoomOnScroll:K,zoomOnDoubleClick:G,zoomActivationKeyPressed:Z,lib:J,onTransformChange:oe}){x&&!c.isZoomingOrPanning&&b();const te=w&&!Z&&!x?Yr({zoomPanValues:c,noWheelClassName:T,d3Selection:y,d3Zoom:g,panOnScrollMode:I,panOnScrollSpeed:B,zoomOnPinch:R,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:u}):Br({noWheelClassName:T,preventScrolling:L,d3ZoomHandler:M});if(y.on("wheel.zoom",te,{passive:!1}),!x){const be=Xr({zoomPanValues:c,onDraggingChange:h,onPanZoomStart:s});g.on("start",be);const ye=Rr({zoomPanValues:c,panOnDrag:S,onPaneContextMenu:!!f,onPanZoom:i,onTransformChange:oe});g.on("zoom",ye);const U=Wr({zoomPanValues:c,panOnDrag:S,panOnScroll:w,onPaneContextMenu:f,onPanZoomEnd:u,onDraggingChange:h});g.on("end",U)}const ge=Kr({zoomActivationKeyPressed:Z,panOnDrag:S,zoomOnScroll:K,panOnScroll:w,zoomOnDoubleClick:G,zoomOnPinch:R,userSelectionActive:x,noPanClassName:V,noWheelClassName:T,lib:J});g.filter(ge),G?y.on("dblclick.zoom",N):y.on("dblclick.zoom",null)}function b(){g.on("zoom",null)}async function v(T,V,f){const x=pn(T),w=g==null?void 0:g.constrain()(x,V,f);return w&&await C(w),new Promise(S=>S(w))}async function p(T,V){const f=pn(T);return await C(f,V),new Promise(x=>x(f))}function _(T){if(y){const V=pn(T),f=y.property("__zoom");(f.k!==T.zoom||f.x!==T.x||f.y!==T.y)&&(g==null||g.transform(y,V,null,{sync:!0}))}}function z(){const T=y?Hi(y.node()):{x:0,y:0,k:1};return{x:T.x,y:T.y,zoom:T.k}}function k(T,V){return y?new Promise(f=>{g==null||g.scaleTo(_n(y,V==null?void 0:V.duration,()=>f(!0)),T)}):Promise.resolve(!1)}function H(T,V){return y?new Promise(f=>{g==null||g.scaleBy(_n(y,V==null?void 0:V.duration,()=>f(!0)),T)}):Promise.resolve(!1)}function A(T){g==null||g.scaleExtent(T)}function O(T){g==null||g.translateExtent(T)}function X(T){const V=!dt(T)||T<0?0:T;g==null||g.clickDistance(V)}return{update:E,destroy:b,setViewport:p,setViewportConstrained:v,getViewport:z,scaleTo:k,scaleBy:H,setScaleExtent:A,setTranslateExtent:O,syncViewport:_,setClickDistance:X}}var ko;(function(t){t.Line="line",t.Handle="handle"})(ko||(ko={}));var Fr=pe('<div role="button" tabindex="-1"><!></div>');function Dt(t,e){de(e,!1);const n=()=>W(G,"$connectable",v),o=()=>W(te,"$connectionRadius",v),r=()=>W(oe,"$domNode",v),l=()=>W(ee,"$nodeLookup",v),i=()=>W(J,"$connectionMode",v),s=()=>W(ye,"$lib",v),u=()=>W(Be,"$autoPanOnConnect",v),h=()=>W($e,"$flowId",v),c=()=>W(be,"$isValidConnectionStore",v),m=()=>W(ie,"$onedgecreate",v),g=()=>W(Me,"$onConnectAction",v),y=()=>W(ce,"$onConnectStartAction",v),M=()=>W(Je,"$onConnectEndAction",v),N=()=>W(ge,"$viewport",v),C=()=>W(ot,"$connection",v),E=()=>W(Ne,"$edges",v),b=()=>W(Xe,"$connectionLookup",v),[v,p]=Ye(),_=q(),z=q(),k=q(),H=q(),A=q(),O=q(),X=q(),T=q();let V=d(e,"id",8,void 0),f=d(e,"type",8,"source"),x=d(e,"position",24,()=>ne.Top),w=d(e,"style",8,void 0),S=d(e,"isValidConnection",8,void 0),I=d(e,"onconnect",8,void 0),B=d(e,"ondisconnect",8,void 0),L=d(e,"isConnectable",8,void 0),R=d(e,"class",8,void 0);const K=Nt("svelteflow__node_id"),G=Nt("svelteflow__node_connectable"),Z=De(),{connectionMode:J,domNode:oe,nodeLookup:ee,connectionRadius:te,viewport:ge,isValidConnection:be,lib:ye,addEdge:U,onedgecreate:ie,panBy:_e,cancelConnection:xe,updateConnection:ke,autoPanOnConnect:Be,edges:Ne,connectionLookup:Xe,onconnect:Me,onconnectstart:ce,onconnectend:Je,flowId:$e,connection:ot}=Z;function Re(ze){const He=Xo(ze);(He&&ze.button===0||!He)&&Vr.onPointerDown(ze,{handleId:a(k),nodeId:K,isTarget:a(_),connectionRadius:o(),domNode:r(),nodeLookup:l(),connectionMode:i(),lib:s(),autoPanOnConnect:u(),flowId:h(),isValidConnection:S()??c(),updateConnection:ke,cancelConnection:xe,panBy:_e,onConnect:Ee=>{var et;const Fe=m()?m()(Ee):Ee;Fe&&(U(Fe),(et=g())==null||et(Ee))},onConnectStart:(Ee,Fe)=>{var et;(et=y())==null||et(Ee,{nodeId:Fe.nodeId,handleId:Fe.handleId,handleType:Fe.handleType})},onConnectEnd:(Ee,Fe)=>{var et;(et=M())==null||et(Ee,Fe)},getTransform:()=>[N().x,N().y,N().zoom],getFromHandle:()=>C().fromHandle})}let Ie=q(null),We=q();$(()=>P(f()),()=>{F(_,f()==="target")}),$(()=>(P(L()),n()),()=>{F(z,L()!==void 0?L():n())}),$(()=>P(V()),()=>{F(k,V()||null)}),$(()=>(P(I()),P(B()),E(),b(),P(f()),P(V())),()=>{(I()||B())&&(E(),F(We,b().get(`${K}-${f()}${V()?`-${V()}`:""}`)))}),$(()=>(a(Ie),a(We),P(B()),P(I())),()=>{if(a(Ie)&&!qi(a(We),a(Ie))){const ze=a(We)??new Map;ao(a(Ie),ze,B()),ao(ze,a(Ie),I())}F(Ie,a(We)??new Map)}),$(()=>C(),()=>{F(H,!!C().fromHandle)}),$(()=>(C(),P(f()),a(k)),()=>{var ze,He,Ee;F(A,((ze=C().fromHandle)==null?void 0:ze.nodeId)===K&&((He=C().fromHandle)==null?void 0:He.type)===f()&&((Ee=C().fromHandle)==null?void 0:Ee.id)===a(k))}),$(()=>(C(),P(f()),a(k)),()=>{var ze,He,Ee;F(O,((ze=C().toHandle)==null?void 0:ze.nodeId)===K&&((He=C().toHandle)==null?void 0:He.type)===f()&&((Ee=C().toHandle)==null?void 0:Ee.id)===a(k))}),$(()=>(i(),C(),P(f()),a(k)),()=>{var ze,He,Ee;F(X,i()===bt.Strict?((ze=C().fromHandle)==null?void 0:ze.type)!==f():K!==((He=C().fromHandle)==null?void 0:He.nodeId)||a(k)!==((Ee=C().fromHandle)==null?void 0:Ee.id))}),$(()=>(a(O),C()),()=>{F(T,a(O)&&C().isValid)}),Ge(),fe();var Ze=Fr();let vt;var Se=ae(Ze);Ue(Se,e,"default",{},null),se(Ze),we(ze=>{le(Ze,"data-handleid",a(k)),le(Ze,"data-nodeid",K),le(Ze,"data-handlepos",x()),le(Ze,"data-id",`${h()??""}-${K??""}-${(V()||"")??""}-${f()??""}`),vt=Qe(Ze,1,ze,null,vt,{valid:a(T),connectingto:a(O),connectingfrom:a(A),source:!a(_),target:a(_),connectablestart:a(z),connectableend:a(z),connectable:a(z),connectionindicator:a(z)&&(!a(H)||a(X))}),lt(Ze,w())},[()=>nt((P(Te),P(x()),P(R()),D(()=>Te(["svelte-flow__handle",`svelte-flow__handle-${x()}`,"nodrag","nopan",x(),R()]))))]),Ce("mousedown",Ze,Re),Ce("touchstart",Ze,Re),j(t,Ze),ue(),p()}var Gr=pe("<!> <!>",1);function Tn(t,e){const n=Oe(e,["children","$$slots","$$events","$$legacy"]);Oe(n,["data","targetPosition","sourcePosition"]),de(e,!1);let o=d(e,"data",24,()=>({label:"Node"})),r=d(e,"targetPosition",8,void 0),l=d(e,"sourcePosition",8,void 0);fe();var i=Gr(),s=Ve(i);{let c=re(()=>(P(r()),P(ne),D(()=>r()??ne.Top)));Dt(s,{type:"target",get position(){return a(c)}})}var u=me(s),h=me(u);{let c=re(()=>(P(l()),P(ne),D(()=>l()??ne.Bottom)));Dt(h,{type:"source",get position(){return a(c)}})}we(()=>rt(u,` ${P(o()),D(()=>{var c;return(c=o())==null?void 0:c.label})??""} `)),j(t,i),ue()}var jr=pe(" <!>",1);function Ur(t,e){const n=Oe(e,["children","$$slots","$$events","$$legacy"]);Oe(n,["data","sourcePosition"]),de(e,!1);let o=d(e,"data",24,()=>({label:"Node"})),r=d(e,"sourcePosition",8,void 0);fe(),Hn();var l=jr(),i=Ve(l),s=me(i);{let u=re(()=>(P(r()),P(ne),D(()=>r()??ne.Bottom)));Dt(s,{type:"source",get position(){return a(u)}})}we(()=>rt(i,`${P(o()),D(()=>{var u;return(u=o())==null?void 0:u.label})??""} `)),j(t,l),ue()}var qr=pe(" <!>",1);function Jr(t,e){const n=Oe(e,["children","$$slots","$$events","$$legacy"]);Oe(n,["data","targetPosition"]),de(e,!1);let o=d(e,"data",24,()=>({label:"Node"})),r=d(e,"targetPosition",8,void 0);fe(),Hn();var l=qr(),i=Ve(l),s=me(i);{let u=re(()=>(P(r()),P(ne),D(()=>r()??ne.Top)));Dt(s,{type:"target",get position(){return a(u)}})}we(()=>rt(i,`${P(o()),D(()=>{var u;return(u=o())==null?void 0:u.label})??""} `)),j(t,l),ue()}function Qr(t,e){const n=Oe(e,["children","$$slots","$$events","$$legacy"]);Oe(n,[])}function Po(t,e,n){if(!e)return;const o=n?e.querySelector(n):e;o&&o.appendChild(t)}function kn(t,{target:e,domNode:n}){return Po(t,n,e),{async update({target:o,domNode:r}){Po(t,r,o)},destroy(){t.parentNode&&t.parentNode.removeChild(t)}}}var $r=pe("<div><!></div>");function es(t,e){de(e,!1);const n=()=>W(l,"$domNode",o),[o,r]=Ye(),{domNode:l}=De();fe();var i=$r(),s=ae(i);Ue(s,e,"default",{},null),se(i),qe(i,(u,h)=>kn==null?void 0:kn(u,h),()=>({target:".svelte-flow__edgelabel-renderer",domNode:n()})),j(t,i),ue(),r()}function ei(){const{edgeLookup:t,selectionRect:e,selectionRectMode:n,multiselectionKeyPressed:o,addSelectedEdges:r,unselectNodesAndEdges:l,elementsSelectable:i}=De();return s=>{const u=Y(t).get(s);if(!u){console.warn("012",Tt.error012(s));return}(u.selectable||Y(i)&&typeof u.selectable>"u")&&(e.set(null),n.set(null),u.selected?u.selected&&Y(o)&&l({nodes:[],edges:[u]}):r([s]))}}var ts=pe('<div class="svelte-flow__edge-label" role="button" tabindex="-1"><!></div>');function ns(t,e){de(e,!1);let n=d(e,"style",8,void 0),o=d(e,"x",8,void 0),r=d(e,"y",8,void 0);const l=ei(),i=Nt("svelteflow__edge_id");fe(),es(t,{children:(s,u)=>{var h=ts();let c;var m=ae(h);Ue(m,e,"default",{},null),se(h),we(()=>c=lt(h,"pointer-events: all;"+n(),c,{transform:`translate(-50%, -50%) translate(${o()??""}px,${r()??""}px)`})),Ce("keyup",h,()=>{}),Ce("click",h,()=>{i&&l(i)}),j(s,h)},$$slots:{default:!0}}),ue()}var os=Le('<path fill="none" class="svelte-flow__edge-interaction"></path>'),is=Le('<path fill="none"></path><!><!>',1);function un(t,e){de(e,!1);let n=d(e,"id",8,void 0),o=d(e,"path",8),r=d(e,"label",8,void 0),l=d(e,"labelX",8,void 0),i=d(e,"labelY",8,void 0),s=d(e,"labelStyle",8,void 0),u=d(e,"markerStart",8,void 0),h=d(e,"markerEnd",8,void 0),c=d(e,"style",8,void 0),m=d(e,"interactionWidth",8,20),g=d(e,"class",8,void 0),y=m()===void 0?20:m();fe();var M=is(),N=Ve(M),C=me(N);{var E=p=>{var _=os();le(_,"stroke-opacity",0),we(()=>{le(_,"d",o()),le(_,"stroke-width",y)}),j(p,_)};Ae(C,p=>{y&&p(E)})}var b=me(C);{var v=p=>{ns(p,{get x(){return l()},get y(){return i()},get style(){return s()},children:(_,z)=>{Hn();var k=ki();we(()=>rt(k,r())),j(_,k)},$$slots:{default:!0}})};Ae(b,p=>{r()&&p(v)})}we(p=>{le(N,"id",n()),le(N,"d",o()),Qe(N,0,p),le(N,"marker-start",u()),le(N,"marker-end",h()),lt(N,c())},[()=>nt((P(Te),P(g()),D(()=>Te(["svelte-flow__edge-path",g()]))))]),j(t,M),ue()}function In(t,e){const n=Oe(e,["children","$$slots","$$events","$$legacy"]);Oe(n,["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"]),de(e,!1);const o=q(),r=q(),l=q();let i=d(e,"label",8,void 0),s=d(e,"labelStyle",8,void 0),u=d(e,"style",8,void 0),h=d(e,"markerStart",8,void 0),c=d(e,"markerEnd",8,void 0),m=d(e,"interactionWidth",8,void 0),g=d(e,"sourceX",8),y=d(e,"sourceY",8),M=d(e,"sourcePosition",8),N=d(e,"targetX",8),C=d(e,"targetY",8),E=d(e,"targetPosition",8);$(()=>(a(o),a(r),a(l),P(g()),P(y()),P(N()),P(C()),P(M()),P(E())),()=>{(b=>{var v=yt(b,3);F(o,v[0]),F(r,v[1]),F(l,v[2])})(Ro({sourceX:g(),sourceY:y(),targetX:N(),targetY:C(),sourcePosition:M(),targetPosition:E()}))}),Ge(),fe(),un(t,{get path(){return a(o)},get labelX(){return a(r)},get labelY(){return a(l)},get label(){return i()},get labelStyle(){return s()},get markerStart(){return h()},get markerEnd(){return c()},get interactionWidth(){return m()},get style(){return u()}}),ue()}function rs(t,e){const n=Oe(e,["children","$$slots","$$events","$$legacy"]);Oe(n,["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"]),de(e,!1);const o=q(),r=q(),l=q();let i=d(e,"label",8,void 0),s=d(e,"labelStyle",8,void 0),u=d(e,"style",8,void 0),h=d(e,"markerStart",8,void 0),c=d(e,"markerEnd",8,void 0),m=d(e,"interactionWidth",8,void 0),g=d(e,"sourceX",8),y=d(e,"sourceY",8),M=d(e,"sourcePosition",8),N=d(e,"targetX",8),C=d(e,"targetY",8),E=d(e,"targetPosition",8);$(()=>(a(o),a(r),a(l),P(g()),P(y()),P(N()),P(C()),P(M()),P(E())),()=>{(b=>{var v=yt(b,3);F(o,v[0]),F(r,v[1]),F(l,v[2])})(rn({sourceX:g(),sourceY:y(),targetX:N(),targetY:C(),sourcePosition:M(),targetPosition:E()}))}),Ge(),fe(),un(t,{get path(){return a(o)},get labelX(){return a(r)},get labelY(){return a(l)},get label(){return i()},get labelStyle(){return s()},get markerStart(){return h()},get markerEnd(){return c()},get interactionWidth(){return m()},get style(){return u()}}),ue()}function ss(t,e){const n=Oe(e,["children","$$slots","$$events","$$legacy"]);Oe(n,["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","targetX","targetY"]),de(e,!1);const o=q(),r=q(),l=q();let i=d(e,"label",8,void 0),s=d(e,"labelStyle",8,void 0),u=d(e,"style",8,void 0),h=d(e,"markerStart",8,void 0),c=d(e,"markerEnd",8,void 0),m=d(e,"interactionWidth",8,void 0),g=d(e,"sourceX",8),y=d(e,"sourceY",8),M=d(e,"targetX",8),N=d(e,"targetY",8);$(()=>(a(o),a(r),a(l),P(g()),P(y()),P(M()),P(N())),()=>{(C=>{var E=yt(C,3);F(o,E[0]),F(r,E[1]),F(l,E[2])})(Sn({sourceX:g(),sourceY:y(),targetX:M(),targetY:N()}))}),Ge(),fe(),un(t,{get path(){return a(o)},get labelX(){return a(r)},get labelY(){return a(l)},get label(){return i()},get labelStyle(){return s()},get markerStart(){return h()},get markerEnd(){return c()},get interactionWidth(){return m()},get style(){return u()}}),ue()}function ls(t,e){const n=Oe(e,["children","$$slots","$$events","$$legacy"]);Oe(n,["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"]),de(e,!1);const o=q(),r=q(),l=q();let i=d(e,"label",8,void 0),s=d(e,"labelStyle",8,void 0),u=d(e,"style",8,void 0),h=d(e,"markerStart",8,void 0),c=d(e,"markerEnd",8,void 0),m=d(e,"interactionWidth",8,void 0),g=d(e,"sourceX",8),y=d(e,"sourceY",8),M=d(e,"sourcePosition",8),N=d(e,"targetX",8),C=d(e,"targetY",8),E=d(e,"targetPosition",8);$(()=>(a(o),a(r),a(l),P(g()),P(y()),P(N()),P(C()),P(M()),P(E())),()=>{(b=>{var v=yt(b,3);F(o,v[0]),F(r,v[1]),F(l,v[2])})(rn({sourceX:g(),sourceY:y(),targetX:N(),targetY:C(),sourcePosition:M(),targetPosition:E(),borderRadius:0}))}),Ge(),fe(),un(t,{get path(){return a(o)},get labelX(){return a(r)},get labelY(){return a(l)},get label(){return i()},get labelStyle(){return s()},get markerStart(){return h()},get markerEnd(){return c()},get interactionWidth(){return m()},get style(){return u()}}),ue()}function as(t,e){const n=t.set,o=e.set,r=Y(t),l=Y(e);let s=r.length===0&&l.length>0?l:r;t.set(s);const u=h=>{const c=n(h);return s=c,o(s),c};t.set=e.set=u,t.update=e.update=h=>u(h(s))}function cs(t,e){const n=t.set,o=e.set;let r=Y(e);t.set(r);const l=i=>{n(i),o(i),r=i};t.set=e.set=l,t.update=e.update=i=>l(i(r))}const ds=(t,e,n)=>{if(!n)return;const o=Y(t),r=e.set,l=n.set;let i=n?Y(n):{x:0,y:0,zoom:1};e.set(i),e.set=s=>(r(s),l(s),i=s,s),n.set=s=>(o==null||o.syncViewport(s),r(s),l(s),i=s,s),e.update=s=>{e.set(s(i))},n.update=s=>{n.set(s(i))}},us=(t,e,n,o=[0,0],r=$t,l,i,s,u,h,c,m,g)=>{const{subscribe:y,set:M,update:N}=Q([]);let C=t,E={},b=!0;const v=k=>{const H=Ko(k,e,n,{elevateNodesOnSelect:b,nodeOrigin:o,nodeExtent:r,defaults:E,checkEquality:!1});return Y(l)&&H&&Y(u)&&(tr({nodes:e,width:Y(h),height:Y(c),panZoom:Y(u),minZoom:Y(m),maxZoom:Y(g)},Y(i)).then(O=>{var X;(X=Y(s))==null||X.resolve(O),s.set(null)}),l.set(!1),i.set(void 0)),C=k,M(C),C},p=k=>v(k(C)),_=k=>{E=k},z=k=>{b=k.elevateNodesOnSelect??b};return v(C),{subscribe:y,set:v,update:p,setDefaultOptions:_,setOptions:z}},fs=(t,e,n,o)=>{const{subscribe:r,set:l,update:i}=Q([]);let s=t,u={};const h=g=>{const y=u?g.map(M=>({...u,...M})):g;Fo(e,n,y),s=y,l(s)},c=g=>h(g(s)),m=g=>{u=g};return h(s),{subscribe:r,set:h,update:c,setDefaultOptions:m}},ti={input:Ur,output:Jr,default:Tn,group:Qr},ni={straight:ss,smoothstep:rs,default:In,step:ls},gs=({nodes:t=[],edges:e=[],width:n,height:o,fitView:r,nodeOrigin:l,nodeExtent:i})=>{const s=new Map,u=new Map,h=new Map,c=new Map,m=l??[0,0],g=i??$t;Ko(t,s,u,{nodeExtent:g,nodeOrigin:m,elevateNodesOnSelect:!1,checkEquality:!1}),Fo(h,c,e);let y={x:0,y:0,zoom:1};if(r&&n&&o){const z=ln(s,{filter:k=>!!((k.width||k.initialWidth)&&(k.height||k.initialHeight))});y=Bn(z,n,o,.5,2,.1)}const M=Q(!1),N=Q(void 0),C=Q(null),E=Q(null),b=Q(500),v=Q(500),p=Q(.5),_=Q(2);return{flowId:Q(null),nodes:us(t,s,u,m,g,M,N,C,E,b,v,p,_),nodeLookup:it(s),parentLookup:it(u),edgeLookup:it(c),visibleNodes:it([]),edges:fs(e,h,c),visibleEdges:it([]),connectionLookup:it(h),width:b,height:v,minZoom:p,maxZoom:_,nodeOrigin:Q(m),nodeDragThreshold:Q(1),nodeExtent:Q(g),translateExtent:Q($t),autoPanOnNodeDrag:Q(!0),autoPanOnConnect:Q(!0),fitViewQueued:M,fitViewOptions:N,fitViewResolver:C,panZoom:E,snapGrid:Q(null),dragging:Q(!1),selectionRect:Q(null),selectionKeyPressed:Q(!1),multiselectionKeyPressed:Q(!1),deleteKeyPressed:Q(!1),panActivationKeyPressed:Q(!1),zoomActivationKeyPressed:Q(!1),selectionRectMode:Q(null),selectionMode:Q(en.Partial),nodeTypes:Q(ti),edgeTypes:Q(ni),viewport:Q(y),connectionMode:Q(bt.Strict),domNode:Q(null),connection:it(En),connectionLineType:Q(zt.Bezier),connectionRadius:Q(20),isValidConnection:Q(()=>!0),nodesDraggable:Q(!0),nodesConnectable:Q(!0),elementsSelectable:Q(!0),selectNodesOnDrag:Q(!0),markers:it([]),defaultMarkerColor:Q("#b1b1b7"),lib:it("svelte"),onlyRenderVisibleElements:Q(!1),onerror:Q(ir),ondelete:Q(void 0),onedgecreate:Q(void 0),onconnect:Q(void 0),onconnectstart:Q(void 0),onconnectend:Q(void 0),onbeforedelete:Q(void 0),nodesInitialized:Q(!1),edgesInitialized:Q(!1),viewportInitialized:Q(!1),initialized:it(!1)}};function hs(t){const e=Et([t.edges,t.nodes,t.nodeLookup,t.onlyRenderVisibleElements,t.viewport,t.width,t.height],([n,,o,r,l,i,s])=>r&&i&&s?n.filter(h=>{const c=o.get(h.source),m=o.get(h.target);return c&&m&&hr({sourceNode:c,targetNode:m,width:i,height:s,transform:[l.x,l.y,l.zoom]})}):n);return Et([e,t.nodes,t.nodeLookup,t.connectionMode,t.onerror],([n,,o,r,l])=>n.reduce((s,u)=>{const h=o.get(u.source),c=o.get(u.target);if(!h||!c)return s;const m=pr({id:u.id,sourceNode:h,targetNode:c,sourceHandle:u.sourceHandle||null,targetHandle:u.targetHandle||null,connectionMode:r,onError:l});return m&&s.push({...u,zIndex:gr({selected:u.selected,zIndex:u.zIndex,sourceNode:h,targetNode:c,elevateOnSelect:!1}),...m}),s},[]))}function ms(t){return Et([t.nodeLookup,t.onlyRenderVisibleElements,t.width,t.height,t.viewport,t.nodes],([e,n,o,r,l])=>{const i=[l.x,l.y,l.zoom];return n?Ao(e,{x:0,y:0,width:o,height:r},i,!0):Array.from(e.values())})}const fn=Symbol();function oi({nodes:t,edges:e,width:n,height:o,fitView:r,nodeOrigin:l,nodeExtent:i}){const s=gs({nodes:t,edges:e,width:n,height:o,fitView:r,nodeOrigin:l,nodeExtent:i});function u(x){s.nodeTypes.set({...ti,...x})}function h(x){s.edgeTypes.set({...ni,...x})}function c(x){const w=Y(s.edges);s.edges.set(vr(x,w))}const m=(x,w=!1)=>{var I;const S=Y(s.nodeLookup);for(const[B,L]of x){const R=(I=S.get(B))==null?void 0:I.internals.userNode;R&&(R.position=L.position,R.dragging=w)}s.nodes.update(B=>B)};function g(x){var L,R,K;const w=Y(s.nodeLookup),S=Y(s.parentLookup),{changes:I,updatedInternals:B}=zr(x,w,Y(s.parentLookup),Y(s.domNode),Y(s.nodeOrigin));if(B){Pr(w,S,{nodeOrigin:l,nodeExtent:i});for(const G of I){const Z=(L=w.get(G.id))==null?void 0:L.internals.userNode;if(Z)switch(G.type){case"dimensions":{const J={...Z.measured,...G.dimensions};G.setAttributes&&(Z.width=((R=G.dimensions)==null?void 0:R.width)??Z.width,Z.height=((K=G.dimensions)==null?void 0:K.height)??Z.height),Z.measured=J;break}case"position":Z.position=G.position??Z.position;break}}s.nodes.update(G=>G),Y(s.nodesInitialized)||s.nodesInitialized.set(!0)}}function y(x){const w=Y(s.fitViewResolver)??ar();return s.fitViewQueued.set(!0),s.fitViewOptions.set(x),s.fitViewResolver.set(w),s.nodes.set(Y(s.nodes)),w.promise}function M(x,w){const S=Y(s.panZoom);return S?S.scaleBy(x,w):Promise.resolve(!1)}function N(x){return M(1.2,x)}function C(x){return M(1/1.2,x)}function E(x){const w=Y(s.panZoom);w&&(w.setScaleExtent([x,Y(s.maxZoom)]),s.minZoom.set(x))}function b(x){const w=Y(s.panZoom);w&&(w.setScaleExtent([Y(s.minZoom),x]),s.maxZoom.set(x))}function v(x){const w=Y(s.panZoom);w&&(w.setTranslateExtent(x),s.translateExtent.set(x))}function p(x){let w=!1;return x.forEach(S=>{S.selected&&(S.selected=!1,w=!0)}),w}function _(x){var w;(w=Y(s.panZoom))==null||w.setClickDistance(x)}function z(x){p((x==null?void 0:x.nodes)||Y(s.nodes))&&s.nodes.set(Y(s.nodes)),p((x==null?void 0:x.edges)||Y(s.edges))&&s.edges.set(Y(s.edges))}s.deleteKeyPressed.subscribe(async x=>{var w;if(x){const S=Y(s.nodes),I=Y(s.edges),B=S.filter(G=>G.selected),L=I.filter(G=>G.selected),{nodes:R,edges:K}=await Vo({nodesToRemove:B,edgesToRemove:L,nodes:S,edges:I,onBeforeDelete:Y(s.onbeforedelete)});(R.length||K.length)&&(s.nodes.update(G=>G.filter(Z=>!R.some(J=>J.id===Z.id))),s.edges.update(G=>G.filter(Z=>!K.some(J=>J.id===Z.id))),(w=Y(s.ondelete))==null||w({nodes:R,edges:K}))}});function k(x){const w=Y(s.multiselectionKeyPressed);s.nodes.update(S=>S.map(I=>{const B=x.includes(I.id),L=w&&I.selected||B;return I.selected=L,I})),w||s.edges.update(S=>S.map(I=>(I.selected=!1,I)))}function H(x){const w=Y(s.multiselectionKeyPressed);s.edges.update(S=>S.map(I=>{const B=x.includes(I.id),L=w&&I.selected||B;return I.selected=L,I})),w||s.nodes.update(S=>S.map(I=>(I.selected=!1,I)))}function A(x){var S;const w=(S=Y(s.nodes))==null?void 0:S.find(I=>I.id===x);if(!w){console.warn("012",Tt.error012(x));return}s.selectionRect.set(null),s.selectionRectMode.set(null),w.selected?w.selected&&Y(s.multiselectionKeyPressed)&&z({nodes:[w],edges:[]}):k([x])}function O(x){const w=Y(s.viewport);return Sr({delta:x,panZoom:Y(s.panZoom),transform:[w.x,w.y,w.zoom],translateExtent:Y(s.translateExtent),width:Y(s.width),height:Y(s.height)})}const X=Q(En),T=x=>{X.set({...x})};function V(){X.set(En)}function f(){s.selectionRect.set(null),s.selectionRectMode.set(null),s.snapGrid.set(null),s.isValidConnection.set(()=>!0),z(),V()}return{...s,visibleEdges:hs(s),visibleNodes:ms(s),connection:Et([X,s.viewport],([x,w])=>x.inProgress?{...x,to:Gt(x.to,[w.x,w.y,w.zoom])}:{...x}),markers:Et([s.edges,s.defaultMarkerColor,s.flowId],([x,w,S])=>_r(x,{defaultColor:w,id:S})),initialized:(()=>{let x=!1;const w=Y(s.nodes).length,S=Y(s.edges).length;return Et([s.nodesInitialized,s.edgesInitialized,s.viewportInitialized],([I,B,L])=>x||(w===0?x=L:S===0?x=L&&I:x=L&&I&&B,x))})(),syncNodeStores:x=>as(s.nodes,x),syncEdgeStores:x=>cs(s.edges,x),syncViewport:x=>ds(s.panZoom,s.viewport,x),setNodeTypes:u,setEdgeTypes:h,addEdge:c,updateNodePositions:m,updateNodeInternals:g,zoomIn:N,zoomOut:C,fitView:x=>y(x),setMinZoom:E,setMaxZoom:b,setTranslateExtent:v,setPaneClickDistance:_,unselectNodesAndEdges:z,addSelectedNodes:k,addSelectedEdges:H,handleNodeSelection:A,panBy:O,updateConnection:T,cancelConnection:V,reset:f}}function De(){const t=Nt(fn);if(!t)throw new Error("In order to use useStore you need to wrap your component in a <SvelteFlowProvider />");return t.getStore()}function ys({nodes:t,edges:e,width:n,height:o,fitView:r,nodeOrigin:l,nodeExtent:i}){const s=oi({nodes:t,edges:e,width:n,height:o,fitView:r,nodeOrigin:l,nodeExtent:i});return Xt(fn,{getStore:()=>s}),s}function Pn(t,e){const{panZoom:n,minZoom:o,maxZoom:r,initialViewport:l,viewport:i,dragging:s,translateExtent:u,paneClickDistance:h}=e,c=Zr({domNode:t,minZoom:o,maxZoom:r,translateExtent:u,viewport:l,paneClickDistance:h,onDraggingChange:s.set}),m=c.getViewport();return i.set(m),n.set(c),c.update(e),{update(g){c.update(g)}}}var vs=pe('<div class="svelte-flow__zoom svelte-1vl0uat"><!></div>');function bs(t,e){de(e,!1);const n=()=>W(I,"$panActivationKeyPressed",h),o=()=>W(V,"$minZoom",h),r=()=>W(f,"$maxZoom",h),l=()=>W(B,"$zoomActivationKeyPressed",h),i=()=>W(T,"$selectionRect",h),s=()=>W(w,"$translateExtent",h),u=()=>W(S,"$lib",h),[h,c]=Ye(),m=q(),g=q(),y=q();let M=d(e,"initialViewport",8,void 0),N=d(e,"onMoveStart",8,void 0),C=d(e,"onMove",8,void 0),E=d(e,"onMoveEnd",8,void 0),b=d(e,"panOnScrollMode",8),v=d(e,"preventScrolling",8),p=d(e,"zoomOnScroll",8),_=d(e,"zoomOnDoubleClick",8),z=d(e,"zoomOnPinch",8),k=d(e,"panOnDrag",8),H=d(e,"panOnScroll",8),A=d(e,"paneClickDistance",8);const{viewport:O,panZoom:X,selectionRect:T,minZoom:V,maxZoom:f,dragging:x,translateExtent:w,lib:S,panActivationKeyPressed:I,zoomActivationKeyPressed:B,viewportInitialized:L}=De(),R=Z=>O.set({x:Z[0],y:Z[1],zoom:Z[2]});Zt(()=>{Qt(L,!0)}),$(()=>P(M()),()=>{F(m,M()||{x:0,y:0,zoom:1})}),$(()=>(n(),P(k())),()=>{F(g,n()||k())}),$(()=>(n(),P(H())),()=>{F(y,n()||H())}),Ge(),fe();var K=vs(),G=ae(K);Ue(G,e,"default",{},null),se(K),qe(K,(Z,J)=>Pn==null?void 0:Pn(Z,J),()=>({viewport:O,minZoom:o(),maxZoom:r(),initialViewport:a(m),dragging:x,panZoom:X,onPanZoomStart:N(),onPanZoom:C(),onPanZoomEnd:E(),zoomOnScroll:p(),zoomOnDoubleClick:_(),zoomOnPinch:z(),panOnScroll:a(y),panOnDrag:a(g),panOnScrollSpeed:.5,panOnScrollMode:b()||gt.Free,zoomActivationKeyPressed:l(),preventScrolling:typeof v()=="boolean"?v():!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!i(),translateExtent:s(),lib:u(),paneClickDistance:A(),onTransformChange:R})),j(t,K),ue(),c()}function Co(t,e){return n=>{n.target===e&&(t==null||t(n))}}function Eo(t){return e=>{const n=t.includes(e.id);return e.selected!==n&&(e.selected=n),e}}var xs=pe("<div><!></div>");function ws(t,e){de(e,!1);const n=()=>W(x,"$panActivationKeyPressed",y),o=()=>W(V,"$selectionKeyPressed",y),r=()=>W(X,"$selectionRect",y),l=()=>W(O,"$elementsSelectable",y),i=()=>W(T,"$selectionRectMode",y),s=()=>W(S,"$connection",y),u=()=>W(k,"$edges",y),h=()=>W(z,"$nodeLookup",y),c=()=>W(H,"$viewport",y),m=()=>W(f,"$selectionMode",y),g=()=>W(A,"$dragging",y),[y,M]=Ye(),N=q(),C=q(),E=q();let b=d(e,"panOnDrag",8,void 0),v=d(e,"selectionOnDrag",8,void 0);const p=wt(),{nodes:_,nodeLookup:z,edges:k,viewport:H,dragging:A,elementsSelectable:O,selectionRect:X,selectionRectMode:T,selectionKeyPressed:V,selectionMode:f,panActivationKeyPressed:x,unselectNodesAndEdges:w,connection:S}=De();let I=q(),B=null,L=[],R=!1;function K(U){if(R||s().inProgress){R=!1;return}p("paneclick",{event:U}),w(),T.set(null)}function G(U){var xe,ke;if(B=a(I).getBoundingClientRect(),!O||!a(C)||U.button!==0||U.target!==a(I)||!B)return;(ke=(xe=U.target)==null?void 0:xe.setPointerCapture)==null||ke.call(xe,U.pointerId);const{x:ie,y:_e}=ht(U,B);w(),X.set({width:0,height:0,startX:ie,startY:_e,x:ie,y:_e})}function Z(U){if(!a(C)||!B||!r())return;R=!0;const ie=ht(U,B),_e=r().startX??0,xe=r().startY??0,ke={...r(),x:ie.x<_e?ie.x:_e,y:ie.y<xe?ie.y:xe,width:Math.abs(ie.x-_e),height:Math.abs(ie.y-xe)},Be=L.map(ce=>ce.id),Ne=Mn(L,u()).map(ce=>ce.id);L=Ao(h(),ke,[c().x,c().y,c().zoom],m()===en.Partial,!0);const Xe=Mn(L,u()).map(ce=>ce.id),Me=L.map(ce=>ce.id);(Be.length!==Me.length||Me.some(ce=>!Be.includes(ce)))&&_.update(ce=>ce.map(Eo(Me))),(Ne.length!==Xe.length||Xe.some(ce=>!Ne.includes(ce)))&&k.update(ce=>ce.map(Eo(Xe))),T.set("user"),X.set(ke)}function J(U){var ie,_e;U.button===0&&((_e=(ie=U.target)==null?void 0:ie.releasePointerCapture)==null||_e.call(ie,U.pointerId),!a(C)&&i()==="user"&&U.target===a(I)&&(K==null||K(U)),X.set(null),L.length>0&&Qt(T,"nodes"),o()&&(R=!1))}const oe=U=>{var ie;if(Array.isArray(a(N))&&((ie=a(N))!=null&&ie.includes(2))){U.preventDefault();return}p("panecontextmenu",{event:U})};$(()=>(n(),P(b())),()=>{F(N,n()||b())}),$(()=>(o(),r(),P(v()),a(N)),()=>{F(C,o()||r()||v()&&a(N)!==!0)}),$(()=>(l(),a(C),i()),()=>{F(E,l()&&(a(C)||i()==="user"))}),Ge(),fe();var ee=xs(),te=no(()=>a(E)?void 0:Co(K,a(I))),ge=no(()=>Co(oe,a(I)));let be;var ye=ae(ee);Ue(ye,e,"default",{},null),se(ee),An(ee,U=>F(I,U),()=>a(I)),we(U=>be=Qe(ee,1,"svelte-flow__pane svelte-j55c5z",null,be,U),[()=>({draggable:b()===!0||Array.isArray(b())&&b().includes(0),dragging:g(),selection:a(C)})]),Ce("click",ee,function(...U){var ie;(ie=a(te))==null||ie.apply(this,U)}),Ce("pointerdown",ee,function(...U){var ie;(ie=a(E)?G:void 0)==null||ie.apply(this,U)}),Ce("pointermove",ee,function(...U){var ie;(ie=a(E)?Z:void 0)==null||ie.apply(this,U)}),Ce("pointerup",ee,function(...U){var ie;(ie=a(E)?J:void 0)==null||ie.apply(this,U)}),Ce("contextmenu",ee,function(...U){var ie;(ie=a(ge))==null||ie.apply(this,U)}),j(t,ee),ue(),M()}var ps=pe('<div class="svelte-flow__viewport xyflow__viewport svelte-tjeeg3"><!></div>');function _s(t,e){de(e,!1);const n=()=>W(l,"$viewport",o),[o,r]=Ye(),{viewport:l}=De();fe();var i=ps(),s=ae(i);Ue(s,e,"default",{},null),se(i),we(()=>lt(i,`transform: translate(${n().x??""}px, ${n().y??""}px) scale(${n().zoom??""})`)),j(t,i),ue(),r()}function St(t,e){const{store:n,onDrag:o,onDragStart:r,onDragStop:l,onNodeMouseDown:i}=e,s=Tr({onDrag:o,onDragStart:r,onDragStop:l,onNodeMouseDown:i,getStoreItems:()=>{const h=Y(n.snapGrid),c=Y(n.viewport);return{nodes:Y(n.nodes),nodeLookup:Y(n.nodeLookup),edges:Y(n.edges),nodeExtent:Y(n.nodeExtent),snapGrid:h||[0,0],snapToGrid:!!h,nodeOrigin:Y(n.nodeOrigin),multiSelectionActive:Y(n.multiselectionKeyPressed),domNode:Y(n.domNode),transform:[c.x,c.y,c.zoom],autoPanOnNodeDrag:Y(n.autoPanOnNodeDrag),nodesDraggable:Y(n.nodesDraggable),selectNodesOnDrag:Y(n.selectNodesOnDrag),nodeDragThreshold:Y(n.nodeDragThreshold),unselectNodesAndEdges:n.unselectNodesAndEdges,updateNodePositions:n.updateNodePositions,panBy:n.panBy}}});function u(h,c){if(c.disabled){s.destroy();return}s.update({domNode:h,noDragClassName:c.noDragClass,handleSelector:c.handleSelector,nodeId:c.nodeId,isSelectable:c.isSelectable,nodeClickDistance:c.nodeClickDistance})}return u(t,e),{update(h){u(t,h)},destroy(){s.destroy()}}}function ks({width:t,height:e,initialWidth:n,initialHeight:o,measuredWidth:r,measuredHeight:l}){if(r===void 0&&l===void 0){const i=t??n,s=e??o;return{width:i?`width:${i}px;`:"",height:s?`height:${s}px;`:""}}return{width:t?`width:${t}px;`:"",height:e?`height:${e}px;`:""}}var Ps=pe("<div><!></div>");function Cs(t,e){de(e,!1);const n=()=>W(ee,"$nodeTypes",i),o=()=>W(U,"$elementsSelectable",i),r=()=>W(ie,"$nodesDraggable",i),l=()=>W(Be,"$connectableStore",i),[i,s]=Ye(),u=q(void 0,!0),h=q(void 0,!0),c=q(void 0,!0),m=q(void 0,!0);let g=d(e,"node",9),y=d(e,"id",9),M=d(e,"data",25,()=>({})),N=d(e,"selected",9,!1),C=d(e,"draggable",9,void 0),E=d(e,"selectable",9,void 0),b=d(e,"connectable",9,!0),v=d(e,"deletable",9,!0),p=d(e,"hidden",9,!1),_=d(e,"dragging",9,!1),z=d(e,"resizeObserver",9,null),k=d(e,"style",9,void 0),H=d(e,"type",9,"default"),A=d(e,"isParent",9,!1),O=d(e,"positionX",9),X=d(e,"positionY",9),T=d(e,"sourcePosition",9,void 0),V=d(e,"targetPosition",9,void 0),f=d(e,"zIndex",9),x=d(e,"measuredWidth",9,void 0),w=d(e,"measuredHeight",9,void 0),S=d(e,"initialWidth",9,void 0),I=d(e,"initialHeight",9,void 0),B=d(e,"width",9,void 0),L=d(e,"height",9,void 0),R=d(e,"dragHandle",9,void 0),K=d(e,"initialized",9,!1),G=d(e,"parentId",9,void 0),Z=d(e,"nodeClickDistance",9,void 0),J=d(e,"class",9,"");const oe=De(),{nodeTypes:ee,nodeDragThreshold:te,selectNodesOnDrag:ge,handleNodeSelection:be,updateNodeInternals:ye,elementsSelectable:U,nodesDraggable:ie}=oe;let _e=q(void 0,!0),xe=q(null,!0);const ke=wt(),Be=Q(b());let Ne=q(void 0,!0),Xe=q(void 0,!0),Me=q(void 0,!0);Xt("svelteflow__node_id",y()),Xt("svelteflow__node_connectable",Be),sn(()=>{var Re;a(xe)&&((Re=z())==null||Re.unobserve(a(xe)))});function ce(Re){E()&&(!Y(ge)||!C()||Y(te)>0)&&be(y()),ke("nodeclick",{node:g().internals.userNode,event:Re})}$(()=>P(H()),()=>{F(u,H()||"default")}),$(()=>(n(),a(u)),()=>{F(h,!!n()[a(u)])}),$(()=>(n(),a(u),Tn),()=>{F(c,n()[a(u)]||Tn)}),$(()=>(a(h),P(H())),()=>{a(h)||console.warn("003",Tt.error003(H()))}),$(()=>(P(B()),P(L()),P(S()),P(I()),P(x()),P(w())),()=>{F(m,ks({width:B(),height:L(),initialWidth:S(),initialHeight:I(),measuredWidth:x(),measuredHeight:w()}))}),$(()=>P(b()),()=>{Be.set(!!b())}),$(()=>(a(Ne),a(u),a(Xe),P(T()),a(Me),P(V()),P(y()),a(_e)),()=>{(a(Ne)&&a(u)!==a(Ne)||a(Xe)&&T()!==a(Xe)||a(Me)&&V()!==a(Me))&&requestAnimationFrame(()=>ye(new Map([[y(),{id:y(),nodeElement:a(_e),force:!0}]]))),F(Ne,a(u)),F(Xe,T()),F(Me,V())}),$(()=>(P(z()),a(_e),a(xe),P(K())),()=>{z()&&(a(_e)!==a(xe)||!K())&&(a(xe)&&z().unobserve(a(xe)),a(_e)&&z().observe(a(_e)),F(xe,a(_e)))}),Ge(),fe(!0);var Je=at(),$e=Ve(Je);{var ot=Re=>{var Ie=Ps();let We,Ze;var vt=ae(Ie);{let Se=re(()=>N()??!1),ze=re(()=>E()??o()??!0),He=re(()=>v()??!0),Ee=re(()=>C()??r()??!0);Ho(vt,()=>a(c),(Fe,et)=>{et(Fe,{get data(){return M()},get id(){return y()},get selected(){return a(Se)},get selectable(){return a(ze)},get deletable(){return a(He)},get sourcePosition(){return T()},get targetPosition(){return V()},get zIndex(){return f()},get dragging(){return _()},get draggable(){return a(Ee)},get dragHandle(){return R()},get parentId(){return G()},get type(){return a(u)},get isConnectable(){return l()},get positionAbsoluteX(){return O()},get positionAbsoluteY(){return X()},get width(){return B()},get height(){return L()}})})}se(Ie),qe(Ie,(Se,ze)=>St==null?void 0:St(Se,ze),()=>({nodeId:y(),isSelectable:E(),disabled:!1,handleSelector:R(),noDragClass:"nodrag",nodeClickDistance:Z(),onNodeMouseDown:be,onDrag:(Se,ze,He,Ee)=>{ke("nodedrag",{event:Se,targetNode:He,nodes:Ee})},onDragStart:(Se,ze,He,Ee)=>{ke("nodedragstart",{event:Se,targetNode:He,nodes:Ee})},onDragStop:(Se,ze,He,Ee)=>{ke("nodedragstop",{event:Se,targetNode:He,nodes:Ee})},store:oe})),An(Ie,Se=>F(_e,Se),()=>a(_e)),mt(()=>Ce("click",Ie,ce)),mt(()=>Ce("mouseenter",Ie,Se=>ke("nodemouseenter",{node:g(),event:Se}))),mt(()=>Ce("mouseleave",Ie,Se=>ke("nodemouseleave",{node:g(),event:Se}))),mt(()=>Ce("mousemove",Ie,Se=>ke("nodemousemove",{node:g(),event:Se}))),mt(()=>Ce("contextmenu",Ie,Se=>ke("nodecontextmenu",{node:g(),event:Se}))),we(Se=>{le(Ie,"data-id",y()),We=Qe(Ie,1,Se,null,We,{dragging:_(),selected:N(),draggable:C(),connectable:b(),selectable:E(),nopan:C(),parent:A()}),Ze=lt(Ie,`${k()??""??""};${a(m),D(()=>a(m).width)??""}${a(m),D(()=>a(m).height)??""}`,Ze,{"z-index":f(),transform:`translate(${O()??""}px, ${X()??""}px)`,visibility:K()?"visible":"hidden"})},[()=>nt((P(Te),a(u),P(J()),D(()=>Te(["svelte-flow__node",`svelte-flow__node-${a(u)}`,J()]))))]),j(Re,Ie)};Ae($e,Re=>{p()||Re(ot)})}j(t,Je),ue(),s()}var Es=pe('<div class="svelte-flow__nodes svelte-v0zrhd"></div>');function Ms(t,e){de(e,!1);const n=()=>W(c,"$visibleNodes",s),o=()=>W(m,"$nodesDraggable",s),r=()=>W(y,"$elementsSelectable",s),l=()=>W(g,"$nodesConnectable",s),i=()=>W(N,"$parentLookup",s),[s,u]=Ye();let h=d(e,"nodeClickDistance",8,0);const{visibleNodes:c,nodesDraggable:m,nodesConnectable:g,elementsSelectable:y,updateNodeInternals:M,parentLookup:N}=De(),C=typeof ResizeObserver>"u"?null:new ResizeObserver(b=>{const v=new Map;b.forEach(p=>{const _=p.target.getAttribute("data-id");v.set(_,{id:_,nodeElement:p.target,force:!0})}),M(v)});sn(()=>{C==null||C.disconnect()}),fe();var E=Es();Vn(E,5,n,b=>b.id,(b,v)=>{{let p=re(()=>(a(v),D(()=>!!a(v).selected))),_=re(()=>(a(v),D(()=>!!a(v).hidden))),z=re(()=>(a(v),o(),D(()=>!!(a(v).draggable||o()&&typeof a(v).draggable>"u")))),k=re(()=>(a(v),r(),D(()=>!!(a(v).selectable||r()&&typeof a(v).selectable>"u")))),H=re(()=>(a(v),l(),D(()=>!!(a(v).connectable||l()&&typeof a(v).connectable>"u")))),A=re(()=>(a(v),D(()=>a(v).deletable??!0))),O=re(()=>(i(),a(v),D(()=>i().has(a(v).id)))),X=re(()=>(a(v),D(()=>a(v).type??"default"))),T=re(()=>(a(v),D(()=>a(v).internals.z??0))),V=re(()=>(P(go),a(v),D(()=>go(a(v)))));Cs(b,{get node(){return a(v)},get id(){return a(v),D(()=>a(v).id)},get data(){return a(v),D(()=>a(v).data)},get selected(){return a(p)},get hidden(){return a(_)},get draggable(){return a(z)},get selectable(){return a(k)},get connectable(){return a(H)},get deletable(){return a(A)},get positionX(){return a(v),D(()=>a(v).internals.positionAbsolute.x)},get positionY(){return a(v),D(()=>a(v).internals.positionAbsolute.y)},get isParent(){return a(O)},get style(){return a(v),D(()=>a(v).style)},get class(){return a(v),D(()=>a(v).class)},get type(){return a(X)},get sourcePosition(){return a(v),D(()=>a(v).sourcePosition)},get targetPosition(){return a(v),D(()=>a(v).targetPosition)},get dragging(){return a(v),D(()=>a(v).dragging)},get zIndex(){return a(T)},get dragHandle(){return a(v),D(()=>a(v).dragHandle)},get initialized(){return a(V)},get width(){return a(v),D(()=>a(v).width)},get height(){return a(v),D(()=>a(v).height)},get initialWidth(){return a(v),D(()=>a(v).initialWidth)},get initialHeight(){return a(v),D(()=>a(v).initialHeight)},get measuredWidth(){return a(v),D(()=>a(v).measured.width)},get measuredHeight(){return a(v),D(()=>a(v).measured.height)},get parentId(){return a(v),D(()=>a(v).parentId)},get resizeObserver(){return C},get nodeClickDistance(){return h()},$$events:{nodeclick(f){ve.call(this,e,f)},nodemouseenter(f){ve.call(this,e,f)},nodemousemove(f){ve.call(this,e,f)},nodemouseleave(f){ve.call(this,e,f)},nodedrag(f){ve.call(this,e,f)},nodedragstart(f){ve.call(this,e,f)},nodedragstop(f){ve.call(this,e,f)},nodecontextmenu(f){ve.call(this,e,f)}}})}}),se(E),j(t,E),ue(),u()}var zs=Le('<svg><g role="img"><!></g></svg>');function Ss(t,e){de(e,!1);const n=()=>W(J,"$edgeTypes",i),o=()=>W(oe,"$flowId",i),r=()=>W(ee,"$elementsSelectable",i),l=()=>W(Z,"$edgeLookup",i),[i,s]=Ye(),u=q(void 0,!0),h=q(void 0,!0),c=q(void 0,!0),m=q(void 0,!0),g=q(void 0,!0);let y=d(e,"id",9),M=d(e,"type",9,"default"),N=d(e,"source",9,""),C=d(e,"target",9,""),E=d(e,"data",25,()=>({})),b=d(e,"style",9,void 0),v=d(e,"zIndex",9,void 0),p=d(e,"animated",9,!1),_=d(e,"selected",9,!1),z=d(e,"selectable",9,void 0),k=d(e,"deletable",9,void 0),H=d(e,"hidden",9,!1),A=d(e,"label",9,void 0),O=d(e,"labelStyle",9,void 0),X=d(e,"markerStart",9,void 0),T=d(e,"markerEnd",9,void 0),V=d(e,"sourceHandle",9,void 0),f=d(e,"targetHandle",9,void 0),x=d(e,"sourceX",9),w=d(e,"sourceY",9),S=d(e,"targetX",9),I=d(e,"targetY",9),B=d(e,"sourcePosition",9),L=d(e,"targetPosition",9),R=d(e,"ariaLabel",9,void 0),K=d(e,"interactionWidth",9,void 0),G=d(e,"class",9,"");Xt("svelteflow__edge_id",y());const{edgeLookup:Z,edgeTypes:J,flowId:oe,elementsSelectable:ee}=De(),te=wt(),ge=ei();function be(xe){const ke=l().get(y());ke&&(ge(y()),te("edgeclick",{event:xe,edge:ke}))}function ye(xe,ke){const Be=l().get(y());Be&&te(ke,{event:xe,edge:Be})}$(()=>P(M()),()=>{F(u,M()||"default")}),$(()=>(n(),a(u),In),()=>{F(h,n()[a(u)]||In)}),$(()=>(P(X()),o()),()=>{F(c,X()?`url('#${Nn(X(),o())}')`:void 0)}),$(()=>(P(T()),o()),()=>{F(m,T()?`url('#${Nn(T(),o())}')`:void 0)}),$(()=>(P(z()),r()),()=>{F(g,z()??r())}),Ge(),fe(!0);var U=at(),ie=Ve(U);{var _e=xe=>{var ke=zs();let Be;var Ne=ae(ke);let Xe;var Me=ae(Ne);{let ce=re(()=>k()??!0);Ho(Me,()=>a(h),(Je,$e)=>{$e(Je,{get id(){return y()},get source(){return N()},get target(){return C()},get sourceX(){return x()},get sourceY(){return w()},get targetX(){return S()},get targetY(){return I()},get sourcePosition(){return B()},get targetPosition(){return L()},get animated(){return p()},get selected(){return _()},get label(){return A()},get labelStyle(){return O()},get data(){return E()},get style(){return b()},get interactionWidth(){return K()},get selectable(){return a(g)},get deletable(){return a(ce)},get type(){return a(u)},get sourceHandleId(){return V()},get targetHandleId(){return f()},get markerStart(){return a(c)},get markerEnd(){return a(m)}})})}se(Ne),se(ke),we(ce=>{Be=lt(ke,"",Be,{"z-index":v()}),Xe=Qe(Ne,0,ce,null,Xe,{animated:p(),selected:_(),selectable:a(g)}),le(Ne,"data-id",y()),le(Ne,"aria-label",R()===null?void 0:R()?R():`Edge from ${N()} to ${C()}`)},[()=>nt((P(Te),P(G()),D(()=>Te(["svelte-flow__edge",G()]))))]),Ce("click",Ne,be),Ce("contextmenu",Ne,ce=>{ye(ce,"edgecontextmenu")}),Ce("mouseenter",Ne,ce=>{ye(ce,"edgemouseenter")}),Ce("mouseleave",Ne,ce=>{ye(ce,"edgemouseleave")}),j(xe,ke)};Ae(ie,xe=>{H()||xe(_e)})}j(t,U),ue(),s()}function Ns(t,e){de(e,!1);let n=d(e,"onMount",8,void 0),o=d(e,"onDestroy",8,void 0);Zt(()=>{var r;return(r=n())==null||r(),o()}),fe(),ue()}var Ts=Le("<defs></defs>");function Is(t,e){de(e,!1);const n=()=>W(l,"$markers",o),[o,r]=Ye(),{markers:l}=De();fe();var i=Ts();Vn(i,5,n,s=>s.id,(s,u)=>{As(s,Bt(()=>a(u)))}),se(i),j(t,i),ue(),r()}var Hs=Le('<polyline stroke-linecap="round" stroke-linejoin="round" fill="none" points="-5,-4 0,0 -5,4"></polyline>'),Os=Le('<polyline stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4 -5,-4"></polyline>'),Ds=Le('<marker class="svelte-flow__arrowhead" viewBox="-10 -10 20 20" refX="0" refY="0"><!></marker>');function As(t,e){de(e,!1);let n=d(e,"id",8),o=d(e,"type",8),r=d(e,"width",8,12.5),l=d(e,"height",8,12.5),i=d(e,"markerUnits",8,"strokeWidth"),s=d(e,"orient",8,"auto-start-reverse"),u=d(e,"color",8,void 0),h=d(e,"strokeWidth",8,void 0);fe();var c=Ds(),m=ae(c);{var g=M=>{var N=Hs();we(()=>{le(N,"stroke",u()),le(N,"stroke-width",h())}),j(M,N)},y=M=>{var N=at(),C=Ve(N);{var E=b=>{var v=Os();we(()=>{le(v,"stroke",u()),le(v,"stroke-width",h()),le(v,"fill",u())}),j(b,v)};Ae(C,b=>{P(o()),P(kt),D(()=>o()===kt.ArrowClosed)&&b(E)},!0)}j(M,N)};Ae(m,M=>{P(o()),P(kt),D(()=>o()===kt.Arrow)?M(g):M(y,!1)})}se(c),we(()=>{le(c,"id",n()),le(c,"markerWidth",`${r()}`),le(c,"markerHeight",`${l()}`),le(c,"markerUnits",i()),le(c,"orient",s())}),j(t,c),ue()}var Vs=pe('<div class="svelte-flow__edges"><svg class="svelte-flow__marker"><!></svg> <!> <!></div>');function Ls(t,e){de(e,!1);const n=()=>W(s,"$visibleEdges",r),o=()=>W(c,"$elementsSelectable",r),[r,l]=Ye();let i=d(e,"defaultEdgeOptions",8);const{visibleEdges:s,edgesInitialized:u,edges:{setDefaultOptions:h},elementsSelectable:c}=De();Zt(()=>{i()&&h(i())}),fe();var m=Vs(),g=ae(m),y=ae(g);Is(y,{}),se(g);var M=me(g,2);Vn(M,1,n,E=>E.id,(E,b)=>{{let v=re(()=>(a(b),o(),D(()=>a(b).selectable??o()))),p=re(()=>(a(b),D(()=>a(b).type||"default")));Ss(E,{get id(){return a(b),D(()=>a(b).id)},get source(){return a(b),D(()=>a(b).source)},get target(){return a(b),D(()=>a(b).target)},get data(){return a(b),D(()=>a(b).data)},get style(){return a(b),D(()=>a(b).style)},get animated(){return a(b),D(()=>a(b).animated)},get selected(){return a(b),D(()=>a(b).selected)},get selectable(){return a(v)},get deletable(){return a(b),D(()=>a(b).deletable)},get hidden(){return a(b),D(()=>a(b).hidden)},get label(){return a(b),D(()=>a(b).label)},get labelStyle(){return a(b),D(()=>a(b).labelStyle)},get markerStart(){return a(b),D(()=>a(b).markerStart)},get markerEnd(){return a(b),D(()=>a(b).markerEnd)},get sourceHandle(){return a(b),D(()=>a(b).sourceHandle)},get targetHandle(){return a(b),D(()=>a(b).targetHandle)},get sourceX(){return a(b),D(()=>a(b).sourceX)},get sourceY(){return a(b),D(()=>a(b).sourceY)},get targetX(){return a(b),D(()=>a(b).targetX)},get targetY(){return a(b),D(()=>a(b).targetY)},get sourcePosition(){return a(b),D(()=>a(b).sourcePosition)},get targetPosition(){return a(b),D(()=>a(b).targetPosition)},get ariaLabel(){return a(b),D(()=>a(b).ariaLabel)},get interactionWidth(){return a(b),D(()=>a(b).interactionWidth)},get class(){return a(b),D(()=>a(b).class)},get type(){return a(p)},get zIndex(){return a(b),D(()=>a(b).zIndex)},$$events:{edgeclick(_){ve.call(this,e,_)},edgecontextmenu(_){ve.call(this,e,_)},edgemouseenter(_){ve.call(this,e,_)},edgemouseleave(_){ve.call(this,e,_)}}})}});var N=me(M,2);{var C=E=>{Ns(E,{onMount:()=>{Qt(u,!0)},onDestroy:()=>{Qt(u,!1)}})};Ae(N,E=>{n(),D(()=>n().length>0)&&E(C)})}se(m),j(t,m),ue(),l()}var Ys=pe('<div class="svelte-flow__selection svelte-1vr3gfi"></div>');function ii(t,e){let n=d(e,"x",8,0),o=d(e,"y",8,0),r=d(e,"width",8,0),l=d(e,"height",8,0),i=d(e,"isVisible",8,!0);var s=at(),u=Ve(s);{var h=c=>{var m=Ys();let g;we(()=>g=lt(m,"",g,{width:typeof r()=="string"?r():`${r()}px`,height:typeof l()=="string"?l():`${l()}px`,transform:`translate(${n()}px, ${o()}px)`})),j(c,m)};Ae(u,c=>{i()&&c(h)})}j(t,s)}function Bs(t,e){de(e,!1);const n=()=>W(i,"$selectionRect",r),o=()=>W(s,"$selectionRectMode",r),[r,l]=Ye(),{selectionRect:i,selectionRectMode:s}=De();fe();{let u=re(()=>!!(n()&&o()==="user")),h=re(()=>{var y;return(y=n())==null?void 0:y.width}),c=re(()=>{var y;return(y=n())==null?void 0:y.height}),m=re(()=>{var y;return(y=n())==null?void 0:y.x}),g=re(()=>{var y;return(y=n())==null?void 0:y.y});ii(t,{get isVisible(){return a(u)},get width(){return a(h)},get height(){return a(c)},get x(){return a(m)},get y(){return a(g)}})}ue(),l()}var Xs=pe('<div class="selection-wrapper nopan svelte-sf2y5e" role="button" tabindex="-1"><!></div>');function Rs(t,e){de(e,!1);const n=()=>W(u,"$selectionRectMode",l),o=()=>W(c,"$nodeLookup",l),r=()=>W(h,"$nodes",l),[l,i]=Ye(),s=De(),{selectionRectMode:u,nodes:h,nodeLookup:c}=s,m=wt();let g=q(null);function y(b){const v=r().filter(p=>p.selected);m("selectioncontextmenu",{nodes:v,event:b})}function M(b){const v=r().filter(p=>p.selected);m("selectionclick",{nodes:v,event:b})}$(()=>(n(),o(),r()),()=>{n()==="nodes"&&(F(g,ln(o(),{filter:b=>!!b.selected})),r())}),Ge(),fe();var N=at(),C=Ve(N);{var E=b=>{var v=Xs(),p=ae(v);ii(p,{width:"100%",height:"100%",x:0,y:0}),se(v),qe(v,(_,z)=>St==null?void 0:St(_,z),()=>({disabled:!1,store:s,onDrag:(_,z,k,H)=>{m("nodedrag",{event:_,targetNode:null,nodes:H})},onDragStart:(_,z,k,H)=>{m("nodedragstart",{event:_,targetNode:null,nodes:H})},onDragStop:(_,z,k,H)=>{m("nodedragstop",{event:_,targetNode:null,nodes:H})}})),mt(()=>Ce("contextmenu",v,y)),mt(()=>Ce("click",v,M)),mt(()=>Ce("keyup",v,()=>{})),we(()=>lt(v,`width: ${a(g),D(()=>a(g).width)??""}px; height: ${a(g),D(()=>a(g).height)??""}px; transform: translate(${a(g),D(()=>a(g).x)??""}px, ${a(g),D(()=>a(g).y)??""}px)`)),j(b,v)};Ae(C,b=>{n(),a(g),P(dt),D(()=>n()==="nodes"&&a(g)&&dt(a(g).x)&&dt(a(g).y))&&b(E)})}j(t,N),ue(),i()}function Pe(t,e){let{enabled:n=!0,trigger:o,type:r="keydown"}=e;function l(i){const s=Array.isArray(o)?o:[o],u={alt:i.altKey,ctrl:i.ctrlKey,shift:i.shiftKey,meta:i.metaKey};for(const h of s){const c={modifier:[],preventDefault:!1,enabled:!0,...h},{modifier:m,key:g,callback:y,preventDefault:M,enabled:N}=c;if(N){if(m.length&&!(Array.isArray(m)?m:[m]).map(b=>typeof b=="string"?[b]:b).some(b=>b.every(v=>u[v])))continue;if(i.key===g){M&&i.preventDefault();const C={node:t,trigger:c,originalEvent:i};t.dispatchEvent(new CustomEvent("shortcut",{detail:C})),y==null||y(C)}}}}return n&&t.addEventListener(r,l),{update:i=>{const{enabled:s=!0,type:u="keydown"}=i;n&&(!s||r!==u)?t.removeEventListener(r,l):!n&&s&&t.addEventListener(u,l),n=s,r=u,o=i.trigger},destroy:()=>{t.removeEventListener(r,l)}}}function Ws(t,e){de(e,!1);let n=d(e,"selectionKey",8,"Shift"),o=d(e,"multiSelectionKey",24,()=>on()?"Meta":"Control"),r=d(e,"deleteKey",8,"Backspace"),l=d(e,"panActivationKey",8," "),i=d(e,"zoomActivationKey",24,()=>on()?"Meta":"Control");const{selectionKeyPressed:s,multiselectionKeyPressed:u,deleteKeyPressed:h,panActivationKeyPressed:c,zoomActivationKeyPressed:m,selectionRect:g}=De();function y(b){return b!==null&&typeof b=="object"}function M(b){return y(b)?b.modifier||[]:[]}function N(b){return b==null?"":y(b)?b.key:b}function C(b,v){return(Array.isArray(b)?b:[b]).map(_=>{const z=N(_);return{key:z,modifier:M(_),enabled:z!==null,callback:v}})}function E(){g.set(null),s.set(!1),u.set(!1),h.set(!1),c.set(!1),m.set(!1)}fe(),Ce("blur",tt,E),Ce("contextmenu",tt,E),qe(tt,(b,v)=>Pe==null?void 0:Pe(b,v),()=>({trigger:C(n(),()=>s.set(!0)),type:"keydown"})),qe(tt,(b,v)=>Pe==null?void 0:Pe(b,v),()=>({trigger:C(n(),()=>s.set(!1)),type:"keyup"})),qe(tt,(b,v)=>Pe==null?void 0:Pe(b,v),()=>({trigger:C(o(),()=>u.set(!0)),type:"keydown"})),qe(tt,(b,v)=>Pe==null?void 0:Pe(b,v),()=>({trigger:C(o(),()=>u.set(!1)),type:"keyup"})),qe(tt,(b,v)=>Pe==null?void 0:Pe(b,v),()=>({trigger:C(r(),b=>{!(b.originalEvent.ctrlKey||b.originalEvent.metaKey||b.originalEvent.shiftKey)&&!ur(b.originalEvent)&&h.set(!0)}),type:"keydown"})),qe(tt,(b,v)=>Pe==null?void 0:Pe(b,v),()=>({trigger:C(r(),()=>h.set(!1)),type:"keyup"})),qe(tt,(b,v)=>Pe==null?void 0:Pe(b,v),()=>({trigger:C(l(),()=>c.set(!0)),type:"keydown"})),qe(tt,(b,v)=>Pe==null?void 0:Pe(b,v),()=>({trigger:C(l(),()=>c.set(!1)),type:"keyup"})),qe(tt,(b,v)=>Pe==null?void 0:Pe(b,v),()=>({trigger:C(i(),()=>m.set(!0)),type:"keydown"})),qe(tt,(b,v)=>Pe==null?void 0:Pe(b,v),()=>({trigger:C(i(),()=>m.set(!1)),type:"keyup"})),ue()}var Ks=Le('<path fill="none" class="svelte-flow__connection-path"></path>'),Zs=Le('<svg class="svelte-flow__connectionline"><g><!><!></g></svg>');function Fs(t,e){de(e,!1);const n=()=>W(y,"$connection",i),o=()=>W(M,"$connectionLineType",i),r=()=>W(m,"$width",i),l=()=>W(g,"$height",i),[i,s]=Ye();let u=d(e,"containerStyle",8,""),h=d(e,"style",8,""),c=d(e,"isCustomComponent",8,!1);const{width:m,height:g,connection:y,connectionLineType:M}=De();let N=q(null);$(()=>(n(),P(c()),o(),a(N),Sn),()=>{if(n().inProgress&&!c()){const{from:v,to:p,fromPosition:_,toPosition:z}=n(),k={sourceX:v.x,sourceY:v.y,sourcePosition:_,targetX:p.x,targetY:p.y,targetPosition:z};switch(o()){case zt.Bezier:(H=>{var A=yt(H,1);F(N,A[0])})(Ro(k));break;case zt.Step:(H=>{var A=yt(H,1);F(N,A[0])})(rn({...k,borderRadius:0}));break;case zt.SmoothStep:(H=>{var A=yt(H,1);F(N,A[0])})(rn(k));break;default:(H=>{var A=yt(H,1);F(N,A[0])})(Sn(k))}}}),Ge(),fe();var C=at(),E=Ve(C);{var b=v=>{var p=Zs(),_=ae(p),z=ae(_);Ue(z,e,"connectionLine",{},null);var k=me(z);{var H=A=>{var O=Ks();we(()=>{le(O,"d",a(N)),lt(O,h())}),j(A,O)};Ae(k,A=>{c()||A(H)})}se(_),se(p),we(A=>{le(p,"width",r()),le(p,"height",l()),lt(p,u()),Qe(_,0,A)},[()=>nt((P(Te),P(co),n(),D(()=>Te(["svelte-flow__connection",co(n().isValid)]))))]),j(v,p)};Ae(E,v=>{n(),D(()=>n().inProgress)&&v(b)})}j(t,C),ue(),s()}var Gs=pe("<div><!></div>");function ri(t,e){const n=Oe(e,["children","$$slots","$$events","$$legacy"]),o=Oe(n,["position","style","class"]);de(e,!1);const r=()=>W(m,"$selectionRectMode",l),[l,i]=Ye(),s=q();let u=d(e,"position",8,"top-right"),h=d(e,"style",8,void 0),c=d(e,"class",8,void 0);const{selectionRectMode:m}=De();$(()=>P(u()),()=>{F(s,`${u()}`.split("-"))}),Ge(),fe();var g=Gs();On(g,M=>({class:M,style:h(),...o,[To]:{"pointer-events":r()?"none":""}}),[()=>(P(Te),P(c()),a(s),D(()=>Te(["svelte-flow__panel",c(),...a(s)])))]);var y=ae(g);Ue(y,e,"default",{},null),se(g),j(t,g),ue(),i()}var js=pe('<a href="https://svelteflow.dev" target="_blank" rel="noopener noreferrer" aria-label="Svelte Flow attribution">Svelte Flow</a>');function Us(t,e){de(e,!1);let n=d(e,"proOptions",8,void 0),o=d(e,"position",8,"bottom-right");fe();var r=at(),l=Ve(r);{var i=s=>{ri(s,{get position(){return o()},class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",children:(u,h)=>{var c=js();j(u,c)},$$slots:{default:!0}})};Ae(l,s=>{P(n()),D(()=>{var u;return!((u=n())!=null&&u.hideAttribution)})&&s(i)})}j(t,r),ue()}function Mo(t,{nodeTypes:e,edgeTypes:n,minZoom:o,maxZoom:r,translateExtent:l,paneClickDistance:i}){e!==void 0&&t.setNodeTypes(e),n!==void 0&&t.setEdgeTypes(n),o!==void 0&&t.setMinZoom(o),r!==void 0&&t.setMaxZoom(r),l!==void 0&&t.setTranslateExtent(l),i!==void 0&&t.setPaneClickDistance(i)}const qs=t=>Object.keys(t);function zo(t,e){qs(e).forEach(n=>{const o=e[n];o!==void 0&&t[n].set(o)})}function Js(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Qs(t="light"){return it("light",n=>{if(t!=="system"){n(t);return}const o=Js(),r=()=>n(o!=null&&o.matches?"dark":"light");return n(o!=null&&o.matches?"dark":"light"),o==null||o.addEventListener("change",r),()=>{o==null||o.removeEventListener("change",r)}})}var $s=pe('<!> <!> <div class="svelte-flow__edgelabel-renderer"></div> <div class="svelte-flow__viewport-portal"></div> <!> <!>',1),el=pe("<!> <!>",1),tl=pe("<div><!> <!> <!> <!></div>");function nl(t,e){const n=Ii(e),o=Oe(e,["children","$$slots","$$events","$$legacy"]),r=Oe(o,["id","nodes","edges","fitView","fitViewOptions","minZoom","maxZoom","initialViewport","viewport","nodeTypes","edgeTypes","selectionKey","selectionMode","panActivationKey","multiSelectionKey","zoomActivationKey","nodesDraggable","nodesConnectable","nodeDragThreshold","elementsSelectable","snapGrid","deleteKey","connectionRadius","connectionLineType","connectionMode","connectionLineStyle","connectionLineContainerStyle","onMoveStart","onMove","onMoveEnd","isValidConnection","translateExtent","nodeExtent","onlyRenderVisibleElements","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnDrag","selectionOnDrag","autoPanOnConnect","autoPanOnNodeDrag","onerror","ondelete","onedgecreate","attributionPosition","proOptions","defaultEdgeOptions","width","height","colorMode","onconnect","onconnectstart","onconnectend","onbeforedelete","oninit","nodeOrigin","paneClickDistance","nodeClickDistance","defaultMarkerColor","style","class"]);de(e,!1);const l=()=>W(v(),"$viewport",u),i=()=>W(ai,"$initialized",u),s=()=>W(a(c),"$colorModeClass",u),[u,h]=Ye(),c=q();let m=d(e,"id",8,"1"),g=d(e,"nodes",8),y=d(e,"edges",8),M=d(e,"fitView",8,void 0),N=d(e,"fitViewOptions",8,void 0),C=d(e,"minZoom",8,void 0),E=d(e,"maxZoom",8,void 0),b=d(e,"initialViewport",8,void 0),v=d(e,"viewport",8,void 0),p=d(e,"nodeTypes",8,void 0),_=d(e,"edgeTypes",8,void 0),z=d(e,"selectionKey",8,void 0),k=d(e,"selectionMode",8,void 0),H=d(e,"panActivationKey",8,void 0),A=d(e,"multiSelectionKey",8,void 0),O=d(e,"zoomActivationKey",8,void 0),X=d(e,"nodesDraggable",8,void 0),T=d(e,"nodesConnectable",8,void 0),V=d(e,"nodeDragThreshold",8,void 0),f=d(e,"elementsSelectable",8,void 0),x=d(e,"snapGrid",8,void 0),w=d(e,"deleteKey",8,void 0),S=d(e,"connectionRadius",8,void 0),I=d(e,"connectionLineType",8,void 0),B=d(e,"connectionMode",24,()=>bt.Strict),L=d(e,"connectionLineStyle",8,""),R=d(e,"connectionLineContainerStyle",8,""),K=d(e,"onMoveStart",8,void 0),G=d(e,"onMove",8,void 0),Z=d(e,"onMoveEnd",8,void 0),J=d(e,"isValidConnection",8,void 0),oe=d(e,"translateExtent",8,void 0),ee=d(e,"nodeExtent",8,void 0),te=d(e,"onlyRenderVisibleElements",8,void 0),ge=d(e,"panOnScrollMode",24,()=>gt.Free),be=d(e,"preventScrolling",8,!0),ye=d(e,"zoomOnScroll",8,!0),U=d(e,"zoomOnDoubleClick",8,!0),ie=d(e,"zoomOnPinch",8,!0),_e=d(e,"panOnScroll",8,!1),xe=d(e,"panOnDrag",8,!0),ke=d(e,"selectionOnDrag",8,void 0),Be=d(e,"autoPanOnConnect",8,!0),Ne=d(e,"autoPanOnNodeDrag",8,!0),Xe=d(e,"onerror",8,void 0),Me=d(e,"ondelete",8,void 0),ce=d(e,"onedgecreate",8,void 0),Je=d(e,"attributionPosition",8,void 0),$e=d(e,"proOptions",8,void 0),ot=d(e,"defaultEdgeOptions",8,void 0),Re=d(e,"width",8,void 0),Ie=d(e,"height",8,void 0),We=d(e,"colorMode",8,"light"),Ze=d(e,"onconnect",8,void 0),vt=d(e,"onconnectstart",8,void 0),Se=d(e,"onconnectend",8,void 0),ze=d(e,"onbeforedelete",8,void 0),He=d(e,"oninit",8,void 0),Ee=d(e,"nodeOrigin",8,void 0),Fe=d(e,"paneClickDistance",8,0),et=d(e,"nodeClickDistance",8,0),Kn=d(e,"defaultMarkerColor",8,"#b1b1b7"),si=d(e,"style",8,void 0),Zn=d(e,"class",8,void 0),gn=q(),At=q(),Vt=q();const li=l()||b(),je=Pi(fn)?De():ys({nodes:Y(g()),edges:Y(y()),width:Re(),height:Ie(),fitView:M(),nodeOrigin:Ee(),nodeExtent:ee()});Zt(()=>(je.width.set(a(At)),je.height.set(a(Vt)),je.domNode.set(a(gn)),je.syncNodeStores(g()),je.syncEdgeStores(y()),je.syncViewport(v()),M()!==void 0&&je.fitViewQueued.set(M()),N()&&je.fitViewOptions.set(N()),Mo(je,{nodeTypes:p(),edgeTypes:_(),minZoom:C(),maxZoom:E(),translateExtent:oe(),paneClickDistance:Fe()}),()=>{je.reset()}));const{initialized:ai}=je;let hn=q(!1);$(()=>(a(At),a(Vt)),()=>{a(At)!==void 0&&a(Vt)!==void 0&&(je.width.set(a(At)),je.height.set(a(Vt)))}),$(()=>(a(hn),i(),P(He())),()=>{var Ke;!a(hn)&&i()&&((Ke=He())==null||Ke(),F(hn,!0))}),$(()=>(P(m()),P(I()),P(S()),P(k()),P(x()),P(Kn()),P(X()),P(T()),P(f()),P(te()),P(J()),P(Be()),P(Ne()),P(Xe()),P(Me()),P(ce()),P(B()),P(V()),P(Ze()),P(vt()),P(Se()),P(ze()),P(Ee()),zo),()=>{const Ke={flowId:m(),connectionLineType:I(),connectionRadius:S(),selectionMode:k(),snapGrid:x(),defaultMarkerColor:Kn(),nodesDraggable:X(),nodesConnectable:T(),elementsSelectable:f(),onlyRenderVisibleElements:te(),isValidConnection:J(),autoPanOnConnect:Be(),autoPanOnNodeDrag:Ne(),onerror:Xe(),ondelete:Me(),onedgecreate:ce(),connectionMode:B(),nodeDragThreshold:V(),onconnect:Ze(),onconnectstart:vt(),onconnectend:Se(),onbeforedelete:ze(),nodeOrigin:Ee()};zo(je,Ke)}),$(()=>(P(p()),P(_()),P(C()),P(E()),P(oe()),P(Fe())),()=>{Mo(je,{nodeTypes:p(),edgeTypes:_(),minZoom:C(),maxZoom:E(),translateExtent:oe(),paneClickDistance:Fe()})}),$(()=>P(We()),()=>{Ei(F(c,Qs(We())),"$colorModeClass",u)}),Ge(),fe();var ft=tl();On(ft,Ke=>({style:si(),class:Ke,"data-testid":"svelte-flow__wrapper",...r,role:"application"}),[()=>(P(Te),P(Zn()),s(),D(()=>Te(["svelte-flow",Zn(),s()])))],void 0,void 0,"svelte-4xqsnx");var Fn=ae(ft);Ws(Fn,{get selectionKey(){return z()},get deleteKey(){return w()},get panActivationKey(){return H()},get multiSelectionKey(){return A()},get zoomActivationKey(){return O()}});var Gn=me(Fn,2);{let Ke=re(()=>(P(ge()),P(gt),D(()=>ge()===void 0?gt.Free:ge()))),di=re(()=>be()===void 0?!0:be()),ui=re(()=>ye()===void 0?!0:ye()),fi=re(()=>U()===void 0?!0:U()),gi=re(()=>ie()===void 0?!0:ie()),hi=re(()=>_e()===void 0?!1:_e()),mi=re(()=>xe()===void 0?!0:xe()),yi=re(()=>Fe()===void 0?0:Fe());bs(Gn,{get initialViewport(){return li},get onMoveStart(){return K()},get onMove(){return G()},get onMoveEnd(){return Z()},get panOnScrollMode(){return a(Ke)},get preventScrolling(){return a(di)},get zoomOnScroll(){return a(ui)},get zoomOnDoubleClick(){return a(fi)},get zoomOnPinch(){return a(gi)},get panOnScroll(){return a(hi)},get panOnDrag(){return a(mi)},get paneClickDistance(){return a(yi)},children:(vi,Fl)=>{{let bi=re(()=>xe()===void 0?!0:xe());ws(vi,{get panOnDrag(){return a(bi)},get selectionOnDrag(){return ke()},$$events:{paneclick(Lt){ve.call(this,e,Lt)},panecontextmenu(Lt){ve.call(this,e,Lt)}},children:(Lt,Gl)=>{var Un=el(),qn=Ve(Un);_s(qn,{children:(wi,jl)=>{var Jn=$s(),Qn=Ve(Jn);Ls(Qn,{get defaultEdgeOptions(){return ot()},$$events:{edgeclick(he){ve.call(this,e,he)},edgecontextmenu(he){ve.call(this,e,he)},edgemouseenter(he){ve.call(this,e,he)},edgemouseleave(he){ve.call(this,e,he)}}});var $n=me(Qn,2);Fs($n,{get containerStyle(){return R()},get style(){return L()},isCustomComponent:D(()=>n.connectionLine),$$slots:{connectionLine:(he,Ul)=>{var to=at(),_i=Ve(to);Ue(_i,e,"connectionLine",{},null),j(he,to)}}});var eo=me($n,6);Ms(eo,{get nodeClickDistance(){return et()},$$events:{nodeclick(he){ve.call(this,e,he)},nodemouseenter(he){ve.call(this,e,he)},nodemousemove(he){ve.call(this,e,he)},nodemouseleave(he){ve.call(this,e,he)},nodedragstart(he){ve.call(this,e,he)},nodedrag(he){ve.call(this,e,he)},nodedragstop(he){ve.call(this,e,he)},nodecontextmenu(he){ve.call(this,e,he)}}});var pi=me(eo,2);Rs(pi,{$$events:{selectionclick(he){ve.call(this,e,he)},selectioncontextmenu(he){ve.call(this,e,he)},nodedragstart(he){ve.call(this,e,he)},nodedrag(he){ve.call(this,e,he)},nodedragstop(he){ve.call(this,e,he)}}}),j(wi,Jn)},$$slots:{default:!0}});var xi=me(qn,2);Bs(xi,{}),j(Lt,Un)},$$slots:{default:!0}})}},$$slots:{default:!0}})}var jn=me(Gn,2);Us(jn,{get proOptions(){return $e()},get position(){return Je()}});var ci=me(jn,2);Ue(ci,e,"default",{},null),se(ft),An(ft,Ke=>F(gn,Ke),()=>a(gn)),ro(ft,"clientWidth",Ke=>F(At,Ke)),ro(ft,"clientHeight",Ke=>F(Vt,Ke)),Ce("dragover",ft,function(Ke){ve.call(this,e,Ke)}),Ce("drop",ft,function(Ke){ve.call(this,e,Ke)}),j(t,ft),ue(),h()}function ol(t,e){de(e,!1);let n=d(e,"initialNodes",8,void 0),o=d(e,"initialEdges",8,void 0),r=d(e,"initialWidth",8,void 0),l=d(e,"initialHeight",8,void 0),i=d(e,"fitView",8,void 0),s=d(e,"nodeOrigin",8,void 0);const u=oi({nodes:n(),edges:o(),width:r(),height:l(),nodeOrigin:s(),fitView:i()});Xt(fn,{getStore:()=>u}),sn(()=>{u.reset()}),fe();var h=at(),c=Ve(h);Ue(c,e,"default",{},null),j(t,h),ue()}var il=pe("<button><!></button>");function Ct(t,e){const n=Oe(e,["children","$$slots","$$events","$$legacy"]),o=Oe(n,["class","bgColor","bgColorHover","color","colorHover","borderColor"]);de(e,!1);let r=d(e,"class",8,void 0),l=d(e,"bgColor",8,void 0),i=d(e,"bgColorHover",8,void 0),s=d(e,"color",8,void 0),u=d(e,"colorHover",8,void 0),h=d(e,"borderColor",8,void 0);fe();var c=il();On(c,g=>({type:"button",class:g,...o,[To]:{"--xy-controls-button-background-color-props":l(),"--xy-controls-button-background-color-hover-props":i(),"--xy-controls-button-color-props":s(),"--xy-controls-button-color-hover-props":u(),"--xy-controls-button-border-color-props":h()}}),[()=>(P(Te),P(r()),D(()=>Te(["svelte-flow__controls-button",r()])))]);var m=ae(c);Ue(m,e,"default",{class:"button-svg"},null),se(c),Ce("click",c,function(g){ve.call(this,e,g)}),j(t,c),ue()}var rl=Le('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"></path></svg>');function sl(t){var e=rl();j(t,e)}var ll=Le('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 5"><path d="M0 0h32v4.2H0z"></path></svg>');function al(t){var e=ll();j(t,e)}var cl=Le('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 30"><path d="M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"></path></svg>');function dl(t){var e=cl();j(t,e)}var ul=Le('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"></path></svg>');function fl(t){var e=ul();j(t,e)}var gl=Le('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"></path></svg>');function hl(t){var e=gl();j(t,e)}var ml=pe("<!> <!>",1),yl=pe("<!> <!> <!> <!> <!> <!>",1);function vl(t,e){de(e,!1);const n=()=>W(I,"$nodesDraggable",u),o=()=>W(B,"$nodesConnectable",u),r=()=>W(L,"$elementsSelectable",u),l=()=>W(x,"$viewport",u),i=()=>W(w,"$minZoom",u),s=()=>W(S,"$maxZoom",u),[u,h]=Ye(),c=q(),m=q(),g=q(),y=q();let M=d(e,"position",8,"bottom-left"),N=d(e,"showZoom",8,!0),C=d(e,"showFitView",8,!0),E=d(e,"showLock",8,!0),b=d(e,"buttonBgColor",8,void 0),v=d(e,"buttonBgColorHover",8,void 0),p=d(e,"buttonColor",8,void 0),_=d(e,"buttonColorHover",8,void 0),z=d(e,"buttonBorderColor",8,void 0),k=d(e,"ariaLabel",8,void 0),H=d(e,"style",8,void 0),A=d(e,"orientation",8,"vertical"),O=d(e,"fitViewOptions",8,void 0),X=d(e,"class",8,"");const{zoomIn:T,zoomOut:V,fitView:f,viewport:x,minZoom:w,maxZoom:S,nodesDraggable:I,nodesConnectable:B,elementsSelectable:L}=De(),R={bgColor:b(),bgColorHover:v(),color:p(),colorHover:_(),borderColor:z()},K=()=>{T()},G=()=>{V()},Z=()=>{f(O())},J=()=>{F(c,!a(c)),I.set(a(c)),B.set(a(c)),L.set(a(c))};$(()=>(n(),o(),r()),()=>{F(c,n()||o()||r())}),$(()=>(l(),i()),()=>{F(m,l().zoom<=i())}),$(()=>(l(),s()),()=>{F(g,l().zoom>=s())}),$(()=>P(A()),()=>{F(y,A()==="horizontal"?"horizontal":"vertical")}),Ge(),fe();{let oe=re(()=>(P(Te),a(y),P(X()),D(()=>Te(["svelte-flow__controls",a(y),X()])))),ee=re(()=>k()??"Svelte Flow controls");ri(t,{get class(){return a(oe)},get position(){return M()},"data-testid":"svelte-flow__controls",get"aria-label"(){return a(ee)},get style(){return H()},children:(te,ge)=>{var be=yl(),ye=Ve(be);Ue(ye,e,"before",{},null);var U=me(ye,2);{var ie=Me=>{var ce=ml(),Je=Ve(ce);Ct(Je,Bt({class:"svelte-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",get disabled(){return a(g)}},()=>R,{$$events:{click:K},children:(ot,Re)=>{sl(ot)},$$slots:{default:!0}}));var $e=me(Je,2);Ct($e,Bt({class:"svelte-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",get disabled(){return a(m)}},()=>R,{$$events:{click:G},children:(ot,Re)=>{al(ot)},$$slots:{default:!0}})),j(Me,ce)};Ae(U,Me=>{N()&&Me(ie)})}var _e=me(U,2);{var xe=Me=>{Ct(Me,Bt({class:"svelte-flow__controls-fitview",title:"fit view","aria-label":"fit view"},()=>R,{$$events:{click:Z},children:(ce,Je)=>{dl(ce)},$$slots:{default:!0}}))};Ae(_e,Me=>{C()&&Me(xe)})}var ke=me(_e,2);{var Be=Me=>{Ct(Me,Bt({class:"svelte-flow__controls-interactive",title:"toggle interactivity","aria-label":"toggle interactivity"},()=>R,{$$events:{click:J},children:(ce,Je)=>{var $e=at(),ot=Ve($e);{var Re=We=>{hl(We)},Ie=We=>{fl(We)};Ae(ot,We=>{a(c)?We(Re):We(Ie,!1)})}j(ce,$e)},$$slots:{default:!0}}))};Ae(ke,Me=>{E()&&Me(Be)})}var Ne=me(ke,2);Ue(Ne,e,"default",{},null);var Xe=me(Ne,2);Ue(Xe,e,"after",{},null),j(te,be)},$$slots:{default:!0}})}ue(),h()}var ut;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(ut||(ut={}));var bl=Le("<circle></circle>");function xl(t,e){de(e,!1);let n=d(e,"radius",8,5),o=d(e,"class",8,"");fe();var r=bl();we(l=>{le(r,"cx",n()),le(r,"cy",n()),le(r,"r",n()),Qe(r,0,l)},[()=>nt((P(Te),P(o()),D(()=>Te(["svelte-flow__background-pattern","dots",o()]))))]),j(t,r),ue()}var wl=Le("<path></path>");function pl(t,e){de(e,!1);let n=d(e,"lineWidth",8,1),o=d(e,"dimensions",8),r=d(e,"variant",8,void 0),l=d(e,"class",8,"");fe();var i=wl();we(s=>{le(i,"stroke-width",n()),le(i,"d",(P(o()),D(()=>`M${o()[0]/2} 0 V${o()[1]} M0 ${o()[1]/2} H${o()[0]}`))),Qe(i,0,s)},[()=>nt((P(Te),P(r()),P(l()),D(()=>Te(["svelte-flow__background-pattern",r(),l()]))))]),j(t,i),ue()}const _l={[ut.Dots]:1,[ut.Lines]:1,[ut.Cross]:6};var kl=Le('<svg data-testid="svelte-flow__background"><pattern patternUnits="userSpaceOnUse"><!></pattern><rect x="0" y="0" width="100%" height="100%"></rect></svg>');function Pl(t,e){de(e,!1);const n=()=>W(_,"$flowId",r),o=()=>W(p,"$viewport",r),[r,l]=Ye(),i=q(),s=q(),u=q(),h=q(),c=q();let m=d(e,"id",8,void 0),g=d(e,"variant",24,()=>ut.Dots),y=d(e,"gap",8,20),M=d(e,"size",8,1),N=d(e,"lineWidth",8,1),C=d(e,"bgColor",8,void 0),E=d(e,"patternColor",8,void 0),b=d(e,"patternClass",8,void 0),v=d(e,"class",8,"");const{viewport:p,flowId:_}=De(),z=M()||_l[g()],k=g()===ut.Dots,H=g()===ut.Cross,A=Array.isArray(y())?y():[y(),y()];$(()=>(n(),P(m())),()=>{F(i,`background-pattern-${n()}-${m()?m():""}`)}),$(()=>o(),()=>{F(s,[A[0]*o().zoom||1,A[1]*o().zoom||1])}),$(()=>o(),()=>{F(u,z*o().zoom)}),$(()=>(a(u),a(s)),()=>{F(h,H?[a(u),a(u)]:a(s))}),$(()=>(a(u),a(h)),()=>{F(c,k?[a(u)/2,a(u)/2]:[a(h)[0]/2,a(h)[1]/2])}),Ge(),fe();var O=kl();let X;var T=ae(O),V=ae(T);{var f=S=>{{let I=re(()=>a(u)/2);xl(S,{get radius(){return a(I)},get class(){return b()}})}},x=S=>{pl(S,{get dimensions(){return a(h)},get variant(){return g()},get lineWidth(){return N()},get class(){return b()}})};Ae(V,S=>{k?S(f):S(x,!1)})}se(T);var w=me(T);se(O),we(S=>{Qe(O,0,S,"svelte-11j66u4"),X=lt(O,"",X,{"--xy-background-color-props":C(),"--xy-background-pattern-color-props":E()}),le(T,"id",a(i)),le(T,"x",(o(),a(s),D(()=>o().x%a(s)[0]))),le(T,"y",(o(),a(s),D(()=>o().y%a(s)[1]))),le(T,"width",(a(s),D(()=>a(s)[0]))),le(T,"height",(a(s),D(()=>a(s)[1]))),le(T,"patternTransform",(a(c),D(()=>`translate(-${a(c)[0]},-${a(c)[1]})`))),le(w,"fill",`url(#${a(i)})`)},[()=>nt((P(Te),P(v()),D(()=>Te(["svelte-flow__background",v()]))))]),j(t,O),ue(),l()}const So=t=>Qi(t);function Cl(){const{zoomIn:t,zoomOut:e,fitView:n,onbeforedelete:o,snapGrid:r,viewport:l,width:i,height:s,minZoom:u,maxZoom:h,panZoom:c,nodes:m,edges:g,domNode:y,nodeLookup:M,nodeOrigin:N,edgeLookup:C,connectionLookup:E}=De(),b=_=>{var O,X;const z=Y(M),k=So(_)?_:z.get(_.id),H=k.parentId?lr(k.position,k.measured,k.parentId,z,Y(N)):k.position,A={...k,position:H,width:((O=k.measured)==null?void 0:O.width)??k.width,height:((X=k.measured)==null?void 0:X.height)??k.height};return Ht(A)},v=(_,z,k={replace:!1})=>{var O;const H=(O=Y(M).get(_))==null?void 0:O.internals.userNode;if(!H)return;const A=typeof z=="function"?z(H):z;k.replace?m.update(X=>X.map(T=>T.id===_?So(A)?A:{...T,...A}:T)):(Object.assign(H,A),m.update(X=>X))},p=_=>Y(M).get(_);return{zoomIn:t,zoomOut:e,getInternalNode:p,getNode:_=>{var z;return(z=p(_))==null?void 0:z.internals.userNode},getNodes:_=>_===void 0?Y(m):No(Y(M),_),getEdge:_=>Y(C).get(_),getEdges:_=>_===void 0?Y(g):No(Y(C),_),setZoom:(_,z)=>{const k=Y(c);return k?k.scaleTo(_,{duration:z==null?void 0:z.duration}):Promise.resolve(!1)},getZoom:()=>Y(l).zoom,setViewport:async(_,z)=>{const k=Y(l),H=Y(c);return H?(await H.setViewport({x:_.x??k.x,y:_.y??k.y,zoom:_.zoom??k.zoom},{duration:z==null?void 0:z.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>Y(l),setCenter:async(_,z,k)=>{const H=typeof(k==null?void 0:k.zoom)<"u"?k.zoom:Y(h),A=Y(c);return A?(await A.setViewport({x:Y(i)/2-_*H,y:Y(s)/2-z*H,zoom:H},{duration:k==null?void 0:k.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitView:n,fitBounds:async(_,z)=>{const k=Y(c);if(!k)return Promise.resolve(!1);const H=Bn(_,Y(i),Y(s),Y(u),Y(h),(z==null?void 0:z.padding)??.1);return await k.setViewport(H,{duration:z==null?void 0:z.duration}),Promise.resolve(!0)},getIntersectingNodes:(_,z=!0,k)=>{const H=fo(_),A=H?_:b(_);return A?(k||Y(m)).filter(O=>{const X=Y(M).get(O.id);if(!X||!H&&O.id===_.id)return!1;const T=Ht(X),V=Wt(T,A);return z&&V>0||V>=A.width*A.height}):[]},isNodeIntersecting:(_,z,k=!0)=>{const A=fo(_)?_:b(_);if(!A)return!1;const O=Wt(A,z);return k&&O>0||O>=A.width*A.height},deleteElements:async({nodes:_=[],edges:z=[]})=>{const{nodes:k,edges:H}=await Vo({nodesToRemove:_,edgesToRemove:z,nodes:Y(m),edges:Y(g),onBeforeDelete:Y(o)});return k&&m.update(A=>A.filter(O=>!k.some(({id:X})=>X===O.id))),H&&g.update(A=>A.filter(O=>!H.some(({id:X})=>X===O.id))),{deletedNodes:k,deletedEdges:H}},screenToFlowPosition:(_,z={snapToGrid:!0})=>{const k=Y(y);if(!k)return _;const H=z.snapToGrid?Y(r):!1,{x:A,y:O,zoom:X}=Y(l),{x:T,y:V}=k.getBoundingClientRect(),f={x:_.x-T,y:_.y-V};return Gt(f,[A,O,X],H!==null,H||[1,1])},flowToScreenPosition:_=>{const z=Y(y);if(!z)return _;const{x:k,y:H,zoom:A}=Y(l),{x:O,y:X}=z.getBoundingClientRect(),T=nn(_,[k,H,A]);return{x:T.x+O,y:T.y+X}},toObject:()=>({nodes:Y(m).map(_=>({..._,position:{..._.position},data:{..._.data}})),edges:Y(g).map(_=>({..._})),viewport:{...Y(l)}}),updateNode:v,updateNodeData:(_,z,k)=>{var O;const H=(O=Y(M).get(_))==null?void 0:O.internals.userNode;if(!H)return;const A=typeof z=="function"?z(H):z;H.data=k!=null&&k.replace?A:{...H.data,...A},m.update(X=>X)},getNodesBounds:_=>{const z=Y(M),k=Y(N);return $i(_,{nodeLookup:z,nodeOrigin:k})},getHandleConnections:({type:_,id:z,nodeId:k})=>{var H;return Array.from(((H=Y(E).get(`${k}-${_}-${z??null}`))==null?void 0:H.values())??[])},viewport:l}}function No(t,e){var o;const n=[];for(const r of e){const l=t.get(r);if(l){const i="internals"in l?(o=l.internals)==null?void 0:o.userNode:l;n.push(i)}}return n}function El(){const{nodesInitialized:t}=De();return{subscribe:t.subscribe}}var Ml=Le('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg>');function zl(t,e){let n=d(e,"className",8,"size-4"),o=d(e,"strokeWidth",8,"1.5");var r=Ml();we(()=>{le(r,"stroke-width",o()),Qe(r,0,nt(n()))}),j(t,r)}var Sl=pe('<div class="text-red-500 line-clamp-2 text-xs mt-0.5"> </div>'),Nl=pe('<div class="text-gray-500 line-clamp-2 text-xs mt-0.5"> </div>'),Tl=pe('<div class="flex w-full"><!> <div class="ml-2"><div class=" flex justify-between items-center"><div class="text-xs text-black dark:text-white font-medium line-clamp-1"> </div></div> <!></div></div>'),Il=pe('<div class="text-red-500 line-clamp-2 text-xs mt-0.5"> </div>'),Hl=pe('<div class="text-gray-500 line-clamp-2 text-xs mt-0.5"> </div>'),Ol=pe('<div class="flex w-full"><!> <div class="ml-2"><div class=" flex justify-between items-center"><div class="text-xs text-black dark:text-white font-medium line-clamp-1"> </div> <button><!></button></div> <!></div></div>'),Dl=pe('<div class="px-4 py-3 shadow-md rounded-xl dark:bg-black bg-white border dark:border-gray-900 w-60 h-20 group"><!> <!> <!></div>');function Al(t,e){de(e,!1);const n=()=>W(l,"$i18n",o),[o,r]=Ye(),l=Nt("i18n");let i=d(e,"data",12);fe();var s=Dl(),u=ae(s);{let m=re(()=>(P(i()),D(()=>{var g,y;return(y=(g=i())==null?void 0:g.message)!=null&&y.error?i().message.error.content:i().message.content})));Ni(u,{get content(){return a(m)},class:"w-full",allowHTML:!1,children:(g,y)=>{var M=at(),N=Ve(M);{var C=b=>{var v=Tl(),p=ae(v);{let T=re(()=>(P(jt),P(i()),D(()=>`${jt}/users/${i().user.id}/profile/image`)));io(p,{get src(){return a(T)},className:"size-5 -translate-y-[1px]"})}var _=me(p,2),z=ae(_),k=ae(z),H=ae(k,!0);se(k),se(z);var A=me(z,2);{var O=T=>{var V=Sl(),f=ae(V,!0);se(V),we(()=>rt(f,(P(i()),D(()=>i().message.error.content)))),j(T,V)},X=T=>{var V=Nl(),f=ae(V,!0);se(V),we(()=>rt(f,(P(i()),D(()=>i().message.content)))),j(T,V)};Ae(A,T=>{P(i()),D(()=>{var V,f;return(f=(V=i())==null?void 0:V.message)==null?void 0:f.error})?T(O):T(X,!1)})}se(_),se(v),we(()=>rt(H,(P(i()),D(()=>{var T,V;return((V=(T=i())==null?void 0:T.user)==null?void 0:V.name)??"User"})))),j(b,v)},E=b=>{var v=Ol(),p=ae(v);{let f=re(()=>(P(jt),P(i()),n(),D(()=>{var x;return`${jt}/models/model/profile/image?id=${((x=i().model)==null?void 0:x.id)??i().message.model}&lang=${n().language}`})));io(p,{get src(){return a(f)},className:"size-5 -translate-y-[1px]"})}var _=me(p,2),z=ae(_),k=ae(z),H=ae(k,!0);se(k);var A=me(k,2),O=ae(A);{let f=re(()=>(P(i()),D(()=>{var x,w;return(w=(x=i())==null?void 0:x.message)!=null&&w.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500"})));Ti(O,{get className(){return`size-3 ${a(f)??""} `},strokeWidth:"2.5"})}se(A),se(z);var X=me(z,2);{var T=f=>{var x=Il(),w=ae(x,!0);se(x),we(()=>rt(w,(P(i()),D(()=>i().message.error.content)))),j(f,x)},V=f=>{var x=Hl(),w=ae(x,!0);se(x),we(()=>rt(w,(P(i()),D(()=>i().message.content)))),j(f,x)};Ae(X,f=>{P(i()),D(()=>{var x,w;return(w=(x=i())==null?void 0:x.message)==null?void 0:w.error})?f(T):f(V,!1)})}se(_),se(v),we(()=>{rt(H,(P(i()),D(()=>{var f,x,w,S;return((x=(f=i())==null?void 0:f.model)==null?void 0:x.name)??((S=(w=i())==null?void 0:w.message)==null?void 0:S.model)??"Assistant"}))),Qe(A,1,nt((P(i()),D(()=>{var f,x;return(x=(f=i())==null?void 0:f.message)!=null&&x.favorite?"":"invisible group-hover:visible"}))))}),Ce("click",A,()=>{var f,x;i(i().message.favorite=!(((x=(f=i())==null?void 0:f.message)==null?void 0:x.favorite)??!1),!0)}),j(b,v)};Ae(N,b=>{P(i()),D(()=>i().message.role==="user")?b(C):b(E,!1)})}j(g,M)},$$slots:{default:!0}})}var h=me(u,2);Dt(h,{type:"target",get position(){return P(ne),D(()=>ne.Top)},class:"w-2 rounded-full dark:bg-gray-900"});var c=me(h,2);Dt(c,{type:"source",get position(){return P(ne),D(()=>ne.Bottom)},class:"w-2 rounded-full dark:bg-gray-900"}),se(s),j(t,s),ue(),r()}var Vl=Le('<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M22 3L2 3" stroke-linecap="round" stroke-linejoin="round"></path><path d="M22 21L2 21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8 15V9C8 7.89543 8.89543 7 10 7H14C15.1046 7 16 7.89543 16 9V15C16 16.1046 15.1046 17 14 17H10C8.89543 17 8 16.1046 8 15Z"></path></svg>');function Ll(t,e){let n=d(e,"className",8,"w-4 h-4"),o=d(e,"strokeWidth",8,"1.5");var r=Vl();we(()=>{Qe(r,0,nt(n())),le(r,"stroke-width",o())}),j(t,r)}var Yl=Le('<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M3 22L3 2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M21 22V2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M15 16H9C7.89543 16 7 15.1046 7 14V10C7 8.89543 7.89543 8 9 8H15C16.1046 8 17 8.89543 17 10V14C17 15.1046 16.1046 16 15 16Z"></path></svg>');function Bl(t,e){let n=d(e,"className",8,"w-4 h-4"),o=d(e,"strokeWidth",8,"1.5");var r=Yl();we(()=>{Qe(r,0,nt(n())),le(r,"stroke-width",o())}),j(t,r)}var Xl=pe("<!> <!>",1),Rl=pe("<!> <!>",1);function Wl(t,e){de(e,!1);const n=()=>W(Mi,"$theme",o),[o,r]=Ye(),l=wt();let i=d(e,"nodes",8),s=d(e,"nodeTypes",8),u=d(e,"edges",8),h=d(e,"setLayoutDirection",8);fe();{let c=re(()=>(n(),D(()=>n().includes("dark")||n()==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")));nl(t,{get nodes(){return i()},get nodeTypes(){return s()},get edges(){return u()},fitView:!0,minZoom:.001,get colorMode(){return a(c)},nodesConnectable:!1,nodesDraggable:!1,oninit:()=>{},$$events:{nodeclick:m=>l("nodeclick",m.detail)},children:(m,g)=>{var y=Rl(),M=Ve(y);vl(M,{showLock:!1,children:(C,E)=>{var b=Xl(),v=Ve(b);Ct(v,{title:"Vertical Layout",$$events:{click:()=>h()("vertical")},children:(_,z)=>{Ll(_,{className:"size-4"})},$$slots:{default:!0}});var p=me(v,2);Ct(p,{title:"Horizontal Layout",$$events:{click:()=>h()("horizontal")},children:(_,z)=>{Bl(_,{className:"size-4"})},$$slots:{default:!0}}),j(C,b)},$$slots:{default:!0}});var N=me(M,2);Pl(N,{get variant(){return P(ut),D(()=>ut.Dots)}}),j(m,y)},$$slots:{default:!0}})}ue(),r()}var Kl=pe('<div class="w-full h-full relative"><div class=" absolute z-50 w-full flex justify-between dark:text-gray-100 px-4 py-3"><div class="flex items-center gap-2.5"><button class="self-center p-0.5"><!></button> <div class=" text-lg font-medium self-center font-primary"> </div></div> <button class="self-center p-0.5"><!></button></div> <!></div>');function Zl(t,e){de(e,!1);const n=()=>W(Si,"$user",i),o=()=>W(zi,"$models",i),r=()=>W(u,"$i18n",i),l=()=>W(E,"$nodes",i),[i,s]=Ye();wt();const u=Nt("i18n"),{width:h,height:c}=De(),{fitView:m}=Cl(),g=El();let y=d(e,"history",8),M=d(e,"onClose",8),N=d(e,"onNodeClick",8),C=q(null);const E=Q([]),b=Q([]);let v=q("vertical");const p={custom:Al},_=async()=>{a(C)===null?await m({nodes:[{id:y().currentId}]}):await m({nodes:[{id:a(C)}]}),F(C,null)},z=async L=>{const R=[],K=[],G=L==="vertical"?150:300,Z=L==="vertical"?250:150;let J=new Map,oe={};Object.keys(y().messages).forEach(ee=>{var be;const te=y().messages[ee];if(!te)return;const ge=te.parentId?(((be=J.get(te.parentId))==null?void 0:be.level)??-1)+1:0;oe[ge]||(oe[ge]=0),J.set(ee,{id:te.id,level:ge,position:oe[ge]++})}),Object.keys(y().messages).forEach(ee=>{const te=J.get(ee);if(!te)return;const ge=L==="vertical"?te.position*Z:te.level*G,be=L==="vertical"?te.level*G:te.position*Z;R.push({id:te.id,type:"custom",data:{user:n(),message:y().messages[ee],model:o().find(U=>U.id===y().messages[ee].model)},position:{x:ge,y:be}});const ye=y().messages[ee].parentId;ye&&K.push({id:ye+"-"+te.id,source:ye,target:te.id,selectable:!1,class:" dark:fill-gray-300 fill-gray-300",type:"smoothstep",animated:y().currentId===ee||k(ee,y().currentId)})}),await b.set([...K]),await E.set([...R])},k=(L,R)=>{const K=y().messages[L];return K.childrenIds&&K.childrenIds.some(G=>G===R||k(G,R))},H=L=>{F(v,L),z(a(v))};Zt(()=>{z(a(v)),g.subscribe(async L=>{L&&(await Ci(),await m({nodes:[{id:y().currentId}]}))}),h.subscribe(L=>{L&&m({nodes:[{id:y().currentId}]})}),c.subscribe(L=>{L&&m({nodes:[{id:y().currentId}]})})}),sn(()=>{E.set([]),b.set([])}),$(()=>(P(y()),a(v)),()=>{y()&&z(a(v))}),$(()=>P(y()),()=>{y()&&y().currentId&&_()}),Ge(),fe();var A=Kl(),O=ae(A),X=ae(O),T=ae(X),V=ae(T);zl(V,{className:"size-3.5"}),se(T);var f=me(T,2),x=ae(f,!0);se(f),se(X);var w=me(X,2),S=ae(w);Di(S,{className:"size-3.5"}),se(w),se(O);var I=me(O,2);{var B=L=>{Wl(L,{get nodes(){return E},get nodeTypes(){return p},get edges(){return b},setLayoutDirection:H,$$events:{nodeclick:R=>{N()(R.detail),F(C,R.detail.node.data.message.id),m({nodes:[{id:a(C)}]})}}})};Ae(I,L=>{l(),D(()=>l().length>0)&&L(B)})}se(A),we(L=>rt(x,L),[()=>(r(),D(()=>r().t("Chat Overview")))]),Ce("click",T,()=>{oo.set(!1)}),Ce("click",w,()=>{M()(),oo.set(!1)}),j(t,A),ue(),s()}function wa(t,e){de(e,!1),wt();let n=d(e,"history",8),o=d(e,"onClose",8),r=d(e,"onNodeClick",8);fe(),ol(t,{children:(l,i)=>{Zl(l,{get history(){return n()},get onClose(){return o()},get onNodeClick(){return r()}})},$$slots:{default:!0}}),ue()}export{wa as default};
//# sourceMappingURL=B4oLWPTI.js.map
