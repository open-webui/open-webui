{"version":3,"file":"lFKG7_8a.js","sources":["../../../../../../src/lib/components/workspace/Prompts/PromptEditor.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { onMount, tick, getContext } from 'svelte';\n\n\timport Textarea from '$lib/components/common/Textarea.svelte';\n\timport { toast } from 'svelte-sonner';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport AccessControl from '../common/AccessControl.svelte';\n\timport LockClosed from '$lib/components/icons/LockClosed.svelte';\n\timport AccessControlModal from '../common/AccessControlModal.svelte';\n\timport { user } from '$lib/stores';\n\timport { slugify } from '$lib/utils';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\n\texport let onSubmit: Function;\n\texport let edit = false;\n\texport let prompt = null;\n\texport let clone = false;\n\texport let disabled = false;\n\n\tconst i18n = getContext('i18n');\n\n\tlet loading = false;\n\n\tlet title = '';\n\tlet command = '';\n\tlet content = '';\n\n\tlet accessControl = {};\n\n\tlet showAccessControlModal = false;\n\n\tlet hasManualEdit = false;\n\n\t$: if (!edit && !hasManualEdit) {\n\t\tcommand = title !== '' ? slugify(title) : '';\n\t}\n\n\t// Track manual edits\n\tfunction handleCommandInput(e: Event) {\n\t\thasManualEdit = true;\n\t}\n\n\tconst submitHandler = async () => {\n\t\tif (disabled) {\n\t\t\ttoast.error($i18n.t('You do not have permission to edit this prompt.'));\n\t\t\treturn;\n\t\t}\n\t\tloading = true;\n\n\t\tif (validateCommandString(command)) {\n\t\t\tawait onSubmit({\n\t\t\t\ttitle,\n\t\t\t\tcommand,\n\t\t\t\tcontent,\n\t\t\t\taccess_control: accessControl\n\t\t\t});\n\t\t} else {\n\t\t\ttoast.error(\n\t\t\t\t$i18n.t('Only alphanumeric characters and hyphens are allowed in the command string.')\n\t\t\t);\n\t\t}\n\n\t\tloading = false;\n\t};\n\n\tconst validateCommandString = (inputString) => {\n\t\t// Regular expression to match only alphanumeric characters, hyphen, and underscore\n\t\tconst regex = /^[a-zA-Z0-9-_]+$/;\n\n\t\t// Test the input string against the regular expression\n\t\treturn regex.test(inputString);\n\t};\n\n\tonMount(async () => {\n\t\tif (prompt) {\n\t\t\ttitle = prompt.title;\n\t\t\tawait tick();\n\n\t\t\tcommand = prompt.command.at(0) === '/' ? prompt.command.slice(1) : prompt.command;\n\t\t\tcontent = prompt.content;\n\n\t\t\taccessControl = prompt?.access_control === undefined ? {} : prompt?.access_control;\n\t\t}\n\t});\n</script>\n\n<AccessControlModal\n\tbind:show={showAccessControlModal}\n\tbind:accessControl\n\taccessRoles={['read', 'write']}\n\tshare={$user?.permissions?.sharing?.prompts || $user?.role === 'admin'}\n\tsharePublic={$user?.permissions?.sharing?.public_prompts || $user?.role === 'admin'}\n/>\n\n<div class=\"w-full max-h-full flex justify-center\">\n\t<form\n\t\tclass=\"flex flex-col w-full mb-10\"\n\t\ton:submit|preventDefault={() => {\n\t\t\tsubmitHandler();\n\t\t}}\n\t>\n\t\t<div class=\"my-2\">\n\t\t\t<Tooltip\n\t\t\t\tcontent={`${$i18n.t('Only alphanumeric characters and hyphens are allowed')} - ${$i18n.t(\n\t\t\t\t\t'Activate this command by typing \"/{{COMMAND}}\" to chat input.',\n\t\t\t\t\t{\n\t\t\t\t\t\tCOMMAND: command\n\t\t\t\t\t}\n\t\t\t\t)}`}\n\t\t\t\tplacement=\"bottom-start\"\n\t\t\t>\n\t\t\t\t<div class=\"flex flex-col w-full\">\n\t\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclass=\"text-2xl font-medium w-full bg-transparent outline-hidden\"\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Title')}\n\t\t\t\t\t\t\tbind:value={title}\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t{disabled}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t{#if disabled}\n\t\t\t\t\t\t\t<div class=\"text-xs shrink-0 text-gray-500\">\n\t\t\t\t\t\t\t\t{$i18n.t('Read Only')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<div class=\"self-center shrink-0\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"bg-gray-50 hover:bg-gray-100 text-black dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-white transition px-2 py-1 rounded-full flex gap-1 items-center\"\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tshowAccessControlModal = true;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<LockClosed strokeWidth=\"2.5\" className=\"size-3.5\" />\n\n\t\t\t\t\t\t\t\t\t<div class=\"text-sm font-medium shrink-0\">\n\t\t\t\t\t\t\t\t\t\t{$i18n.t('Access')}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex gap-0.5 items-center text-xs text-gray-500\">\n\t\t\t\t\t\t<div class=\"\">/</div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclass=\" w-full bg-transparent outline-hidden\"\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Command')}\n\t\t\t\t\t\t\tbind:value={command}\n\t\t\t\t\t\t\ton:input={handleCommandInput}\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\tdisabled={edit || disabled}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Tooltip>\n\t\t</div>\n\n\t\t<div class=\"my-2\">\n\t\t\t<div class=\"flex w-full justify-between\">\n\t\t\t\t<div class=\" self-center text-sm font-medium\">{$i18n.t('Prompt Content')}</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"mt-2\">\n\t\t\t\t<div>\n\t\t\t\t\t<Textarea\n\t\t\t\t\t\tclassName=\"text-sm w-full bg-transparent outline-hidden overflow-y-hidden resize-none\"\n\t\t\t\t\t\tplaceholder={$i18n.t('Write a summary in 50 words that summarizes {{topic}}.')}\n\t\t\t\t\t\tbind:value={content}\n\t\t\t\t\t\trows={6}\n\t\t\t\t\t\trequired\n\t\t\t\t\t\treadonly={disabled}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"text-xs text-gray-400 dark:text-gray-500\">\n\t\t\t\t\tâ“˜ {$i18n.t('Format your variables using brackets like this:')}&nbsp;<span\n\t\t\t\t\t\tclass=\" text-gray-600 dark:text-gray-300 font-medium\"\n\t\t\t\t\t\t>{'{{'}{$i18n.t('variable')}{'}}'}</span\n\t\t\t\t\t>.\n\t\t\t\t\t{$i18n.t('Make sure to enclose them with')}\n\t\t\t\t\t<span class=\" text-gray-600 dark:text-gray-300 font-medium\">{'{{'}</span>\n\t\t\t\t\t{$i18n.t('and')}\n\t\t\t\t\t<span class=\" text-gray-600 dark:text-gray-300 font-medium\">{'}}'}</span>.\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"text-xs text-gray-400 dark:text-gray-500 underline\">\n\t\t\t\t\t<a href=\"https://docs.openwebui.com/features/workspace/prompts\" target=\"_blank\">\n\t\t\t\t\t\t{$i18n.t('To learn more about powerful prompt variables, click here')}\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"my-4 flex justify-end pb-20\">\n\t\t\t<Tooltip content={disabled ? $i18n.t('You do not have permission to save this prompt.') : ''}>\n\t\t\t\t<button\n\t\t\t\t\tclass=\" text-sm w-full lg:w-fit px-4 py-2 transition rounded-xl {loading || disabled\n\t\t\t\t\t\t? ' cursor-not-allowed bg-gray-200 text-gray-500 dark:bg-gray-700 dark:text-gray-400'\n\t\t\t\t\t\t: 'bg-black hover:bg-gray-900 text-white dark:bg-white dark:hover:bg-gray-100 dark:text-black'} flex w-full justify-center\"\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tdisabled={loading || disabled}\n\t\t\t\t>\n\t\t\t\t\t<div class=\" self-center font-medium\">{$i18n.t('Save & Create')}</div>\n\t\t\t\t\t{#if loading}\n\t\t\t\t\t\t<div class=\"ml-1.5 self-center\">\n\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</button>\n\t\t\t</Tooltip>\n\t\t</div>\n\t</form>\n</div>\n"],"names":["onSubmit","$.prop","$$props","edit","prompt","disabled","i18n","getContext","loading","title","command","content","accessControl","$.mutable_source","showAccessControlModal","hasManualEdit","handleCommandInput","e","$.set","submitHandler","toast","$i18n","validateCommandString","$.get","inputString","onMount","tick","_a","_b","slugify","_c","$user","_d","AccessControlModal","node","$$value","div","$.sibling","form","$.child","div_1","$.untrack","Tooltip","node_1","div_2","root_1","div_3","input","$.remove_input_defaults","node_2","div_4","root_2","div_5","root_3","button","node_3","LockClosed","div_6","$.reset","$$render","consequent","alternate","div_7","input_1","$.set_attribute","$0","$1","$.event","div_8","div_9","div_10","div_11","div_12","Textarea","node_4","div_13","span","text_3","text_4","text_5","span_1","span_2","text_6","div_14","a","div_15","node_5","button_1","root_4","div_16","div_17","root_5","Spinner","node_7","consequent_1","$.set_class","$.append","$$anchor","$.preventDefault"],"mappings":"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"}