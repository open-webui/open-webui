import{_ as b}from"./C1FmrZbK.js";import{b as l}from"./DLhnqOlE.js";import{a as C}from"./cX8aofVu.js";import{g as I}from"./Bp8N0x0r.js";const N=async(o="",t=null,a=!1,e=!1)=>{const n=new URLSearchParams;e&&n.append("refresh","true");let i=null;const s=await fetch(`${l}/api/models${a?"/base":""}?${n.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}}}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).catch(r=>(i=r,null));if(i)throw i;let c=(s==null?void 0:s.data)??[];if(t&&!a){let r=[];if(t){const h=t.OPENAI_API_BASE_URLS,u=t.OPENAI_API_KEYS,j=t.OPENAI_API_CONFIGS,d=[];for(const f in h){const O=h[f];if(f.toString()in j){const $=j[f.toString()]??{},g=($==null?void 0:$.enable)??!0,A=($==null?void 0:$.model_ids)??[];if(g)if(A.length>0){const T={object:"list",data:A.map(y=>({id:y,name:y,owned_by:"openai",openai:{id:y},urlIdx:f}))};d.push((async()=>T)())}else d.push((async()=>await I(O,u[f]).then(T=>T).catch(T=>({object:"list",data:[],urlIdx:f})))());else d.push((async()=>({object:"list",data:[],urlIdx:f}))())}}const S=await Promise.all(d);for(const f in S){const O=S[f],$=j[f.toString()]??{};let g=Array.isArray(O)?O:(O==null?void 0:O.data)??[];g=g.map(y=>({...y,openai:{id:y.id},urlIdx:f}));const A=$.prefix_id;if(A)for(const y of g)y.id=`${A}.${y.id}`;const T=$.tags;if(T)for(const y of g)y.tags=T;r=r.concat(g)}}c=c.concat(r.map(h=>({...h,name:(h==null?void 0:h.name)??(h==null?void 0:h.id),direct:!0})));const p={};for(const h of c)p[h.id]=h;c=Object.values(p)}return c},J=async(o,t)=>{let a=null;const e=await fetch(`${l}/api/chat/completed`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}},body:JSON.stringify(t)}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>("detail"in n?a=n.detail:a=n,null));if(a)throw a;return e},R=async(o,t,a)=>{let e=null;const n=await fetch(`${l}/api/chat/actions/${t}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}},body:JSON.stringify(a)}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>("detail"in i?e=i.detail:e=i,null));if(e)throw e;return n},U=async(o,t)=>{let a=null;const e=await fetch(`${l}/api/tasks/stop/${t}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}}}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>("detail"in n?a=n.detail:a=n,null));if(a)throw a;return e},G=async(o,t)=>{let a=null;const e=await fetch(`${l}/api/tasks/chat/${t}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}}}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>("detail"in n?a=n.detail:a=n,null));if(a)throw a;return e},B=async(o,t)=>{let a=null;const e=await fetch(`${t}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}}}).then(async n=>{if(t.toLowerCase().endsWith(".yaml")||t.toLowerCase().endsWith(".yml")){if(!n.ok)throw await n.text();const[i,{parse:s}]=await Promise.all([n.text(),b(()=>import("./Crekzzsx.js"),[],import.meta.url)]);return s(i)}else{if(!n.ok)throw await n.json();return n.json()}}).catch(n=>("detail"in n?a=n.detail:a=n,null));if(a)throw a;return e},L=async o=>(await Promise.all(o.filter(t=>{var a;return(a=t==null?void 0:t.config)==null?void 0:a.enable}).map(async t=>{let a=null,e=null;const n=(t==null?void 0:t.auth_type)??"bearer";n==="bearer"?e=t==null?void 0:t.key:n==="none"||n==="session"&&(e=localStorage.token);let i=null;const s=(t==null?void 0:t.spec_type)??"url";if(s==="url")i=await B(e,((t==null?void 0:t.path)??"").includes("://")?t==null?void 0:t.path:`${t==null?void 0:t.url}${((t==null?void 0:t.path)??"").startsWith("/")?"":"/"}${t==null?void 0:t.path}`).catch(c=>(a=c,null));else if((s==="json"&&(t==null?void 0:t.spec))??null)try{i=JSON.parse(t==null?void 0:t.spec)}catch{a="Failed to parse JSON spec"}if(i){if(!i.paths)return{error:"Invalid OpenAPI spec",url:t==null?void 0:t.url};const{openapi:c,info:r,specs:p}={openapi:i,info:i.info,specs:C(i)};return{url:t==null?void 0:t.url,openapi:c,info:r,specs:p}}else return a?{error:a,url:t==null?void 0:t.url}:null}))).filter(t=>t),q=async(o,t,a,e,n)=>{let i=null;try{const s=Object.entries(n.openapi.paths).find(([m,w])=>Object.entries(w).some(([P,E])=>E.operationId===a));if(!s)throw new Error(`No matching route found for operationId: ${a}`);const[c,r]=s,p=Object.entries(r).find(([m,w])=>w.operationId===a);if(!p)throw new Error(`No matching method found for operationId: ${a}`);const[h,u]=p,j={},d={};let S={};u.parameters&&u.parameters.forEach(m=>{const w=m.name,P=m.in;e.hasOwnProperty(w)&&(P==="path"?j[w]=e[w]:P==="query"&&(d[w]=e[w]))});let f=`${t}${c}`;if(Object.entries(j).forEach(([m,w])=>{f=f.replace(new RegExp(`{${m}}`,"g"),encodeURIComponent(w))}),Object.keys(d).length>0){const m=new URLSearchParams(Object.entries(d).map(([w,P])=>[w,String(P)])).toString();f+=`?${m}`}if(u.requestBody&&u.requestBody.content){const m=Object.keys(u.requestBody.content)[0];if(e!==void 0)S=e;else throw new Error(`Request body expected for operation '${a}' but none found.`)}const O={"Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}},$={method:h.toUpperCase(),headers:O};["post","put","patch","delete"].includes(h.toLowerCase())&&u.requestBody&&($.body=JSON.stringify(S));const g=await fetch(f,$);if(!g.ok){const m=await g.text();throw new Error(`HTTP error! Status: ${g.status}. Message: ${m}`)}const A={};g.headers.forEach((m,w)=>{A[w]=m});const T=await g.text();let y;try{y=JSON.parse(T)}catch{y=T}return[y,A]}catch(s){return i=s.message,[{error:i},null]}},D=async(o="")=>{let t=null;const a=await fetch(`${l}/api/v1/tasks/config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}}}).then(async e=>{if(!e.ok)throw await e.json();return e.json()}).catch(e=>(t=e,null));if(t)throw t;return a},M=async(o,t)=>{let a=null;const e=await fetch(`${l}/api/v1/tasks/config/update`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}},body:JSON.stringify(t)}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>("detail"in n?a=n.detail:a=n,null));if(a)throw a;return e},V=async(o="",t,a,e)=>{var s,c;let n=null;const i=await fetch(`${l}/api/v1/tasks/title/completions`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({model:t,messages:a,...e})}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).catch(r=>("detail"in r&&(n=r.detail),null));if(n)throw n;try{const p=(((c=(s=i==null?void 0:i.choices[0])==null?void 0:s.message)==null?void 0:c.content)??"").replace(/['‘’`]/g,'"'),h=p.indexOf("{"),u=p.lastIndexOf("}");if(h!==-1&&u!==-1){const j=p.substring(h,u+1),d=JSON.parse(j);return d&&d.title?d.title:null}return null}catch{return null}},W=async(o="",t,a,e)=>{var s,c;let n=null;const i=await fetch(`${l}/api/v1/tasks/tags/completions`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({model:t,messages:a,...e&&{chat_id:e}})}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).catch(r=>("detail"in r&&(n=r.detail),null));if(n)throw n;try{const p=(((c=(s=i==null?void 0:i.choices[0])==null?void 0:s.message)==null?void 0:c.content)??"").replace(/['‘’`]/g,'"'),h=p.indexOf("{"),u=p.lastIndexOf("}");if(h!==-1&&u!==-1){const j=p.substring(h,u+1),d=JSON.parse(j);return d&&d.tags?Array.isArray(d.tags)?d.tags:[]:[]}return[]}catch{return[]}},F=async(o="",t,a,e)=>{var c,r;let n=null;const i=await fetch(`${l}/api/v1/tasks/emoji/completions`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({model:t,prompt:a,...e&&{chat_id:e}})}).then(async p=>{if(!p.ok)throw await p.json();return p.json()}).catch(p=>("detail"in p&&(n=p.detail),null));if(n)throw n;const s=((r=(c=i==null?void 0:i.choices[0])==null?void 0:c.message)==null?void 0:r.content.replace(/["']/g,""))??null;return s&&new RegExp("\\p{Extended_Pictographic}","u").test(s)?s.match(new RegExp("\\p{Extended_Pictographic}","gu"))[0]:null},H=async(o="",t,a,e,n="search query")=>{var p,h;const i=new AbortController;let s=null;const c=await fetch(`${l}/api/v1/tasks/auto/completions`,{signal:i.signal,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({model:t,prompt:a,...e&&{messages:e},type:n,stream:!1})}).then(async u=>{if(!u.ok)throw await u.json();return u.json()}).catch(u=>("detail"in u&&(s=u.detail),null));if(s)throw s;const r=((h=(p=c==null?void 0:c.choices[0])==null?void 0:p.message)==null?void 0:h.content)??"";try{const u=r.indexOf("{"),j=r.lastIndexOf("}");if(u!==-1&&j!==-1){const d=r.substring(u,j+1),S=JSON.parse(d);return S&&S.text?S.text:""}return r}catch{return r}},K=async(o="",t,a,e)=>{const n=new AbortController;let i=null;const s=await fetch(`${l}/api/v1/tasks/moa/completions`,{signal:n.signal,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({model:t,prompt:a,responses:e,stream:!0})}).catch(c=>(i=c,null));if(i)throw i;return[s,n]},Y=async(o="")=>{let t=null;const a=await fetch(`${l}/api/v1/pipelines/list`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}}}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(t=n,null));if(t)throw t;return(a==null?void 0:a.data)??[]},Q=async(o,t,a)=>{let e=null;const n=new FormData;n.append("file",t),n.append("urlIdx",a);const i=await fetch(`${l}/api/v1/pipelines/upload`,{method:"POST",headers:{...o&&{authorization:`Bearer ${o}`}},body:n}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>("detail"in s?e=s.detail:e=s,null));if(e)throw e;return i},X=async(o,t,a)=>{let e=null;const n=await fetch(`${l}/api/v1/pipelines/add`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}},body:JSON.stringify({url:t,urlIdx:a})}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>("detail"in i?e=i.detail:e=i,null));if(e)throw e;return n},Z=async(o,t,a)=>{let e=null;const n=await fetch(`${l}/api/v1/pipelines/delete`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}},body:JSON.stringify({id:t,urlIdx:a})}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>("detail"in i?e=i.detail:e=i,null));if(e)throw e;return n},v=async(o,t)=>{let a=null;const e=new URLSearchParams;t!==void 0&&e.append("urlIdx",t);const n=await fetch(`${l}/api/v1/pipelines/?${e.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}}}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(a=s,null));if(a)throw a;return(n==null?void 0:n.data)??[]},tt=async(o,t,a)=>{let e=null;const n=new URLSearchParams;a!==void 0&&n.append("urlIdx",a);const i=await fetch(`${l}/api/v1/pipelines/${t}/valves?${n.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}}}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(e=s,null));if(e)throw e;return i},nt=async(o,t,a)=>{let e=null;const n=new URLSearchParams;a!==void 0&&n.append("urlIdx",a);const i=await fetch(`${l}/api/v1/pipelines/${t}/valves/spec?${n.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}}}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(e=s,null));if(e)throw e;return i},at=async(o="",t,a,e)=>{let n=null;const i=new URLSearchParams;e!==void 0&&i.append("urlIdx",e);const s=await fetch(`${l}/api/v1/pipelines/${t}/valves/update?${i.toString()}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...o&&{authorization:`Bearer ${o}`}},body:JSON.stringify(a)}).then(async c=>{if(!c.ok)throw await c.json();return c.json()}).catch(c=>("detail"in c?n=c.detail:n=c,null));if(n)throw n;return s},et=async(o="")=>{let t=null;const a=await fetch(`${l}/api/usage`,{method:"GET",headers:{"Content-Type":"application/json",...o&&{Authorization:`Bearer ${o}`}}}).then(async e=>{if(!e.ok)throw await e.json();return e.json()}).catch(e=>(t=e,null));if(t)throw t;return a},ot=async()=>{let o=null;const t=await fetch(`${l}/api/config`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(o=a,null));if(o)throw o;return t},it=async()=>{let o=null;const t=await fetch(`${l}/api/changelog`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(o=a,null));if(o)throw o;return t},st=async o=>{let t=null;const a=await fetch(`${l}/api/version`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(async e=>{if(!e.ok)throw await e.json();return e.json()}).catch(e=>(t=e,null));if(t)throw t;return a},rt=async o=>{let t=null;const a=await fetch(`${l}/api/version/updates`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(async e=>{if(!e.ok)throw await e.json();return e.json()}).catch(e=>(t=e,null));if(t)throw t;return a},ct=async o=>{let t=null;const a=await fetch(`${l}/api/webhook`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(async e=>{if(!e.ok)throw await e.json();return e.json()}).catch(e=>(t=e,null));if(t)throw t;return a.url},lt=async(o,t)=>{let a=null;const e=await fetch(`${l}/api/webhook`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({url:t})}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(a=n,null));if(a)throw a;return e.url};export{U as A,V as B,L as C,it as D,ot as a,B as b,st as c,et as d,q as e,W as f,N as g,ct as h,rt as i,Y as j,at as k,v as l,nt as m,tt as n,Q as o,X as p,Z as q,D as r,M as s,H as t,lt as u,F as v,G as w,J as x,R as y,K as z};
//# sourceMappingURL=B6gyXX6T.js.map
