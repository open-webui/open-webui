import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as Fe,g as Ue,q as Ee,i as h,m as ae,j as r,u as ue,v as Le,f as P,c as t,r as a,k as d,t as I,w as i,s as v,l as O,a as p,b as De,e as ce,A as Ke,z as ve,y as We,n as ze,aQ as ye,x as qe}from"./0WpKKl27.js";import{i as Y}from"./Cmf4RC8y.js";import{a as Ae,r as Ge,s as Xe}from"./CZ1y6KaE.js";import{i as je}from"./C3k0oZ3o.js";import{p as A}from"./DpN1w328.js";import{a as H,s as Be}from"./BVrWTcfB.js";import{c as Re,a as Ye,u as He}from"./PCOILo-8.js";import{t as fe}from"./DYdr9DjX.js";import{a as Pe,s as Je,b as Qe}from"./DR3TfYWm.js";import{n as Ve}from"./cX8aofVu.js";import{M as Te}from"./CcreKc1w.js";import{L as Ze}from"./1w6CVy8g.js";import{X as Ne}from"./CZmZoefv.js";import{s as et}from"./3-JilrU5.js";import"./BtReZMDb.js";import{b as tt,c as Me}from"./DA2vpIKA.js";import{f as at}from"./Dbtivbjp.js";import{D as rt}from"./DD5ATWsz.js";import{G as st}from"./CYXXpf3O.js";import{P as ot}from"./DVjsywiU.js";import{T as lt}from"./Db0gdTVr.js";import{D as it}from"./CmPVC7JK.js";import{b as nt}from"./kb1CvZ3a.js";import{p as dt}from"./Bfc47y5P.js";import{S as ct}from"./BO1efK8r.js";import"./B5RARo22.js";import{T as ut}from"./CWXf-F9t.js";import{K as vt}from"./D_eQ6KZY.js";import{g as ft}from"./DesYX7fr.js";var mt=P('<a target="_blank"> <span class=" underline"> </span>.</a> <button class="underline"> </button> ',1),gt=P('<button class="self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full" type="button"> </button>'),pt=P('<div class="px-5 pt-4 pb-5 w-full flex flex-col justify-center"><div class=" text-sm dark:text-gray-300 mb-1"><!></div> <div class="flex justify-end"><div class="flex flex-col items-end space-x-1 mt-3"><div class="flex gap-1"><!> <button class="self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full" type="button" id="copy-and-share-chat-button"><!> <!></button></div></div></div></div>'),_t=P('<div><div class=" flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5"><div class=" text-lg font-medium self-center"> </div> <button class="self-center"><!></button></div> <!></div>');function oa(re,y){Fe(y,!1);const e=()=>H(J,"$i18n",R),se=()=>H(Ye,"$models",R),K=()=>H(Re,"$config",R),[R,oe]=Be();let U=A(y,"chatId",8),l=ae(null),q=null;const J=Ue("i18n"),D=async()=>{r(l);const o=await Je(localStorage.token,U());return q=`${window.location.origin}/s/${o.id}`,h(l,await Pe(localStorage.token,U())),q},w=async()=>{const o=r(l).chat;fe.success(e().t("Redirecting you to Open WebUI Community"));const k="https://openwebui.com",M=await window.open(`${k}/chats/upload`,"_blank");window.addEventListener("message",E=>{E.origin===k&&E.data==="loaded"&&M.postMessage(JSON.stringify({chat:o,models:se().filter(F=>o.models.includes(F.id))}),"*")},!1)};let $=A(y,"show",12,!1);const _=o=>r(l)?o?r(l).id!==o.id||r(l).share_id!==o.share_id:!1:!0;Ee(()=>(ue($()),ue(U()),r(l)),()=>{$()&&(async()=>{if(U()){const o=await Pe(localStorage.token,U());_(o)&&h(l,o)}else h(l,null),r(l)})()}),Le(),je(),Te(re,{size:"md",get show(){return $()},set show(o){$(o)},children:(o,k)=>{var M=_t(),E=t(M),F=t(E),g=t(F,!0);a(F);var T=d(F,2),S=t(T);Ne(S,{className:"size-5"}),a(T),a(E);var j=d(E,2);{var b=x=>{var C=pt(),B=t(C),L=t(B);{var $e=f=>{var c=mt(),m=ce(c),G=t(m),pe=d(G),_e=t(pe,!0);a(pe),Ke(),a(m);var xe=d(m),W=d(xe),ke=t(W,!0);a(W);var be=d(W);I((X,he,Se,Ce,s)=>{Ae(m,"href",`/s/${r(l),i(()=>r(l).share_id)??""}`),v(G,`${X??""} `),v(_e,he),v(xe,` ${Se??""} `),v(ke,Ce),v(be,` ${s??""}`)},[()=>(e(),i(()=>e().t("You have shared this chat"))),()=>(e(),i(()=>e().t("before"))),()=>(e(),i(()=>e().t("Click here to"))),()=>(e(),i(()=>e().t("delete this link"))),()=>(e(),i(()=>e().t("and create a new shared link.")))]),O("click",W,async()=>{await Qe(localStorage.token,U())&&h(l,await Pe(localStorage.token,U()))}),p(f,c)},me=f=>{var c=ve();I(m=>v(c,m),[()=>(e(),i(()=>e().t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")))]),p(f,c)};Y(L,f=>{r(l),i(()=>r(l).share_id)?f($e):f(me,!1)})}a(B);var le=d(B,2),Q=t(le),V=t(Q),Z=t(V);{var we=f=>{var c=gt(),m=t(c,!0);a(c),I(G=>v(m,G),[()=>(e(),i(()=>e().t("Share to Open WebUI Community")))]),O("click",c,()=>{w(),$(!1)}),p(f,c)};Y(Z,f=>{K(),i(()=>{var c;return(c=K())==null?void 0:c.features.enable_community_sharing})&&f(we)})}var ee=d(Z,2),te=t(ee);Ze(te,{});var ge=d(te,2);{var ie=f=>{var c=ve();I(m=>v(c,m),[()=>(e(),i(()=>e().t("Update and Copy Link")))]),p(f,c)},ne=f=>{var c=ve();I(m=>v(c,m),[()=>(e(),i(()=>e().t("Copy Link")))]),p(f,c)};Y(ge,f=>{r(l),i(()=>r(l).share_id)?f(ie):f(ne,!1)})}a(ee),a(V),a(Q),a(le),a(C),O("click",ee,async()=>{if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){const c=async()=>{const m=await D();return new Blob([m],{type:"text/plain"})};navigator.clipboard.write([new ClipboardItem({"text/plain":c()})]).then(()=>!0).catch(m=>!1)}else Ve(await D());fe.success(e().t("Copied shared chat URL to clipboard!")),$(!1)}),p(x,C)};Y(j,x=>{r(l)&&x(b)})}a(M),I(x=>v(g,x),[()=>(e(),i(()=>e().t("Share Chat")))]),O("click",T,()=>{$(!1)}),p(o,M)},$$slots:{default:!0},$$legacy:!0}),De(),oe()}var xt=P("<button><!></button>"),bt=P('<!> <div class="flex items-center"> </div>',1),ht=P('<!> <div class="flex items-center"> </div>',1),yt=P('<!> <div class="flex items-center"> </div>',1),$t=P("<!> <!> <!>",1),wt=P('<div slot="content"><!></div>');function la(re,y){Fe(y,!1);const e=()=>H(R,"$i18n",se),[se,K]=Be(),R=Ue("i18n"),oe=We();let U=A(y,"align",8,"start"),l=A(y,"onEdit",8,()=>{}),q=A(y,"onExport",8,()=>{}),J=A(y,"onDelete",8,()=>{}),D=ae(!1);je(),rt(re,{get show(){return r(D)},set show(w){h(D,w)},$$events:{change:w=>{w.detail===!1&&oe("close")}},children:(w,$)=>{{let _=ze(()=>(e(),i(()=>e().t("More"))));lt(w,{get content(){return r(_)},children:(o,k)=>{var M=xt(),E=t(M);et(E,y,"default",{},null),a(M),O("click",M,F=>{F.stopPropagation(),h(D,!r(D))}),p(o,M)},$$slots:{default:!0}})}},$$slots:{default:!0,content:(w,$)=>{var _=wt(),o=t(_);tt(o,{class:"w-full max-w-[170px] rounded-2xl px-1 py-1 border border-gray-100  dark:border-gray-800   z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:-2,side:"bottom",get align(){return U()},get transition(){return at},children:(k,M)=>{var E=$t(),F=ce(E);Me(F,{class:"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{l()()}},children:(S,j)=>{var b=bt(),x=ce(b);ot(x,{});var C=d(x,2),B=t(C,!0);a(C),I(L=>v(B,L),[()=>(e(),i(()=>e().t("Edit")))]),p(S,b)},$$slots:{default:!0}});var g=d(F,2);Me(g,{class:"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{q()()}},children:(S,j)=>{var b=ht(),x=ce(b);it(x,{});var C=d(x,2),B=t(C,!0);a(C),I(L=>v(B,L),[()=>(e(),i(()=>e().t("Export")))]),p(S,b)},$$slots:{default:!0}});var T=d(g,2);Me(T,{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{J()()}},children:(S,j)=>{var b=yt(),x=ce(b);st(x,{});var C=d(x,2),B=t(C,!0);a(C),I(L=>v(B,L),[()=>(e(),i(()=>e().t("Delete")))]),p(S,b)},$$slots:{default:!0}}),p(k,E)},$$slots:{default:!0}}),a(_),p(w,_)}},$$legacy:!0}),De(),K()}var kt=P('<div class="my-1"><div class="mb-2 text-xs text-gray-500"> </div> <div><!></div></div>'),St=P('<div slot="label"><div class="flex w-full justify-between"><div class=" mb-2 text-xs text-gray-500"> </div></div></div>'),Ct=P('<div class="ml-2 self-center"><!></div>'),It=P('<div><div class=" flex justify-between dark:text-gray-300 px-5 pt-4 pb-1"><div class=" text-lg font-medium self-center"><!></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-5 pb-4 md:space-x-4 dark:text-gray-200"><div class=" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"><form class="flex flex-col w-full"><div class="flex flex-col w-full mt-1"><div class=" mb-1 text-xs text-gray-500"> </div> <div class="flex-1"><input id="folder-name" class="w-full text-sm bg-transparent placeholder:text-gray-300 dark:placeholder:text-gray-700 outline-hidden" type="text" autocomplete="off"/></div></div> <input id="folder-background-image-input" type="file" hidden="" accept="image/*"/> <div class="flex justify-between w-full mt-1 items-center"><div class="text-xs text-gray-500"> </div> <div><button aria-labelledby="chat-background-label background-image-url-state" class="p-1 px-3 text-xs flex rounded-sm transition" type="button"><span class="ml-2 self-center" id="background-image-url-state"> </span></button></div></div> <hr class=" border-gray-50 dark:border-gray-850/30 my-2.5 w-full"/> <!> <div class="my-2"><!></div> <div class="flex justify-end pt-3 text-sm font-medium gap-1.5"><button type="submit"> <!></button></div></form></div></div></div>');function ia(re,y){Fe(y,!1);const e=()=>H(U,"$i18n",R),se=()=>H(Re,"$config",R),K=()=>H(He,"$user",R),[R,oe]=Be(),U=Ue("i18n");let l=A(y,"show",12,!1),q=A(y,"onSubmit",8,g=>{}),J=A(y,"folderId",8,null),D=A(y,"edit",8,!1),w=null,$=ae(""),_=ae({background_image_url:null}),o=ae({system_prompt:"",files:[]}),k=ae(!1);const M=async()=>{var T,S,j,b;if(h(k,!0),(((T=r(o))==null?void 0:T.files)??[]).some(x=>x.status==="uploading")){fe.error(e().t("Please wait until all files are uploaded.")),h(k,!1);return}const g=((j=(S=se())==null?void 0:S.features)==null?void 0:j.folder_max_file_count)??"";if(g&&(((b=r(o))==null?void 0:b.files)??[]).length>g){fe.error(e().t("Maximum number of files per folder is {{max}}.",{max:g??0})),h(k,!1);return}await q()({name:r($),meta:r(_),data:r(o)}),l(!1),h(k,!1)},E=async()=>{J()&&(w=await ft(localStorage.token,J()).catch(g=>(fe.error(`${g}`),null)),h($,w.name),h(_,w.meta||{background_image_url:null}),h(o,w.data||{system_prompt:"",files:[]})),F()},F=async()=>{await qe();const g=document.getElementById("folder-name");g&&(g.focus(),g.select())};Ee(()=>ue(l()),()=>{l()&&E()}),Ee(()=>(ue(l()),ue(D())),()=>{!l()&&!D()&&(h($,""),h(_,{background_image_url:null}),h(o,{system_prompt:"",files:[]}))}),Le(),je(),Te(re,{size:"md",get show(){return l()},set show(g){l(g)},children:(g,T)=>{var S=It(),j=t(S),b=t(j),x=t(b);{var C=s=>{var n=ve();I(u=>v(n,u),[()=>(e(),i(()=>e().t("Edit Folder")))]),p(s,n)},B=s=>{var n=ve();I(u=>v(n,u),[()=>(e(),i(()=>e().t("Create Folder")))]),p(s,n)};Y(x,s=>{D()?s(C):s(B,!1)})}a(b);var L=d(b,2),$e=t(L);Ne($e,{className:"size-5"}),a(L),a(j);var me=d(j,2),le=t(me),Q=t(le),V=t(Q),Z=t(V),we=t(Z,!0);a(Z);var ee=d(Z,2),te=t(ee);Ge(te),a(ee),a(V);var ge=d(V,2),ie=d(ge,2),ne=t(ie),f=t(ne,!0);a(ne);var c=d(ne,2),m=t(c),G=t(m),pe=t(G,!0);a(G),a(m),a(c),a(ie);var _e=d(ie,4);{var xe=s=>{var n=kt(),u=t(n),z=t(u,!0);a(u);var N=d(u,2),Ie=t(N);{let de=ze(()=>(e(),i(()=>e().t(`Write your model system prompt content here
e.g.) You are Mario from Super Mario Bros, acting as an assistant.`))));ut(Ie,{className:" text-sm w-full bg-transparent outline-hidden ",get placeholder(){return r(de)},maxSize:200,get value(){return r(o).system_prompt},set value(Oe){ye(o,r(o).system_prompt=Oe)},$$legacy:!0})}a(N),a(n),I(de=>v(z,de),[()=>(e(),i(()=>e().t("System Prompt")))]),p(s,n)};Y(_e,s=>{K(),i(()=>{var n,u,z;return((n=K())==null?void 0:n.role)==="admin"||(((z=(u=K())==null?void 0:u.permissions.chat)==null?void 0:z.system_prompt)??!0)})&&s(xe)})}var W=d(_e,2),ke=t(W);vt(ke,{get selectedItems(){return r(o).files},set selectedItems(s){ye(o,r(o).files=s)},$$slots:{label:(s,n)=>{var u=St(),z=t(u),N=t(z),Ie=t(N,!0);a(N),a(z),a(u),I(de=>v(Ie,de),[()=>(e(),i(()=>e().t("Knowledge")))]),p(s,u)}},$$legacy:!0}),a(W);var be=d(W,2),X=t(be),he=t(X),Se=d(he);{var Ce=s=>{var n=Ct(),u=t(n);ct(u,{}),a(n),p(s,n)};Y(Se,s=>{r(k)&&s(Ce)})}a(X),a(be),a(Q),a(le),a(me),a(S),I((s,n,u,z,N)=>{v(we,s),Ae(te,"placeholder",n),v(f,u),v(pe,z),Xe(X,1,`px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-950 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full flex flex-row space-x-1 items-center ${r(k)?" cursor-not-allowed":""}`),X.disabled=r(k),v(he,`${N??""} `)},[()=>(e(),i(()=>e().t("Folder Name"))),()=>(e(),i(()=>e().t("Enter folder name"))),()=>(e(),i(()=>e().t("Folder Background Image"))),()=>(r(_),e(),i(()=>{var s;return(((s=r(_))==null?void 0:s.background_image_url)??null)===null?e().t("Upload"):e().t("Reset")})),()=>(e(),i(()=>e().t("Save")))]),O("click",L,()=>{l(!1)}),nt(te,()=>r($),s=>h($,s)),O("change",ge,s=>{const n=s.target.files;let u=new FileReader;u.onload=z=>{let N=`${z.target.result}`;ye(_,r(_).background_image_url=N)},n&&n.length>0&&["image/gif","image/webp","image/jpeg","image/png"].includes(n[0].type)?u.readAsDataURL(n[0]):(`${n[0].type}`,s.target.value="")}),O("click",m,()=>{var s;if(((s=r(_))==null?void 0:s.background_image_url)!==null)ye(_,r(_).background_image_url=null);else{const n=document.getElementById("folder-background-image-input");n&&n.click()}}),O("submit",Q,dt(()=>{M()})),p(g,S)},$$slots:{default:!0},$$legacy:!0}),De(),oe()}export{ia as F,oa as S,la as a};
//# sourceMappingURL=C8udzHqa.js.map
