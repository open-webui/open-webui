{"version":3,"file":"BPNMd0k5.js","sources":["../../../../../../src/lib/components/channel/MessageInput/InputMenu.svelte","../../../../../../src/lib/components/channel/MessageInput/MentionList.svelte","../../../../../../src/lib/components/channel/MessageInput.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { flyAndScale } from '$lib/utils/transitions';\n\timport { getContext, onMount, tick } from 'svelte';\n\n\timport { config, user, tools as _tools, mobile } from '$lib/stores';\n\timport { getTools } from '$lib/apis/tools';\n\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport DocumentArrowUpSolid from '$lib/components/icons/DocumentArrowUpSolid.svelte';\n\timport Switch from '$lib/components/common/Switch.svelte';\n\timport GlobeAltSolid from '$lib/components/icons/GlobeAltSolid.svelte';\n\timport WrenchSolid from '$lib/components/icons/WrenchSolid.svelte';\n\timport CameraSolid from '$lib/components/icons/CameraSolid.svelte';\n\timport Camera from '$lib/components/icons/Camera.svelte';\n\timport Clip from '$lib/components/icons/Clip.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let screenCaptureHandler: Function;\n\texport let uploadFilesHandler: Function;\n\n\texport let onClose: Function = () => {};\n\n\tlet show = false;\n\n\t$: if (show) {\n\t\tinit();\n\t}\n\n\tconst init = async () => {};\n</script>\n\n<Dropdown\n\tbind:show\n\ton:change={(e) => {\n\t\tif (e.detail === false) {\n\t\t\tonClose();\n\t\t}\n\t}}\n>\n\t<Tooltip content={$i18n.t('More')}>\n\t\t<slot />\n\t</Tooltip>\n\n\t<div slot=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full max-w-[200px] rounded-2xl px-1 py-1  border border-gray-100  dark:border-gray-800 z-999 bg-white dark:bg-gray-850 dark:text-white shadow-lg transition\"\n\t\t\tsideOffset={4}\n\t\t\talignOffset={-6}\n\t\t\tside=\"bottom\"\n\t\t\talign=\"start\"\n\t\t\ttransition={flyAndScale}\n\t\t>\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 rounded-xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tuploadFilesHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Clip />\n\t\t\t\t<div class=\"line-clamp-1\">{$i18n.t('Upload Files')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50  rounded-xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tscreenCaptureHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Camera />\n\t\t\t\t<div class=\" line-clamp-1\">{$i18n.t('Capture')}</div>\n\t\t\t</DropdownMenu.Item>\n\t\t</DropdownMenu.Content>\n\t</div>\n</Dropdown>\n","<script lang=\"ts\">\n\timport { getContext, onDestroy, onMount } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport { channels, models, user } from '$lib/stores';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Hashtag from '$lib/components/icons/Hashtag.svelte';\n\timport Lock from '$lib/components/icons/Lock.svelte';\n\timport { WEBUI_API_BASE_URL, WEBUI_BASE_URL } from '$lib/constants';\n\timport { searchUsers } from '$lib/apis/users';\n\n\texport let query = '';\n\n\texport let command: (payload: { id: string; label: string }) => void;\n\texport let selectedIndex = 0;\n\n\texport let label = '';\n\texport let triggerChar = '@';\n\n\texport let modelSuggestions = false;\n\texport let userSuggestions = false;\n\texport let channelSuggestions = false;\n\n\tlet _models = [];\n\tlet _users = [];\n\tlet _channels = [];\n\n\t$: filteredItems = [..._users, ..._models, ..._channels].filter(\n\t\t(u) =>\n\t\t\tu.label.toLowerCase().includes(query.toLowerCase()) ||\n\t\t\tu.id.toLowerCase().includes(query.toLowerCase())\n\t);\n\n\tconst getUserList = async () => {\n\t\tconst res = await searchUsers(localStorage.token, query).catch((error) => {\n\t\t\tconsole.error('Error searching users:', error);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\t_users = [...res.users.map((u) => ({ type: 'user', id: u.id, label: u.name }))].sort((a, b) =>\n\t\t\t\ta.label.localeCompare(b.label)\n\t\t\t);\n\t\t}\n\t};\n\n\t$: if (query !== null && userSuggestions) {\n\t\tgetUserList();\n\t}\n\n\tconst select = (index: number) => {\n\t\tconst item = filteredItems[index];\n\t\tif (!item) return;\n\n\t\t// Add the \"U:\", \"M:\" or \"C:\" prefix to the id\n\t\t// and also append the label after a pipe |\n\t\t// so that the mention renderer can show the label\n\t\tif (item)\n\t\t\tcommand({\n\t\t\t\tid: `${item.type === 'user' ? 'U' : item.type === 'model' ? 'M' : 'C'}:${item.id}|${item.label}`,\n\t\t\t\tlabel: item.label\n\t\t\t});\n\t};\n\n\tconst onKeyDown = (event: KeyboardEvent) => {\n\t\tif (!['ArrowUp', 'ArrowDown', 'Enter', 'Tab', 'Escape'].includes(event.key)) return false;\n\n\t\tif (event.key === 'ArrowUp') {\n\t\t\tselectedIndex = Math.max(0, selectedIndex - 1);\n\t\t\tconst item = document.querySelector(`[data-selected=\"true\"]`);\n\t\t\titem?.scrollIntoView({ block: 'center', inline: 'nearest', behavior: 'instant' });\n\t\t\treturn true;\n\t\t}\n\t\tif (event.key === 'ArrowDown') {\n\t\t\tselectedIndex = Math.min(selectedIndex + 1, filteredItems.length - 1);\n\t\t\tconst item = document.querySelector(`[data-selected=\"true\"]`);\n\t\t\titem?.scrollIntoView({ block: 'center', inline: 'nearest', behavior: 'instant' });\n\t\t\treturn true;\n\t\t}\n\t\tif (event.key === 'Enter' || event.key === 'Tab') {\n\t\t\tselect(selectedIndex);\n\n\t\t\tif (event.key === 'Enter') {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\tif (event.key === 'Escape') {\n\t\t\t// tell tiptap we handled it (it will close)\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\t// This method will be called from the suggestion renderer\n\t// @ts-ignore\n\texport function _onKeyDown(event: KeyboardEvent) {\n\t\treturn onKeyDown(event);\n\t}\n\n\tconst keydownListener = (e) => {\n\t\t// required to prevent the default enter behavior\n\t\tif (e.key === 'Enter') {\n\t\t\te.preventDefault();\n\t\t\tselect(selectedIndex);\n\t\t}\n\t};\n\n\tonMount(async () => {\n\t\twindow.addEventListener('keydown', keydownListener);\n\t\tif (channelSuggestions) {\n\t\t\t// Add a dummy channel item\n\t\t\t_channels = [\n\t\t\t\t...$channels\n\t\t\t\t\t.filter((c) => c?.type !== 'dm')\n\t\t\t\t\t.map((c) => ({ type: 'channel', id: c.id, label: c.name, data: c }))\n\t\t\t];\n\t\t} else {\n\t\t\tif (userSuggestions) {\n\t\t\t\tawait getUserList();\n\t\t\t}\n\n\t\t\tif (modelSuggestions) {\n\t\t\t\t_models = [...$models.map((m) => ({ type: 'model', id: m.id, label: m.name, data: m }))];\n\t\t\t}\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\twindow.removeEventListener('keydown', keydownListener);\n\t});\n</script>\n\n{#if filteredItems.length}\n\t<div\n\t\tclass=\"mention-list text-black dark:text-white rounded-2xl shadow-lg border border-gray-200 dark:border-gray-800 flex flex-col bg-white dark:bg-gray-850 w-72 p-1\"\n\t\tid=\"suggestions-container\"\n\t>\n\t\t<div class=\"overflow-y-auto scrollbar-thin max-h-60\">\n\t\t\t{#each filteredItems as item, i}\n\t\t\t\t{#if i === 0 || item?.type !== filteredItems[i - 1]?.type}\n\t\t\t\t\t<div class=\"px-2 text-xs text-gray-500 py-1\">\n\t\t\t\t\t\t{#if item?.type === 'user'}\n\t\t\t\t\t\t\t{$i18n.t('Users')}\n\t\t\t\t\t\t{:else if item?.type === 'model'}\n\t\t\t\t\t\t\t{$i18n.t('Models')}\n\t\t\t\t\t\t{:else if item?.type === 'channel'}\n\t\t\t\t\t\t\t{$i18n.t('Channels')}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t<Tooltip content={item?.id} placement=\"top-start\">\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\ton:click={() => select(i)}\n\t\t\t\t\t\ton:mousemove={() => {\n\t\t\t\t\t\t\tselectedIndex = i;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclass=\"flex items-center justify-between px-2.5 py-1.5 rounded-xl w-full text-left {i ===\n\t\t\t\t\t\tselectedIndex\n\t\t\t\t\t\t\t? 'bg-gray-50 dark:bg-gray-800 selected-command-option-button'\n\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\tdata-selected={i === selectedIndex}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if item.type === 'channel'}\n\t\t\t\t\t\t\t<div class=\" size-4 justify-center flex items-center mr-0.5\">\n\t\t\t\t\t\t\t\t{#if item?.data?.access_control === null}\n\t\t\t\t\t\t\t\t\t<Hashtag className=\"size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<Lock className=\"size-[15px]\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{:else if item.type === 'model'}\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/models/model/profile/image?id=${item.id}&lang=${$i18n.language}`}\n\t\t\t\t\t\t\t\talt={item?.data?.name ?? item.id}\n\t\t\t\t\t\t\t\tclass=\"rounded-full size-5 items-center mr-2\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{:else if item.type === 'user'}\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/users/${item.id}/profile/image`}\n\t\t\t\t\t\t\t\talt={item?.label ?? item.id}\n\t\t\t\t\t\t\t\tclass=\"rounded-full size-5 items-center mr-2\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<div class=\"truncate flex-1 pr-2\">\n\t\t\t\t\t\t\t{item.label}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"shrink-0 text-xs text-gray-500\">\n\t\t\t\t\t\t\t{#if item.type === 'user'}\n\t\t\t\t\t\t\t\t{$i18n.t('User')}\n\t\t\t\t\t\t\t{:else if item.type === 'model'}\n\t\t\t\t\t\t\t\t{$i18n.t('Model')}\n\t\t\t\t\t\t\t{:else if item.type === 'channel'}\n\t\t\t\t\t\t\t\t{$i18n.t('Channel')}\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\t\t\t{/each}\n\t\t</div>\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { v4 as uuidv4 } from 'uuid';\n\n\timport { tick, getContext, onMount, onDestroy } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport { config, mobile, settings, socket, user } from '$lib/stores';\n\timport {\n\t\tconvertHeicToJpeg,\n\t\tcompressImage,\n\t\textractInputVariables,\n\t\tgetAge,\n\t\tgetCurrentDateTime,\n\t\tgetFormattedDate,\n\t\tgetFormattedTime,\n\t\tgetUserPosition,\n\t\tgetUserTimezone,\n\t\tgetWeekday,\n\t\textractCurlyBraceWords\n\t} from '$lib/utils';\n\n\timport { getSessionUser } from '$lib/apis/auths';\n\n\timport { uploadFile } from '$lib/apis/files';\n\timport { WEBUI_API_BASE_URL } from '$lib/constants';\n\n\timport { getSuggestionRenderer } from '../common/RichTextInput/suggestions';\n\timport CommandSuggestionList from '../chat/MessageInput/CommandSuggestionList.svelte';\n\n\timport InputMenu from './MessageInput/InputMenu.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport RichTextInput from '../common/RichTextInput.svelte';\n\timport VoiceRecording from '../chat/MessageInput/VoiceRecording.svelte';\n\timport FileItem from '../common/FileItem.svelte';\n\timport Image from '../common/Image.svelte';\n\timport FilesOverlay from '../chat/MessageInput/FilesOverlay.svelte';\n\timport InputVariablesModal from '../chat/MessageInput/InputVariablesModal.svelte';\n\timport MentionList from './MessageInput/MentionList.svelte';\n\timport Skeleton from '../chat/Messages/Skeleton.svelte';\n\timport XMark from '../icons/XMark.svelte';\n\n\texport let placeholder = $i18n.t('Type here...');\n\texport let chatInputElement;\n\n\texport let id = null;\n\texport let channel = null;\n\n\texport let typingUsers = [];\n\texport let inputLoading = false;\n\n\texport let onSubmit: Function = (e) => {};\n\texport let onChange: Function = (e) => {};\n\texport let onStop: Function = (e) => {};\n\n\texport let scrollEnd = true;\n\texport let scrollToBottom: Function = () => {};\n\n\texport let disabled = false;\n\texport let acceptFiles = true;\n\texport let showFormattingToolbar = true;\n\n\texport let userSuggestions = false;\n\texport let channelSuggestions = false;\n\n\texport let replyToMessage = null;\n\n\texport let typingUsersClassName = 'from-white dark:from-gray-900';\n\n\tlet loaded = false;\n\tlet draggedOver = false;\n\n\tlet recording = false;\n\tlet content = '';\n\tlet files = [];\n\n\tlet filesInputElement;\n\tlet inputFiles;\n\n\tlet showInputVariablesModal = false;\n\tlet inputVariablesModalCallback: (variableValues: Record<string, any>) => void;\n\tlet inputVariables: Record<string, any> = {};\n\tlet inputVariableValues = {};\n\n\tconst inputVariableHandler = async (text: string): Promise<string> => {\n\t\tinputVariables = extractInputVariables(text);\n\n\t\t// No variables? return the original text immediately.\n\t\tif (Object.keys(inputVariables).length === 0) {\n\t\t\treturn text;\n\t\t}\n\n\t\t// Show modal and wait for the user's input.\n\t\tshowInputVariablesModal = true;\n\t\treturn await new Promise<string>((resolve) => {\n\t\t\tinputVariablesModalCallback = (variableValues) => {\n\t\t\t\tinputVariableValues = { ...inputVariableValues, ...variableValues };\n\t\t\t\treplaceVariables(inputVariableValues);\n\t\t\t\tshowInputVariablesModal = false;\n\t\t\t\tresolve(text);\n\t\t\t};\n\t\t});\n\t};\n\n\tconst textVariableHandler = async (text: string) => {\n\t\tif (text.includes('{{CLIPBOARD}}')) {\n\t\t\tconst clipboardText = await navigator.clipboard.readText().catch((err) => {\n\t\t\t\ttoast.error($i18n.t('Failed to read clipboard contents'));\n\t\t\t\treturn '{{CLIPBOARD}}';\n\t\t\t});\n\n\t\t\tconst clipboardItems = await navigator.clipboard.read();\n\n\t\t\tfor (const item of clipboardItems) {\n\t\t\t\t// Check for known image types\n\t\t\t\tfor (const type of item.types) {\n\t\t\t\t\tif (type.startsWith('image/')) {\n\t\t\t\t\t\tconst blob = await item.getType(type);\n\t\t\t\t\t\tconst file = new File([blob], `clipboard-image.${type.split('/')[1]}`, {\n\t\t\t\t\t\t\ttype: type\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tinputFilesHandler([file]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttext = text.replaceAll('{{CLIPBOARD}}', clipboardText.replaceAll('\\r\\n', '\\n'));\n\t\t}\n\n\t\tif (text.includes('{{USER_LOCATION}}')) {\n\t\t\tlet location;\n\t\t\ttry {\n\t\t\t\tlocation = await getUserPosition();\n\t\t\t} catch (error) {\n\t\t\t\ttoast.error($i18n.t('Location access not allowed'));\n\t\t\t\tlocation = 'LOCATION_UNKNOWN';\n\t\t\t}\n\t\t\ttext = text.replaceAll('{{USER_LOCATION}}', String(location));\n\t\t}\n\n\t\tconst sessionUser = await getSessionUser(localStorage.token);\n\n\t\tif (text.includes('{{USER_NAME}}')) {\n\t\t\tconst name = sessionUser?.name || 'User';\n\t\t\ttext = text.replaceAll('{{USER_NAME}}', name);\n\t\t}\n\n\t\tif (text.includes('{{USER_BIO}}')) {\n\t\t\tconst bio = sessionUser?.bio || '';\n\n\t\t\tif (bio) {\n\t\t\t\ttext = text.replaceAll('{{USER_BIO}}', bio);\n\t\t\t}\n\t\t}\n\n\t\tif (text.includes('{{USER_GENDER}}')) {\n\t\t\tconst gender = sessionUser?.gender || '';\n\n\t\t\tif (gender) {\n\t\t\t\ttext = text.replaceAll('{{USER_GENDER}}', gender);\n\t\t\t}\n\t\t}\n\n\t\tif (text.includes('{{USER_BIRTH_DATE}}')) {\n\t\t\tconst birthDate = sessionUser?.date_of_birth || '';\n\n\t\t\tif (birthDate) {\n\t\t\t\ttext = text.replaceAll('{{USER_BIRTH_DATE}}', birthDate);\n\t\t\t}\n\t\t}\n\n\t\tif (text.includes('{{USER_AGE}}')) {\n\t\t\tconst birthDate = sessionUser?.date_of_birth || '';\n\n\t\t\tif (birthDate) {\n\t\t\t\t// calculate age using date\n\t\t\t\tconst age = getAge(birthDate);\n\t\t\t\ttext = text.replaceAll('{{USER_AGE}}', age);\n\t\t\t}\n\t\t}\n\n\t\tif (text.includes('{{USER_LANGUAGE}}')) {\n\t\t\tconst language = localStorage.getItem('locale') || 'en-US';\n\t\t\ttext = text.replaceAll('{{USER_LANGUAGE}}', language);\n\t\t}\n\n\t\tif (text.includes('{{CURRENT_DATE}}')) {\n\t\t\tconst date = getFormattedDate();\n\t\t\ttext = text.replaceAll('{{CURRENT_DATE}}', date);\n\t\t}\n\n\t\tif (text.includes('{{CURRENT_TIME}}')) {\n\t\t\tconst time = getFormattedTime();\n\t\t\ttext = text.replaceAll('{{CURRENT_TIME}}', time);\n\t\t}\n\n\t\tif (text.includes('{{CURRENT_DATETIME}}')) {\n\t\t\tconst dateTime = getCurrentDateTime();\n\t\t\ttext = text.replaceAll('{{CURRENT_DATETIME}}', dateTime);\n\t\t}\n\n\t\tif (text.includes('{{CURRENT_TIMEZONE}}')) {\n\t\t\tconst timezone = getUserTimezone();\n\t\t\ttext = text.replaceAll('{{CURRENT_TIMEZONE}}', timezone);\n\t\t}\n\n\t\tif (text.includes('{{CURRENT_WEEKDAY}}')) {\n\t\t\tconst weekday = getWeekday();\n\t\t\ttext = text.replaceAll('{{CURRENT_WEEKDAY}}', weekday);\n\t\t}\n\n\t\treturn text;\n\t};\n\n\tconst replaceVariables = (variables: Record<string, any>) => {\n\t\tconsole.log('Replacing variables:', variables);\n\n\t\tconst chatInput = document.getElementById('chat-input');\n\n\t\tif (chatInput) {\n\t\t\tchatInputElement.replaceVariables(variables);\n\t\t\tchatInputElement.focus();\n\t\t}\n\t};\n\n\texport const setText = async (text?: string, cb?: (text: string) => void) => {\n\t\tconst chatInput = document.getElementById('chat-input');\n\n\t\tif (chatInput) {\n\t\t\tif (text !== '') {\n\t\t\t\ttext = await textVariableHandler(text || '');\n\t\t\t}\n\n\t\t\tchatInputElement?.setText(text);\n\t\t\tchatInputElement?.focus();\n\n\t\t\tif (text !== '') {\n\t\t\t\ttext = await inputVariableHandler(text);\n\t\t\t}\n\n\t\t\tawait tick();\n\t\t\tif (cb) await cb(text);\n\t\t}\n\t};\n\n\tconst getCommand = () => {\n\t\tconst chatInput = document.getElementById('chat-input');\n\t\tlet word = '';\n\n\t\tif (chatInput) {\n\t\t\tword = chatInputElement?.getWordAtDocPos();\n\t\t}\n\n\t\treturn word;\n\t};\n\n\tconst replaceCommandWithText = (text) => {\n\t\tconst chatInput = document.getElementById('chat-input');\n\t\tif (!chatInput) return;\n\n\t\tchatInputElement?.replaceCommandWithText(text);\n\t};\n\n\tconst insertTextAtCursor = async (text: string) => {\n\t\tconst chatInput = document.getElementById('chat-input');\n\t\tif (!chatInput) return;\n\n\t\ttext = await textVariableHandler(text);\n\n\t\tif (command) {\n\t\t\treplaceCommandWithText(text);\n\t\t} else {\n\t\t\tchatInputElement?.insertContent(text);\n\t\t}\n\n\t\tawait tick();\n\t\ttext = await inputVariableHandler(text);\n\t\tawait tick();\n\n\t\tconst chatInputContainer = document.getElementById('chat-input-container');\n\t\tif (chatInputContainer) {\n\t\t\tchatInputContainer.scrollTop = chatInputContainer.scrollHeight;\n\t\t}\n\n\t\tawait tick();\n\t\tif (chatInput) {\n\t\t\tchatInput.focus();\n\t\t\tchatInput.dispatchEvent(new Event('input'));\n\n\t\t\tconst words = extractCurlyBraceWords(prompt);\n\n\t\t\tif (words.length > 0) {\n\t\t\t\tconst word = words.at(0);\n\t\t\t\tawait tick();\n\t\t\t} else {\n\t\t\t\tchatInput.scrollTop = chatInput.scrollHeight;\n\t\t\t}\n\t\t}\n\t};\n\n\tlet command = '';\n\n\texport let showCommands = false;\n\t$: showCommands = ['/'].includes(command?.charAt(0));\n\tlet suggestions = null;\n\n\tconst screenCaptureHandler = async () => {\n\t\ttry {\n\t\t\t// Request screen media\n\t\t\tconst mediaStream = await navigator.mediaDevices.getDisplayMedia({\n\t\t\t\tvideo: { cursor: 'never' },\n\t\t\t\taudio: false\n\t\t\t});\n\t\t\t// Once the user selects a screen, temporarily create a video element\n\t\t\tconst video = document.createElement('video');\n\t\t\tvideo.srcObject = mediaStream;\n\t\t\t// Ensure the video loads without affecting user experience or tab switching\n\t\t\tawait video.play();\n\t\t\t// Set up the canvas to match the video dimensions\n\t\t\tconst canvas = document.createElement('canvas');\n\t\t\tcanvas.width = video.videoWidth;\n\t\t\tcanvas.height = video.videoHeight;\n\t\t\t// Grab a single frame from the video stream using the canvas\n\t\t\tconst context = canvas.getContext('2d');\n\t\t\tcontext.drawImage(video, 0, 0, canvas.width, canvas.height);\n\t\t\t// Stop all video tracks (stop screen sharing) after capturing the image\n\t\t\tmediaStream.getTracks().forEach((track) => track.stop());\n\n\t\t\t// bring back focus to this current tab, so that the user can see the screen capture\n\t\t\twindow.focus();\n\n\t\t\t// Convert the canvas to a Base64 image URL\n\t\t\tconst imageUrl = canvas.toDataURL('image/png');\n\t\t\tconst blob = await (await fetch(imageUrl)).blob();\n\t\t\tconst file = new File([blob], `screen-capture-${Date.now()}.png`, { type: 'image/png' });\n\t\t\tinputFilesHandler([file]);\n\t\t\t// Clean memory: Clear video srcObject\n\t\t\tvideo.srcObject = null;\n\t\t} catch (error) {\n\t\t\t// Handle any errors (e.g., user cancels screen sharing)\n\t\t\tconsole.error('Error capturing screen:', error);\n\t\t}\n\t};\n\n\tconst inputFilesHandler = async (inputFiles) => {\n\t\tinputFiles.forEach(async (file) => {\n\t\t\tconsole.info('Processing file:', {\n\t\t\t\tname: file.name,\n\t\t\t\ttype: file.type,\n\t\t\t\tsize: file.size,\n\t\t\t\textension: file.name.split('.').at(-1)\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\t($config?.file?.max_size ?? null) !== null &&\n\t\t\t\tfile.size > ($config?.file?.max_size ?? 0) * 1024 * 1024\n\t\t\t) {\n\t\t\t\tconsole.error('File exceeds max size limit:', {\n\t\t\t\t\tfileSize: file.size,\n\t\t\t\t\tmaxSize: ($config?.file?.max_size ?? 0) * 1024 * 1024\n\t\t\t\t});\n\t\t\t\ttoast.error(\n\t\t\t\t\t$i18n.t(`File size should not exceed {{maxSize}} MB.`, {\n\t\t\t\t\t\tmaxSize: $config?.file?.max_size\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (file['type'].startsWith('image/')) {\n\t\t\t\tconst compressImageHandler = async (imageUrl, settings = {}, config = {}) => {\n\t\t\t\t\t// Quick shortcut so we donâ€™t do unnecessary work.\n\t\t\t\t\tconst settingsCompression = settings?.imageCompression ?? false;\n\t\t\t\t\tconst configWidth = config?.file?.image_compression?.width ?? null;\n\t\t\t\t\tconst configHeight = config?.file?.image_compression?.height ?? null;\n\n\t\t\t\t\t// If neither settings nor config wants compression, return original URL.\n\t\t\t\t\tif (!settingsCompression && !configWidth && !configHeight) {\n\t\t\t\t\t\treturn imageUrl;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Default to null (no compression unless set)\n\t\t\t\t\tlet width = null;\n\t\t\t\t\tlet height = null;\n\n\t\t\t\t\t// If user/settings want compression, pick their preferred size.\n\t\t\t\t\tif (settingsCompression) {\n\t\t\t\t\t\twidth = settings?.imageCompressionSize?.width ?? null;\n\t\t\t\t\t\theight = settings?.imageCompressionSize?.height ?? null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Apply config limits as an upper bound if any\n\t\t\t\t\tif (configWidth && (width === null || width > configWidth)) {\n\t\t\t\t\t\twidth = configWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (configHeight && (height === null || height > configHeight)) {\n\t\t\t\t\t\theight = configHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Do the compression if required\n\t\t\t\t\tif (width || height) {\n\t\t\t\t\t\treturn await compressImage(imageUrl, width, height);\n\t\t\t\t\t}\n\t\t\t\t\treturn imageUrl;\n\t\t\t\t};\n\n\t\t\t\tlet reader = new FileReader();\n\n\t\t\t\treader.onload = async (event) => {\n\t\t\t\t\tlet imageUrl = event.target.result;\n\n\t\t\t\t\t// Compress the image if settings or config require it\n\t\t\t\t\tif ($settings?.imageCompression && $settings?.imageCompressionInChannels) {\n\t\t\t\t\t\timageUrl = await compressImageHandler(imageUrl, $settings, $config);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst blob = await (await fetch(imageUrl)).blob();\n\t\t\t\t\tconst compressedFile = new File([blob], file.name, { type: file.type });\n\n\t\t\t\t\tuploadFileHandler(compressedFile, false);\n\t\t\t\t};\n\n\t\t\t\treader.readAsDataURL(file['type'] === 'image/heic' ? await convertHeicToJpeg(file) : file);\n\t\t\t} else {\n\t\t\t\tuploadFileHandler(file);\n\t\t\t}\n\t\t});\n\t};\n\n\tconst uploadFileHandler = async (file, process = true) => {\n\t\tconst tempItemId = uuidv4();\n\t\tconst fileItem = {\n\t\t\ttype: 'file',\n\t\t\tfile: '',\n\t\t\tid: null,\n\t\t\turl: '',\n\t\t\tname: file.name,\n\t\t\tcollection_name: '',\n\t\t\tstatus: 'uploading',\n\t\t\tsize: file.size,\n\t\t\terror: '',\n\t\t\titemId: tempItemId\n\t\t};\n\n\t\tif (fileItem.size == 0) {\n\t\t\ttoast.error($i18n.t('You cannot upload an empty file.'));\n\t\t\treturn null;\n\t\t}\n\n\t\tfiles = [...files, fileItem];\n\n\t\ttry {\n\t\t\t// During the file upload, file content is automatically extracted.\n\t\t\t// If the file is an audio file, provide the language for STT.\n\t\t\tlet metadata = {\n\t\t\t\tchannel_id: channel.id,\n\t\t\t\t// If the file is an audio file, provide the language for STT.\n\t\t\t\t...((file.type.startsWith('audio/') || file.type.startsWith('video/')) &&\n\t\t\t\t$settings?.audio?.stt?.language\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tlanguage: $settings?.audio?.stt?.language\n\t\t\t\t\t\t}\n\t\t\t\t\t: {})\n\t\t\t};\n\n\t\t\tconst uploadedFile = await uploadFile(localStorage.token, file, metadata, process);\n\n\t\t\tif (uploadedFile) {\n\t\t\t\tconsole.info('File upload completed:', {\n\t\t\t\t\tid: uploadedFile.id,\n\t\t\t\t\tname: fileItem.name,\n\t\t\t\t\tcollection: uploadedFile?.meta?.collection_name\n\t\t\t\t});\n\n\t\t\t\tif (uploadedFile.error) {\n\t\t\t\t\tconsole.error('File upload warning:', uploadedFile.error);\n\t\t\t\t\ttoast.warning(uploadedFile.error);\n\t\t\t\t}\n\n\t\t\t\tfileItem.status = 'uploaded';\n\t\t\t\tfileItem.file = uploadedFile;\n\t\t\t\tfileItem.id = uploadedFile.id;\n\t\t\t\tfileItem.collection_name =\n\t\t\t\t\tuploadedFile?.meta?.collection_name || uploadedFile?.collection_name;\n\t\t\t\tfileItem.content_type = uploadedFile.meta?.content_type || uploadedFile.content_type;\n\t\t\t\tfileItem.url = `${uploadedFile.id}`;\n\n\t\t\t\tfiles = files;\n\t\t\t} else {\n\t\t\t\tfiles = files.filter((item) => item?.itemId !== tempItemId);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\ttoast.error(`${e}`);\n\t\t\tfiles = files.filter((item) => item?.itemId !== tempItemId);\n\t\t}\n\t};\n\n\tconst handleKeyDown = (event: KeyboardEvent) => {\n\t\tif (event.key === 'Escape') {\n\t\t\tdraggedOver = false;\n\t\t}\n\t};\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\n\t\t// Check if a file is being draggedOver.\n\t\tif (e.dataTransfer?.types?.includes('Files')) {\n\t\t\tdraggedOver = true;\n\t\t} else {\n\t\t\tdraggedOver = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = () => {\n\t\tdraggedOver = false;\n\t};\n\n\tconst onDrop = async (e) => {\n\t\te.preventDefault();\n\n\t\tif (e.dataTransfer?.files && acceptFiles) {\n\t\t\tconst inputFiles = Array.from(e.dataTransfer?.files);\n\t\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\t\tconsole.log(inputFiles);\n\t\t\t\tinputFilesHandler(inputFiles);\n\t\t\t}\n\t\t}\n\n\t\tdraggedOver = false;\n\t};\n\n\tconst submitHandler = async () => {\n\t\tif (content === '' && files.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tonSubmit({\n\t\t\tcontent,\n\t\t\tdata: {\n\t\t\t\tfiles: files\n\t\t\t}\n\t\t});\n\n\t\tcontent = '';\n\t\tfiles = [];\n\n\t\tif (chatInputElement) {\n\t\t\tchatInputElement?.setText('');\n\n\t\t\tawait tick();\n\n\t\t\tchatInputElement.focus();\n\t\t}\n\t};\n\n\t$: if (content) {\n\t\tonChange();\n\t}\n\n\tonMount(async () => {\n\t\tsuggestions = [\n\t\t\t{\n\t\t\t\tchar: '@',\n\t\t\t\trender: getSuggestionRenderer(MentionList, {\n\t\t\t\t\ti18n,\n\t\t\t\t\ttriggerChar: '@',\n\t\t\t\t\tmodelSuggestions: true,\n\t\t\t\t\tuserSuggestions\n\t\t\t\t})\n\t\t\t},\n\t\t\t...(channelSuggestions\n\t\t\t\t? [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchar: '#',\n\t\t\t\t\t\t\trender: getSuggestionRenderer(MentionList, {\n\t\t\t\t\t\t\t\ti18n,\n\t\t\t\t\t\t\t\ttriggerChar: '#',\n\t\t\t\t\t\t\t\tchannelSuggestions\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t: []),\n\t\t\t{\n\t\t\t\tchar: '/',\n\t\t\t\trender: getSuggestionRenderer(CommandSuggestionList, {\n\t\t\t\t\ti18n,\n\t\t\t\t\tonSelect: (e) => {\n\t\t\t\t\t\tconst { type, data } = e;\n\n\t\t\t\t\t\tif (type === 'model') {\n\t\t\t\t\t\t\tconsole.log('Selected model:', data);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdocument.getElementById('chat-input')?.focus();\n\t\t\t\t\t},\n\n\t\t\t\t\tinsertTextHandler: insertTextAtCursor,\n\t\t\t\t\tonUpload: (e) => {\n\t\t\t\t\t\tconst { type, data } = e;\n\n\t\t\t\t\t\tif (type === 'file') {\n\t\t\t\t\t\t\tif (files.find((f) => f.id === data.id)) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfiles = [\n\t\t\t\t\t\t\t\t...files,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t...data,\n\t\t\t\t\t\t\t\t\tstatus: 'processed'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t];\n\t\tloaded = true;\n\n\t\twindow.setTimeout(() => {\n\t\t\tif (chatInputElement) {\n\t\t\t\tchatInputElement.focus();\n\t\t\t}\n\t\t}, 100);\n\n\t\twindow.addEventListener('keydown', handleKeyDown);\n\t\tawait tick();\n\n\t\tconst dropzoneElement = document.getElementById('channel-container');\n\n\t\tdropzoneElement?.addEventListener('dragover', onDragOver);\n\t\tdropzoneElement?.addEventListener('drop', onDrop);\n\t\tdropzoneElement?.addEventListener('dragleave', onDragLeave);\n\t});\n\n\tonDestroy(() => {\n\t\twindow.removeEventListener('keydown', handleKeyDown);\n\n\t\tconst dropzoneElement = document.getElementById('channel-container');\n\n\t\tif (dropzoneElement) {\n\t\t\tdropzoneElement?.removeEventListener('dragover', onDragOver);\n\t\t\tdropzoneElement?.removeEventListener('drop', onDrop);\n\t\t\tdropzoneElement?.removeEventListener('dragleave', onDragLeave);\n\t\t}\n\t});\n</script>\n\n{#if loaded}\n\t<FilesOverlay show={draggedOver} />\n\n\t{#if acceptFiles}\n\t\t<input\n\t\t\tbind:this={filesInputElement}\n\t\t\tbind:files={inputFiles}\n\t\t\ttype=\"file\"\n\t\t\thidden\n\t\t\tmultiple\n\t\t\ton:change={async () => {\n\t\t\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\t\t\tinputFilesHandler(Array.from(inputFiles));\n\t\t\t\t} else {\n\t\t\t\t\ttoast.error($i18n.t(`File not found.`));\n\t\t\t\t}\n\n\t\t\t\tfilesInputElement.value = '';\n\t\t\t}}\n\t\t/>\n\t{/if}\n\n\t<InputVariablesModal\n\t\tbind:show={showInputVariablesModal}\n\t\tvariables={inputVariables}\n\t\tonSave={inputVariablesModalCallback}\n\t/>\n\n\t<div class=\"bg-transparent\">\n\t\t<div class=\"max-w-full mx-auto inset-x-0 relative\">\n\t\t\t<div\n\t\t\t\tclass=\"absolute top-0 left-0 right-0 mx-auto inset-x-0 bg-transparent flex justify-center\"\n\t\t\t>\n\t\t\t\t<div class=\"flex flex-col px-3 w-full\">\n\t\t\t\t\t<div class=\"relative\">\n\t\t\t\t\t\t{#if scrollEnd === false}\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\" bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tscrollEnd = true;\n\t\t\t\t\t\t\t\t\t\tscrollToBottom();\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\td=\"M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z\"\n\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if typingUsers.length > 0}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\" -mt-7 pb-2.5 bg-gradient-to-t to-transparent {typingUsersClassName} pointer-events-none select-none\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" text-xs px-1 mt-1.5 flex items-center gap-1.5\">\n\t\t\t\t\t\t\t\t<Skeleton size=\"xs\" />\n\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<span class=\" font-normal text-black dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t{typingUsers.map((user) => user.name).join(', ')}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t{$i18n.t('is typing...')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tclass=\"{disabled ? 'opacity-50 pointer-events-none cursor-not-allowed' : ''} relative z-20\"\n\t\t\t>\n\t\t\t\t{#if recording}\n\t\t\t\t\t<VoiceRecording\n\t\t\t\t\t\tbind:recording\n\t\t\t\t\t\tonCancel={async () => {\n\t\t\t\t\t\t\trecording = false;\n\n\t\t\t\t\t\t\tawait tick();\n\n\t\t\t\t\t\t\tif (chatInputElement) {\n\t\t\t\t\t\t\t\tchatInputElement.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonConfirm={async (data) => {\n\t\t\t\t\t\t\tconst { text, filename } = data;\n\t\t\t\t\t\t\trecording = false;\n\n\t\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\t\tinsertTextAtCursor(text);\n\n\t\t\t\t\t\t\tawait tick();\n\n\t\t\t\t\t\t\tif (chatInputElement) {\n\t\t\t\t\t\t\t\tchatInputElement.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else}\n\t\t\t\t\t<form\n\t\t\t\t\t\tclass=\"w-full flex gap-1.5\"\n\t\t\t\t\t\ton:submit|preventDefault={() => {\n\t\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tid=\"message-input-container\"\n\t\t\t\t\t\t\tclass=\"flex-1 flex flex-col relative w-full shadow-lg rounded-3xl border border-gray-50 dark:border-gray-850/30 hover:border-gray-100 focus-within:border-gray-100 hover:dark:border-gray-800 focus-within:dark:border-gray-800 transition px-1 bg-white/90 dark:bg-gray-400/5 dark:text-gray-100\"\n\t\t\t\t\t\t\tdir={$settings?.chatDirection ?? 'auto'}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#if replyToMessage !== null}\n\t\t\t\t\t\t\t\t<div class=\"px-3 pt-3 text-left w-full flex flex-col z-10\">\n\t\t\t\t\t\t\t\t\t<div class=\"flex items-center justify-between w-full\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"pl-[1px] flex items-center gap-2 text-sm\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"translate-y-[0.5px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>{$i18n.t('Replying to {{NAME}}', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tNAME: replyToMessage?.meta?.model_name ?? replyToMessage.user.name\n\t\t\t\t\t\t\t\t\t\t\t\t\t})}</span\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"flex items-center dark:text-gray-500\"\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\treplyToMessage = null;\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<XMark />\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t{#if files.length > 0}\n\t\t\t\t\t\t\t\t<div class=\"mx-2 mt-2.5 -mb-1 flex flex-wrap gap-2\">\n\t\t\t\t\t\t\t\t\t{#each files as file, fileIdx}\n\t\t\t\t\t\t\t\t\t\t{#if file.type === 'image' || (file?.content_type ?? '').startsWith('image/')}\n\t\t\t\t\t\t\t\t\t\t\t{@const fileUrl =\n\t\t\t\t\t\t\t\t\t\t\t\tfile.url.startsWith('data') || file.url.startsWith('http')\n\t\t\t\t\t\t\t\t\t\t\t\t\t? file.url\n\t\t\t\t\t\t\t\t\t\t\t\t\t: `${WEBUI_API_BASE_URL}/files/${file.url}${file?.content_type ? '/content' : ''}`}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\" relative group\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"relative\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={fileUrl}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\timageClassName=\" size-10 rounded-xl object-cover\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" absolute -top-1 -right-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" bg-white text-black border border-white rounded-full group-hover:visible invisible transition\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t<FileItem\n\t\t\t\t\t\t\t\t\t\t\t\titem={file}\n\t\t\t\t\t\t\t\t\t\t\t\tname={file.name}\n\t\t\t\t\t\t\t\t\t\t\t\ttype={file.type}\n\t\t\t\t\t\t\t\t\t\t\t\tsize={file?.size}\n\t\t\t\t\t\t\t\t\t\t\t\tsmall={true}\n\t\t\t\t\t\t\t\t\t\t\t\tloading={file.status === 'uploading'}\n\t\t\t\t\t\t\t\t\t\t\t\tdismissible={true}\n\t\t\t\t\t\t\t\t\t\t\t\tedit={true}\n\t\t\t\t\t\t\t\t\t\t\t\ton:dismiss={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(file);\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t<div class=\"px-2.5\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"scrollbar-hidden rtl:text-right ltr:text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-2.5 pb-[5px] px-1 resize-none h-fit max-h-96 overflow-auto\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{#key $settings?.richTextInput && $settings?.showFormattingToolbar}\n\t\t\t\t\t\t\t\t\t\t<RichTextInput\n\t\t\t\t\t\t\t\t\t\t\tid=\"chat-input\"\n\t\t\t\t\t\t\t\t\t\t\tbind:this={chatInputElement}\n\t\t\t\t\t\t\t\t\t\t\tjson={true}\n\t\t\t\t\t\t\t\t\t\t\tmessageInput={true}\n\t\t\t\t\t\t\t\t\t\t\teditable={!disabled}\n\t\t\t\t\t\t\t\t\t\t\t{placeholder}\n\t\t\t\t\t\t\t\t\t\t\trichText={$settings?.richTextInput ?? true}\n\t\t\t\t\t\t\t\t\t\t\tshowFormattingToolbar={$settings?.showFormattingToolbar ?? false}\n\t\t\t\t\t\t\t\t\t\t\tshiftEnter={!($settings?.ctrlEnterToSend ?? false) &&\n\t\t\t\t\t\t\t\t\t\t\t\t!$mobile &&\n\t\t\t\t\t\t\t\t\t\t\t\t!(\n\t\t\t\t\t\t\t\t\t\t\t\t\t'ontouchstart' in window ||\n\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.maxTouchPoints > 0 ||\n\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.msMaxTouchPoints > 0\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\tlargeTextAsFile={$settings?.largeTextAsFile ?? false}\n\t\t\t\t\t\t\t\t\t\t\tfloatingMenuPlacement={'top-start'}\n\t\t\t\t\t\t\t\t\t\t\t{suggestions}\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst { md } = e;\n\t\t\t\t\t\t\t\t\t\t\t\tcontent = md;\n\t\t\t\t\t\t\t\t\t\t\t\tcommand = getCommand();\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\ton:keydown={async (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\te = e.detail.event;\n\t\t\t\t\t\t\t\t\t\t\t\tconst isCtrlPressed = e.ctrlKey || e.metaKey; // metaKey is for Cmd key on Mac\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst suggestionsContainerElement =\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('suggestions-container');\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (!suggestionsContainerElement) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t!$mobile ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t!(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'ontouchstart' in window ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.maxTouchPoints > 0 ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.msMaxTouchPoints > 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Prevent Enter key from creating a new line\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Uses keyCode '13' for Enter key for chinese/japanese keyboards\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (e.keyCode === 13 && !e.shiftKey) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Submit the content when Enter key is pressed\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (content !== '' && e.keyCode === 13 && !e.shiftKey) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.info('Escape');\n\t\t\t\t\t\t\t\t\t\t\t\t\treplyToMessage = null;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\ton:paste={async (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\te = e.detail.event;\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(e);\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst clipboardData = e.clipboardData || window.clipboardData;\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (clipboardData && clipboardData.items) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (const item of clipboardData.items) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst file = item.getAsFile();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (file) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait inputFilesHandler([file]);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{/key}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\" flex justify-between mb-2.5 mx-0.5\">\n\t\t\t\t\t\t\t\t<div class=\"ml-1 self-end flex space-x-1 flex-1\">\n\t\t\t\t\t\t\t\t\t<slot name=\"menu\">\n\t\t\t\t\t\t\t\t\t\t{#if acceptFiles}\n\t\t\t\t\t\t\t\t\t\t\t<InputMenu\n\t\t\t\t\t\t\t\t\t\t\t\t{screenCaptureHandler}\n\t\t\t\t\t\t\t\t\t\t\t\tuploadFilesHandler={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfilesInputElement.click();\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"input-menu-button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-transparent hover:bg-white/80 text-gray-800 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-hidden focus:outline-hidden\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"More\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t</InputMenu>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</slot>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"self-end flex space-x-1 mr-1\">\n\t\t\t\t\t\t\t\t\t{#if content === ''}\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Record voice')}>\n\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"voice-input-button\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\" text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet stream = await navigator.mediaDevices\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.getUserMedia({ audio: true })\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.catch(function (err) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`Permission denied when accessing microphone: {{error}}`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\terror: err\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (stream) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trecording = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst tracks = stream.getTracks();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttracks.forEach((track) => track.stop());\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstream = null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Permission denied when accessing microphone'));\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Voice Input\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-5 h-5 translate-y-[0.5px]\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path d=\"M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\n\t\t\t\t\t\t\t\t\t\t{#if inputLoading && onStop}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Stop')}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonStop();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Send message')}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"send-message-button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{content !== '' || files.length !== 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 '\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled'} transition rounded-full p-1.5 self-center\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={content === '' && files.length === 0}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n"],"names":["i18n","getContext","screenCaptureHandler","$.prop","$$props","uploadFilesHandler","onClose","show","init","$.get","Dropdown","$$anchor","$$value","e","$i18n","Tooltip","div","root_3","flyAndScale","Clip","node_3","div_1","$.sibling","Camera","node_5","div_2","query","command","selectedIndex","modelSuggestions","userSuggestions","channelSuggestions","_models","$.mutable_source","_users","_channels","getUserList","res","searchUsers","error","u","a","b","select","index","item","filteredItems","onKeyDown","event","_onKeyDown","keydownListener","onMount","$channels","c","$models","m","onDestroy","$.set","root_1","$.child","$.index","i","$.untrack","$$render","consequent_1","alternate","consequent","alternate_1","button","root_9","node_6","div_3","root_10","Hashtag","Lock","img","root_14","$.set_attribute","WEBUI_API_BASE_URL","$.append","img_1","root_16","consequent_7","consequent_6","alternate_3","consequent_5","alternate_4","div_4","div_5","consequent_10","consequent_9","alternate_5","consequent_8","alternate_6","$.reset","$.set_class","placeholder","chatInputElement","channel","typingUsers","inputLoading","onSubmit","onChange","onStop","scrollEnd","scrollToBottom","disabled","acceptFiles","replyToMessage","typingUsersClassName","loaded","draggedOver","recording","content","files","filesInputElement","inputFiles","showInputVariablesModal","inputVariablesModalCallback","inputVariables","inputVariableValues","inputVariableHandler","text","extractInputVariables","resolve","variableValues","replaceVariables","textVariableHandler","clipboardText","err","toast","clipboardItems","type","blob","file","inputFilesHandler","location","getUserPosition","sessionUser","getSessionUser","name","bio","gender","birthDate","age","getAge","language","date","getFormattedDate","time","getFormattedTime","dateTime","getCurrentDateTime","timezone","getUserTimezone","weekday","getWeekday","variables","setText","cb","_a","_b","tick","getCommand","chatInput","word","replaceCommandWithText","insertTextAtCursor","chatInputContainer","words","extractCurlyBraceWords","showCommands","suggestions","mediaStream","video","canvas","track","imageUrl","$config","_d","_c","_f","_e","_h","_g","compressImageHandler","settings","config","settingsCompression","configWidth","configHeight","width","height","compressImage","reader","$settings","compressedFile","uploadFileHandler","convertHeicToJpeg","process","tempItemId","uuidv4","fileItem","metadata","uploadedFile","uploadFile","_i","handleKeyDown","onDragOver","onDragLeave","onDrop","submitHandler","getSuggestionRenderer","MentionList","CommandSuggestionList","data","f","dropzoneElement","FilesOverlay","node_1","input","root_2","$.mutate","InputVariablesModal","div_6","root_4","div_7","Skeleton","div_8","span","user","div_9","node_7","VoiceRecording","filename","form","root_6","div_10","node_8","div_11","root_7","div_12","div_13","div_14","span_1","div_15","button_1","node_9","XMark","consequent_4","div_16","root_8","fileIdx","fileUrl","$.derived_safe_equal","div_17","div_18","Image","node_12","div_19","button_2","FileItem","div_20","node_10","div_21","node_13","$mobile","RichTextInput","md","clipboardData","div_22","div_23","InputMenu","button_3","root_15","div_24","button_4","root_17","stream","div_25","node_16","div_26","root_18","node_18","button_5","root_19","div_27","root_20","node_19","button_6","root_21","$.preventDefault","consequent_3","alternate_2","$.template_effect"],"mappings":"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"}