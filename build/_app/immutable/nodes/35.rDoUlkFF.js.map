{"version":3,"file":"35.rDoUlkFF.js","sources":["../../../../../../src/routes/(app)/workspace/models/create/+page.svelte"],"sourcesContent":["<script>\n\timport { v4 as uuidv4 } from 'uuid';\n\timport { toast } from 'svelte-sonner';\n\timport { goto } from '$app/navigation';\n\timport { config, models, settings } from '$lib/stores';\n\timport { WEBUI_BASE_URL } from '$lib/constants';\n\n\timport { onMount, tick, getContext } from 'svelte';\n\timport { createNewModel, getModelById } from '$lib/apis/models';\n\timport { getModels } from '$lib/apis';\n\n\timport ModelEditor from '$lib/components/workspace/Models/ModelEditor.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\tconst onSubmit = async (modelInfo) => {\n\t\tif ($models.find((m) => m.id === modelInfo.id)) {\n\t\t\ttoast.error(\n\t\t\t\t$i18n.t(\n\t\t\t\t\t\"Error: A model with the ID '{{modelId}}' already exists. Please select a different ID to proceed.\",\n\t\t\t\t\t{ modelId: modelInfo.id }\n\t\t\t\t)\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tif (modelInfo.id === '') {\n\t\t\ttoast.error($i18n.t('Error: Model ID cannot be empty. Please enter a valid ID to proceed.'));\n\t\t\treturn;\n\t\t}\n\n\t\tif (modelInfo) {\n\t\t\tconst res = await createNewModel(localStorage.token, {\n\t\t\t\t...modelInfo,\n\t\t\t\tmeta: {\n\t\t\t\t\t...modelInfo.meta,\n\t\t\t\t\tprofile_image_url:\n\t\t\t\t\t\tmodelInfo.meta.profile_image_url ?? `${WEBUI_BASE_URL}/static/favicon.png`,\n\t\t\t\t\tsuggestion_prompts: modelInfo.meta.suggestion_prompts\n\t\t\t\t\t\t? modelInfo.meta.suggestion_prompts.filter((prompt) => prompt.content !== '')\n\t\t\t\t\t\t: null\n\t\t\t\t},\n\t\t\t\tparams: { ...modelInfo.params }\n\t\t\t}).catch((error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t});\n\n\t\t\tif (res) {\n\t\t\t\tawait models.set(\n\t\t\t\t\tawait getModels(\n\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t$config?.features?.enable_direct_connections && ($settings?.directConnections ?? null)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\ttoast.success($i18n.t('Model created successfully!'));\n\t\t\t\tawait goto('/workspace/models');\n\t\t\t}\n\t\t}\n\t};\n\n\tlet model = null;\n\n\tonMount(async () => {\n\t\twindow.addEventListener('message', async (event) => {\n\t\t\tif (\n\t\t\t\t!['https://openwebui.com', 'https://www.openwebui.com', 'http://localhost:9999'].includes(\n\t\t\t\t\tevent.origin\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tlet data = JSON.parse(event.data);\n\n\t\t\t\tif (data?.info) {\n\t\t\t\t\tdata = data.info;\n\t\t\t\t}\n\n\t\t\t\tmodel = data;\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error('Failed to parse message data:', e);\n\t\t\t}\n\t\t});\n\n\t\tif (window.opener ?? false) {\n\t\t\twindow.opener.postMessage('loaded', '*');\n\t\t}\n\n\t\tif (sessionStorage.model) {\n\t\t\tmodel = JSON.parse(sessionStorage.model);\n\t\t\tsessionStorage.removeItem('model');\n\t\t}\n\t});\n</script>\n\n{#key model}\n\t<ModelEditor {model} {onSubmit} />\n{/key}\n"],"names":["i18n","getContext","onSubmit","modelInfo","$models","m","toast","$i18n","createNewModel","WEBUI_BASE_URL","prompt","error","models","getModels","_b","_a","$config","_c","$settings","goto","model","onMount","event","data","$.set","e","$$anchor","ModelEditor"],"mappings":"8mBAAA,qHAaOA,EAAOC,EAAW,MAAM,EAExBC,EAAQ,MAAUC,GAAc,WACjC,GAAAC,EAAO,EAAC,KAAMC,GAAMA,EAAE,KAAOF,EAAU,EAAE,EAAG,CAC/CG,EAAM,MACLC,EAAK,EAAC,EACL,oGAAmG,CACjG,QAASJ,EAAU,EAAE,CAAA,CAAA,QAI1B,CAEI,GAAAA,EAAU,KAAO,GAAI,CACxBG,EAAM,MAAMC,EAAK,EAAC,EAAE,sEAAsE,CAAA,QAE3F,CAEIJ,GACM,MAASK,EAAe,aAAa,MAAK,IAC/CL,EACH,KAAI,CACA,GAAAA,EAAU,KACb,kBACCA,EAAU,KAAK,sBAAwBM,CAAc,sBACtD,mBAAoBN,EAAU,KAAK,mBAChCA,EAAU,KAAK,mBAAmB,OAAQO,GAAWA,EAAO,UAAY,EAAE,EAC1E,MAEJ,OAAM,CAAA,GAAOP,EAAU,MAAM,IAC3B,MAAOQ,IACTL,EAAM,MAAK,GAAIK,CAAK,EAAA,EACb,KACP,IAGM,MAAAC,EAAO,IAAG,MACTC,EACL,aAAa,QACbC,GAAAC,EAAAC,EAAO,IAAP,YAAAD,EAAS,WAAT,YAAAD,EAAmB,+BAA8BG,EAAAC,EAAS,IAAT,YAAAD,EAAW,oBAAqB,KAAI,CAAA,EAGvFX,EAAM,QAAQC,EAAK,EAAC,EAAE,6BAA6B,CAAA,EAC7C,MAAAY,EAAK,mBAAmB,EAGjC,EAEI,IAAAC,IAAQ,IAAI,EAEhBC,EAAO,SAAa,CACnB,OAAO,iBAAiB,UAAS,MAASC,GAAU,KAEhD,wBAAyB,4BAA6B,yBAAyB,SAChFA,EAAM,MAAA,EAMJ,GAAA,CACC,IAAAC,EAAO,KAAK,MAAMD,EAAM,IAAI,EAE5BC,GAAA,MAAAA,EAAM,OACTA,EAAOA,EAAK,MAGbC,EAAAJ,EAAQG,CAAI,CACb,OAASE,EAAG,CAEZ,CACD,CAAC,GAEG,OAAO,QAAU,KACpB,OAAO,OAAO,YAAY,SAAU,GAAG,EAGpC,eAAe,QAClBD,EAAAJ,EAAQ,KAAK,MAAM,eAAe,KAAK,CAAA,EACvC,eAAe,WAAW,OAAO,EAEnC,CAAC,iCAGIA,CAAK,EAAAM,GAAA,CACTC,EAAWD,EAAA,sBAAEN,CAAK,GAAG,SAAAlB,oBAHf"}