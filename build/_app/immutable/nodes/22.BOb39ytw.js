import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{B as Ut,t as H,a as i,p as Ke,g as tt,o as dt,f,e as be,i as m,m as le,j as e,n as se,k as y,b as Qe,w as s,c as a,u as o,r,l as Ae,s as fe,d as Fe,z as Je,A as Et,x as ot,q as st,v as lt,aM as Lt,aQ as et,h as ht,$ as xt}from"../chunks/0WpKKl27.js";import{i as Ze}from"../chunks/C3k0oZ3o.js";import{s as Xe,a as Le}from"../chunks/BVrWTcfB.js";import{p as Jt}from"../chunks/CLoTtgoA.js";import{i as b}from"../chunks/Cmf4RC8y.js";import{k as er}from"../chunks/fZxlt1qL.js";import{h as tr}from"../chunks/Bwqchdu-.js";import{s as Oe,c as jt,a as He,r as rr}from"../chunks/CZ1y6KaE.js";import{b as At}from"../chunks/Bo3ZTtFv.js";import{p as q}from"../chunks/DpN1w328.js";import{t as Ye}from"../chunks/DYdr9DjX.js";import{P as ar,c as yt,d as sr}from"../chunks/DUmcHkcJ.js";import{g as Rt}from"../chunks/B5RARo22.js";import{u as it,b as lr,m as ir,s as ft,g as nr,i as Dt,e as bt,j as wt,h as $t}from"../chunks/PCOILo-8.js";import{g as or,r as dr,a as vr,p as Bt,u as cr,d as ur,b as fr,c as gr,e as mr,f as _r,h as kt,s as Wt,i as Mt,j as Pt}from"../chunks/CuJG2T8v.js";import{e as rt,i as ut}from"../chunks/u5Cnd4mY.js";import{d as Se,r as mt}from"../chunks/BC4znSyB.js";import{G as Ht,H as Ot,l as Yt,I as zt,z as pr}from"../chunks/cX8aofVu.js";import{a as We}from"../chunks/DLhnqOlE.js";import{M as Tt,I as hr}from"../chunks/mfo8rR81.js";import{N as xr,P as yr}from"../chunks/DLQ8GCeM.js";import{C as br}from"../chunks/ByHAJgVC.js";import{G as wr}from"../chunks/CYXXpf3O.js";import{P as $r}from"../chunks/DVjsywiU.js";import{T as Ve}from"../chunks/Db0gdTVr.js";import{T as kr}from"../chunks/CWXf-F9t.js";import{C as Mr,F as Pr}from"../chunks/DetCT4Dy.js";import{P as Ft}from"../chunks/BYYyNfoo.js";import{E as Ct,F as St,U as zr}from"../chunks/DB6UFW7h.js";import{C as Tr}from"../chunks/DAAddo_l.js";import{E as Cr}from"../chunks/BwmNngm2.js";import{S as It}from"../chunks/CYM6LQlA.js";import{P as Sr}from"../chunks/C-WU2PKw.js";import{P as gt}from"../chunks/lU9u-k0A.js";import{L as Vt}from"../chunks/l5Bi75JT.js";import{S as at}from"../chunks/BO1efK8r.js";import{M as Gt}from"../chunks/BPNMd0k5.js";import{S as Ir}from"../chunks/CGW29DRJ.js";import{H as qt,L as Kt}from"../chunks/CG-UgebJ.js";import{M as _t}from"../chunks/CcreKc1w.js";import{X as vt}from"../chunks/CZmZoefv.js";import{b as Nr}from"../chunks/kb1CvZ3a.js";import{P as Ur}from"../chunks/DyEgVTRu.js";import{B as Er}from"../chunks/DUufguWK.js";import{P as Lr}from"../chunks/BonmQdqt.js";import{M as jr,U as Ar}from"../chunks/BTu22fOQ.js";import{D as Rr}from"../chunks/DcAIj4L_.js";import{i as Dr}from"../chunks/owMDqXnQ.js";var Br=Ut('<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M10.25 4.75L6.75 8.25L10.25 11.75" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.75 8.25L12.75 8.25C14.9591 8.25 16.75 10.0409 16.75 12.25V19.25" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function Wr(je,w){let v=q(w,"className",8,"w-4 h-4"),V=q(w,"strokeWidth",8,"1.5");var Z=Br();H(()=>{Oe(Z,0,jt(v())),He(Z,"stroke-width",V())}),i(je,Z)}var Hr=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1 svelte-s6wdik"><!></button>'),Or=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-0.5 svelte-s6wdik"><!></button>'),Yr=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1 svelte-s6wdik"><!></button>'),Fr=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1 svelte-s6wdik"><!></button>'),Vr=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1 svelte-s6wdik"><!></button>'),Gr=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1 svelte-s6wdik"><!></button>'),qr=f("<!> <!>",1),Kr=f('<div><div class="flex gap-1 rounded-lg bg-white dark:bg-gray-850 shadow-md p-0.5 border border-gray-100/30 dark:border-gray-850/30 svelte-s6wdik"><!> <!> <!> <!> <!></div></div>'),Qr=f('<div><div class="ml-8.5 flex items-center gap-1 px-1 rounded-full text-xs svelte-s6wdik"><!> <span class="text-gray-500 svelte-s6wdik"> </span></div></div>'),Zr=f('<img class="size-4 ml-0.5 rounded-full object-cover svelte-s6wdik"/>'),Xr=f('<img class="size-4 ml-0.5 rounded-full object-cover svelte-s6wdik"/>'),Jr=f('<div class="relative text-xs mb-1 svelte-s6wdik"><div class="absolute h-3 w-7 left-[18px] top-2 rounded-tl-lg border-t-[1.5px] border-l-[1.5px] border-gray-200 dark:border-gray-700 z-0 svelte-s6wdik"></div> <button class="ml-12 flex items-center space-x-2 relative z-0 svelte-s6wdik"><!> <div class="shrink-0 svelte-s6wdik"> </div> <div class="italic text-sm text-gray-500 dark:text-gray-400 line-clamp-1 w-full flex-1 svelte-s6wdik"><!></div></button></div>'),ea=f('<img class="size-8 translate-y-1 ml-0.5 object-cover rounded-full svelte-s6wdik"/>'),ta=f('<div class="mt-1.5 flex shrink-0 items-center text-xs self-center invisible group-hover:visible text-gray-500 font-medium first-letter:capitalize svelte-s6wdik"><!></div>'),ra=f('<span class="line-clamp-1 svelte-s6wdik"><!></span>'),aa=f('<div class=" self-center text-xs text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px] svelte-s6wdik"><!></div>'),sa=f('<div class=" self-end text-base shrink-0 font-medium truncate svelte-s6wdik"><!></div> <!>',1),la=f('<div class=" my-2 svelte-s6wdik"><!></div>'),ia=f('<video controls class=" max-h-96 rounded-lg svelte-s6wdik"></video>',2),na=f('<div class="svelte-s6wdik"><!></div>'),oa=f('<div class="my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap svelte-s6wdik"></div>'),da=f('<div class="py-2 svelte-s6wdik"><!> <div class=" mt-2 mb-1 flex justify-end text-sm font-medium svelte-s6wdik"><div class="flex space-x-1.5 svelte-s6wdik"><button id="close-edit-message-button" class="px-3.5 py-1.5 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl svelte-s6wdik"> </button> <button id="confirm-edit-message-button" class="px-3.5 py-1.5 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl svelte-s6wdik"> </button></div></div></div>'),va=f('<span class="text-gray-500 text-[10px] pl-1 self-center svelte-s6wdik"> </span>'),ca=f("<!><!>",1),ua=f('<div class="text-xs font-medium text-gray-500 dark:text-gray-400 svelte-s6wdik"> </div>'),fa=f("<button><!> <!></button>"),ga=f('<div class="flex items-center gap-1.5 bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1 transition rounded-xl px-1 py-1 cursor-pointer text-gray-500 dark:text-gray-400 svelte-s6wdik"><!></div>'),ma=f('<div class="svelte-s6wdik"><div class="flex items-center flex-wrap gap-y-1.5 gap-1 mt-1 mb-2 svelte-s6wdik"><!> <!></div></div>'),_a=f('<div class="flex items-center gap-1.5 -mt-0.5 mb-1.5 svelte-s6wdik"><button class="flex items-center text-xs py-1 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition svelte-s6wdik"><span class="font-medium mr-1 svelte-s6wdik"> </span><span class="svelte-s6wdik"> </span> <span class="ml-1 svelte-s6wdik"><!></span></button></div>'),pa=f("<div><!></div> <!> <!>",1),ha=f('<div><!> <!> <!> <div><div><!></div> <div class="flex-auto w-0 pl-2 svelte-s6wdik"><!> <!> <!></div></div></div>'),xa=f("<!> <!>",1);function Qt(je,w){Ke(w,!1);const v=()=>Le(K,"$i18n",$e),V=()=>Le(it,"$user",$e),Z=()=>Le(lr,"$settings",$e),[$e,ge]=Xe();Se.extend(mt),Se.extend(Ht),Se.extend(Ot),Se.extend(Yt);const K=tt("i18n");let O=q(w,"className",8,""),t=q(w,"message",12),Q=q(w,"channel",8),p=q(w,"showUserProfile",8,!0),pe=q(w,"thread",8,!1),ie=q(w,"replyToMessage",8,!1),ke=q(w,"disabled",8,!1),me=q(w,"pending",8,!1),L=q(w,"onDelete",8,()=>{}),R=q(w,"onEdit",8,()=>{}),ee=q(w,"onReply",8,()=>{}),ne=q(w,"onPin",8,()=>{}),xe=q(w,"onThread",8,()=>{}),oe=q(w,"onReaction",8,()=>{}),G=le(!1),te=le(!1),Me=le(null),Ie=le(!1);const I=async()=>{var T,n;if(t()&&((T=t())!=null&&T.data)){const C=await or(localStorage.token,(n=Q())==null?void 0:n.id,t().id);C&&t(t().data=C,!0)}};dt(async()=>{var T;t()&&((T=t())!=null&&T.data)&&await I()}),Ze();var Pe=xa(),X=be(Pe);{let T=se(()=>(v(),s(()=>v().t("Delete Message")))),n=se(()=>(v(),s(()=>v().t("Are you sure you want to delete this message?"))));br(X,{get title(){return e(T)},get message(){return e(n)},onConfirm:async()=>{await L()()},get show(){return e(Ie)},set show(C){m(Ie,C)},$$legacy:!0})}var z=y(X,2);{var U=T=>{var n=ha(),C=a(n);{var j=$=>{var h=Kr(),Y=a(h),de=a(Y);{var ue=P=>{Ct(P,{onClose:()=>m(G,!1),onSubmit:M=>{m(G,!1),oe()(M)},children:(M,ye)=>{{let ze=se(()=>(v(),s(()=>v().t("Add Reaction"))));Ve(M,{get content(){return e(ze)},children:(ve,ae)=>{var we=Hr(),he=a(we);St(he,{}),r(we),Ae("click",we,()=>{m(G,!0)}),i(ve,we)},$$slots:{default:!0}})}},$$slots:{default:!0}})};b(de,P=>{oe()&&P(ue)})}var B=y(de,2);{var W=P=>{{let M=se(()=>(v(),s(()=>v().t("Reply"))));Ve(P,{get content(){return e(M)},children:(ye,ze)=>{var ve=Or(),ae=a(ve);Wr(ae,{className:"size-5"}),r(ve),Ae("click",ve,()=>{ee()(t())}),i(ye,ve)},$$slots:{default:!0}})}};b(B,P=>{ee()&&P(W)})}var N=y(B,2);{let P=se(()=>(o(t()),v(),s(()=>{var M;return(M=t())!=null&&M.is_pinned?v().t("Unpin"):v().t("Pin")})));Ve(N,{get content(){return e(P)},children:(M,ye)=>{var ze=Yr(),ve=a(ze);{var ae=he=>{Sr(he,{className:"size-4"})},we=he=>{gt(he,{className:"size-4"})};b(ve,he=>{o(t()),s(()=>{var Ee;return(Ee=t())==null?void 0:Ee.is_pinned})?he(ae):he(we,!1)})}r(ze),Ae("click",ze,()=>{ne()(t())}),i(M,ze)},$$slots:{default:!0}})}var Re=y(N,2);{var Ce=P=>{{let M=se(()=>(v(),s(()=>v().t("Reply in Thread"))));Ve(P,{get content(){return e(M)},children:(ye,ze)=>{var ve=Fr(),ae=a(ve);Mr(ae,{}),r(ve),Ae("click",ve,()=>{xe()(t().id)}),i(ye,ve)},$$slots:{default:!0}})}};b(Re,P=>{!pe()&&xe()&&P(Ce)})}var S=y(Re,2);{var E=P=>{var M=qr(),ye=be(M);{var ze=we=>{{let he=se(()=>(v(),s(()=>v().t("Edit"))));Ve(we,{get content(){return e(he)},children:(Ee,Be)=>{var De=Vr(),Ge=a(De);$r(Ge,{}),r(De),Ae("click",De,()=>{m(te,!0),m(Me,t().content)}),i(Ee,De)},$$slots:{default:!0}})}};b(ye,we=>{R()&&we(ze)})}var ve=y(ye,2);{var ae=we=>{{let he=se(()=>(v(),s(()=>v().t("Delete"))));Ve(we,{get content(){return e(he)},children:(Ee,Be)=>{var De=Gr(),Ge=a(De);wr(Ge,{}),r(De),Ae("click",De,()=>m(Ie,!0)),i(Ee,De)},$$slots:{default:!0}})}};b(ve,we=>{L()&&we(ae)})}i(P,M)};b(S,P=>{o(t()),V(),s(()=>{var M,ye;return t().user_id===((M=V())==null?void 0:M.id)||((ye=V())==null?void 0:ye.role)==="admin"})&&P(E)})}r(Y),r(h),H(()=>Oe(h,1,` absolute ${e(G)?"":"invisible group-hover:visible"} right-1 -top-2 z-10`,"svelte-s6wdik")),i($,h)};b(C,$=>{!e(te)&&!ke()&&$(j)})}var c=y(C,2);{var _=$=>{var h=Qr(),Y=a(h),de=a(Y);gt(de,{className:"size-3 text-yellow-500 dark:text-yellow-300"});var ue=y(de,2),B=a(ue,!0);r(ue),r(Y),r(h),H(W=>{Oe(h,1,`flex ${p()?"mb-0.5":"mt-0.5"}`,"svelte-s6wdik"),fe(B,W)},[()=>(v(),s(()=>v().t("Pinned")))]),i($,h)};b(c,$=>{o(t()),s(()=>{var h;return(h=t())==null?void 0:h.is_pinned})&&$(_)})}var u=y(c,2);{var g=$=>{var h=Jr(),Y=y(a(h),2),de=a(Y);{var ue=S=>{var E=Zr();H(()=>{He(E,"src",(o(We),o(t()),s(()=>`${We}/models/model/profile/image?id=${t().reply_to_message.meta.model_id}`))),He(E,"alt",(o(t()),s(()=>t().reply_to_message.meta.model_name??t().reply_to_message.meta.model_id)))}),i(S,E)},B=S=>{var E=Xr();H(P=>{He(E,"src",(o(t()),o(We),s(()=>{var M,ye,ze;return((M=t().reply_to_message.user)==null?void 0:M.role)==="webhook"?`${We}/channels/webhooks/${(ye=t().reply_to_message.user)==null?void 0:ye.id}/profile/image`:`${We}/users/${(ze=t().reply_to_message.user)==null?void 0:ze.id}/profile/image`}))),He(E,"alt",P)},[()=>(o(t()),v(),s(()=>{var P;return((P=t().reply_to_message.user)==null?void 0:P.name)??v().t("Unknown User")}))]),i(S,E)};b(de,S=>{o(t()),s(()=>{var E,P,M;return(M=(P=(E=t())==null?void 0:E.reply_to_message)==null?void 0:P.meta)==null?void 0:M.model_id})?S(ue):S(B,!1)})}var W=y(de,2),N=a(W,!0);r(W);var Re=y(W,2),Ce=a(Re);{let S=se(()=>(o(t()),s(()=>`${t().id}-reply-to`))),E=se(()=>(o(t()),s(()=>{var P,M;return(M=(P=t())==null?void 0:P.reply_to_message)==null?void 0:M.content})));Tt(Ce,{get id(){return e(S)},get content(){return e(E)}})}r(Re),r(Y),r(h),H(S=>fe(N,S),[()=>(o(t()),v(),s(()=>{var S,E,P,M;return((E=(S=t())==null?void 0:S.reply_to_message.meta)==null?void 0:E.model_name)??((M=(P=t())==null?void 0:P.reply_to_message.user)==null?void 0:M.name)??v().t("Unknown User")}))]),Ae("click",Y,()=>{const S=document.getElementById(`message-${t().reply_to_message.id}`);if(S){S.scrollIntoView({behavior:"smooth",block:"center"}),S.classList.add("highlight"),setTimeout(()=>{S.classList.remove("highlight")},2e3);return}}),i($,h)};b(u,$=>{o(t()),s(()=>{var h,Y;return(Y=(h=t())==null?void 0:h.reply_to_message)==null?void 0:Y.user})&&$(g)})}var l=y(u,2),d=a(l);Oe(d,1,"shrink-0 mr-1 w-9","svelte-s6wdik");var x=a(d);{var k=$=>{var h=Fe(),Y=be(h);{var de=B=>{var W=ea();H(()=>{He(W,"src",(o(We),o(t()),s(()=>`${We}/models/model/profile/image?id=${t().meta.model_id}`))),He(W,"alt",(o(t()),s(()=>t().meta.model_name??t().meta.model_id)))}),i(B,W)},ue=B=>{Ft(B,{get user(){return o(t()),s(()=>t().user)},children:(W,N)=>{{let Re=se(()=>(o(t()),o(We),s(()=>{var Ce,S,E;return((Ce=t().user)==null?void 0:Ce.role)==="webhook"?`${We}/channels/webhooks/${(S=t().user)==null?void 0:S.id}/profile/image`:`${We}/users/${(E=t().user)==null?void 0:E.id}/profile/image`})));yr(W,{get src(){return e(Re)},className:"size-8 ml-0.5"})}},$$slots:{default:!0}})};b(Y,B=>{o(t()),s(()=>{var W,N;return(N=(W=t())==null?void 0:W.meta)==null?void 0:N.model_id})?B(de):B(ue,!1)})}i($,h)},F=$=>{var h=Fe(),Y=be(h);{var de=ue=>{var B=ta(),W=a(B);{let N=se(()=>(o(Se),o(t()),s(()=>Se(t().created_at/1e6).format("LLLL"))));Ve(W,{get content(){return e(N)},children:(Re,Ce)=>{Et();var S=Je();H(E=>fe(S,E),[()=>(o(Se),o(t()),s(()=>Se(t().created_at/1e6).format("HH:mm")))]),i(Re,S)},$$slots:{default:!0}})}r(B),i(ue,B)};b(Y,ue=>{o(t()),s(()=>t().created_at)&&ue(de)})}i($,h)};b(x,$=>{p()?$(k):$(F,!1)})}r(d);var D=y(d,2),A=a(D);{var _e=$=>{xr($,{children:(h,Y)=>{var de=sa(),ue=be(de),B=a(ue);{var W=S=>{var E=Je();H(()=>fe(E,(o(t()),s(()=>{var P,M,ye,ze;return((M=(P=t())==null?void 0:P.meta)==null?void 0:M.model_name)??((ze=(ye=t())==null?void 0:ye.meta)==null?void 0:ze.model_id)})))),i(S,E)},N=S=>{var E=Je();H(()=>fe(E,(o(t()),s(()=>{var P,M;return(M=(P=t())==null?void 0:P.user)==null?void 0:M.name})))),i(S,E)};b(B,S=>{o(t()),s(()=>{var E,P;return(P=(E=t())==null?void 0:E.meta)==null?void 0:P.model_id})?S(W):S(N,!1)})}r(ue);var Re=y(ue,2);{var Ce=S=>{var E=aa(),P=a(E);{let M=se(()=>(o(Se),o(t()),s(()=>Se(t().created_at/1e6).format("LLLL"))));Ve(P,{get content(){return e(M)},children:(ye,ze)=>{var ve=ra(),ae=a(ve);{var we=Ee=>{var Be=Je();H(De=>fe(Be,De),[()=>(o(Se),o(t()),s(()=>Se(t().created_at/1e6).format("LT")))]),i(Ee,Be)},he=Ee=>{var Be=Je();H(De=>fe(Be,De),[()=>(v(),o(zt),o(t()),o(Se),s(()=>v().t(zt(t().created_at/1e6),{LOCALIZED_TIME:Se(t().created_at/1e6).format("LT"),LOCALIZED_DATE:Se(t().created_at/1e6).format("L")})))]),i(Ee,Be)};b(ae,Ee=>{o(Se),o(t()),s(()=>Se(t().created_at/1e6).isToday())?Ee(we):Ee(he,!1)})}r(ve),i(ye,ve)},$$slots:{default:!0}})}r(E),i(S,E)};b(Re,S=>{o(t()),s(()=>t().created_at)&&S(Ce)})}i(h,de)},$$slots:{default:!0}})};b(A,$=>{p()&&$(_e)})}var ce=y(A,2);{var Ne=$=>{var h=la(),Y=a(h);It(Y,{}),r(h),i($,h)},J=$=>{var h=Fe(),Y=be(h);{var de=ue=>{var B=oa();rt(B,5,()=>(o(t()),s(()=>{var W,N;return(N=(W=t())==null?void 0:W.data)==null?void 0:N.files})),ut,(W,N)=>{const Re=se(()=>(e(N),o(We),s(()=>{var M;return e(N).url.startsWith("data")||e(N).url.startsWith("http")?e(N).url:`${We}/files/${e(N).url}${(M=e(N))!=null&&M.content_type?"/content":""}`})));var Ce=na(),S=a(Ce);{var E=M=>{hr(M,{get src(){return e(Re)},get alt(){return e(N),s(()=>e(N).name)},imageClassName:" max-h-96 rounded-lg"})},P=M=>{var ye=Fe(),ze=be(ye);{var ve=we=>{var he=ia();H(()=>He(he,"src",e(Re))),i(we,he)},ae=we=>{{let he=se(()=>(e(N),s(()=>{var Ee;return(Ee=e(N))==null?void 0:Ee.size})));Pr(we,{get item(){return e(N)},get url(){return e(N),s(()=>e(N).url)},get name(){return e(N),s(()=>e(N).name)},get type(){return e(N),s(()=>e(N).type)},get size(){return e(he)},small:!0})}};b(ze,we=>{e(N),s(()=>{var he;return e(N).type==="video"||(((he=e(N))==null?void 0:he.content_type)??"").startsWith("video/")})?we(ve):we(ae,!1)},!0)}i(M,ye)};b(S,M=>{e(N),s(()=>{var ye;return e(N).type==="image"||(((ye=e(N))==null?void 0:ye.content_type)??"").startsWith("image/")})?M(E):M(P,!1)})}r(Ce),i(W,Ce)}),r(B),H(()=>{He(B,"dir",(Z(),s(()=>{var W;return((W=Z())==null?void 0:W.chatDirection)??"auto"}))),B.dir=B.dir}),i(ue,B)};b(Y,ue=>{o(t()),s(()=>{var B,W;return(((W=(B=t())==null?void 0:B.data)==null?void 0:W.files)??[]).length>0})&&ue(de)},!0)}i($,h)};b(ce,$=>{o(t()),s(()=>{var h;return((h=t())==null?void 0:h.data)===!0})?$(Ne):$(J,!1)})}var re=y(ce,2);{var Te=$=>{var h=da(),Y=a(h);kr(Y,{className:" bg-transparent outline-hidden w-full resize-none",onKeydown:Ce=>{var P,M;Ce.key==="Escape"&&((P=document.getElementById("close-edit-message-button"))==null||P.click());const S=Ce.metaKey||Ce.ctrlKey,E=Ce.key==="Enter";S&&E&&((M=document.getElementById("confirm-edit-message-button"))==null||M.click())},get value(){return e(Me)},set value(Ce){m(Me,Ce)},$$legacy:!0});var de=y(Y,2),ue=a(de),B=a(ue),W=a(B,!0);r(B);var N=y(B,2),Re=a(N,!0);r(N),r(ue),r(de),r(h),H((Ce,S)=>{fe(W,Ce),fe(Re,S)},[()=>(v(),s(()=>v().t("Cancel"))),()=>(v(),s(()=>v().t("Save")))]),Ae("click",B,()=>{m(te,!1),m(Me,null)}),Ae("click",N,async()=>{R()(e(Me)),m(te,!1),m(Me,null)}),i($,h)},Ue=$=>{var h=pa(),Y=be(h),de=a(Y);{var ue=S=>{It(S,{})},B=S=>{var E=ca(),P=be(E);Tt(P,{get id(){return o(t()),s(()=>t().id)},get content(){return o(t()),s(()=>t().content)},paragraphTag:"span"});var M=y(P);{var ye=ze=>{var ve=va(),ae=a(ve);r(ve),H(we=>fe(ae,`(${we??""})`),[()=>(v(),s(()=>v().t("edited")))]),i(ze,ve)};b(M,ze=>{o(t()),s(()=>{var ve,ae;return t().created_at!==t().updated_at&&(((ae=(ve=t())==null?void 0:ve.meta)==null?void 0:ae.model_id)??null)===null})&&ze(ye)})}i(S,E)};b(de,S=>{o(t()),s(()=>{var E,P,M;return(((E=t())==null?void 0:E.content)??"").trim()===""&&((M=(P=t())==null?void 0:P.meta)==null?void 0:M.model_id)})?S(ue):S(B,!1)})}r(Y);var W=y(Y,2);{var N=S=>{var E=ma(),P=a(E),M=a(P);rt(M,1,()=>(o(t()),s(()=>t().reactions)),ut,(ve,ae)=>{{let we=se(()=>(v(),e(ae),V(),s(()=>v().t("{{NAMES}} reacted with {{REACTION}}",{NAMES:e(ae).users.reduce((he,Ee,Be)=>{var ct;const De=Ee.id===((ct=V())==null?void 0:ct.id)?v().t("You"):Ee.name,Ge=e(ae).users.length;if(Be<3){const qe=Be===0?"":Be===Math.min(2,Ge-1)?` ${v().t("and")} `:", ";return`${he}${qe}${De}`}return Be===3&&Ge>4?he+` ${v().t("and {{COUNT}} others",{COUNT:Ge-3})}`:he},"").trim(),REACTION:`:${e(ae).name}:`}))));Ve(ve,{get content(){return e(we)},children:(he,Ee)=>{var Be=fa(),De=a(Be);Cr(De,{get shortCode(){return e(ae),s(()=>e(ae).name)}});var Ge=y(De,2);{var ct=qe=>{var nt=ua(),Xt=a(nt,!0);r(nt),H(()=>fe(Xt,(e(ae),s(()=>{var pt;return(pt=e(ae).users)==null?void 0:pt.length})))),i(qe,nt)};b(Ge,qe=>{e(ae),s(()=>e(ae).users.length>0)&&qe(ct)})}r(Be),H(qe=>Oe(Be,1,`flex items-center gap-1.5 transition rounded-xl px-2 py-1 cursor-pointer ${qe??""}`,"svelte-s6wdik"),[()=>(e(ae),V(),s(()=>{var qe;return e(ae).users.map(nt=>nt.id).includes((qe=V())==null?void 0:qe.id)?" bg-blue-300/10 outline outline-blue-500/50 outline-1":"bg-gray-300/10 dark:bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1"}))]),Ae("click",Be,()=>{oe()&&oe()(e(ae).name)}),i(he,Be)},$$slots:{default:!0}})}});var ye=y(M,2);{var ze=ve=>{Ct(ve,{onSubmit:ae=>{oe()(ae)},children:(ae,we)=>{{let he=se(()=>(v(),s(()=>v().t("Add Reaction"))));Ve(ae,{get content(){return e(he)},children:(Ee,Be)=>{var De=ga(),Ge=a(De);St(Ge,{}),r(De),i(Ee,De)},$$slots:{default:!0}})}},$$slots:{default:!0}})};b(ye,ve=>{oe()&&ve(ze)})}r(P),r(E),i(S,E)};b(W,S=>{o(t()),s(()=>{var E;return(((E=t())==null?void 0:E.reactions)??[]).length>0})&&S(N)})}var Re=y(W,2);{var Ce=S=>{var E=_a(),P=a(E),M=a(P),ye=a(M,!0);r(M);var ze=y(M),ve=a(ze);r(ze);var ae=y(ze,2),we=a(ae);Tr(we,{className:"size-2.5",strokeWidth:"3"}),r(ae),r(P),r(E),H((he,Ee,Be)=>{fe(ye,he),fe(ve,` - ${Ee??""}
									${Be??""}`)},[()=>(v(),o(t()),s(()=>v().t("{{COUNT}} Replies",{COUNT:t().reply_count}))),()=>(v(),s(()=>v().t("Last reply"))),()=>(o(Se),o(t()),s(()=>Se.unix(t().latest_reply_at/1e9).fromNow()))]),Ae("click",P,()=>{xe()(t().id)}),i(S,E)};b(Re,S=>{o(pe()),o(t()),s(()=>!pe()&&t().reply_count>0)&&S(Ce)})}H(()=>Oe(Y,1,` min-w-full markdown-prose ${me()?"opacity-50":""}`,"svelte-s6wdik")),i($,h)};b(re,$=>{e(te)?$(Te):$(Ue,!1)})}r(D),r(l),r(n),H(()=>{He(n,"id",`message-${o(t()),s(()=>t().id)??""}`),Oe(n,1,`flex flex-col justify-between w-full max-w-full mx-auto group hover:bg-gray-300/5 dark:hover:bg-gray-700/5 transition relative ${o(O()),o(ie()),o(t()),V(),s(()=>{var $,h,Y,de,ue,B,W;return O()?O():`px-5 ${ie()?"border-l-4 border-blue-500 bg-blue-100/10 dark:bg-blue-100/5 pl-4":""} ${(((Y=(h=($=t())==null?void 0:$.reply_to_message)==null?void 0:h.meta)==null?void 0:Y.model_id)??((ue=(de=t())==null?void 0:de.reply_to_message)==null?void 0:ue.user_id))===((B=V())==null?void 0:B.id)?"border-l-4 border-orange-500 bg-orange-100/10 dark:bg-orange-100/5 pl-4":""} ${(W=t())!=null&&W.is_pinned?"bg-yellow-100/20 dark:bg-yellow-100/5":""}`})??""} ${p()?"pt-1.5 pb-0.5":""}`,"svelte-s6wdik"),Oe(l,1,` flex w-full message-${o(t()),s(()=>t().id)??""} `,"svelte-s6wdik"),He(l,"id",`message-${o(t()),s(()=>t().id)??""}`),He(l,"dir",(Z(),s(()=>Z().chatDirection))),l.dir=l.dir}),i(T,n)};b(z,T=>{t()&&T(U)})}i(je,Pe),Qe(),ge()}var ya=f('<div class="w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2"><!> <div class=" "> </div></div>'),ba=f("<img/>"),wa=f('<div class="flex ml-[1px] mr-0.5"></div>'),$a=f('<div class="flex flex-col gap-1.5 pb-5 pt-10"><!> <div class="text-2xl font-medium capitalize"><!></div> <div class=" text-gray-500"> </div></div>'),ka=f('<div class="flex justify-center text-xs items-center gap-2 py-5"><div class=" "> </div></div>'),Ma=f('<hr class=" border-gray-50 dark:border-gray-700/20 py-2.5 w-full"/>'),Pa=f('<div class="px-5 max-w-full mx-auto"><!> <!></div>'),za=f('<div><!> <!> <div class="pb-6"></div></div>');function Zt(je,w){Ke(w,!1);const v=()=>Le(ge,"$i18n",Z),V=()=>Le(it,"$user",Z),[Z,$e]=Xe();Se.extend(mt),Se.extend(Ht),Se.extend(Ot);const ge=tt("i18n");let K=q(w,"id",8,null),O=q(w,"channel",8,null),t=q(w,"messages",28,()=>[]),Q=q(w,"replyToMessage",8,null),p=q(w,"top",8,!1),pe=q(w,"thread",8,!1),ie=q(w,"onLoad",8,()=>{}),ke=q(w,"onReply",8,()=>{}),me=q(w,"onThread",8,()=>{}),L=le(!1);const R=async()=>{const oe=document.getElementById("messages-container");oe.scrollTop=oe.scrollTop+100,m(L,!0),await ie()(),await ot(),m(L,!1)};Ze();var ee=Fe(),ne=be(ee);{var xe=oe=>{const G=se(()=>(o(t()),s(()=>t().slice().reverse())));var te=za(),Me=a(te);{var Ie=X=>{Vt(X,{$$events:{visible:z=>{console.info("visible"),e(L)||R()}},children:(z,U)=>{var T=ya(),n=a(T);at(n,{className:" size-4"});var C=y(n,2),j=a(C,!0);r(C),r(T),H(c=>fe(j,c),[()=>(v(),s(()=>v().t("Loading...")))]),i(z,T)},$$slots:{default:!0}})},I=X=>{var z=Fe(),U=be(z);{var T=n=>{var C=Pa(),j=a(C);{var c=l=>{var d=$a(),x=a(d);{var k=J=>{var re=wa();rt(re,5,()=>(o(O()),V(),s(()=>O().users.filter(Te=>{var Ue;return Te.id!==((Ue=V())==null?void 0:Ue.id)}).slice(0,2))),ut,(Te,Ue,$)=>{var h=ba();Oe(h,1,` size-7.5 rounded-full border-2 border-white dark:border-gray-900 ${$===1?"-ml-2.5":""}`),H(()=>{He(h,"src",(o(We),e(Ue),s(()=>`${We}/users/${e(Ue).id}/profile/image`))),He(h,"alt",(e(Ue),s(()=>e(Ue).name)))}),i(Te,h)}),r(re),i(J,re)};b(x,J=>{o(O()),s(()=>{var re;return((re=O())==null?void 0:re.type)==="dm"})&&J(k)})}var F=y(x,2),D=a(F);{var A=J=>{var re=Je();H(()=>fe(re,(o(O()),s(()=>O().name)))),i(J,re)},_e=J=>{var re=Je();H(Te=>fe(re,Te),[()=>(o(O()),V(),s(()=>{var Te,Ue;return(Ue=(Te=O())==null?void 0:Te.users)==null?void 0:Ue.filter($=>{var h;return $.id!==((h=V())==null?void 0:h.id)}).map($=>$.name).join(", ")}))]),i(J,re)};b(D,J=>{o(O()),s(()=>{var re;return(re=O())==null?void 0:re.name})?J(A):J(_e,!1)})}r(F);var ce=y(F,2),Ne=a(ce,!0);r(ce),r(d),H(J=>fe(Ne,J),[()=>(v(),o(Se),o(O()),s(()=>v().t("This channel was created on {{createdAt}}. This is the very beginning of the {{channelName}} channel.",{createdAt:Se(O().created_at/1e6).format("MMMM D, YYYY"),channelName:O().name})))]),i(l,d)},_=l=>{var d=ka(),x=a(d),k=a(x,!0);r(x),r(d),H(F=>fe(k,F),[()=>(v(),s(()=>v().t("Start of the channel")))]),i(l,d)};b(j,l=>{O()?l(c):l(_,!1)})}var u=y(j,2);{var g=l=>{var d=Ma();i(l,d)};b(u,l=>{o(e(G)),s(()=>e(G).length>0)&&l(g)})}r(C),i(n,C)};b(U,n=>{pe()||n(T)},!0)}i(X,z)};b(Me,X=>{p()?X(I,!1):X(Ie)})}var Pe=y(Me,2);rt(Pe,3,()=>e(G),X=>K()?`${K()}-${X.id}`:X.id,(X,z,U)=>{{let T=se(()=>(o(Q()),e(z),s(()=>{var c;return((c=Q())==null?void 0:c.id)===e(z).id}))),n=se(()=>(o(O()),e(z),s(()=>{var c,_;return!((c=O())!=null&&c.write_access)||((_=e(z))==null?void 0:_.temp_id)}))),C=se(()=>(e(z),s(()=>{var c;return!!((c=e(z))!=null&&c.temp_id)}))),j=se(()=>(o(e(U)),o(e(G)),e(z),s(()=>{var c,_,u,g,l,d,x,k,F;return e(U)===0||((c=e(G).at(e(U)-1))==null?void 0:c.user_id)!==e(z).user_id||((u=(_=e(G).at(e(U)-1))==null?void 0:_.user)==null?void 0:u.id)!==((g=e(z).user)==null?void 0:g.id)||((d=(l=e(G).at(e(U)-1))==null?void 0:l.meta)==null?void 0:d.model_id)!==((k=(x=e(z))==null?void 0:x.meta)==null?void 0:k.model_id)||((F=e(z))==null?void 0:F.reply_to_message)!==null})));Qt(X,{get message(){return e(z)},get channel(){return O()},get thread(){return pe()},get replyToMessage(){return e(T)},get disabled(){return e(n)},get pending(){return e(C)},get showUserProfile(){return e(j)},onDelete:()=>{t(t().filter(c=>c.id!==e(z).id)),ur(localStorage.token,e(z).channel_id,e(z).id).catch(c=>(Ye.error(`${c}`),null))},onEdit:c=>{t(t().map(_=>(_.id===e(z).id&&(_.content=c),_))),cr(localStorage.token,e(z).channel_id,e(z).id,{content:c}).catch(_=>(Ye.error(`${_}`),null))},onReply:c=>{ke()(c)},onPin:async c=>{t(t().map(_=>{var u;return _.id===c.id&&(_.is_pinned=!_.is_pinned,_.pinned_by=_.is_pinned?(u=V())==null?void 0:u.id:null,_.pinned_at=_.is_pinned?Date.now()*1e6:null),_})),await Bt(localStorage.token,c.channel_id,c.id,c.is_pinned).catch(_=>(Ye.error(`${_}`),null))},onThread:c=>{me()(c)},onReaction:c=>{var _,u,g;((g=(u=(((_=e(z))==null?void 0:_.reactions)??[]).find(l=>l.name===c))==null?void 0:u.users)==null?void 0:g.some(l=>{var d;return l.id===((d=V())==null?void 0:d.id)}))??!1?(t(t().map(l=>{if(l.id===e(z).id){const d=l.reactions.find(x=>x.name===c);d&&(d.users=d.users.filter(x=>{var k;return x.id!==((k=V())==null?void 0:k.id)}),d.count=d.users.length,d.count===0&&(l.reactions=l.reactions.filter(x=>x.name!==c)))}return l})),dr(localStorage.token,e(z).channel_id,e(z).id,c).catch(l=>(Ye.error(`${l}`),null))):(t(t().map(l=>{var d,x,k,F;if(l.id===e(z).id&&l.reactions){const D=l.reactions.find(A=>A.name===c);D?(D.users.push({id:(d=V())==null?void 0:d.id,name:(x=V())==null?void 0:x.name}),D.count=D.users.length):l.reactions.push({name:c,users:[{id:(k=V())==null?void 0:k.id,name:(F=V())==null?void 0:F.name}],count:1})}return l})),vr(localStorage.token,e(z).channel_id,e(z).id,c).catch(l=>(Ye.error(`${l}`),null)))}})}}),Et(2),r(te),i(oe,te)};b(ne,oe=>{t()&&oe(xe)})}i(je,ee),Qe(),$e()}var Ta=Ut('<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor"><path d="M5 20V19C5 15.134 8.13401 12 12 12V12C15.866 12 19 15.134 19 19V20" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function Ca(je,w){let v=q(w,"className",8,"size-4"),V=q(w,"strokeWidth",8,"1.5");var Z=Ta();H(()=>{He(Z,"stroke-width",V()),Oe(Z,0,jt(v()))}),i(je,Z)}var Sa=f('<div class="my-10"><!></div>'),Ia=f('<div><button type="button" class=" px-3 py-1.5 gap-1 rounded-xl bg-gray-100/50 dark:text-white dark:bg-gray-850/50 text-black transition font-medium text-xs flex items-center justify-center"><!> <span> </span></button></div>'),Na=f('<div class="flex gap-1 px-1 mb-1"><div class=" flex w-full space-x-2"><div class="flex flex-1 items-center"><div class=" self-center ml-1 mr-3"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path></svg></div> <input class=" w-full text-sm pr-4 py-1 rounded-r-xl outline-hidden bg-transparent"/></div></div></div>'),Ua=f('<img class="rounded-2xl w-6 h-6 object-cover flex-shrink-0" alt="user"/>'),Ea=f('<div class="font-medium truncate"> </div>'),La=f('<div><span class="relative flex size-1.5"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75"></span> <span class="relative inline-flex size-1.5 rounded-full bg-green-500"></span></span></div>'),ja=f('<div><button class=" rounded-full p-1 hover:bg-gray-100 dark:hover:bg-gray-850 transition disabled:opacity-50 disabled:cursor-not-allowed" type="button"><!></button></div>'),Aa=f('<div class=" dark:border-gray-850 text-xs flex items-center justify-between"><div class="px-2 py-1.5 font-medium text-gray-900 dark:text-white flex-1"><div class="flex items-center gap-2"><!> <!> <!></div></div> <div class="px-2 py-1 flex items-center gap-1 translate-y-0.5"><div class=" "><!></div> <!></div></div>'),Ra=f('<div class="scrollbar-hidden relative whitespace-nowrap w-full max-w-full"><div class=" text-sm text-left text-gray-500 dark:text-gray-400 w-full max-w-full"><div class="w-full"></div></div></div> <!>',1),Da=f('<div class="text-gray-500 text-xs text-center py-5 px-10"> </div>'),Ba=f('<div class="flex items-center justify-between px-2 mb-1"><div class="flex gap-1 items-center"><span class="text-sm"> </span> <span class="text-sm text-gray-500"> </span></div> <!></div> <!> <!>',1),Wa=f('<div class="flex flex-col justify-center"><!></div>');function Ha(je,w){Ke(w,!1);const v=()=>Le(ge,"$i18n",Z),V=()=>Le(it,"$_user",Z),[Z,$e]=Xe();Se.extend(mt),Se.extend(Yt);const ge=tt("i18n");let K=q(w,"channel",8,null),O=q(w,"onAdd",8,null),t=q(w,"onRemove",8,null),Q=q(w,"search",8,!0);q(w,"sort",8,!0);let p=le(1),pe=le(null),ie=le(null),ke=le(""),me=le("name"),L=le("asc");const R=async()=>{try{const G=await fr(localStorage.token,K().id,e(ke),e(me),e(L),e(p)).catch(te=>(Ye.error(`${te}`),null));G&&(m(pe,G.users),m(ie,G.total))}catch(G){}};st(()=>(o(K()),e(p),e(ke),e(me),e(L)),()=>{K()!==null&&e(p)!==null&&e(ke)!==null&&e(me)!==null&&e(L)!==null&&R()}),lt(),Ze();var ee=Wa(),ne=a(ee);{var xe=G=>{var te=Sa(),Me=a(te);at(Me,{className:"size-5"}),r(te),i(G,te)},oe=G=>{var te=Ba(),Me=be(te),Ie=a(Me),I=a(Ie),Pe=a(I,!0);r(I);var X=y(I,2),z=a(X,!0);r(X),r(Ie);var U=y(Ie,2);{var T=u=>{var g=Ia(),l=a(g),d=a(l);Lr(d,{className:"size-3.5 "});var x=y(d,2),k=a(x,!0);r(x),r(l),r(g),H(F=>fe(k,F),[()=>(v(),s(()=>v().t("Add Member")))]),Ae("click",l,function(...F){var D;(D=O())==null||D.apply(this,F)}),i(u,g)};b(U,u=>{O()&&u(T)})}r(Me);var n=y(Me,2);{var C=u=>{var g=Na(),l=a(g),d=a(l),x=y(a(d),2);rr(x),r(d),r(l),r(g),H(k=>He(x,"placeholder",k),[()=>(v(),s(()=>v().t("Search")))]),Nr(x,()=>e(ke),k=>m(ke,k)),i(u,g)};b(n,u=>{Q()&&u(C)})}var j=y(n,2);{var c=u=>{var g=Ra(),l=be(g),d=a(l),x=a(d);rt(x,7,()=>e(pe),D=>D.id,(D,A)=>{var _e=Aa(),ce=a(_e),Ne=a(ce),J=a(Ne);Ft(J,{get user(){return e(A)},side:"right",align:"center",sideOffset:6,children:(B,W)=>{var N=Ua();H(()=>He(N,"src",(o(We),e(A),s(()=>`${We}/users/${e(A).id}/profile/image`)))),i(B,N)},$$slots:{default:!0}});var re=y(J,2);Ve(re,{get content(){return e(A),s(()=>e(A).email)},placement:"top-start",children:(B,W)=>{var N=Ea(),Re=a(N,!0);r(N),H(()=>fe(Re,(e(A),s(()=>e(A).name)))),i(B,N)},$$slots:{default:!0}});var Te=y(re,2);{var Ue=B=>{var W=La();i(B,W)};b(Te,B=>{e(A),s(()=>{var W;return(W=e(A))==null?void 0:W.is_active})&&B(Ue)})}r(Ne),r(ce);var $=y(ce,2),h=a($),Y=a(h);{let B=se(()=>(e(A),s(()=>e(A).role==="admin"?"info":e(A).role==="user"?"success":"muted"))),W=se(()=>(v(),e(A),s(()=>v().t(e(A).role))));Er(Y,{get type(){return e(B)},get content(){return e(W)}})}r(h);var de=y(h,2);{var ue=B=>{var W=ja(),N=a(W),Re=a(N);vt(Re,{}),r(N),r(W),H(()=>N.disabled=(e(A),V(),s(()=>{var Ce;return e(A).id===((Ce=V())==null?void 0:Ce.id)}))),Ae("click",N,()=>{t()(e(A).id)}),i(B,W)};b(de,B=>{t()&&B(ue)})}r($),r(_e),i(D,_e)}),r(x),r(d),r(l);var k=y(l,2);{var F=D=>{Ur(D,{get count(){return e(ie)},perPage:30,get page(){return e(p)},set page(A){m(p,A)},$$legacy:!0})};b(k,D=>{e(ie)>30&&D(F)})}i(u,g)},_=u=>{var g=Da(),l=a(g,!0);r(g),H(d=>fe(l,d),[()=>(v(),s(()=>v().t("No users were found.")))]),i(u,g)};b(j,u=>{e(pe),s(()=>e(pe).length>0)?u(c):u(_,!1)})}H(u=>{fe(Pe,u),fe(z,e(ie))},[()=>(v(),s(()=>v().t("Members")))]),i(G,te)};b(ne,G=>{e(pe)===null||e(ie)===null?G(xe):G(oe,!1)})}r(ee),i(je,ee),Qe(),$e()}var Oa=f('<div class="ml-2 self-center"><!></div>'),Ya=f('<div><div class=" flex justify-between dark:text-gray-100 px-5 pt-4 mb-1.5"><div class="self-center text-base"><div class="flex items-center gap-0.5 shrink-0"> </div></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-3 pb-4 md:space-x-4 dark:text-gray-200"><div class=" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"><form class="flex flex-col w-full"><div class="flex flex-col w-full h-full pb-2"><!></div> <div class="flex justify-end pt-3 text-sm font-medium gap-1.5"><button type="submit"> <!></button></div></form></div></div></div>');function Fa(je,w){Ke(w,!1);const v=()=>Le($e,"$i18n",V),[V,Z]=Xe(),$e=tt("i18n");let ge=q(w,"show",12,!1),K=q(w,"channel",8,null),O=q(w,"onUpdate",8,()=>{}),t=le([]),Q=le([]),p=le(!1);const pe=async()=>{await gr(localStorage.token,K().id,{user_ids:e(Q),group_ids:e(t)}).catch(ee=>(Ye.error(`${ee}`),null))?(Ye.success(v().t("Members added successfully")),O()(),ge(!1)):Ye.error(v().t("Failed to add members"))},ie=()=>{m(Q,[]),m(t,[]),m(p,!1)};st(()=>o(ge()),()=>{ge()||ie()}),lt(),Ze();var ke=Fe(),me=be(ke);{var L=R=>{_t(R,{size:"sm",get show(){return ge()},set show(ee){ge(ee)},children:(ee,ne)=>{var xe=Ya(),oe=a(xe),G=a(oe),te=a(G),Me=a(te,!0);r(te),r(G);var Ie=y(G,2),I=a(Ie);vt(I,{className:"size-5"}),r(Ie),r(oe);var Pe=y(oe,2),X=a(Pe),z=a(X),U=a(z),T=a(U);jr(T,{includeGroups:!0,get userIds(){return e(Q)},set userIds(u){m(Q,u)},get groupIds(){return e(t)},set groupIds(u){m(t,u)},$$legacy:!0}),r(U);var n=y(U,2),C=a(n),j=a(C),c=y(j);{var _=u=>{var g=Oa(),l=a(g);at(l,{}),r(g),i(u,g)};b(c,u=>{e(p)&&u(_)})}r(C),r(n),r(z),r(X),r(Pe),r(xe),H((u,g)=>{fe(Me,u),Oe(C,1,`px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-950 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full flex flex-row space-x-1 items-center ${e(p)?" cursor-not-allowed":""}`),C.disabled=e(p),fe(j,`${g??""} `)},[()=>(v(),s(()=>v().t("Add Members"))),()=>(v(),s(()=>v().t("Add")))]),Ae("click",Ie,()=>{ge(!1)}),Ae("submit",z,u=>{u.preventDefault(),pe()}),i(ee,xe)},$$slots:{default:!0},$$legacy:!0})};b(me,R=>{K()&&R(L)})}i(je,ke),Qe(),Z()}var Va=f('<div class=" text-left self-center overflow-hidden w-full line-clamp-1 flex-1"> </div>'),Ga=f('<div class=" size-4 justify-center flex items-center"><!></div> <div class=" text-left self-center overflow-hidden w-full line-clamp-1 flex-1"> </div>',1),qa=f('<div><div class=" flex justify-between dark:text-gray-100 px-5 pt-4 mb-1.5"><div class="self-center text-base"><div class="flex items-center gap-0.5 shrink-0"><!></div></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-3 pb-4 md:space-x-4 dark:text-gray-200"><div class=" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"><form class="flex flex-col w-full"><div class="flex flex-col w-full h-full pb-2"><!></div></form></div></div></div>'),Ka=f("<!> <!>",1);function Qa(je,w){Ke(w,!1);const v=()=>Le($e,"$i18n",V),[V,Z]=Xe(),$e=tt("i18n");let ge=q(w,"show",12,!1),K=q(w,"channel",8,null),O=q(w,"onUpdate",8,()=>{}),t=le(!1);const Q=async()=>{},p=async me=>{await mr(localStorage.token,K().id,{user_ids:[me]}).catch(R=>(Ye.error(`${R}`),null))?(Ye.success(v().t("Member removed successfully")),O()()):Ye.error(v().t("Failed to remove member"))};dt(()=>{}),st(()=>o(ge()),()=>{ge()}),lt(),Ze();var pe=Fe(),ie=be(pe);{var ke=me=>{var L=Ka(),R=be(L);Fa(R,{get channel(){return K()},get onUpdate(){return O()},get show(){return e(t)},set show(ne){m(t,ne)},$$legacy:!0});var ee=y(R,2);_t(ee,{size:"sm",get show(){return ge()},set show(ne){ge(ne)},children:(ne,xe)=>{var oe=qa(),G=a(oe),te=a(G),Me=a(te),Ie=a(Me);{var I=c=>{var _=Va(),u=a(_,!0);r(_),H(g=>fe(u,g),[()=>(v(),s(()=>v().t("Direct Message")))]),i(c,_)},Pe=c=>{var _=Ga(),u=be(_),g=a(u);{var l=F=>{qt(F,{className:"size-3.5",strokeWidth:"2.5"})},d=F=>{Kt(F,{className:"size-5.5",strokeWidth:"2"})};b(g,F=>{o(K()),s(()=>{var D,A,_e;return((D=K())==null?void 0:D.type)==="group"?!((A=K())!=null&&A.is_private):((_e=K())==null?void 0:_e.access_control)===null})?F(l):F(d,!1)})}r(u);var x=y(u,2),k=a(x,!0);r(x),H(()=>fe(k,(o(K()),s(()=>K().name)))),i(c,_)};b(Ie,c=>{o(K()),s(()=>{var _;return((_=K())==null?void 0:_.type)==="dm"})?c(I):c(Pe,!1)})}r(Me),r(te);var X=y(te,2),z=a(X);vt(z,{className:"size-5"}),r(X),r(G);var U=y(G,2),T=a(U),n=a(T),C=a(n),j=a(C);{let c=se(()=>(o(K()),e(t),s(()=>{var l,d;return((l=K())==null?void 0:l.type)==="group"&&((d=K())!=null&&d.is_manager)?()=>{m(t,!0)}:null}))),_=se(()=>(o(K()),s(()=>{var l,d;return((l=K())==null?void 0:l.type)==="group"&&((d=K())!=null&&d.is_manager)?x=>{p(x)}:null}))),u=se(()=>(o(K()),s(()=>{var l;return((l=K())==null?void 0:l.type)!=="dm"}))),g=se(()=>(o(K()),s(()=>{var l;return((l=K())==null?void 0:l.type)!=="dm"})));Ha(j,{get channel(){return K()},get onAdd(){return e(c)},get onRemove(){return e(_)},get search(){return e(u)},get sort(){return e(g)}})}r(C),r(n),r(T),r(U),r(oe),Ae("click",X,()=>{ge(!1)}),Ae("submit",n,c=>{c.preventDefault(),Q()}),i(ne,oe)},$$slots:{default:!0},$$legacy:!0}),i(me,L)};b(ie,me=>{K()&&me(ke)})}i(je,pe),Qe(),Z()}var Za=f('<div class="my-10"><!></div>'),Xa=f('<div class=" text-center text-xs text-gray-500 dark:text-gray-400 py-6"> </div>'),Ja=f('<div class="w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2"><!> <div class=" "> </div></div>'),es=f("<!> <!>",1),ts=f('<div class="flex flex-col gap-2 max-h-[60vh] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-700 scrollbar-track-transparent py-2"><!></div>'),rs=f('<div><div class=" flex justify-between dark:text-gray-100 px-5 pt-4 mb-1.5"><div class="self-center text-base"><div class="flex items-center gap-0.5 shrink-0"> </div></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-4 pb-4 md:space-x-4 dark:text-gray-200"><div class=" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"><div class="flex flex-col w-full h-full pb-2 gap-1"><!></div></div></div></div>');function as(je,w){Ke(w,!1);const v=()=>Le($e,"$i18n",V),[V,Z]=Xe(),$e=tt("i18n");let ge=q(w,"show",12,!1),K=q(w,"channel",8,null),O=q(w,"onPin",8,(ee,ne)=>{}),t=le(1),Q=le(null),p=le(!1),pe=le(!1);const ie=async()=>{if(K()&&!e(p)){m(pe,!0);try{const ee=await _r(localStorage.token,K().id,e(t)).catch(ne=>(Ye.error(`${ne}`),null));ee&&m(Q,[...e(Q)??[],...ee]),ee.length===0&&m(p,!0)}catch(ee){}finally{m(pe,!1)}}},ke=()=>{m(t,1),m(Q,null),m(p,!1),ie()};dt(()=>{ke()}),st(()=>o(ge()),()=>{ge()&&ke()}),lt(),Ze();var me=Fe(),L=be(me);{var R=ee=>{_t(ee,{size:"sm",get show(){return ge()},set show(ne){ge(ne)},children:(ne,xe)=>{var oe=rs(),G=a(oe),te=a(G),Me=a(te),Ie=a(Me,!0);r(Me),r(te);var I=y(te,2),Pe=a(I);vt(Pe,{className:"size-5"}),r(I),r(G);var X=y(G,2),z=a(X),U=a(z),T=a(U);{var n=j=>{var c=Za(),_=a(c);at(_,{className:"size-5"}),r(c),i(j,c)},C=j=>{var c=ts(),_=a(c);{var u=l=>{var d=Xa(),x=a(d,!0);r(d),H(k=>fe(x,k),[()=>(v(),s(()=>v().t("No pinned messages")))]),i(l,d)},g=l=>{var d=Fe(),x=be(d);rt(x,3,()=>e(Q),k=>k.id,(k,F,D)=>{var A=es(),_e=be(A);Qt(_e,{className:"rounded-xl px-2",get message(){return e(F)},get channel(){return K()},onPin:async J=>{m(Q,e(Q).filter(re=>re.id!==J.id)),O()(J.id,!J.is_pinned),await Bt(localStorage.token,J.channel_id,J.id,!J.is_pinned).catch(re=>(Ye.error(`${re}`),null)),ke()},onReaction:!1,onThread:!1,onReply:!1,onEdit:!1,onDelete:!1});var ce=y(_e,2);{var Ne=J=>{Vt(J,{$$events:{visible:re=>{e(pe)||(m(t,e(t)+1),ie())}},children:(re,Te)=>{var Ue=Ja(),$=a(Ue);at($,{className:" size-4"});var h=y($,2),Y=a(h,!0);r(h),r(Ue),H(de=>fe(Y,de),[()=>(v(),s(()=>v().t("Loading...")))]),i(re,Ue)},$$slots:{default:!0}})};b(ce,J=>{o(e(D)),e(Q),e(p),s(()=>e(D)===e(Q).length-1&&!e(p))&&J(Ne)})}i(k,A)}),i(l,d)};b(_,l=>{e(Q),s(()=>e(Q).length===0)?l(u):l(g,!1)})}r(c),i(j,c)};b(T,j=>{e(Q)===null?j(n):j(C,!1)})}r(U),r(z),r(X),r(oe),H(j=>fe(Ie,j),[()=>(v(),s(()=>v().t("Pinned Messages")))]),Ae("click",I,()=>{ge(!1)}),i(ne,oe)},$$slots:{default:!0},$$legacy:!0})};b(L,ee=>{K()&&ee(R)})}i(je,me),Qe(),Z()}var ss=f('<button id="sidebar-toggle-button" class=" cursor-pointer flex rounded-lg hover:bg-gray-100 dark:hover:bg-gray-850 transition cursor-"><div class=" self-center p-1.5"><!></div></button>'),ls=f("<div><!></div>"),is=f("<img/>"),ns=f('<span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75"></span>'),os=f('<div class="absolute bottom-0 right-0"><span class="relative flex size-2"><!> <span></span></span></div>'),ds=f('<div class="flex mr-1.5 relative"><!> <!></div>'),vs=f('<div class=" size-4.5 justify-center flex items-center"><!></div>'),cs=f('<div class="flex items-center gap-0.5 shrink-0"><!> <div class=" text-left self-center overflow-hidden w-full line-clamp-1 flex-1"><!></div></div>'),us=f('<button class=" flex cursor-pointer py-1.5 px-1.5 border dark:border-gray-850 border-gray-50 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition" aria-label="Pinned Messages" type="button"><div class=" flex items-center gap-0.5 m-auto self-center"><!></div></button>'),fs=f('<button class=" flex cursor-pointer py-1 px-1.5 border dark:border-gray-850 border-gray-50 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition" aria-label="User Count" type="button"><div class=" flex items-center gap-0.5 m-auto self-center"><!> <div class="text-sm"> </div></div></button>'),gs=f("<!> <!>",1),ms=f('<button class="select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition" aria-label="User Menu"><div class=" self-center"><img class="size-6 object-cover rounded-full" alt="User profile" draggable="false"/></div></button>'),_s=f('<!> <!> <nav class="sticky top-0 z-30 w-full px-1.5 py-1 -mb-8 flex items-center drag-region flex flex-col"><div id="navbar-bg-gradient-to-b" class=" bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]"></div> <div class=" flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent"><div class="flex items-center w-full max-w-full"><!> <div><!></div> <div class="self-start flex flex-none items-center text-gray-600 dark:text-gray-400 gap-1"><!> <!></div></div></div></nav>',1);function ps(je,w){Ke(w,!1);const v=()=>Le(ir,"$mobile",ge),V=()=>Le(ft,"$showSidebar",ge),Z=()=>Le(O,"$i18n",ge),$e=()=>Le(it,"$user",ge),[ge,K]=Xe(),O=tt("i18n");let t=le(!1),Q=le(!1),p=q(w,"channel",8),pe=q(w,"onPin",8,(U,T)=>{}),ie=q(w,"onUpdate",8,()=>{});Ze();var ke=_s(),me=be(ke);as(me,{get channel(){return p()},get onPin(){return pe()},get show(){return e(t)},set show(U){m(t,U)},$$legacy:!0});var L=y(me,2);Qa(L,{get channel(){return p()},get onUpdate(){return ie()},get show(){return e(Q)},set show(U){m(Q,U)},$$legacy:!0});var R=y(L,2),ee=y(a(R),2),ne=a(ee),xe=a(ne);{var oe=U=>{var T=ls(),n=a(T);{let C=se(()=>(V(),Z(),s(()=>V()?Z().t("Close Sidebar"):Z().t("Open Sidebar"))));Ve(n,{get content(){return e(C)},interactive:!0,children:(j,c)=>{var _=ss(),u=a(_),g=a(u);Ir(g,{}),r(u),r(_),Ae("click",_,()=>{ft.set(!V())}),i(j,_)},$$slots:{default:!0}})}r(T),H(()=>Oe(T,1,`${V()?"md:hidden":""} mr-1.5 mt-0.5 self-start flex flex-none items-center text-gray-600 dark:text-gray-400`)),i(U,T)};b(xe,U=>{v()&&U(oe)})}var G=y(xe,2),te=a(G);{var Me=U=>{var T=cs(),n=a(T);{var C=l=>{var d=Fe(),x=be(d);{var k=D=>{const A=se(()=>(o(p()),$e(),s(()=>p().users.filter(re=>{var Te;return re.id!==((Te=$e())==null?void 0:Te.id)}))));var _e=ds(),ce=a(_e);rt(ce,1,()=>(o(e(A)),s(()=>e(A).slice(0,2))),ut,(re,Te,Ue)=>{var $=is();Oe($,1,` size-6.5 rounded-full border-2 border-white dark:border-gray-900 ${Ue===1?"-ml-3":""}`),H(()=>{He($,"src",(o(We),e(Te),s(()=>`${We}/users/${e(Te).id}/profile/image`))),He($,"alt",(e(Te),s(()=>e(Te).name)))}),i(re,$)});var Ne=y(ce,2);{var J=re=>{var Te=os(),Ue=a(Te),$=a(Ue);{var h=de=>{var ue=ns();i(de,ue)};b($,de=>{o(e(A)),s(()=>{var ue;return(ue=e(A)[0])==null?void 0:ue.is_active})&&de(h)})}var Y=y($,2);r(Ue),r(Te),H(()=>Oe(Y,1,`relative inline-flex size-2 rounded-full ${o(e(A)),s(()=>{var de;return(de=e(A)[0])!=null&&de.is_active?"bg-green-500":"bg-gray-300 dark:bg-gray-700"})??""} border-[1.5px] border-white dark:border-gray-900`)),i(re,Te)};b(Ne,re=>{o(e(A)),s(()=>e(A).length===1)&&re(J)})}r(_e),i(D,_e)},F=D=>{Ar(D,{className:"size-4 ml-1 mr-0.5",strokeWidth:"2"})};b(x,D=>{o(p()),s(()=>{var A;return(A=p())==null?void 0:A.users})?D(k):D(F,!1)})}i(l,d)},j=l=>{var d=vs(),x=a(d);{var k=D=>{qt(D,{className:"size-3.5",strokeWidth:"2.5"})},F=D=>{Kt(D,{className:"size-5",strokeWidth:"2"})};b(x,D=>{o(p()),s(()=>{var A,_e,ce;return((A=p())==null?void 0:A.type)==="group"?!((_e=p())!=null&&_e.is_private):((ce=p())==null?void 0:ce.access_control)===null})?D(k):D(F,!1)})}r(d),i(l,d)};b(n,l=>{o(p()),s(()=>{var d;return((d=p())==null?void 0:d.type)==="dm"})?l(C):l(j,!1)})}var c=y(n,2),_=a(c);{var u=l=>{var d=Je();H(()=>fe(d,(o(p()),s(()=>p().name)))),i(l,d)},g=l=>{var d=Je();H(x=>fe(d,x),[()=>(o(p()),$e(),s(()=>{var x,k;return(k=(x=p())==null?void 0:x.users)==null?void 0:k.filter(F=>{var D;return F.id!==((D=$e())==null?void 0:D.id)}).map(F=>F.name).join(", ")}))]),i(l,d)};b(_,l=>{o(p()),s(()=>{var d;return(d=p())==null?void 0:d.name})?l(u):l(g,!1)})}r(c),r(T),i(U,T)};b(te,U=>{p()&&U(Me)})}r(G);var Ie=y(G,2),I=a(Ie);{var Pe=U=>{var T=gs(),n=be(T);{let c=se(()=>(Z(),s(()=>Z().t("Pinned Messages"))));Ve(n,{get content(){return e(c)},children:(_,u)=>{var g=us(),l=a(g),d=a(l);gt(d,{className:" size-4",strokeWidth:"1.5"}),r(l),r(g),Ae("click",g,()=>{m(t,!0)}),i(_,g)},$$slots:{default:!0}})}var C=y(n,2);{var j=c=>{{let _=se(()=>(Z(),s(()=>Z().t("Users"))));Ve(c,{get content(){return e(_)},children:(u,g)=>{var l=fs(),d=a(l),x=a(d);Ca(x,{className:" size-4",strokeWidth:"1.5"});var k=y(x,2),F=a(k,!0);r(k),r(d),r(l),H(()=>fe(F,(o(p()),s(()=>p().user_count)))),Ae("click",l,()=>{m(Q,!0)}),i(u,l)},$$slots:{default:!0}})}};b(C,c=>{o(p()),s(()=>{var _;return((_=p())==null?void 0:_.user_count)!==void 0})&&c(j)})}i(U,T)};b(I,U=>{p()&&U(Pe)})}var X=y(I,2);{var z=U=>{{let T=se(()=>($e(),s(()=>{var n;return(n=$e())==null?void 0:n.role})));zr(U,{className:"max-w-[240px]",get role(){return e(T)},help:!0,$$events:{show:n=>{n.detail==="archived-chat"&&nr.set(!0)}},children:(n,C)=>{var j=ms(),c=a(j),_=a(c);r(c),r(j),H(()=>He(_,"src",(o(We),$e(),s(()=>{var u;return`${We}/users/${(u=$e())==null?void 0:u.id}/profile/image`})))),i(n,j)},$$slots:{default:!0}})}};b(X,U=>{$e()!==void 0&&U(z)})}r(Ie),r(ne),r(ee),r(R),H(()=>Oe(G,1,`flex-1 overflow-hidden max-w-full py-0.5 flex items-center
			${V()?"ml-1":""}
			`)),i(je,ke),Qe(),K()}var hs=f('<div class="w-full flex justify-center pt-5 pb-10"><!></div>'),xs=f('<div class="flex flex-col w-full h-full bg-gray-50 dark:bg-gray-850"><div class="sticky top-0 flex items-center justify-between px-3.5 py-3"><div class=" font-medium text-lg"> </div> <div><button class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 p-2"><!></button></div></div> <div class=" max-h-full w-full overflow-y-auto"><!> <div class=" pb-[1rem] px-2.5 w-full"><!></div></div></div>');function Nt(je,w){Ke(w,!1);const v=()=>Le(it,"$user",$e),V=()=>Le(Dt,"$socket",$e),Z=()=>Le(K,"$i18n",$e),[$e,ge]=Xe(),K=tt("i18n");let O=q(w,"threadId",8,null),t=q(w,"channel",8,null),Q=q(w,"onClose",8,()=>{}),p=le(null),pe=le(!1),ie=le(null),ke=le(null),me=le(null),L=le([]),R={};const ee=()=>{et(ie,e(ie).scrollTop=e(ie).scrollHeight)},ne=async()=>{m(p,null),m(pe,!1),m(L,[]),R={},t()?(m(p,await kt(localStorage.token,t().id,O())),e(p).length<50&&m(pe,!0),await ot(),ee()):Rt("/")},xe=async I=>{var Pe,X,z;if(I.channel_id===t().id){const U=((Pe=I==null?void 0:I.data)==null?void 0:Pe.type)??null,T=((X=I==null?void 0:I.data)==null?void 0:X.data)??null;if(U==="message")((T==null?void 0:T.parent_id)??null)===O()&&e(p)&&(m(p,[T,...e(p)]),e(L).find(n=>n.id===I.user.id)&&m(L,e(L).filter(n=>n.id!==I.user.id)));else if(U==="message:update"){if(e(p)){const n=e(p).findIndex(C=>C.id===T.id);n!==-1&&et(p,e(p)[n]=T)}}else if(U==="message:delete")e(p)&&m(p,e(p).filter(n=>n.id!==T.id));else if(U.includes("message:reaction")){if(e(p)){const n=e(p).findIndex(C=>C.id===T.id);n!==-1&&et(p,e(p)[n]=T)}}else if(U==="typing"&&I.message_id===O()){if(I.user.id===((z=v())==null?void 0:z.id))return;m(L,T.typing?[...e(L),...e(L).find(n=>n.id===I.user.id)?[]:[{id:I.user.id,name:I.user.name}]]:e(L).filter(n=>n.id!==I.user.id)),R[I.user.id]&&clearTimeout(R[I.user.id]),R[I.user.id]=setTimeout(()=>{m(L,e(L).filter(n=>n.id!==I.user.id))},5e3)}}},oe=async({content:I,data:Pe})=>{var X;!I&&((Pe==null?void 0:Pe.files)??[]).length===0||(await Wt(localStorage.token,t().id,{parent_id:O(),reply_to_id:((X=e(me))==null?void 0:X.id)??null,content:I,data:Pe}).catch(z=>(Ye.error(`${z}`),null)),m(me,null))},G=async()=>{var I;(I=V())==null||I.emit("events:channel",{channel_id:t().id,message_id:O(),data:{type:"typing",data:{typing:!0}}})};dt(()=>{var I;(I=V())==null||I.on("events:channel",xe)}),Lt(()=>{var I;(I=V())==null||I.off("events:channel",xe)}),st(()=>o(O()),()=>{O()&&ne()}),lt(),Ze();var te=Fe(),Me=be(te);{var Ie=I=>{var Pe=xs(),X=a(Pe),z=a(X),U=a(z,!0);r(z);var T=y(z,2),n=a(T),C=a(n);vt(C,{}),r(n),r(T),r(X);var j=y(X,2),c=a(j);{var _=d=>{Zt(d,{get id(){return O()},get channel(){return t()},get top(){return e(pe)},get messages(){return e(p)},get replyToMessage(){return e(me)},thread:!0,onReply:async x=>{var k;m(me,x),await ot(),(k=e(ke))==null||k.focus()},onLoad:async()=>{const x=await kt(localStorage.token,t().id,O(),e(p).length);if(m(p,[...e(p),...x]),x.length<50){m(pe,!0);return}}})},u=d=>{var x=hs(),k=a(x);at(k,{}),r(x),i(d,x)};b(c,d=>{e(p)!==null?d(_):d(u,!1)})}var g=y(c,2),l=a(g);{let d=se(()=>(o(t()),s(()=>{var k;return!((k=t())!=null&&k.write_access)}))),x=se(()=>(o(t()),Z(),s(()=>{var k;return(k=t())!=null&&k.write_access?Z().t("Reply to thread..."):Z().t("You do not have permission to send messages in this thread.")})));Gt(l,{get id(){return O()},get channel(){return t()},get disabled(){return e(d)},get placeholder(){return e(x)},typingUsersClassName:"from-gray-50 dark:from-gray-850",get typingUsers(){return e(L)},userSuggestions:!0,channelSuggestions:!0,onChange:G,onSubmit:oe,get replyToMessage(){return e(me)},set replyToMessage(k){m(me,k)},get chatInputElement(){return e(ke)},set chatInputElement(k){m(ke,k)},$$legacy:!0})}r(g),r(j),At(j,d=>m(ie,d),()=>e(ie)),r(Pe),H(d=>fe(U,d),[()=>(Z(),s(()=>Z().t("Thread")))]),Ae("click",n,()=>{Q()()}),i(I,Pe)};b(Me,I=>{t()&&I(Ie)})}i(je,te),Qe(),ge()}var ys=f('<div class="flex-1 overflow-y-auto"><div class=" pb-2.5 max-w-full z-10 scrollbar-hidden w-full h-full pt-6 flex-1 flex flex-col-reverse overflow-auto" id="messages-container"><!></div></div> <div class=" pb-[1rem] px-2.5"><!></div>',1),bs=f('<div class=" flex items-center justify-center h-full w-full"><div class="m-auto"><!></div></div>'),ws=f("<!> <!>",1),$s=f("<div><!></div>"),ks=f('<div class=" absolute -left-1.5 -right-1.5 -top-0 -bottom-0 z-20 cursor-col-resize bg-transparent"></div>'),Ms=f('<div class="h-full w-full shadow-xl"><!></div>'),Ps=f("<!> <!>",1),zs=f("<!> <!>",1),Ts=f('<div id="channel-container"><!></div>');function Cs(je,w){Ke(w,!1);const v=()=>Le(Dt,"$socket",O),V=()=>Le($t,"$channels",O),Z=()=>Le(it,"$user",O),$e=()=>Le(bt,"$chatId",O),ge=()=>Le(ft,"$showSidebar",O),K=()=>Le(Dr,"$i18n",O),[O,t]=Xe();let Q=q(w,"id",8,""),p=null,pe=le(!0),ie=le(null),ke=le(null),me=le(!1),L=le(null),R=le(null),ee=le(null),ne=le(null),xe=le([]),oe={};const G=()=>{e(ie)&&et(ie,e(ie).scrollTop=e(ie).scrollHeight)},te=async n=>{var C;(C=v())==null||C.emit("events:channel",{channel_id:n,message_id:null,data:{type:"last_read_at"}}),$t.set(V().map(j=>j.id===n?{...j,unread_count:0}:j))},Me=async()=>{p&&te(p),p=Q(),te(Q()),wt.set(Q()),m(me,!1),m(R,null),m(L,null),m(ne,null),m(xe,[]),oe={},m(L,await Mt(localStorage.token,Q()).catch(n=>null)),e(L)?(m(R,await Pt(localStorage.token,Q(),0)),e(R)&&(G(),e(R).length<50&&m(me,!0))):Rt("/")},Ie=async n=>{var C,j,c;if(n.channel_id===Q()){const _=((C=n==null?void 0:n.data)==null?void 0:C.type)??null,u=((j=n==null?void 0:n.data)==null?void 0:j.data)??null;if(_==="message"){if(((u==null?void 0:u.parent_id)??null)===null){const g=(u==null?void 0:u.temp_id)??null;m(R,[{...u,temp_id:null},...e(R).filter(l=>!g||(l==null?void 0:l.temp_id)!==g)]),e(xe).find(l=>l.id===n.user.id)&&m(xe,e(xe).filter(l=>l.id!==n.user.id)),await ot(),e(pe)&&G()}}else if(_==="message:update"){const g=e(R).findIndex(l=>l.id===u.id);g!==-1&&et(R,e(R)[g]=u)}else if(_==="message:delete")m(R,e(R).filter(g=>g.id!==u.id));else if(_==="message:reply"){const g=e(R).findIndex(l=>l.id===u.id);g!==-1&&et(R,e(R)[g]=u)}else if(_.includes("message:reaction")){const g=e(R).findIndex(l=>l.id===u.id);g!==-1&&et(R,e(R)[g]=u)}else if(_==="typing"&&n.message_id===null){if(n.user.id===((c=Z())==null?void 0:c.id))return;m(xe,u.typing?[...e(xe),...e(xe).find(g=>g.id===n.user.id)?[]:[{id:n.user.id,name:n.user.name}]]:e(xe).filter(g=>g.id!==n.user.id)),oe[n.user.id]&&clearTimeout(oe[n.user.id]),oe[n.user.id]=setTimeout(()=>{m(xe,e(xe).filter(g=>g.id!==n.user.id))},5e3)}}},I=async({content:n,data:C})=>{var g,l;if(!n&&((C==null?void 0:C.files)??[]).length===0)return;const j=pr(),c={temp_id:j,content:n,data:C,reply_to_id:((g=e(ee))==null?void 0:g.id)??null},_=Date.now()*1e6;m(R,[{...c,id:j,user_id:(l=Z())==null?void 0:l.id,user:Z(),reply_to_message:e(ee)??null,created_at:_,updated_at:_},...e(R)]),await Wt(localStorage.token,Q(),c).catch(d=>(Ye.error(`${d}`),null))&&et(ie,e(ie).scrollTop=e(ie).scrollHeight),m(ee,null)},Pe=async()=>{var n;(n=v())==null||n.emit("events:channel",{channel_id:Q(),message_id:null,data:{type:"typing",data:{typing:!0}}}),te(Q())};let X,z=le(!1);dt(()=>{var C;$e()&&bt.set(""),(C=v())==null||C.on("events:channel",Ie),X=window.matchMedia("(min-width: 1024px)");const n=async j=>{j.matches?m(z,!0):m(z,!1)};X.addEventListener("change",n),n(X)}),Lt(()=>{var n;te(Q()),wt.set(null),(n=v())==null||n.off("events:channel",Ie)}),st(()=>o(Q()),()=>{Q()&&Me()}),lt(),Ze();var U=Ts();tr("l5reg3",n=>{var C=Fe(),j=be(C);{var c=u=>{ht(g=>{xt.title=`${g??""}  Open WebUI`},[()=>(e(L),Z(),s(()=>{var g,l;return((g=e(L))==null?void 0:g.name.trim())||((l=e(L))==null?void 0:l.users.reduce((d,x,k,F)=>{var D;return x.id===((D=Z())==null?void 0:D.id)?d:d?`${d}, ${x.name}`:x.name},""))}))])},_=u=>{ht(()=>{xt.title=`#${e(L),s(()=>{var g;return((g=e(L))==null?void 0:g.name)??"Channel"})??""}  Open WebUI`})};b(j,u=>{e(L),s(()=>{var g;return((g=e(L))==null?void 0:g.type)==="dm"})?u(c):u(_,!1)})}i(n,C)});var T=a(U);ar(T,{direction:"horizontal",class:"w-full h-full",children:(n,C)=>{var j=zs(),c=be(j);yt(c,{defaultSize:50,minSize:50,class:"h-full flex flex-col w-full relative",children:(l,d)=>{var x=ws(),k=be(x);ps(k,{get channel(){return e(L)},onPin:(_e,ce)=>{m(R,e(R).map(Ne=>Ne.id===_e?{...Ne,is_pinned:ce}:Ne))},onUpdate:async()=>{m(L,await Mt(localStorage.token,Q()).catch(_e=>null))}});var F=y(k,2);{var D=_e=>{var ce=ys(),Ne=be(ce),J=a(Ne),re=a(J);er(re,Q,$=>{Zt($,{get channel(){return e(L)},get top(){return e(me)},get messages(){return e(R)},get replyToMessage(){return e(ee)},onReply:async h=>{var Y;m(ee,h),await ot(),(Y=e(ke))==null||Y.focus()},onThread:h=>{m(ne,h)},onLoad:async()=>{const h=await Pt(localStorage.token,Q(),e(R).length);if(m(R,[...e(R),...h]),h.length<50){m(me,!0);return}}})}),r(J),At(J,$=>m(ie,$),()=>e(ie)),r(Ne);var Te=y(Ne,2),Ue=a(Te);{let $=se(()=>(e(L),s(()=>{var Y;return!((Y=e(L))!=null&&Y.write_access)}))),h=se(()=>(e(L),K(),s(()=>{var Y;return(Y=e(L))!=null&&Y.write_access?K().t("Type here..."):K().t("You do not have permission to send messages in this channel.")})));Gt(Ue,{id:"root",get typingUsers(){return e(xe)},get channel(){return e(L)},userSuggestions:!0,channelSuggestions:!0,get disabled(){return e($)},get placeholder(){return e(h)},onChange:Pe,onSubmit:I,scrollToBottom:G,get scrollEnd(){return e(pe)},get chatInputElement(){return e(ke)},set chatInputElement(Y){m(ke,Y)},get replyToMessage(){return e(ee)},set replyToMessage(Y){m(ee,Y)},$$legacy:!0})}r(Te),Ae("scroll",J,$=>{m(pe,Math.abs(e(ie).scrollTop)<=50)}),i(_e,ce)},A=_e=>{var ce=bs(),Ne=a(ce),J=a(Ne);at(J,{className:"size-5"}),r(Ne),r(ce),i(_e,ce)};b(F,_e=>{e(L)&&e(R)!==null?_e(D):_e(A,!1)})}i(l,x)},$$slots:{default:!0}});var _=y(c,2);{var u=l=>{var d=Fe(),x=be(d);{var k=F=>{{let D=se(()=>e(ne)!==null);Rr(F,{get show(){return e(D)},onClose:()=>{m(ne,null)},children:(A,_e)=>{var ce=$s(),Ne=a(ce);Nt(Ne,{get threadId(){return e(ne)},get channel(){return e(L)},onClose:()=>{m(ne,null)}}),r(ce),H(()=>Oe(ce,1,` ${e(ne)!==null?" h-screen  w-full":"px-6 py-4"} h-full`)),i(A,ce)},$$slots:{default:!0}})}};b(x,F=>{e(ne)!==null&&F(k)})}i(l,d)},g=l=>{var d=Fe(),x=be(d);{var k=F=>{var D=Ps(),A=be(D);sr(A,{class:"relative flex items-center justify-center group border-l border-gray-50 dark:border-gray-850/30 hover:border-gray-200 dark:hover:border-gray-800  transition z-20",id:"controls-resizer",children:(ce,Ne)=>{var J=ks();i(ce,J)},$$slots:{default:!0}});var _e=y(A,2);yt(_e,{defaultSize:50,minSize:30,class:"h-full w-full",children:(ce,Ne)=>{var J=Ms(),re=a(J);Nt(re,{get threadId(){return e(ne)},get channel(){return e(L)},onClose:()=>{m(ne,null)}}),r(J),i(ce,J)},$$slots:{default:!0}}),i(F,D)};b(x,F=>{e(ne)!==null&&F(k)},!0)}i(l,d)};b(_,l=>{e(z)?l(g,!1):l(u)})}i(n,j)},$$slots:{default:!0}}),r(U),H(()=>Oe(U,1,`h-screen max-h-[100dvh] transition-width duration-200 ease-in-out ${ge()?"md:max-w-[calc(100%-var(--sidebar-width))]":""} w-full max-w-full flex flex-col`)),i(je,U),Qe(),t()}function Pl(je,w){Ke(w,!1);const v=()=>Le(Jt,"$page",V),[V,Z]=Xe();Ze(),Cs(je,{get id(){return v().params.id}}),Qe(),Z()}export{Pl as component};
//# sourceMappingURL=22.BOb39ytw.js.map
