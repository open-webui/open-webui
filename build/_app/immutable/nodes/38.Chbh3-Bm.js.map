{"version":3,"file":"38.Chbh3-Bm.js","sources":["../../../../../../src/routes/(app)/workspace/prompts/create/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { goto } from '$app/navigation';\n\timport { prompts } from '$lib/stores';\n\timport { onMount, tick, getContext } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport { createNewPrompt, getPrompts } from '$lib/apis/prompts';\n\timport PromptEditor from '$lib/components/workspace/Prompts/PromptEditor.svelte';\n\n\tlet prompt: {\n\t\ttitle: string;\n\t\tcommand: string;\n\t\tcontent: string;\n\t\taccess_control: any | null;\n\t} | null = null;\n\n\tlet clone = false;\n\n\tconst onSubmit = async (_prompt) => {\n\t\tconst res = await createNewPrompt(localStorage.token, _prompt).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\ttoast.success($i18n.t('Prompt created successfully'));\n\n\t\t\tawait prompts.set(await getPrompts(localStorage.token));\n\t\t\tawait goto('/workspace/prompts');\n\t\t}\n\t};\n\n\tonMount(async () => {\n\t\twindow.addEventListener('message', async (event) => {\n\t\t\tconsole.log(event);\n\t\t\tif (\n\t\t\t\t!['https://openwebui.com', 'https://www.openwebui.com', 'http://localhost:9999'].includes(\n\t\t\t\t\tevent.origin\n\t\t\t\t)\n\t\t\t)\n\t\t\t\treturn;\n\t\t\tconst _prompt = JSON.parse(event.data);\n\t\t\tconsole.log('Received prompt via window message:', _prompt);\n\n\t\t\tclone = true;\n\t\t\tprompt = {\n\t\t\t\ttitle: _prompt.title,\n\t\t\t\tcommand: _prompt.command,\n\t\t\t\tcontent: _prompt.content,\n\t\t\t\taccess_control: _prompt.access_control !== undefined ? _prompt.access_control : {}\n\t\t\t};\n\t\t});\n\n\t\tif (window.opener ?? false) {\n\t\t\twindow.opener.postMessage('loaded', '*');\n\t\t}\n\n\t\tif (sessionStorage.prompt) {\n\t\t\tconst _prompt = JSON.parse(sessionStorage.prompt);\n\t\t\tsessionStorage.removeItem('prompt');\n\n\t\t\tconsole.log('Received prompt via sessionStorage:', _prompt);\n\n\t\t\tclone = true;\n\t\t\tprompt = {\n\t\t\t\ttitle: _prompt.title,\n\t\t\t\tcommand: _prompt.command,\n\t\t\t\tcontent: _prompt.content,\n\t\t\t\taccess_control: _prompt.access_control !== undefined ? _prompt.access_control : {}\n\t\t\t};\n\t\t}\n\t});\n</script>\n\n{#key prompt}\n\t<PromptEditor {prompt} {onSubmit} {clone} />\n{/key}\n"],"names":["i18n","getContext","prompt","clone","onSubmit","_prompt","createNewPrompt","error","toast","$i18n","prompts","getPrompts","goto","onMount","event","$.set","$$anchor","PromptEditor"],"mappings":"khBAAA,8CAMOA,EAAOC,EAAW,MAAM,EAK1B,IAAAC,IAKO,IAAI,EAEXC,IAAQ,EAAK,QAEXC,EAAQ,MAAUC,GAAY,CAC1B,MAASC,EAAgB,aAAa,MAAOD,CAAO,EAAE,MAAOE,IACrEC,EAAM,MAAK,GAAID,CAAK,EAAA,EACb,KACP,IAGAC,EAAM,QAAQC,EAAK,EAAC,EAAE,6BAA6B,CAAA,EAE7C,MAAAC,EAAQ,IAAG,MAAOC,EAAW,aAAa,KAAK,CAAA,EAC/C,MAAAC,EAAK,oBAAoB,EAEjC,EAEAC,EAAO,SAAa,IACnB,OAAO,iBAAiB,UAAS,MAASC,GAAU,MAGhD,wBAAyB,4BAA6B,yBAAyB,SAChFA,EAAM,MAAA,EAAA,OAIF,MAAAT,EAAU,KAAK,MAAMS,EAAM,IAAI,EAGrCC,EAAAZ,EAAQ,EAAI,IACZD,EAAM,CACL,MAAOG,EAAQ,MACf,QAASA,EAAQ,QACjB,QAASA,EAAQ,QACjB,eAAgBA,EAAQ,iBAAmB,OAAYA,EAAQ,eAAc,CAAA,GAE/E,CAAC,GAEG,OAAO,QAAU,KACpB,OAAO,OAAO,YAAY,SAAU,GAAG,EAGpC,eAAe,OAAQ,CACpB,MAAAA,EAAU,KAAK,MAAM,eAAe,MAAM,EAChD,eAAe,WAAW,QAAQ,EAIlCU,EAAAZ,EAAQ,EAAI,IACZD,EAAM,CACL,MAAOG,EAAQ,MACf,QAASA,EAAQ,QACjB,QAASA,EAAQ,QACjB,eAAgBA,EAAQ,iBAAmB,OAAYA,EAAQ,eAAc,CAAA,GAE/E,CACD,CAAC,iCAGIH,CAAM,EAAAc,GAAA,CACVC,EAAYD,EAAA,uBAAEd,CAAM,GAAG,SAAAE,uBAAWD,CAAK,qBAHjC"}