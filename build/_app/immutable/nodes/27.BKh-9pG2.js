import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as ve,g as ge,o as Ee,aQ as N,j as e,m as $,f as j,c as o,r as s,k as C,aR as ne,i as d,t as _,w as g,u as ie,s as R,l as H,a as y,b as ue,q as Je,v as Le,aP as Qe,x as K,z as Se,e as We}from"../chunks/0WpKKl27.js";import{i as V}from"../chunks/Cmf4RC8y.js";import{e as Me,i as Re}from"../chunks/u5Cnd4mY.js";import{a as F,d as Ye,s as Ze}from"../chunks/CZ1y6KaE.js";import{b as de}from"../chunks/kb1CvZ3a.js";import{b as ce}from"../chunks/Bo3ZTtFv.js";import{i as fe}from"../chunks/C3k0oZ3o.js";import{a as q,s as je}from"../chunks/BVrWTcfB.js";import{t as Ge}from"../chunks/DYdr9DjX.js";import{g as Ke}from"../chunks/B5RARo22.js";import{b as Ve}from"../chunks/DLhnqOlE.js";import{b as Xe,u as et,c as tt,a as st}from"../chunks/PCOILo-8.js";import{c as at}from"../chunks/Bp8N0x0r.js";import{o as rt}from"../chunks/cX8aofVu.js";import{C as ot}from"../chunks/mfo8rR81.js";import{p as X}from"../chunks/DpN1w328.js";import{C as lt}from"../chunks/BTdOvR0T.js";import{P as it}from"../chunks/DVjsywiU.js";var nt=j('<div class="flex gap-2 group"><div class="flex items-start pt-1"><div class="px-2 py-1 text-sm font-semibold uppercase min-w-[6rem] text-left rounded-lg transition"> </div></div> <div class="flex-1"><textarea class="w-full bg-transparent outline-hidden rounded-lg p-2 text-sm resize-none overflow-hidden" rows="1"></textarea></div> <div class=" pt-1"><button class=" group-hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-300 transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path></svg></button></div></div>');function dt(P,S){ve(S,!1);const r=()=>q(z,"$i18n",E),[E,J]=je(),z=ge("i18n");let u=X(S,"message",12),T=X(S,"idx",8),L=X(S,"onDelete",8),c=$();Ee(()=>{N(c,e(c).style.height=""),N(c,e(c).style.height=e(c).scrollHeight+"px")}),fe();var m=nt(),U=o(m),A=o(U),w=o(A,!0);s(A),s(U);var B=C(U,2),f=o(B);ne(f),ce(f,p=>d(c,p),()=>e(c)),s(B);var k=C(B,2),h=o(k);s(k),s(m),_((p,v)=>{R(w,p),F(f,"id",`${ie(u()),g(()=>u().role)??""}-${T()??""}-textarea`),F(f,"placeholder",v)},[()=>(r(),ie(u()),g(()=>r().t(u().role))),()=>(r(),ie(u()),g(()=>r().t("Enter {{role}} message here",{role:u().role==="user"?r().t("a user"):r().t("an assistant")})))]),H("input",f,p=>{N(c,e(c).style.height=""),N(c,e(c).style.height=e(c).scrollHeight+"px")}),H("focus",f,p=>{N(c,e(c).style.height=""),N(c,e(c).style.height=e(c).scrollHeight+"px")}),de(f,()=>u().content,p=>u(u().content=p,!0)),H("click",h,()=>{L()()}),y(P,m),ue(),J()}var ct=j('<div class="py-3 space-y-3"></div>');function vt(P,S){ve(S,!1),ge("i18n");let r=X(S,"messages",28,()=>[]);fe();var E=ct();Me(E,5,r,Re,(J,z,u)=>{dt(J,{get message(){return e(z)},idx:u,onDelete:()=>{r(r().filter((T,L)=>L!==u))}})}),s(E),y(P,E),ue()}var gt=j('<div class=" flex-1 text-gray-500 line-clamp-1"> </div>'),ut=j('<div class="flex gap-2 justify-between items-center"><div class=" shrink-0 font-medium ml-1.5"> </div> <!> <div class="shrink-0"><button class="p-1.5 bg-transparent hover:bg-white/5 transition rounded-lg"><!></button></div></div>'),ft=j('<div slot="content"><div class="pt-1 px-1.5"><textarea class="w-full h-full bg-transparent resize-none outline-hidden text-sm" rows="4"></textarea></div></div>'),mt=j('<option class="bg-gray-50 dark:bg-gray-700"> </option>'),pt=j('<button class="px-3.5 py-1.5 text-sm font-medium disabled:bg-gray-50 dark:disabled:hover:bg-gray-850 disabled:cursor-not-allowed bg-gray-50 hover:bg-gray-100 text-gray-900 dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-gray-200 transition rounded-lg"> </button> <button class="px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-lg"> </button>',1),ht=j('<button class="px-3 py-1.5 text-sm font-medium bg-gray-300 text-black transition rounded-lg"> </button>'),xt=j('<div class=" flex flex-col justify-between w-full overflow-y-auto h-full"><div class="mx-auto w-full md:px-0 h-full relative"><div class=" flex flex-col h-full px-3.5"><div class="flex w-full items-start gap-1.5"><!></div> <div class=" pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0" id="messages-container"><div class=" h-full w-full flex flex-col"><div class="flex-1 p-1"><!></div></div></div> <div class="pb-3"><div class="border border-gray-100/30 dark:border-gray-850/30 w-full px-3 py-2.5 rounded-xl"><div class="py-0.5"><textarea class=" w-full h-full bg-transparent resize-none outline-hidden text-sm" rows="2"></textarea></div> <div class="flex justify-between flex-col sm:flex-row items-start sm:items-center gap-2 mt-2"><div class="shrink-0"><button type="button"><!></button></div> <div class="flex items-center justify-between gap-2 w-full sm:w-auto"><div class="flex-1"><select class=" bg-transparent border border-gray-100/30 dark:border-gray-850/30 rounded-lg py-1 px-2 -mx-0.5 text-sm outline-hidden w-full"></select></div> <div class="flex gap-2 shrink-0"><!></div></div></div></div></div></div></div></div>');function bt(P,S){ve(S,!1);const r=()=>q(c,"$i18n",T),E=()=>q(st,"$models",T),J=()=>q(et,"$user",T),z=()=>q(Xe,"$settings",T),u=()=>q(tt,"$config",T),[T,L]=je(),c=ge("i18n");let m=$(""),U=$(!1),A=!1,w=$(),B=$(),f=$(!1),k=$(""),h=$("user"),p=$(""),v=$([]);const me=()=>{const t=e(B);t&&(t.scrollTop=t==null?void 0:t.scrollHeight)},ze=()=>{A=!0},pe=async()=>{await K(),e(w)&&(N(w,e(w).style.height=""),N(w,e(w).style.height=Math.min(e(w).scrollHeight,555)+"px"))},Te=async()=>{var x;if(e(m)===""){Ge.error(r().t("Please select a model."));return}const t=E().find(M=>M.id===e(m));if(!t){d(m,"");return}const[l,a]=await at(localStorage.token,{model:t.id,stream:!0,messages:[e(k)?{role:"system",content:e(k)}:void 0,...e(v)].filter(M=>M)},`${Ve}/api`);let n;((x=e(v).at(-1))==null?void 0:x.role)==="assistant"?n=e(v).at(-1):(n={role:"assistant",content:""},e(v).push(n),d(v,e(v))),await K();const i=document.getElementById(`assistant-${e(v).length-1}-textarea`);if(l&&l.ok){const M=l.body.pipeThrough(new TextDecoderStream).pipeThrough(rt(`
`)).getReader();for(;;){const{value:I,done:G}=await M.read();if(G||A){A&&a.abort("User: Stop Response");break}try{let W=I.split(`
`);for(const O of W)if(O!=="")if(O==="data: [DONE]")d(v,e(v));else{let Y=JSON.parse(O.replace(/^data: /,""));if(n.content==""&&Y.choices[0].delta.content==`
`)continue;i.style.height=i.scrollHeight+"px",n.content+=Y.choices[0].delta.content??"",d(v,e(v)),i.style.height=i.scrollHeight+"px",await K()}}catch(W){}me()}}},he=async()=>{e(p)&&(e(v).push({role:e(h),content:e(p)}),d(v,e(v)),d(p,""),await K(),me())},Ne=async()=>{e(m)&&(await he(),d(U,!0),await Te(),d(U,!1),A=!1)};Ee(async()=>{var t,l,a,n,i;((t=J())==null?void 0:t.role)!=="admin"&&await Ke("/"),(l=z())!=null&&l.models?d(m,(a=z())==null?void 0:a.models[0]):(n=u())!=null&&n.default_models?d(m,(i=u())==null?void 0:i.default_models.split(",")[0]):d(m,"")}),Je(()=>e(f),()=>{e(f)&&pe()}),Le(),fe();var ee=xt(),xe=o(ee),be=o(xe),te=o(be),Pe=o(te);ot(Pe,{className:"w-full flex-1",buttonClassName:"w-full rounded-lg text-sm border border-gray-100/30 dark:border-gray-850/30 w-full py-1 px-1.5",grow:!0,get open(){return e(f)},set open(t){d(f,t)},children:(t,l)=>{var a=ut(),n=o(a),i=o(n,!0);s(n);var x=C(n,2);{var M=b=>{var le=gt(),Fe=o(le,!0);s(le),_(()=>R(Fe,e(k))),y(b,le)};V(x,b=>{e(f),e(k),g(()=>!e(f)&&e(k).trim())&&b(M)})}var I=C(x,2),G=o(I),W=o(G);{var O=b=>{lt(b,{className:"size-3.5"})},Y=b=>{it(b,{className:"size-3.5"})};V(W,b=>{e(f)?b(O):b(Y,!1)})}s(G),s(I),s(a),_(b=>R(i,b),[()=>(r(),g(()=>r().t("System Instructions")))]),y(t,a)},$$slots:{default:!0,content:(t,l)=>{var a=ft(),n=o(a),i=o(n);ne(i),ce(i,x=>d(w,x),()=>e(w)),s(n),s(a),_(x=>F(i,"placeholder",x),[()=>(r(),g(()=>r().t("You're a helpful assistant.")))]),de(i,()=>e(k),x=>d(k,x)),H("input",i,()=>{pe()}),y(t,a)}},$$legacy:!0}),s(te);var Z=C(te,2),_e=o(Z),ye=o(_e),Ue=o(ye);vt(Ue,{get messages(){return e(v)},set messages(t){d(v,t)},$$legacy:!0}),s(ye),s(_e),s(Z),ce(Z,t=>d(B,t),()=>e(B));var we=C(Z,2),ke=o(we),se=o(ke),Q=o(se);ne(Q),s(se);var $e=C(se,2),ae=o($e),D=o(ae),Ae=o(D);{var Be=t=>{var l=Se();_(a=>R(l,a),[()=>(r(),g(()=>r().t("User")))]),y(t,l)},De=t=>{var l=Se();_(a=>R(l,a),[()=>(r(),g(()=>r().t("Assistant")))]),y(t,l)};V(Ae,t=>{e(h)==="user"?t(Be):t(De,!1)})}s(D),s(ae);var Ce=C(ae,2),re=o(Ce),oe=o(re);_(()=>{e(m),Qe(()=>{E()})}),Me(oe,5,E,Re,(t,l)=>{var a=mt(),n=o(a,!0);s(a);var i={};_(()=>{R(n,(e(l),g(()=>e(l).name))),i!==(i=(e(l),g(()=>e(l).id)))&&(a.value=(a.__value=(e(l),g(()=>e(l).id)))??"")}),y(t,a)}),s(oe),s(re);var He=C(re,2),Ie=o(He);{var Oe=t=>{var l=pt(),a=We(l),n=o(a,!0);s(a);var i=C(a,2),x=o(i,!0);s(i),_((M,I)=>{a.disabled=e(p)==="",R(n,M),R(x,I)},[()=>(r(),g(()=>r().t("Add"))),()=>(r(),g(()=>r().t("Run")))]),H("click",a,()=>{he(),d(h,e(h)==="user"?"assistant":"user")}),H("click",i,()=>{Ne()}),y(t,l)},qe=t=>{var l=ht(),a=o(l,!0);s(l),_(n=>R(a,n),[()=>(r(),g(()=>r().t("Cancel")))]),H("click",l,()=>{ze()}),y(t,l)};V(Ie,t=>{e(U)?t(qe,!1):t(Oe)})}s(He),s(Ce),s($e),s(ke),s(we),s(be),s(xe),s(ee),_((t,l)=>{F(Q,"placeholder",t),Ze(D,1,`px-3.5 py-1.5 text-sm font-medium bg-gray-50 hover:bg-gray-100 text-gray-900 dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-gray-200 transition rounded-lg shrink-0 ${z(),g(()=>{var a;return((a=z())==null?void 0:a.highContrastMode)??!1?"":"outline-hidden"})??""}`),F(D,"aria-pressed",e(h)==="assistant"),F(D,"aria-label",l)},[()=>(r(),e(h),g(()=>r().t("Enter {{role}} message here",{role:e(h)==="user"?r().t("a user"):r().t("an assistant")}))),()=>(r(),e(h),g(()=>r().t(e(h)==="user"?"Switch to Assistant role":"Switch to User role")))]),de(Q,()=>e(p),t=>d(p,t)),H("input",Q,t=>{t.target.style.height="",t.target.style.height=Math.min(t.target.scrollHeight,150)+"px"}),H("focus",Q,t=>{t.target.style.height="",t.target.style.height=Math.min(t.target.scrollHeight,150)+"px"}),H("click",D,()=>{d(h,e(h)==="user"?"assistant":"user")}),Ye(oe,()=>e(m),t=>d(m,t)),y(P,ee),ue(),L()}function It(P){bt(P,{})}export{It as component};
//# sourceMappingURL=27.BKh-9pG2.js.map
