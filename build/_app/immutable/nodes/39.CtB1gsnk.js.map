{"version":3,"file":"39.CtB1gsnk.js","sources":["../../../../../../src/routes/(app)/workspace/prompts/edit/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { goto } from '$app/navigation';\n\timport { prompts } from '$lib/stores';\n\timport { onMount, tick, getContext } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport { getPromptByCommand, getPrompts, updatePromptByCommand } from '$lib/apis/prompts';\n\timport { page } from '$app/stores';\n\n\timport PromptEditor from '$lib/components/workspace/Prompts/PromptEditor.svelte';\n\n\tlet prompt = null;\n\tlet disabled = false;\n\n\tconst onSubmit = async (_prompt) => {\n\t\tconsole.log(_prompt);\n\t\tconst prompt = await updatePromptByCommand(localStorage.token, _prompt).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (prompt) {\n\t\t\ttoast.success($i18n.t('Prompt updated successfully'));\n\t\t\tawait prompts.set(await getPrompts(localStorage.token));\n\t\t\tawait goto('/workspace/prompts');\n\t\t}\n\t};\n\n\tonMount(async () => {\n\t\tconst command = $page.url.searchParams.get('command');\n\t\tif (command) {\n\t\t\tconst _prompt = await getPromptByCommand(\n\t\t\t\tlocalStorage.token,\n\t\t\t\tcommand.replace(/\\//g, '')\n\t\t\t).catch((error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t});\n\n\t\t\tif (_prompt) {\n\t\t\t\tdisabled = !_prompt.write_access ?? true;\n\t\t\t\tprompt = {\n\t\t\t\t\ttitle: _prompt.title,\n\t\t\t\t\tcommand: _prompt.command,\n\t\t\t\t\tcontent: _prompt.content,\n\t\t\t\t\taccess_control: _prompt?.access_control === undefined ? {} : _prompt?.access_control\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tgoto('/workspace/prompts');\n\t\t\t}\n\t\t} else {\n\t\t\tgoto('/workspace/prompts');\n\t\t}\n\t});\n</script>\n\n{#if prompt}\n\t<PromptEditor {prompt} {onSubmit} {disabled} edit />\n{/if}\n"],"names":["i18n","getContext","prompt","disabled","onSubmit","_prompt","updatePromptByCommand","error","toast","$i18n","prompts","getPrompts","goto","onMount","command","$page","getPromptByCommand","$.set","PromptEditor","$$anchor","$$render","consequent"],"mappings":"8jBAAA,mEAMOA,EAAOC,EAAW,MAAM,EAO1B,IAAAC,IAAS,IAAI,EACbC,IAAW,EAAK,QAEdC,EAAQ,MAAUC,GAAY,CAEvB,MAASC,EAAsB,aAAa,MAAOD,CAAO,EAAE,MAAOE,IAC9EC,EAAM,MAAK,GAAID,CAAK,EAAA,EACb,KACP,IAGAC,EAAM,QAAQC,EAAK,EAAC,EAAE,6BAA6B,CAAA,EAC7C,MAAAC,EAAQ,IAAG,MAAOC,EAAW,aAAa,KAAK,CAAA,EAC/C,MAAAC,EAAK,oBAAoB,EAEjC,EAEAC,EAAO,SAAa,OACbC,EAAUC,EAAK,EAAC,IAAI,aAAa,IAAI,SAAS,EAChD,GAAAD,EAAS,CACN,MAAAT,QAAgBW,EACrB,aAAa,MACbF,EAAQ,QAAQ,MAAO,EAAE,GACxB,MAAOP,IACRC,EAAM,MAAK,GAAID,CAAK,EAAA,EACb,KACP,EAEGF,GACHY,EAAAd,EAAQ,CAAIE,EAAQ,YAAoB,IACxCH,EAAM,CACL,MAAOG,EAAQ,MACf,QAASA,EAAQ,QACjB,QAASA,EAAQ,QACjB,gBAAgBA,GAAA,YAAAA,EAAS,kBAAmB,OAAS,CAAA,EAAQA,GAAA,YAAAA,EAAS,kBAGvEO,EAAK,oBAAoB,CAE3B,MACCA,EAAK,oBAAoB,CAE3B,CAAC,kCAIAM,EAAYC,EAAA,uBAAEjB,CAAM,GAAG,SAAAE,0BAAWD,CAAQ,wBADvCD,CAAM,GAAAkB,EAAAC,CAAA,kBAFH"}