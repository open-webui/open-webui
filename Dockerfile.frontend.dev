# Frontend Development Dockerfile - Hot Reload with Vite
FROM node:22-alpine3.20

WORKDIR /app

# Set Node.js memory limit for development
ENV NODE_OPTIONS="--max-old-space-size=4096"

# Install dependencies first (better Docker layer caching)
COPY package.json package-lock.json ./
# Use legacy-peer-deps to match how the lock file was generated
RUN npm ci --force --legacy-peer-deps

# Copy source code for hot reload development
COPY . .

# Expose Vite dev server port
EXPOSE 5173

# Configure Vite for Docker hot reload
ENV VITE_HOST=0.0.0.0

# Start Vite dev server with hot module replacement
CMD ["npm", "run", "dev:docker"]