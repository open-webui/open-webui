{"version":3,"file":"27.DxPy7nGt.js","sources":["../../../../../../src/routes/(app)/workspace/models/create/+page.svelte"],"sourcesContent":["<script>\n\timport { v4 as uuidv4 } from 'uuid';\n\timport { toast } from 'svelte-sonner';\n\timport { goto } from '$app/navigation';\n\timport { config, models, settings } from '$lib/stores';\n\n\timport { onMount, tick, getContext } from 'svelte';\n\timport { createNewModel, getModelById } from '$lib/apis/models';\n\timport { getModels } from '$lib/apis';\n\n\timport ModelEditor from '$lib/components/workspace/Models/ModelEditor.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\tconst onSubmit = async (modelInfo) => {\n\t\tif ($models.find((m) => m.id === modelInfo.id)) {\n\t\t\ttoast.error(\n\t\t\t\t`Error: A model with the ID '${modelInfo.id}' already exists. Please select a different ID to proceed.`\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tif (modelInfo.id === '') {\n\t\t\ttoast.error('Error: Model ID cannot be empty. Please enter a valid ID to proceed.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (modelInfo) {\n\t\t\tconst res = await createNewModel(localStorage.token, {\n\t\t\t\t...modelInfo,\n\t\t\t\tmeta: {\n\t\t\t\t\t...modelInfo.meta,\n\t\t\t\t\tprofile_image_url: modelInfo.meta.profile_image_url ?? '/static/favicon.png',\n\t\t\t\t\tsuggestion_prompts: modelInfo.meta.suggestion_prompts\n\t\t\t\t\t\t? modelInfo.meta.suggestion_prompts.filter((prompt) => prompt.content !== '')\n\t\t\t\t\t\t: null\n\t\t\t\t},\n\t\t\t\tparams: { ...modelInfo.params }\n\t\t\t}).catch((error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t});\n\n\t\t\tif (res) {\n\t\t\t\tawait models.set(\n\t\t\t\t\tawait getModels(\n\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t$config?.features?.enable_direct_connections && ($settings?.directConnections ?? null)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\ttoast.success($i18n.t('Model created successfully!'));\n\t\t\t\tawait goto('/workspace/models');\n\t\t\t}\n\t\t}\n\t};\n\n\tlet model = null;\n\n\tonMount(async () => {\n\t\twindow.addEventListener('message', async (event) => {\n\t\t\tif (\n\t\t\t\t!['https://openwebui.com', 'https://www.openwebui.com', 'http://localhost:5173'].includes(\n\t\t\t\t\tevent.origin\n\t\t\t\t)\n\t\t\t)\n\t\t\t\treturn;\n\t\t\tmodel = JSON.parse(event.data);\n\t\t});\n\n\t\tif (window.opener ?? false) {\n\t\t\twindow.opener.postMessage('loaded', '*');\n\t\t}\n\n\t\tif (sessionStorage.model) {\n\t\t\tmodel = JSON.parse(sessionStorage.model);\n\t\t\tsessionStorage.removeItem('model');\n\t\t}\n\t});\n</script>\n\n{#key model}\n\t<ModelEditor {model} {onSubmit} />\n{/key}\n"],"names":["ctx","i18n","getContext","onSubmit","modelInfo","$models","m","toast","createNewModel","prompt","error","models","getModels","_a","$config","$settings","$i18n","goto","model","onMount","event","$$invalidate"],"mappings":"20BAgFMA,EAAK,CAAA,2GAALA,EAAK,CAAA,CAAA,iOApEJC,EAAOC,EAAW,MAAM,qBAExB,MAAAC,QAAkBC,GAAS,UAC5BC,EAAQ,KAAMC,GAAMA,EAAE,KAAOF,EAAU,EAAE,EAAA,CAC5CG,EAAM,MAC0B,+BAAAH,EAAU,EAAE,4DAAA,YAKzCA,EAAU,KAAO,GAAE,CACtBG,EAAM,MAAM,sEAAsE,SAI/EH,GACe,MAAAI,EAAe,aAAa,MAAK,IAC/CJ,EACH,KAAI,CACA,GAAAA,EAAU,KACb,kBAAmBA,EAAU,KAAK,mBAAqB,sBACvD,mBAAoBA,EAAU,KAAK,mBAChCA,EAAU,KAAK,mBAAmB,OAAQK,GAAWA,EAAO,UAAY,EAAE,EAC1E,MAEJ,OAAM,CAAA,GAAOL,EAAU,MAAM,CAC3B,CAAA,EAAA,MAAOM,IACTH,EAAM,MAAK,GAAIG,CAAK,EAAA,EACb,SAID,MAAAC,EAAO,IAAG,MACTC,EACL,aAAa,QACbC,EAAAC,GAAA,YAAAA,EAAS,WAAT,YAAAD,EAAmB,8BAA8BE,GAAA,YAAAA,EAAW,oBAAqB,KAAI,CAAA,EAGvFR,EAAM,QAAQS,EAAM,EAAE,6BAA6B,CAAA,EAC7C,MAAAC,EAAK,mBAAmB,IAK7B,IAAAC,EAAQ,KAEZ,OAAAC,EAAO,SAAA,CACN,OAAO,iBAAiB,gBAAkBC,GAAK,EAE3C,wBAAyB,4BAA6B,yBAAyB,SAChFA,EAAM,MAAA,GAIRC,EAAA,EAAAH,EAAQ,KAAK,MAAME,EAAM,IAAI,CAAA,KAG1B,OAAO,QAAU,KACpB,OAAO,OAAO,YAAY,SAAU,GAAG,EAGpC,eAAe,QAClBC,EAAA,EAAAH,EAAQ,KAAK,MAAM,eAAe,KAAK,CAAA,EACvC,eAAe,WAAW,OAAO"}