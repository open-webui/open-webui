{"version":3,"file":"PromptEditor.SxSLm8xO.js","sources":["../../../../../../src/lib/components/workspace/Prompts/PromptEditor.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { onMount, tick, getContext } from 'svelte';\n\n\timport Textarea from '$lib/components/common/Textarea.svelte';\n\timport { toast } from 'svelte-sonner';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport AccessControl from '../common/AccessControl.svelte';\n\timport LockClosed from '$lib/components/icons/LockClosed.svelte';\n\timport AccessControlModal from '../common/AccessControlModal.svelte';\n\n\texport let onSubmit: Function;\n\texport let edit = false;\n\texport let prompt = null;\n\n\tconst i18n = getContext('i18n');\n\n\tlet loading = false;\n\n\tlet title = '';\n\tlet command = '';\n\tlet content = '';\n\n\tlet accessControl = null;\n\n\tlet showAccessControlModal = false;\n\n\t$: if (!edit) {\n\t\tcommand = title !== '' ? `${title.replace(/\\s+/g, '-').toLowerCase()}` : '';\n\t}\n\n\tconst submitHandler = async () => {\n\t\tloading = true;\n\n\t\tif (validateCommandString(command)) {\n\t\t\tawait onSubmit({\n\t\t\t\ttitle,\n\t\t\t\tcommand,\n\t\t\t\tcontent,\n\t\t\t\taccess_control: accessControl\n\t\t\t});\n\t\t} else {\n\t\t\ttoast.error(\n\t\t\t\t$i18n.t('Only alphanumeric characters and hyphens are allowed in the command string.')\n\t\t\t);\n\t\t}\n\n\t\tloading = false;\n\t};\n\n\tconst validateCommandString = (inputString) => {\n\t\t// Regular expression to match only alphanumeric characters and hyphen\n\t\tconst regex = /^[a-zA-Z0-9-]+$/;\n\n\t\t// Test the input string against the regular expression\n\t\treturn regex.test(inputString);\n\t};\n\n\tonMount(async () => {\n\t\tif (prompt) {\n\t\t\ttitle = prompt.title;\n\t\t\tawait tick();\n\n\t\t\tcommand = prompt.command.at(0) === '/' ? prompt.command.slice(1) : prompt.command;\n\t\t\tcontent = prompt.content;\n\n\t\t\taccessControl = prompt?.access_control ?? null;\n\t\t}\n\t});\n</script>\n\n<AccessControlModal\n\tbind:show={showAccessControlModal}\n\tbind:accessControl\n\taccessRoles={['read', 'write']}\n/>\n\n<div class=\"w-full max-h-full flex justify-center\">\n\t<form\n\t\tclass=\"flex flex-col w-full mb-10\"\n\t\ton:submit|preventDefault={() => {\n\t\t\tsubmitHandler();\n\t\t}}\n\t>\n\t\t<div class=\"my-2\">\n\t\t\t<Tooltip\n\t\t\t\tcontent={`${$i18n.t('Only alphanumeric characters and hyphens are allowed')} - ${$i18n.t(\n\t\t\t\t\t'Activate this command by typing \"/{{COMMAND}}\" to chat input.',\n\t\t\t\t\t{\n\t\t\t\t\t\tCOMMAND: command\n\t\t\t\t\t}\n\t\t\t\t)}`}\n\t\t\t\tplacement=\"bottom-start\"\n\t\t\t>\n\t\t\t\t<div class=\"flex flex-col w-full\">\n\t\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclass=\"text-2xl font-semibold w-full bg-transparent outline-none\"\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Title')}\n\t\t\t\t\t\t\tbind:value={title}\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<div class=\"self-center flex-shrink-0\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"bg-gray-50 hover:bg-gray-100 text-black dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-white transition px-2 py-1 rounded-full flex gap-1 items-center\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tshowAccessControlModal = true;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<LockClosed strokeWidth=\"2.5\" className=\"size-3.5\" />\n\n\t\t\t\t\t\t\t\t<div class=\"text-sm font-medium flex-shrink-0\">\n\t\t\t\t\t\t\t\t\t{$i18n.t('Access')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex gap-0.5 items-center text-xs text-gray-500\">\n\t\t\t\t\t\t<div class=\"\">/</div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclass=\" w-full bg-transparent outline-none\"\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Command')}\n\t\t\t\t\t\t\tbind:value={command}\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\tdisabled={edit}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Tooltip>\n\t\t</div>\n\n\t\t<div class=\"my-2\">\n\t\t\t<div class=\"flex w-full justify-between\">\n\t\t\t\t<div class=\" self-center text-sm font-semibold\">{$i18n.t('Prompt Content')}</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"mt-2\">\n\t\t\t\t<div>\n\t\t\t\t\t<Textarea\n\t\t\t\t\t\tclassName=\"text-sm w-full bg-transparent outline-none overflow-y-hidden resize-none\"\n\t\t\t\t\t\tplaceholder={$i18n.t('Write a summary in 50 words that summarizes [topic or keyword].')}\n\t\t\t\t\t\tbind:value={content}\n\t\t\t\t\t\trows={6}\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"text-xs text-gray-400 dark:text-gray-500\">\n\t\t\t\t\tâ“˜ {$i18n.t('Format your variables using brackets like this:')}&nbsp;<span\n\t\t\t\t\t\tclass=\" text-gray-600 dark:text-gray-300 font-medium\"\n\t\t\t\t\t\t>{'{{'}{$i18n.t('variable')}{'}}'}</span\n\t\t\t\t\t>.\n\t\t\t\t\t{$i18n.t('Make sure to enclose them with')}\n\t\t\t\t\t<span class=\" text-gray-600 dark:text-gray-300 font-medium\">{'{{'}</span>\n\t\t\t\t\t{$i18n.t('and')}\n\t\t\t\t\t<span class=\" text-gray-600 dark:text-gray-300 font-medium\">{'}}'}</span>.\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"text-xs text-gray-400 dark:text-gray-500\">\n\t\t\t\t\t{$i18n.t('Utilize')}<span class=\" text-gray-600 dark:text-gray-300 font-medium\">\n\t\t\t\t\t\t{` {{CLIPBOARD}}`}</span\n\t\t\t\t\t>\n\t\t\t\t\t{$i18n.t('variable to have them replaced with clipboard content.')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"my-4 flex justify-end pb-20\">\n\t\t\t<button\n\t\t\t\tclass=\" text-sm w-full lg:w-fit px-4 py-2 transition rounded-lg {loading\n\t\t\t\t\t? ' cursor-not-allowed bg-black hover:bg-gray-900 text-white dark:bg-white dark:hover:bg-gray-100 dark:text-black'\n\t\t\t\t\t: 'bg-black hover:bg-gray-900 text-white dark:bg-white dark:hover:bg-gray-100 dark:text-black'} flex w-full justify-center\"\n\t\t\t\ttype=\"submit\"\n\t\t\t\tdisabled={loading}\n\t\t\t>\n\t\t\t\t<div class=\" self-center font-medium\">{$i18n.t('Save & Create')}</div>\n\n\t\t\t\t{#if loading}\n\t\t\t\t\t<div class=\"ml-1.5 self-center\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\tclass=\" w-4 h-4\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t><style>\n\t\t\t\t\t\t\t\t.spinner_ajPY {\n\t\t\t\t\t\t\t\t\ttransform-origin: center;\n\t\t\t\t\t\t\t\t\tanimation: spinner_AtaB 0.75s infinite linear;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t@keyframes spinner_AtaB {\n\t\t\t\t\t\t\t\t\t100% {\n\t\t\t\t\t\t\t\t\t\ttransform: rotate(360deg);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</style><path\n\t\t\t\t\t\t\t\td=\"M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z\"\n\t\t\t\t\t\t\t\topacity=\".25\"\n\t\t\t\t\t\t\t/><path\n\t\t\t\t\t\t\t\td=\"M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z\"\n\t\t\t\t\t\t\t\tclass=\"spinner_ajPY\"\n\t\t\t\t\t\t\t/></svg\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</button>\n\t\t</div>\n\t</form>\n</div>\n"],"names":["ctx","insert_hydration","target","div5","anchor","append_hydration","div2","input0","div1","button","div0","div4","div3","input1","set_data","t2","t2_value","div","accesscontrolmodal_props","create_if_block","attr","button_class_value","div10","form","div7","div6","span0","span1","span2","span3","div9","div8","dirty","tooltip_changes","t6","t6_value","t9","t9_value","t12","t12_value","t16","t16_value","t21","t21_value","t24","t24_value","t26","t26_value","current","onSubmit","$$props","edit","prompt","i18n","getContext","loading","title","command","content","accessControl","showAccessControlModal","submitHandler","validateCommandString","toast","$i18n","inputString","onMount","$$invalidate","tick","value"],"mappings":"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"}