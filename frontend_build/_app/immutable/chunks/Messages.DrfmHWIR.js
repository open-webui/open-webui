var qr=Object.defineProperty;var Fr=(n,e,t)=>e in n?qr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var vt=(n,e,t)=>Fr(n,typeof e!="symbol"?e+"":e,t);import{s as De,e as I,k as A,c as E,a as k,d as m,o as H,f as d,i as N,g as v,n as ve,t as W,b as U,N as Pe,C as nt,u as ge,h as G,Q as Ue,H as et,j as Ie,p as qe,B as gt,q as bt,y as We,A as Ye,r as Jr,v as Gr,w as Zr,x as Kr,E as be,F as ke,l as fe,S as St,D as Ne,M as Qr,an as fl,T as Ot,P as Tt,ai as Xr,aj as Yr}from"./scheduler.CRl-z1y4.js";import{S as Te,i as Be,b as X,d as Y,m as $,t as b,a as M,e as x,f as $e,g as ee,c as te,h as Bt}from"./index.Ci9MLlfz.js";import{e as Ee,u as Gt,o as yr,d as $r}from"./each.Cd7EUOR7.js";import{m as At,d as ul,i as Ir,h as xr,G as en,H as tn,a as Ht,c as Er,T as cl,u as zt,e as Lt,W as ln,b as dl,l as sn,z as hl,B as rn}from"./index.iZ7GkiWf.js";import{t as Le}from"./Toaster.svelte_svelte_type_style_lang.CQ9dEDgo.js";import{f as nn,u as on,i as an}from"./index.BVXN1SfG.js";import{b as Jt,m as Mr,x as fn,f as pt,t as Pt,l as Nr,v as ml}from"./index.DD5gL1tX.js";import{d as it}from"./relativeTime.BDz4fsXT.js";import{b as gl,c as un}from"./index.BOlNDaqn.js";import{n as cn}from"./index.BPZ_ALe6.js";import{s as dn}from"./index.CXWwS1xV.js";import{i as hn}from"./index.CM-D7NG_.js";import{ai as mn,ag as yt,af as Dr,ae as Zt,ah as Vr}from"./Markdown.DIm7mEBt.js";import{T as Re}from"./Tooltip.DuavYtFf.js";import{T as gn}from"./Tags.Dr9qGsTG.js";import{S as Wt}from"./Spinner.B5qNQZjw.js";import{C as Cr}from"./ChevronDown.WCB6d4qr.js";import{C as Tr}from"./ChevronUp.CCExq5gH.js";import{M as _n}from"./MagnifyingGlass.CZ4ONnAz.js";import{C as Br}from"./Collapsible.an7Zv-qh.js";import{I as vn,F as pn}from"./FileItem.Lzieq5vp.js";import{M as Rr}from"./Modal.DNebWnXQ.js";import{B as Kt}from"./Badge.C9HRfTMB.js";import{C as bn}from"./Check.q_8z9jb-.js";import{X as kn}from"./XMark.DKXpQqi-.js";import{E as wn}from"./EllipsisHorizontal.f3ex1JiB.js";import{m as jt}from"./marked.esm._0_gBwjO.js";import{c as _l}from"./index.C1J9xu5V.js";import{L as yn}from"./Loader.Bw4xRnol.js";import{f as Rt}from"./index.JHD1JQaA.js";import{F as In}from"./fuse.CU2r43ac.js";function En(n){return new Worker(""+new URL("../workers/kokoro.worker-Cev3ZHQt.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class Mn{constructor(e="fp32"){vt(this,"worker",null);vt(this,"initialized",!1);vt(this,"dtype");vt(this,"requestQueue",[]);vt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new En,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function Nn(n){let e,t,l,s,r,i,o,a,f,u,h,c,g,_,D,p,y,w,R,B,O,V,L,S,C,T;return{c(){e=I("div"),t=I("div"),l=I("div"),s=I("div"),i=A(),o=I("div"),a=I("div"),u=A(),h=I("div"),g=A(),_=I("div"),D=I("div"),y=A(),w=I("div"),B=A(),O=I("div"),L=A(),S=I("div"),this.h()},l(j){e=E(j,"DIV",{class:!0});var q=k(e);t=E(q,"DIV",{class:!0});var ae=k(t);l=E(ae,"DIV",{class:!0});var ie=k(l);s=E(ie,"DIV",{class:!0}),k(s).forEach(m),i=H(ie),o=E(ie,"DIV",{class:!0});var se=k(o);a=E(se,"DIV",{class:!0}),k(a).forEach(m),u=H(se),h=E(se,"DIV",{class:!0}),k(h).forEach(m),se.forEach(m),g=H(ie),_=E(ie,"DIV",{class:!0});var oe=k(_);D=E(oe,"DIV",{class:!0}),k(D).forEach(m),y=H(oe),w=E(oe,"DIV",{class:!0}),k(w).forEach(m),B=H(oe),O=E(oe,"DIV",{class:!0}),k(O).forEach(m),oe.forEach(m),L=H(ie),S=E(ie,"DIV",{class:!0}),k(S).forEach(m),ie.forEach(m),ae.forEach(m),q.forEach(m),this.h()},h(){d(s,"class",r=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded mr-14"),d(a,"class",f=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2"),d(h,"class",c=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1"),d(o,"class","grid grid-cols-3 gap-4"),d(D,"class",p=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1"),d(w,"class",R=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2"),d(O,"class",V=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1 mr-4"),d(_,"class","grid grid-cols-4 gap-4"),d(S,"class",C=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded"),d(l,"class",T=(n[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),d(t,"class","animate-pulse flex w-full"),d(e,"class","w-full mt-2 mb-2")},m(j,q){N(j,e,q),v(e,t),v(t,l),v(l,s),v(l,i),v(l,o),v(o,a),v(o,u),v(o,h),v(l,g),v(l,_),v(_,D),v(_,y),v(_,w),v(_,B),v(_,O),v(l,L),v(l,S)},p(j,[q]){q&1&&r!==(r=(j[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded mr-14")&&d(s,"class",r),q&1&&f!==(f=(j[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2")&&d(a,"class",f),q&1&&c!==(c=(j[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1")&&d(h,"class",c),q&1&&p!==(p=(j[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1")&&d(D,"class",p),q&1&&R!==(R=(j[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2")&&d(w,"class",R),q&1&&V!==(V=(j[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1 mr-4")&&d(O,"class",V),q&1&&C!==(C=(j[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded")&&d(S,"class",C),q&1&&T!==(T=(j[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&d(l,"class",T)},i:ve,o:ve,d(j){j&&m(e)}}}function Dn(n,e,t){let{size:l="md"}=e;return n.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class Qt extends Te{constructor(e){super(),Be(this,e,Dn,Nn,De,{size:0})}}function vl(n,e,t){const l=n.slice();return l[23]=e[t],l}function pl(n,e,t){const l=n.slice();return l[26]=e[t],l}function bl(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=k(e);l=U(i,t),i.forEach(m),this.h()},h(){d(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){N(r,e,i),v(e,l)},p(r,i){var o;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((o=r[7])==null?void 0:o.name)??r[7].id:r[1].selectedModelId})+"")&&G(l,t)},d(r){r&&m(e)}}}function kl(n){let e,t=n[26]+"",l,s,r,i,o,a;function f(){return n[12](n[26])}return{c(){e=I("button"),l=W(t),s=A(),this.h()},l(u){e=E(u,"BUTTON",{class:!0});var h=k(e);l=U(h,t),s=H(h),h.forEach(m),this.h()},h(){var u,h;d(e,"class",r="size-7 text-sm border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white disabled:dark:bg-gray-900"),e.disabled=i=((h=(u=n[1])==null?void 0:u.annotation)==null?void 0:h.rating)===-1?n[26]>5:n[26]<6},m(u,h){N(u,e,h),v(e,l),v(e,s),o||(a=ge(e,"click",f),o=!0)},p(u,h){var c,g;n=u,h&64&&r!==(r="size-7 text-sm border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white disabled:dark:bg-gray-900")&&d(e,"class",r),h&2&&i!==(i=((g=(c=n[1])==null?void 0:c.annotation)==null?void 0:g.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&m(e),o=!1,a()}}}function wl(n){let e,t=n[8].t("Why?")+"",l,s,r,i=Ee(n[3]),o=[];for(let a=0;a<i.length;a+=1)o[a]=yl(vl(n,i,a));return{c(){e=I("div"),l=W(t),s=A(),r=I("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=E(a,"DIV",{class:!0});var f=k(e);l=U(f,t),f.forEach(m),s=H(a),r=E(a,"DIV",{class:!0});var u=k(r);for(let h=0;h<o.length;h+=1)o[h].l(u);u.forEach(m),this.h()},h(){d(e,"class","text-sm mt-1.5 font-medium"),d(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(a,f){N(a,e,f),v(e,l),N(a,s,f),N(a,r,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f&256&&t!==(t=a[8].t("Why?")+"")&&G(l,t),f&280){i=Ee(a[3]);let u;for(u=0;u<i.length;u+=1){const h=vl(a,i,u);o[u]?o[u].p(h,f):(o[u]=yl(h),o[u].c(),o[u].m(r,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&(m(e),m(s),m(r)),Ue(o,a)}}}function Vn(n){let e=n[23]+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&G(t,e)},d(l){l&&m(t)}}}function Cn(n){let e=n[8].t("Other")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&G(t,e)},d(l){l&&m(t)}}}function Tn(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&G(t,e)},d(l){l&&m(t)}}}function Bn(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&G(t,e)},d(l){l&&m(t)}}}function Rn(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&G(t,e)},d(l){l&&m(t)}}}function Sn(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&G(t,e)},d(l){l&&m(t)}}}function On(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&G(t,e)},d(l){l&&m(t)}}}function Ln(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&G(t,e)},d(l){l&&m(t)}}}function Pn(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&G(t,e)},d(l){l&&m(t)}}}function jn(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&G(t,e)},d(l){l&&m(t)}}}function An(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&G(t,e)},d(l){l&&m(t)}}}function Hn(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&G(t,e)},d(l){l&&m(t)}}}function zn(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&G(t,e)},d(l){l&&m(t)}}}function Wn(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&G(t,e)},d(l){l&&m(t)}}}function Un(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&G(t,e)},d(l){l&&m(t)}}}function yl(n){let e,t,l,s,r;function i(u,h){return u[23]==="accurate_information"?Un:u[23]==="followed_instructions_perfectly"?Wn:u[23]==="showcased_creativity"?zn:u[23]==="positive_attitude"?Hn:u[23]==="attention_to_detail"?An:u[23]==="thorough_explanation"?jn:u[23]==="dont_like_the_style"?Pn:u[23]==="too_verbose"?Ln:u[23]==="not_helpful"?On:u[23]==="not_factually_correct"?Sn:u[23]==="didnt_fully_follow_instructions"?Rn:u[23]==="refused_when_it_shouldnt_have"?Bn:u[23]==="being_lazy"?Tn:u[23]==="other"?Cn:Vn}let o=i(n),a=o(n);function f(){return n[13](n[23])}return{c(){e=I("button"),a.c(),t=A(),this.h()},l(u){e=E(u,"BUTTON",{class:!0});var h=k(e);a.l(h),t=H(h),h.forEach(m),this.h()},h(){d(e,"class",l="px-3 py-0.5 border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,h){N(u,e,h),a.m(e,null),v(e,t),s||(r=ge(e,"click",f),s=!0)},p(u,h){n=u,o===(o=i(n))&&a?a.p(n,h):(a.d(1),a=o(n),a&&(a.c(),a.m(e,t))),h&24&&l!==(l="px-3 py-0.5 border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&d(e,"class",l)},d(u){u&&m(e),a.d(),s=!1,r()}}}function qn(n){var ce;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,o,a,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,h,c,g,_,D,p,y,w=n[8].t("Awful")+"",R,B,O,V,L=n[8].t("Amazing")+"",S,C,T,j,q,ae,ie,se,oe,J,le,me,_e,Z=n[8].t("Save")+"",z,ue,re,Q,P,K=((ce=n[1])==null?void 0:ce.arena)&&bl(n),he=Ee(Array.from({length:10}).map(Il)),de=[];for(let ne=0;ne<he.length;ne+=1)de[ne]=kl(pl(n,he,ne));let we=n[3].length>0&&wl(n);return le=new gn({props:{tags:n[2]}}),le.$on("delete",n[15]),le.$on("add",n[16]),{c(){K&&K.c(),e=A(),t=I("div"),l=I("div"),s=I("div"),i=W(r),o=A(),a=I("button"),a.innerHTML=f,u=A(),h=I("div"),c=I("div"),g=I("div");for(let ne=0;ne<de.length;ne+=1)de[ne].c();_=A(),D=I("div"),p=I("div"),y=W("1 - "),R=W(w),B=A(),O=I("div"),V=W("10 - "),S=W(L),C=A(),T=I("div"),we&&we.c(),j=A(),q=I("div"),ae=I("textarea"),se=A(),oe=I("div"),J=I("div"),X(le.$$.fragment),me=A(),_e=I("button"),z=W(Z),this.h()},l(ne){K&&K.l(ne),e=H(ne),t=E(ne,"DIV",{class:!0,id:!0});var pe=k(t);l=E(pe,"DIV",{class:!0});var Ve=k(l);s=E(Ve,"DIV",{class:!0});var je=k(s);i=U(je,r),je.forEach(m),o=H(Ve),a=E(Ve,"BUTTON",{"data-svelte-h":!0}),Pe(a)!=="svelte-1ew22ui"&&(a.innerHTML=f),Ve.forEach(m),u=H(pe),h=E(pe,"DIV",{class:!0});var Ce=k(h);c=E(Ce,"DIV",{class:!0});var Ae=k(c);g=E(Ae,"DIV",{class:!0});var He=k(g);for(let st=0;st<de.length;st+=1)de[st].l(He);He.forEach(m),_=H(Ae),D=E(Ae,"DIV",{class:!0});var Fe=k(D);p=E(Fe,"DIV",{});var tt=k(p);y=U(tt,"1 - "),R=U(tt,w),tt.forEach(m),B=H(Fe),O=E(Fe,"DIV",{});var lt=k(O);V=U(lt,"10 - "),S=U(lt,L),lt.forEach(m),Fe.forEach(m),Ae.forEach(m),Ce.forEach(m),C=H(pe),T=E(pe,"DIV",{});var ot=k(T);we&&we.l(ot),ot.forEach(m),j=H(pe),q=E(pe,"DIV",{class:!0});var at=k(q);ae=E(at,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),k(ae).forEach(m),at.forEach(m),se=H(pe),oe=E(pe,"DIV",{class:!0});var xe=k(oe);J=E(xe,"DIV",{class:!0});var ft=k(J);Y(le.$$.fragment,ft),ft.forEach(m),me=H(xe),_e=E(xe,"BUTTON",{class:!0});var ut=k(_e);z=U(ut,Z),ut.forEach(m),xe.forEach(m),pe.forEach(m),this.h()},h(){d(s,"class","text-sm font-medium"),d(l,"class","flex justify-between items-center"),d(g,"class","mt-1.5 w-fit flex gap-1 pb-5"),d(D,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),d(c,"class","relative w-fit"),d(h,"class","w-full flex justify-center"),d(ae,"class","w-full text-sm px-1 py-2 bg-transparent outline-none resize-none rounded-xl"),d(ae,"placeholder",ie=n[8].t("Feel free to add specific details")),d(ae,"rows","3"),d(q,"class","mt-2"),d(J,"class","flex items-end group"),d(_e,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(oe,"class","mt-2 gap-1.5 flex justify-between"),d(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-50 dark:border-gray-850"),d(t,"id",ue="message-feedback-"+n[1].id)},m(ne,pe){K&&K.m(ne,pe),N(ne,e,pe),N(ne,t,pe),v(t,l),v(l,s),v(s,i),v(l,o),v(l,a),v(t,u),v(t,h),v(h,c),v(c,g);for(let Ve=0;Ve<de.length;Ve+=1)de[Ve]&&de[Ve].m(g,null);v(c,_),v(c,D),v(D,p),v(p,y),v(p,R),v(D,B),v(D,O),v(O,V),v(O,S),v(t,C),v(t,T),we&&we.m(T,null),v(t,j),v(t,q),v(q,ae),nt(ae,n[5]),v(t,se),v(t,oe),v(oe,J),$(le,J,null),v(oe,me),v(oe,_e),v(_e,z),re=!0,Q||(P=[ge(a,"click",n[11]),ge(ae,"input",n[14]),ge(_e,"click",n[17])],Q=!0)},p(ne,[pe]){var je;if((je=ne[1])!=null&&je.arena?K?K.p(ne,pe):(K=bl(ne),K.c(),K.m(e.parentNode,e)):K&&(K.d(1),K=null),(!re||pe&256)&&r!==(r=ne[8].t("How would you rate this response?")+"")&&G(i,r),pe&66){he=Ee(Array.from({length:10}).map(Il));let Ce;for(Ce=0;Ce<he.length;Ce+=1){const Ae=pl(ne,he,Ce);de[Ce]?de[Ce].p(Ae,pe):(de[Ce]=kl(Ae),de[Ce].c(),de[Ce].m(g,null))}for(;Ce<de.length;Ce+=1)de[Ce].d(1);de.length=he.length}(!re||pe&256)&&w!==(w=ne[8].t("Awful")+"")&&G(R,w),(!re||pe&256)&&L!==(L=ne[8].t("Amazing")+"")&&G(S,L),ne[3].length>0?we?we.p(ne,pe):(we=wl(ne),we.c(),we.m(T,null)):we&&(we.d(1),we=null),(!re||pe&256&&ie!==(ie=ne[8].t("Feel free to add specific details")))&&d(ae,"placeholder",ie),pe&32&&nt(ae,ne[5]);const Ve={};pe&4&&(Ve.tags=ne[2]),le.$set(Ve),(!re||pe&256)&&Z!==(Z=ne[8].t("Save")+"")&&G(z,Z),(!re||pe&2&&ue!==(ue="message-feedback-"+ne[1].id))&&d(t,"id",ue)},i(ne){re||(b(le.$$.fragment,ne),re=!0)},o(ne){M(le.$$.fragment,ne),re=!1},d(ne){ne&&(m(e),m(t)),K&&K.d(ne),Ue(de,ne),we&&we.d(),x(le),Q=!1,et(P)}}}const Il=(n,e)=>e+1;function Fn(n,e,t){let l,s;Ie(n,At,T=>t(18,s=T));const r=qe("i18n");Ie(n,r,T=>t(8,l=T));const i=gt();let{message:o}=e,{show:a=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],h=[],c=[],g=null,_="",D=null,p=null;const y=()=>{var T,j,q,ae,ie;g||t(4,g=((T=o==null?void 0:o.annotation)==null?void 0:T.reason)??""),_||t(5,_=((j=o==null?void 0:o.annotation)==null?void 0:j.comment)??""),t(2,h=(((q=o==null?void 0:o.annotation)==null?void 0:q.tags)??[]).map(se=>({name:se}))),D||t(6,D=((ie=(ae=o==null?void 0:o.annotation)==null?void 0:ae.details)==null?void 0:ie.rating)??null)};bt(()=>{o!=null&&o.arena&&(t(7,p=s.find(T=>T.id===o.selectedModelId)),Le.success(l.t('This response was generated by "{{model}}"',{model:p?(p==null?void 0:p.name)??p.id:o.selectedModelId})))});const w=()=>{console.log("saveHandler"),i("save",{reason:g,comment:_,tags:h.map(T=>T.name),details:{rating:D}}),Le.success(l.t("Thanks for your feedback!")),t(0,a=!1)},R=()=>{t(0,a=!1)},B=T=>{t(6,D=T)},O=T=>{t(4,g=T)};function V(){_=this.value,t(5,_)}const L=T=>{t(2,h=h.filter(j=>j.name.replaceAll(" ","_").toLowerCase()!==T.detail.replaceAll(" ","_").toLowerCase()))},S=T=>{t(2,h=[...h,{name:T.detail}])},C=()=>{w()};return n.$$set=T=>{"message"in T&&t(1,o=T.message),"show"in T&&t(0,a=T.show)},n.$$.update=()=>{var T,j;n.$$.dirty&2&&(((T=o==null?void 0:o.annotation)==null?void 0:T.rating)===1?t(3,c=f):((j=o==null?void 0:o.annotation)==null?void 0:j.rating)===-1&&t(3,c=u)),n.$$.dirty&2&&o&&y()},[a,o,h,c,g,_,D,p,l,r,w,R,B,O,V,L,S,C]}class Jn extends Te{constructor(e){super(),Be(this,e,Fn,qn,De,{message:1,show:0})}}function El(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function Gn(n){let e,t;return e=new Cr({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Zn(n){let e,t;return e=new Tr({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Kn(n){let e,t,l,s,r;const i=n[2].default,o=Jr(i,n,n[4],null),a=[Zn,Gn],f=[];function u(h,c){return h[1]?0:1}return l=u(n),s=f[l]=a[l](n),{c(){e=I("div"),o&&o.c(),t=A(),s.c(),this.h()},l(h){e=E(h,"DIV",{class:!0});var c=k(e);o&&o.l(c),t=H(c),s.l(c),c.forEach(m),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(h,c){N(h,e,c),o&&o.m(e,null),v(e,t),f[l].m(e,null),r=!0},p(h,c){o&&o.p&&(!r||c&16)&&Gr(o,i,h,h[4],r?Kr(i,h[4],c,null):Zr(h[4]),null);let g=l;l=u(h),l!==g&&(ee(),M(f[g],1,1,()=>{f[g]=null}),te(),s=f[l],s||(s=f[l]=a[l](h),s.c()),b(s,1),s.m(e,null))},i(h){r||(b(o,h),b(s),r=!0)},o(h){M(o,h),M(s),r=!1},d(h){h&&m(e),o&&o.d(h),f[l].d()}}}function Ml(n){let e,t,l,s,r,i=n[0].query+"",o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',h,c;return l=new _n({}),{c(){e=I("a"),t=I("div"),X(l.$$.fragment),s=A(),r=I("div"),o=W(i),a=A(),f=I("div"),f.innerHTML=u,this.h()},l(g){e=E(g,"A",{href:!0,target:!0,class:!0});var _=k(e);t=E(_,"DIV",{class:!0});var D=k(t);Y(l.$$.fragment,D),s=H(D),r=E(D,"DIV",{class:!0});var p=k(r);o=U(p,i),p.forEach(m),D.forEach(m),a=H(_),f=E(_,"DIV",{class:!0,"data-svelte-h":!0}),Pe(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(m),this.h()},h(){d(r,"class","line-clamp-1"),d(t,"class","flex gap-2 items-center"),d(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",h="https://www.google.com/search?q="+n[0].query),d(e,"target","_blank"),d(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(g,_){N(g,e,_),v(e,t),$(l,t,null),v(t,s),v(t,r),v(r,o),v(e,a),v(e,f),c=!0},p(g,_){(!c||_&1)&&i!==(i=g[0].query+"")&&G(o,i),(!c||_&1&&h!==(h="https://www.google.com/search?q="+g[0].query))&&d(e,"href",h)},i(g){c||(b(l.$$.fragment,g),c=!0)},o(g){M(l.$$.fragment,g),c=!1},d(g){g&&m(e),x(l)}}}function Nl(n){let e,t,l=n[5]+"",s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',a,f,u;return{c(){e=I("a"),t=I("div"),s=W(l),r=A(),i=I("div"),i.innerHTML=o,a=A(),this.h()},l(h){e=E(h,"A",{href:!0,target:!0,class:!0});var c=k(e);t=E(c,"DIV",{class:!0});var g=k(t);s=U(g,l),g.forEach(m),r=H(c),i=E(c,"DIV",{class:!0,"data-svelte-h":!0}),Pe(i)!=="svelte-14xjows"&&(i.innerHTML=o),a=H(c),c.forEach(m),this.h()},h(){d(t,"class","line-clamp-1"),d(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",f=n[5]),d(e,"target","_blank"),d(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(h,c){N(h,e,c),v(e,t),v(t,s),v(e,r),v(e,i),v(e,a)},p(h,c){c&1&&l!==(l=h[5]+"")&&G(s,l),c&1&&f!==(f=h[5])&&d(e,"href",f),c&1&&u!==(u="flex w-full items-center p-3 px-4 "+(h[7]===h[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&d(e,"class",u)},d(h){h&&m(e)}}}function Qn(n){var o;let e,t,l,s=((o=n[0])==null?void 0:o.query)&&Ml(n),r=Ee(n[0].urls),i=[];for(let a=0;a<r.length;a+=1)i[a]=Nl(El(n,r,a));return{c(){e=I("div"),s&&s.c(),t=A();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){e=E(a,"DIV",{class:!0,slot:!0});var f=k(e);s&&s.l(f),t=H(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(m),this.h()},h(){d(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),d(e,"slot","content")},m(a,f){N(a,e,f),s&&s.m(e,null),v(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(a,f){var u;if((u=a[0])!=null&&u.query?s?(s.p(a,f),f&1&&b(s,1)):(s=Ml(a),s.c(),b(s,1),s.m(e,t)):s&&(ee(),M(s,1,1,()=>{s=null}),te()),f&1){r=Ee(a[0].urls);let h;for(h=0;h<r.length;h+=1){const c=El(a,r,h);i[h]?i[h].p(c,f):(i[h]=Nl(c),i[h].c(),i[h].m(e,null))}for(;h<i.length;h+=1)i[h].d(1);i.length=r.length}},i(a){l||(b(s),l=!0)},o(a){M(s),l=!1},d(a){a&&m(e),s&&s.d(),Ue(i,a)}}}function Xn(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[Qn],default:[Kn]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new Br({props:r}),We.push(()=>$e(e,"open",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&19&&(a.$$scope={dirty:o,ctx:i}),!t&&o&2&&(t=!0,a.open=i[1],Ye(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function Yn(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function o(a){i=a,t(1,i)}return n.$$set=a=>{"status"in a&&t(0,r=a.status),"$$scope"in a&&t(4,s=a.$$scope)},[r,i,l,o,s]}class $n extends Te{constructor(e){super(),Be(this,e,Yn,Xn,De,{status:0})}}function xn(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){N(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function ei(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class ti extends Te{constructor(e){super(),Be(this,e,ei,xn,De,{className:0,strokeWidth:1})}}function li(n){let e,t,l,s,r,i=(typeof n[0]=="string"?n[0]:JSON.stringify(n[0]))+"",o,a;return l=new vn({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=I("div"),t=I("div"),X(l.$$.fragment),s=A(),r=I("div"),o=W(i),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=k(e);t=E(u,"DIV",{class:!0});var h=k(t);Y(l.$$.fragment,h),h.forEach(m),s=H(u),r=E(u,"DIV",{class:!0});var c=k(r);o=U(c,i),c.forEach(m),u.forEach(m),this.h()},h(){d(t,"class","self-start mt-0.5"),d(r,"class","self-center text-sm"),d(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){N(f,e,u),v(e,t),$(l,t,null),v(e,s),v(e,r),v(r,o),a=!0},p(f,[u]){(!a||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&G(o,i)},i(f){a||(b(l.$$.fragment,f),a=!0)},o(f){M(l.$$.fragment,f),a=!1},d(f){f&&m(e),x(l)}}}function si(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let ri=class extends Te{constructor(e){super(),Be(this,e,si,li,De,{content:0})}};function Dl(n,e,t){const l=n.slice();return l[9]=e[t],l[11]=t,l}function ni(n){const e=n.slice(),t=vi(e[9].distance);return e[12]=t,e}function ii(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);l=U(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,r){N(s,e,r),v(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&G(l,t)},i:ve,o:ve,d(s){s&&m(e)}}}function oi(n){let e,t,l,s;e=new Re({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[ai]},$$scope:{ctx:n}}});let r=n[2]&&Cl(n);return{c(){X(e.$$.fragment),t=A(),r&&r.c(),l=fe()},l(i){Y(e.$$.fragment,i),t=H(i),r&&r.l(i),l=fe()},m(i,o){$(e,i,o),N(i,t,o),r&&r.m(i,o),N(i,l,o),s=!0},p(i,o){const a={};o&16&&(a.content=i[4].t("Open file")),o&8216&&(a.$$scope={dirty:o,ctx:i}),e.$set(a),i[2]?r?(r.p(i,o),o&4&&b(r,1)):(r=Cl(i),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(ee(),M(r,1,1,()=>{r=null}),te())},i(i){s||(b(e.$$.fragment,i),b(r),s=!0)},o(i){M(e.$$.fragment,i),M(r),s=!1},d(i){i&&(m(t),m(l)),x(e,i),r&&r.d(i)}}}function Vl(n){let e,t,l=n[4].t("page")+"",s,r,i=n[9].metadata.page+1+"",o,a;return{c(){e=I("span"),t=W("("),s=W(l),r=A(),o=W(i),a=W(")"),this.h()},l(f){e=E(f,"SPAN",{class:!0});var u=k(e);t=U(u,"("),s=U(u,l),r=H(u),o=U(u,i),a=U(u,")"),u.forEach(m),this.h()},h(){d(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){N(f,e,u),v(e,t),v(e,s),v(e,r),v(e,o),v(e,a)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&G(s,l),u&8&&i!==(i=f[9].metadata.page+1+"")&&G(o,i)},d(f){f&&m(e)}}}function ai(n){var a,f,u,h;let e,t,l=(((f=(a=n[9])==null?void 0:a.metadata)==null?void 0:f.name)??n[9].source.name)+"",s,r,i,o=((h=(u=n[9])==null?void 0:u.metadata)==null?void 0:h.page)&&Vl(n);return{c(){e=I("div"),t=I("a"),s=W(l),i=A(),o&&o.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var g=k(e);t=E(g,"A",{class:!0,href:!0,target:!0});var _=k(t);s=U(_,l),_.forEach(m),i=H(g),o&&o.l(g),g.forEach(m),this.h()},h(){var c,g,_,D,p,y,w,R;d(t,"class","hover:text-gray-500 hover:dark:text-gray-100 underline flex-grow"),d(t,"href",r=(g=(c=n[9])==null?void 0:c.metadata)!=null&&g.file_id?`${ul}/files/${(D=(_=n[9])==null?void 0:_.metadata)==null?void 0:D.file_id}/content${((y=(p=n[9])==null?void 0:p.metadata)==null?void 0:y.page)!==void 0?`#page=${n[9].metadata.page+1}`:""}`:(R=(w=n[9].source)==null?void 0:w.url)!=null&&R.includes("http")?n[9].source.url:"#"),d(t,"target","_blank"),d(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(c,g){N(c,e,g),v(e,t),v(t,s),v(e,i),o&&o.m(e,null)},p(c,g){var _,D,p,y,w,R,B,O,V,L,S,C;g&8&&l!==(l=(((D=(_=c[9])==null?void 0:_.metadata)==null?void 0:D.name)??c[9].source.name)+"")&&G(s,l),g&8&&r!==(r=(y=(p=c[9])==null?void 0:p.metadata)!=null&&y.file_id?`${ul}/files/${(R=(w=c[9])==null?void 0:w.metadata)==null?void 0:R.file_id}/content${((O=(B=c[9])==null?void 0:B.metadata)==null?void 0:O.page)!==void 0?`#page=${c[9].metadata.page+1}`:""}`:(L=(V=c[9].source)==null?void 0:V.url)!=null&&L.includes("http")?c[9].source.url:"#")&&d(t,"href",r),(C=(S=c[9])==null?void 0:S.metadata)!=null&&C.page?o?o.p(c,g):(o=Vl(c),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(c){c&&m(e),o&&o.d()}}}function Cl(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,o,a;const f=[ui,fi],u=[];function h(c,g){return c[9].distance!==void 0?0:1}return r=h(n),i=u[r]=f[r](n),{c(){e=I("div"),l=W(t),s=A(),i.c(),o=fe(),this.h()},l(c){e=E(c,"DIV",{class:!0});var g=k(e);l=U(g,t),g.forEach(m),s=H(c),i.l(c),o=fe(),this.h()},h(){d(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(c,g){N(c,e,g),v(e,l),N(c,s,g),u[r].m(c,g),N(c,o,g),a=!0},p(c,g){(!a||g&16)&&t!==(t=c[4].t("Relevance")+"")&&G(l,t);let _=r;r=h(c),r===_?u[r].p(c,g):(ee(),M(u[_],1,1,()=>{u[_]=null}),te(),i=u[r],i?i.p(c,g):(i=u[r]=f[r](c),i.c()),b(i,1),i.m(o.parentNode,o))},i(c){a||(b(i),a=!0)},o(c){M(i),a=!1},d(c){c&&(m(e),m(s),m(o)),u[r].d(c)}}}function fi(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);l=U(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,r){N(s,e,r),v(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&G(l,t)},i:ve,o:ve,d(s){s&&m(e)}}}function ui(n){let e,t;return e=new Re({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[di]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&8202&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ci(n){let e,t=n[9].distance.toFixed(4)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var r=k(e);l=U(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-gray-500 dark:text-gray-500")},m(s,r){N(s,e,r),v(e,l)},p(s,r){r&8&&t!==(t=s[9].distance.toFixed(4)+"")&&G(l,t)},d(s){s&&m(e)}}}function Tl(n){let e,t=n[12].toFixed(2)+"",l,s,r,i,o,a,f=n[9].distance.toFixed(4)+"",u,h;return{c(){e=I("span"),l=W(t),s=W("%"),i=A(),o=I("span"),a=W("("),u=W(f),h=W(")"),this.h()},l(c){e=E(c,"SPAN",{class:!0});var g=k(e);l=U(g,t),s=U(g,"%"),g.forEach(m),i=H(c),o=E(c,"SPAN",{class:!0});var _=k(o);a=U(_,"("),u=U(_,f),h=U(_,")"),_.forEach(m),this.h()},h(){d(e,"class",r=`px-1 rounded font-medium ${Sl(n[12])}`),d(o,"class","text-gray-500 dark:text-gray-500")},m(c,g){N(c,e,g),v(e,l),v(e,s),N(c,i,g),N(c,o,g),v(o,a),v(o,u),v(o,h)},p(c,g){g&8&&t!==(t=c[12].toFixed(2)+"")&&G(l,t),g&8&&r!==(r=`px-1 rounded font-medium ${Sl(c[12])}`)&&d(e,"class",r),g&8&&f!==(f=c[9].distance.toFixed(4)+"")&&G(u,f)},d(c){c&&(m(e),m(i),m(o))}}}function di(n){let e;function t(i,o){return i[1]?Tl:ci}function l(i,o){return o===Tl?ni(i):i}let s=t(n),r=s(l(n,s));return{c(){e=I("div"),r.c(),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=k(e);r.l(o),o.forEach(m),this.h()},h(){d(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,o){N(i,e,o),r.m(e,null)},p(i,o){s===(s=t(i))&&r?r.p(l(i,s),o):(r.d(1),r=s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function hi(n){let e,t,l=n[9].document+"",s,r;return{c(){e=I("pre"),t=W("                "),s=W(l),r=W(`
              `),this.h()},l(i){e=E(i,"PRE",{class:!0});var o=k(e);t=U(o,"                "),s=U(o,l),r=U(o,`
              `),o.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,o){N(i,e,o),v(e,t),v(e,s),v(e,r)},p(i,o){o&8&&l!==(l=i[9].document+"")&&G(s,l)},d(i){i&&m(e)}}}function mi(n){let e,t,l;return{c(){e=I("iframe"),this.h()},l(s){e=E(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),k(e).forEach(m),this.h()},h(){d(e,"class","w-full border-0 h-auto rounded-none"),d(e,"sandbox","allow-scripts allow-forms allow-same-origin"),d(e,"srcdoc",t=n[9].document),d(e,"title",l=n[4].t("Content"))},m(s,r){N(s,e,r)},p(s,r){r&8&&t!==(t=s[9].document)&&d(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&d(e,"title",l)},d(s){s&&m(e)}}}function Bl(n){let e;return{c(){e=I("hr"),this.h()},l(t){e=E(t,"HR",{class:!0}),this.h()},h(){d(e,"class","dark:border-gray-850 my-3")},m(t,l){N(t,e,l)},d(t){t&&m(e)}}}function Rl(n){let e,t,l=n[4].t("Source")+"",s,r,i,o,a,f,u,h=n[4].t("Content")+"",c,g,_,D,p;const y=[oi,ii],w=[];function R(S,C){var T;return(T=S[9].source)!=null&&T.name?0:1}i=R(n),o=w[i]=y[i](n);function B(S,C){var T;return(T=S[9].metadata)!=null&&T.html?mi:hi}let O=B(n),V=O(n),L=n[11]!==n[3].length-1&&Bl();return{c(){e=I("div"),t=I("div"),s=W(l),r=A(),o.c(),a=A(),f=I("div"),u=I("div"),c=W(h),g=A(),V.c(),_=A(),L&&L.c(),D=fe(),this.h()},l(S){e=E(S,"DIV",{class:!0});var C=k(e);t=E(C,"DIV",{class:!0});var T=k(t);s=U(T,l),T.forEach(m),r=H(C),o.l(C),C.forEach(m),a=H(S),f=E(S,"DIV",{class:!0});var j=k(f);u=E(j,"DIV",{class:!0});var q=k(u);c=U(q,h),q.forEach(m),g=H(j),V.l(j),j.forEach(m),_=H(S),L&&L.l(S),D=fe(),this.h()},h(){d(t,"class","text-sm font-medium dark:text-gray-300"),d(e,"class","flex flex-col w-full"),d(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),d(f,"class","flex flex-col w-full")},m(S,C){N(S,e,C),v(e,t),v(t,s),v(e,r),w[i].m(e,null),N(S,a,C),N(S,f,C),v(f,u),v(u,c),v(f,g),V.m(f,null),N(S,_,C),L&&L.m(S,C),N(S,D,C),p=!0},p(S,C){(!p||C&16)&&l!==(l=S[4].t("Source")+"")&&G(s,l);let T=i;i=R(S),i===T?w[i].p(S,C):(ee(),M(w[T],1,1,()=>{w[T]=null}),te(),o=w[i],o?o.p(S,C):(o=w[i]=y[i](S),o.c()),b(o,1),o.m(e,null)),(!p||C&16)&&h!==(h=S[4].t("Content")+"")&&G(c,h),O===(O=B(S))&&V?V.p(S,C):(V.d(1),V=O(S),V&&(V.c(),V.m(f,null))),S[11]!==S[3].length-1?L||(L=Bl(),L.c(),L.m(D.parentNode,D)):L&&(L.d(1),L=null)},i(S){p||(b(o),p=!0)},o(S){M(o),p=!1},d(S){S&&(m(e),m(a),m(f),m(_),m(D)),w[i].d(),V.d(),L&&L.d(S)}}}function gi(n){let e,t,l,s=n[4].t("Citation")+"",r,i,o,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,h,c,g,_,D=Ee(n[3]),p=[];for(let w=0;w<D.length;w+=1)p[w]=Rl(Dl(n,D,w));const y=w=>M(p[w],1,1,()=>{p[w]=null});return{c(){e=I("div"),t=I("div"),l=I("div"),r=W(s),i=A(),o=I("button"),o.innerHTML=a,f=A(),u=I("div"),h=I("div");for(let w=0;w<p.length;w+=1)p[w].c();this.h()},l(w){e=E(w,"DIV",{});var R=k(e);t=E(R,"DIV",{class:!0});var B=k(t);l=E(B,"DIV",{class:!0});var O=k(l);r=U(O,s),O.forEach(m),i=H(B),o=E(B,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(o)!=="svelte-745w2y"&&(o.innerHTML=a),B.forEach(m),f=H(R),u=E(R,"DIV",{class:!0});var V=k(u);h=E(V,"DIV",{class:!0});var L=k(h);for(let S=0;S<p.length;S+=1)p[S].l(L);L.forEach(m),V.forEach(m),R.forEach(m),this.h()},h(){d(l,"class","text-lg font-medium self-center capitalize"),d(o,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(h,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(w,R){N(w,e,R),v(e,t),v(t,l),v(l,r),v(t,i),v(t,o),v(e,f),v(e,u),v(u,h);for(let B=0;B<p.length;B+=1)p[B]&&p[B].m(h,null);c=!0,g||(_=ge(o,"click",n[7]),g=!0)},p(w,R){if((!c||R&16)&&s!==(s=w[4].t("Citation")+"")&&G(r,s),R&30){D=Ee(w[3]);let B;for(B=0;B<D.length;B+=1){const O=Dl(w,D,B);p[B]?(p[B].p(O,R),b(p[B],1)):(p[B]=Rl(O),p[B].c(),b(p[B],1),p[B].m(h,null))}for(ee(),B=D.length;B<p.length;B+=1)y(B);te()}},i(w){if(!c){for(let R=0;R<D.length;R+=1)b(p[R]);c=!0}},o(w){p=p.filter(Boolean);for(let R=0;R<p.length;R+=1)M(p[R]);c=!1},d(w){w&&m(e),Ue(p,w),g=!1,_()}}}function _i(n){let e,t,l;function s(i){n[8](i)}let r={size:"lg",$$slots:{default:[gi]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Rr({props:r}),We.push(()=>$e(e,"show",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&8223&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ye(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function vi(n){return n<0?0:n>1?100:Math.round(n*1e4)/100}function Sl(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function pi(n,e,t){let l;const s=qe("i18n");Ie(n,s,c=>t(4,l=c));let{show:r=!1}=e,{citation:i}=e,{showPercentage:o=!1}=e,{showRelevance:a=!0}=e,f=[];const u=()=>{t(0,r=!1)};function h(c){r=c,t(0,r)}return n.$$set=c=>{"show"in c&&t(0,r=c.show),"citation"in c&&t(6,i=c.citation),"showPercentage"in c&&t(1,o=c.showPercentage),"showRelevance"in c&&t(2,a=c.showRelevance)},n.$$.update=()=>{var c;n.$$.dirty&72&&i&&(t(3,f=(c=i.document)==null?void 0:c.map((g,_)=>{var D,p;return{source:i.source,document:g,metadata:(D=i.metadata)==null?void 0:D[_],distance:(p=i.distances)==null?void 0:p[_]}})),f.every(g=>g.distance!==void 0)&&t(3,f=f.sort((g,_)=>(_.distance??1/0)-(g.distance??1/0))))},[r,o,a,f,l,s,i,u,h]}class bi extends Te{constructor(e){super(),Be(this,e,pi,_i,De,{show:0,citation:6,showPercentage:1,showRelevance:2})}}function Ol(n,e,t){const l=n.slice();return l[17]=e[t],l[19]=t,l}function Ll(n,e,t){const l=n.slice();return l[17]=e[t],l[19]=t,l}function Pl(n,e,t){const l=n.slice();return l[17]=e[t],l[19]=t,l}function jl(n){let e,t,l,s;const r=[wi,ki],i=[];function o(a,f){return a[0].length<=3?0:1}return t=o(n),l=i[t]=r[t](n),{c(){e=I("div"),l.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(m),this.h()},h(){d(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(a,f){N(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(ee(),M(i[u],1,1,()=>{i[u]=null}),te(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){M(l),s=!1},d(a){a&&m(e),i[t].d()}}}function ki(n){let e,t,l;function s(i){n[16](i)}let r={id:"collapsible-sources",className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[Mi],default:[Ei]},$$scope:{ctx:n}};return n[5]!==void 0&&(r.open=n[5]),e=new Br({props:r}),We.push(()=>$e(e,"open",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,o){const a={};o&4194425&&(a.$$scope={dirty:o,ctx:i}),!t&&o&32&&(t=!0,a.open=i[5],Ye(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function wi(n){let e,t=Ee(n[0]),l=[];for(let s=0;s<t.length;s+=1)l[s]=ql(Pl(n,t,s));return{c(){e=I("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(m),this.h()},h(){d(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){N(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&25){t=Ee(s[0]);let i;for(i=0;i<t.length;i+=1){const o=Pl(s,t,i);l[i]?l[i].p(o,r):(l[i]=ql(o),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:ve,o:ve,d(s){s&&m(e),Ue(l,s)}}}function Al(n){let e,t=n[19]+1+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);l=U(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){N(s,e,r),v(e,l)},d(s){s&&m(e)}}}function Hl(n){let e,t=n[0].every(n[11]),l,s,r=n[17].source.name+"",i,o,a,f,u=t&&Al(n);function h(){return n[15](n[17])}return{c(){e=I("button"),u&&u.c(),l=A(),s=I("div"),i=W(r),o=A(),this.h()},l(c){e=E(c,"BUTTON",{class:!0});var g=k(e);u&&u.l(g),l=H(g),s=E(g,"DIV",{class:!0});var _=k(s);i=U(_,r),_.forEach(m),o=H(g),g.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"class","no-toggle outline-none flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(c,g){N(c,e,g),u&&u.m(e,null),v(e,l),v(e,s),v(s,i),v(e,o),a||(f=[ge(e,"click",h),ge(e,"pointerup",Ci)],a=!0)},p(c,g){n=c,g&1&&(t=n[0].every(n[11])),t?u||(u=Al(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),g&1&&r!==(r=n[17].source.name+"")&&G(i,r)},d(c){c&&m(e),u&&u.d(),a=!1,et(f)}}}function yi(n){let e,t;return e=new Cr({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ii(n){let e,t;return e=new Tr({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ei(n){let e,t,l,s=n[6].t("References from")+"",r,i,o,a,f,u,h,c=n[6].t("and")+"",g,_,D=n[0].length-2+"",p,y,w,R=n[6].t("more")+"",B,O,V,L,S,C,T=Ee(n[0].slice(0,2)),j=[];for(let se=0;se<T.length;se+=1)j[se]=Hl(Ol(n,T,se));const q=[Ii,yi],ae=[];function ie(se,oe){return se[5]?0:1}return L=ie(n),S=ae[L]=q[L](n),{c(){e=I("div"),t=I("div"),l=I("span"),r=W(s),i=A(),o=I("div"),a=I("div");for(let se=0;se<j.length;se+=1)j[se].c();f=A(),u=I("div"),h=I("span"),g=W(c),_=A(),p=W(D),y=A(),w=I("span"),B=W(R),O=A(),V=I("div"),S.c(),this.h()},l(se){e=E(se,"DIV",{class:!0});var oe=k(e);t=E(oe,"DIV",{class:!0});var J=k(t);l=E(J,"SPAN",{class:!0});var le=k(l);r=U(le,s),le.forEach(m),i=H(J),o=E(J,"DIV",{class:!0});var me=k(o);a=E(me,"DIV",{class:!0});var _e=k(a);for(let Q=0;Q<j.length;Q+=1)j[Q].l(_e);_e.forEach(m),me.forEach(m),f=H(J),u=E(J,"DIV",{class:!0});var Z=k(u);h=E(Z,"SPAN",{class:!0});var z=k(h);g=U(z,c),z.forEach(m),_=H(Z),p=U(Z,D),y=H(Z),w=E(Z,"SPAN",{});var ue=k(w);B=U(ue,R),ue.forEach(m),Z.forEach(m),J.forEach(m),O=H(oe),V=E(oe,"DIV",{class:!0});var re=k(V);S.l(re),re.forEach(m),oe.forEach(m),this.h()},h(){d(l,"class","whitespace-nowrap hidden sm:inline flex-shrink-0"),d(a,"class","flex text-xs font-medium items-center"),d(o,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),d(h,"class","hidden sm:inline"),d(u,"class","flex items-center gap-1 whitespace-nowrap flex-shrink-0"),d(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),d(V,"class","flex-shrink-0"),d(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(se,oe){N(se,e,oe),v(e,t),v(t,l),v(l,r),v(t,i),v(t,o),v(o,a);for(let J=0;J<j.length;J+=1)j[J]&&j[J].m(a,null);v(t,f),v(t,u),v(u,h),v(h,g),v(u,_),v(u,p),v(u,y),v(u,w),v(w,B),v(e,O),v(e,V),ae[L].m(V,null),C=!0},p(se,oe){if((!C||oe&64)&&s!==(s=se[6].t("References from")+"")&&G(r,s),oe&25){T=Ee(se[0].slice(0,2));let le;for(le=0;le<T.length;le+=1){const me=Ol(se,T,le);j[le]?j[le].p(me,oe):(j[le]=Hl(me),j[le].c(),j[le].m(a,null))}for(;le<j.length;le+=1)j[le].d(1);j.length=T.length}(!C||oe&64)&&c!==(c=se[6].t("and")+"")&&G(g,c),(!C||oe&1)&&D!==(D=se[0].length-2+"")&&G(p,D),(!C||oe&64)&&R!==(R=se[6].t("more")+"")&&G(B,R);let J=L;L=ie(se),L!==J&&(ee(),M(ae[J],1,1,()=>{ae[J]=null}),te(),S=ae[L],S||(S=ae[L]=q[L](se),S.c()),b(S,1),S.m(V,null))},i(se){C||(b(S),C=!0)},o(se){M(S),C=!1},d(se){se&&m(e),Ue(j,se),ae[L].d()}}}function zl(n){let e,t=n[19]+1+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);l=U(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){N(s,e,r),v(e,l)},d(s){s&&m(e)}}}function Wl(n){let e,t=n[0].every(n[10]),l,s,r=n[17].source.name+"",i,o,a,f,u=t&&zl(n);function h(){return n[14](n[17])}return{c(){e=I("button"),u&&u.c(),l=A(),s=I("div"),i=W(r),o=A(),this.h()},l(c){e=E(c,"BUTTON",{id:!0,class:!0});var g=k(e);u&&u.l(g),l=H(g),s=E(g,"DIV",{class:!0});var _=k(s);i=U(_,r),_.forEach(m),o=H(g),g.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"id",`source-${n[19]}`),d(e,"class","no-toggle outline-none flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(c,g){N(c,e,g),u&&u.m(e,null),v(e,l),v(e,s),v(s,i),v(e,o),a||(f=ge(e,"click",h),a=!0)},p(c,g){n=c,g&1&&(t=n[0].every(n[10])),t?u||(u=zl(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),g&1&&r!==(r=n[17].source.name+"")&&G(i,r)},d(c){c&&m(e),u&&u.d(),a=!1,f()}}}function Mi(n){let e,t,l=Ee(n[0]),s=[];for(let r=0;r<l.length;r+=1)s[r]=Wl(Ll(n,l,r));return{c(){e=I("div"),t=I("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=E(r,"DIV",{slot:!0});var i=k(e);t=E(i,"DIV",{class:!0});var o=k(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),i.forEach(m),this.h()},h(){d(t,"class","flex text-xs font-medium flex-wrap"),d(e,"slot","content")},m(r,i){N(r,e,i),v(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,i){if(i&25){l=Ee(r[0]);let o;for(o=0;o<l.length;o+=1){const a=Ll(r,l,o);s[o]?s[o].p(a,i):(s[o]=Wl(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(r){r&&m(e),Ue(s,r)}}}function Ul(n){let e,t=n[19]+1+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);l=U(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){N(s,e,r),v(e,l)},d(s){s&&m(e)}}}function ql(n){let e,t=n[0].every(n[9]),l,s,r=n[17].source.name+"",i,o,a,f,u=t&&Ul(n);function h(){return n[13](n[17])}return{c(){e=I("button"),u&&u.c(),l=A(),s=I("div"),i=W(r),o=A(),this.h()},l(c){e=E(c,"BUTTON",{id:!0,class:!0});var g=k(e);u&&u.l(g),l=H(g),s=E(g,"DIV",{class:!0});var _=k(s);i=U(_,r),_.forEach(m),o=H(g),g.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),d(e,"id",`source-${n[19]}`),d(e,"class","no-toggle outline-none flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(c,g){N(c,e,g),u&&u.m(e,null),v(e,l),v(e,s),v(s,i),v(e,o),a||(f=ge(e,"click",h),a=!0)},p(c,g){n=c,g&1&&(t=n[0].every(n[9])),t?u||(u=Ul(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),g&1&&r!==(r=n[17].source.name+"")&&G(i,r)},d(c){c&&m(e),u&&u.d(),a=!1,f()}}}function Ni(n){let e,t,l,s,r;function i(f){n[12](f)}let o={citation:n[4],showPercentage:n[1],showRelevance:n[2]};n[3]!==void 0&&(o.show=n[3]),e=new bi({props:o}),We.push(()=>$e(e,"show",i));let a=n[0].length>0&&jl(n);return{c(){X(e.$$.fragment),l=A(),a&&a.c(),s=fe()},l(f){Y(e.$$.fragment,f),l=H(f),a&&a.l(f),s=fe()},m(f,u){$(e,f,u),N(f,l,u),a&&a.m(f,u),N(f,s,u),r=!0},p(f,[u]){const h={};u&16&&(h.citation=f[4]),u&2&&(h.showPercentage=f[1]),u&4&&(h.showRelevance=f[2]),!t&&u&8&&(t=!0,h.show=f[3],Ye(()=>t=!1)),e.$set(h),f[0].length>0?a?(a.p(f,u),u&1&&b(a,1)):(a=jl(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(ee(),M(a,1,1,()=>{a=null}),te())},i(f){r||(b(e.$$.fragment,f),b(a),r=!0)},o(f){M(e.$$.fragment,f),M(a),r=!1},d(f){f&&(m(l),m(s)),x(e,f),a&&a.d(f)}}}function Di(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function Vi(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const Ci=n=>{n.stopPropagation()};function Ti(n,e,t){let l;const s=qe("i18n");Ie(n,s,B=>t(6,l=B));let{sources:r=[]}=e,i=[],o=!1,a=!0,f=!1,u=null,h=!1;const c=B=>B.distances!==void 0,g=B=>B.distances!==void 0,_=B=>B.distances!==void 0;function D(B){f=B,t(3,f)}const p=B=>{t(3,f=!0),t(4,u=B)},y=B=>{t(3,f=!0),t(4,u=B)},w=B=>{t(3,f=!0),t(4,u=B)};function R(B){h=B,t(5,h)}return n.$$set=B=>{"sources"in B&&t(8,r=B.sources)},n.$$.update=()=>{n.$$.dirty&257&&(t(0,i=r.reduce((B,O)=>(Object.keys(O).length===0||O.document.forEach((V,L)=>{var ae,ie;const S=(ae=O.metadata)==null?void 0:ae[L],C=(ie=O.distances)==null?void 0:ie[L],T=(S==null?void 0:S.source)??"N/A";let j=O==null?void 0:O.source;S!=null&&S.name&&(j={...j,name:S.name}),(T.startsWith("http://")||T.startsWith("https://"))&&(j={...j,name:T,url:T});const q=B.find(se=>se.id===T);q?(q.document.push(V),q.metadata.push(S),C!==void 0&&q.distances.push(C)):B.push({id:T,source:j,document:[V],metadata:S?[S]:[],distances:C!==void 0?[C]:void 0})}),B),[])),t(2,a=Di(i)),t(1,o=Vi(i)))},[i,o,a,f,u,h,l,s,r,c,g,_,D,p,y,w,R]}class Bi extends Te{constructor(e){super(),Be(this,e,Ti,Ni,De,{sources:8})}}function Fl(n,e,t){const l=n.slice();return l[6]=e[t],l}function Jl(n){let e,t,l,s;const r=[Oi,Si,Ri],i=[];function o(a,f){var u,h;return(u=a[1].result)!=null&&u.error?0:(h=a[1].result)!=null&&h.output?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=I("div"),l.c()},l(a){e=E(a,"DIV",{});var f=k(e);l.l(f),f.forEach(m)},m(a,f){N(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t!==u&&(ee(),M(i[u],1,1,()=>{i[u]=null}),te(),l=i[t],l||(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){M(l),s=!1},d(a){a&&m(e),i[t].d()}}}function Ri(n){let e,t;return e=new Kt({props:{type:"warning",content:"incomplete"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Si(n){let e,t;return e=new Kt({props:{type:"success",content:"success"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Oi(n){let e,t;return e=new Kt({props:{type:"error",content:"error"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Gl(n){let e,t,l;return t=new Wt({props:{className:"size-4"}}),{c(){e=I("div"),X(t.$$.fragment)},l(s){e=E(s,"DIV",{});var r=k(e);Y(t.$$.fragment,r),r.forEach(m)},m(s,r){N(s,e,r),$(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function Li(n){let e=n[2].t("Code execution")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&G(t,e)},d(l){l&&m(t)}}}function Pi(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=W(e),l=W(": "),r=W(s)},l(o){t=U(o,e),l=U(o,": "),r=U(o,s)},m(o,a){N(o,t,a),N(o,l,a),N(o,r,a)},p(o,a){var f;a&4&&e!==(e=o[2].t("Code execution")+"")&&G(t,e),a&2&&s!==(s=((f=o[1])==null?void 0:f.name)+"")&&G(r,s)},d(o){o&&(m(t),m(l),m(r))}}}function Zl(n){var r,i,o,a;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&Kl(n),s=((a=(o=n[1])==null?void 0:o.result)==null?void 0:a.output)&&Ql(n);return{c(){e=I("div"),l&&l.c(),t=A(),s&&s.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=k(e);l&&l.l(u),t=H(u),s&&s.l(u),u.forEach(m),this.h()},h(){d(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){N(f,e,u),l&&l.m(e,null),v(e,t),s&&s.m(e,null)},p(f,u){var h,c,g,_;(c=(h=f[1])==null?void 0:h.result)!=null&&c.error?l?l.p(f,u):(l=Kl(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(g=f[1])==null?void 0:g.result)!=null&&_.output?s?s.p(f,u):(s=Ql(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&m(e),l&&l.d(),s&&s.d()}}}function Kl(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",a;return{c(){e=I("div"),t=I("div"),s=W(l),r=A(),i=I("div"),a=W(o),this.h()},l(h){e=E(h,"DIV",{});var c=k(e);t=E(c,"DIV",{class:!0});var g=k(t);s=U(g,l),g.forEach(m),r=H(c),i=E(c,"DIV",{class:!0});var _=k(i);a=U(_,o),_.forEach(m),c.forEach(m),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(h,c){N(h,e,c),v(e,t),v(t,s),v(e,r),v(e,i),v(i,a)},p(h,c){var g,_;c&4&&l!==(l=h[2].t("ERROR")+"")&&G(s,l),c&2&&o!==(o=((_=(g=h[1])==null?void 0:g.result)==null?void 0:_.error)+"")&&G(a,o)},d(h){h&&m(e)}}}function Ql(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",a;return{c(){e=I("div"),t=I("div"),s=W(l),r=A(),i=I("div"),a=W(o),this.h()},l(h){e=E(h,"DIV",{});var c=k(e);t=E(c,"DIV",{class:!0});var g=k(t);s=U(g,l),g.forEach(m),r=H(c),i=E(c,"DIV",{class:!0});var _=k(i);a=U(_,o),_.forEach(m),c.forEach(m),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(h,c){N(h,e,c),v(e,t),v(t,s),v(e,r),v(e,i),v(i,a)},p(h,c){var g,_;c&4&&l!==(l=h[2].t("OUTPUT")+"")&&G(s,l),c&2&&o!==(o=((_=(g=h[1])==null?void 0:g.result)==null?void 0:_.output)+"")&&G(a,o)},d(h){h&&m(e)}}}function Xl(n){var h,c;let e,t,l,s,r=n[2].t("Files")+"",i,o,a,f=Ee((c=(h=n[1])==null?void 0:h.result)==null?void 0:c.files),u=[];for(let g=0;g<f.length;g+=1)u[g]=Yl(Fl(n,f,g));return{c(){e=I("div"),t=I("hr"),l=A(),s=I("div"),i=W(r),o=A(),a=I("ul");for(let g=0;g<u.length;g+=1)u[g].c();this.h()},l(g){e=E(g,"DIV",{class:!0});var _=k(e);t=E(_,"HR",{class:!0}),l=H(_),s=E(_,"DIV",{class:!0});var D=k(s);i=U(D,r),D.forEach(m),o=H(_),a=E(_,"UL",{class:!0});var p=k(a);for(let y=0;y<u.length;y+=1)u[y].l(p);p.forEach(m),_.forEach(m),this.h()},h(){d(t,"class","dark:border-gray-850 my-2"),d(s,"class","text-sm font-medium dark:text-gray-300"),d(a,"class","mt-1 list-disc pl-4 text-xs"),d(e,"class","flex flex-col w-full")},m(g,_){N(g,e,_),v(e,t),v(e,l),v(e,s),v(s,i),v(e,o),v(e,a);for(let D=0;D<u.length;D+=1)u[D]&&u[D].m(a,null)},p(g,_){var D,p;if(_&4&&r!==(r=g[2].t("Files")+"")&&G(i,r),_&2){f=Ee((p=(D=g[1])==null?void 0:D.result)==null?void 0:p.files);let y;for(y=0;y<f.length;y+=1){const w=Fl(g,f,y);u[y]?u[y].p(w,_):(u[y]=Yl(w),u[y].c(),u[y].m(a,null))}for(;y<u.length;y+=1)u[y].d(1);u.length=f.length}},d(g){g&&m(e),Ue(u,g)}}}function Yl(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=I("li"),t=I("a"),s=W(l),i=A(),this.h()},l(o){e=E(o,"LI",{});var a=k(e);t=E(a,"A",{href:!0,target:!0});var f=k(t);s=U(f,l),f.forEach(m),i=H(a),a.forEach(m),this.h()},h(){d(t,"href",r=n[6].url),d(t,"target","_blank")},m(o,a){N(o,e,a),v(e,t),v(t,s),v(e,i)},p(o,a){a&2&&l!==(l=o[6].name+"")&&G(s,l),a&2&&r!==(r=o[6].url)&&d(t,"href",r)},d(o){o&&m(e)}}}function ji(n){var q,ae,ie,se,oe,J,le,me,_e,Z,z,ue,re,Q,P,K,he,de,we;let e,t,l,s,r,i,o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',h,c,g,_,D,p,y,w,R,B,O=((q=n[1])==null?void 0:q.result)&&Jl(n),V=!((ae=n[1])!=null&&ae.result)&&Gl();function L(ce,ne){var pe;return(pe=ce[1])!=null&&pe.name?Pi:Li}let S=L(n),C=S(n);D=new mn({props:{id:"code-exec-"+((ie=n[1])==null?void 0:ie.id)+"-code",lang:((se=n[1])==null?void 0:se.language)??"",code:((oe=n[1])==null?void 0:oe.code)??"",className:"",editorClassName:(J=n[1])!=null&&J.result&&((me=(le=n[1])==null?void 0:le.result)!=null&&me.error||(Z=(_e=n[1])==null?void 0:_e.result)!=null&&Z.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let T=((z=n[1])==null?void 0:z.result)&&(((re=(ue=n[1])==null?void 0:ue.result)==null?void 0:re.error)||((P=(Q=n[1])==null?void 0:Q.result)==null?void 0:P.output))&&Zl(n),j=((he=(K=n[1])==null?void 0:K.result)==null?void 0:he.files)&&((we=(de=n[1])==null?void 0:de.result)==null?void 0:we.files.length)>0&&Xl(n);return{c(){e=I("div"),t=I("div"),l=I("div"),O&&O.c(),s=A(),r=I("div"),V&&V.c(),i=A(),o=I("div"),C.c(),a=A(),f=I("button"),f.innerHTML=u,h=A(),c=I("div"),g=I("div"),_=I("div"),X(D.$$.fragment),p=A(),T&&T.c(),y=A(),j&&j.c(),this.h()},l(ce){e=E(ce,"DIV",{});var ne=k(e);t=E(ne,"DIV",{class:!0});var pe=k(t);l=E(pe,"DIV",{class:!0});var Ve=k(l);O&&O.l(Ve),s=H(Ve),r=E(Ve,"DIV",{class:!0});var je=k(r);V&&V.l(je),i=H(je),o=E(je,"DIV",{});var Ce=k(o);C.l(Ce),Ce.forEach(m),je.forEach(m),Ve.forEach(m),a=H(pe),f=E(pe,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(f)!=="svelte-vnrwun"&&(f.innerHTML=u),pe.forEach(m),h=H(ne),c=E(ne,"DIV",{class:!0});var Ae=k(c);g=E(Ae,"DIV",{class:!0});var He=k(g);_=E(He,"DIV",{class:!0});var Fe=k(_);Y(D.$$.fragment,Fe),Fe.forEach(m),p=H(He),T&&T.l(He),y=H(He),j&&j.l(He),He.forEach(m),Ae.forEach(m),ne.forEach(m),this.h()},h(){d(r,"class","flex gap-2 items-center"),d(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),d(f,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(_,"class","flex flex-col w-full"),d(g,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(c,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(ce,ne){N(ce,e,ne),v(e,t),v(t,l),O&&O.m(l,null),v(l,s),v(l,r),V&&V.m(r,null),v(r,i),v(r,o),C.m(o,null),v(t,a),v(t,f),v(e,h),v(e,c),v(c,g),v(g,_),$(D,_,null),v(g,p),T&&T.m(g,null),v(g,y),j&&j.m(g,null),w=!0,R||(B=ge(f,"click",n[4]),R=!0)},p(ce,ne){var Ve,je,Ce,Ae,He,Fe,tt,lt,ot,at,xe,ft,ut,st,It,Et,Mt,Nt,Dt;(Ve=ce[1])!=null&&Ve.result?O?(O.p(ce,ne),ne&2&&b(O,1)):(O=Jl(ce),O.c(),b(O,1),O.m(l,s)):O&&(ee(),M(O,1,1,()=>{O=null}),te()),(je=ce[1])!=null&&je.result?V&&(ee(),M(V,1,1,()=>{V=null}),te()):V?ne&2&&b(V,1):(V=Gl(),V.c(),b(V,1),V.m(r,i)),S===(S=L(ce))&&C?C.p(ce,ne):(C.d(1),C=S(ce),C&&(C.c(),C.m(o,null)));const pe={};ne&2&&(pe.id="code-exec-"+((Ce=ce[1])==null?void 0:Ce.id)+"-code"),ne&2&&(pe.lang=((Ae=ce[1])==null?void 0:Ae.language)??""),ne&2&&(pe.code=((He=ce[1])==null?void 0:He.code)??""),ne&2&&(pe.editorClassName=(Fe=ce[1])!=null&&Fe.result&&((lt=(tt=ce[1])==null?void 0:tt.result)!=null&&lt.error||(at=(ot=ce[1])==null?void 0:ot.result)!=null&&at.output)?"rounded-b-none":""),D.$set(pe),(xe=ce[1])!=null&&xe.result&&((ut=(ft=ce[1])==null?void 0:ft.result)!=null&&ut.error||(It=(st=ce[1])==null?void 0:st.result)!=null&&It.output)?T?T.p(ce,ne):(T=Zl(ce),T.c(),T.m(g,y)):T&&(T.d(1),T=null),(Mt=(Et=ce[1])==null?void 0:Et.result)!=null&&Mt.files&&((Dt=(Nt=ce[1])==null?void 0:Nt.result)==null?void 0:Dt.files.length)>0?j?j.p(ce,ne):(j=Xl(ce),j.c(),j.m(g,null)):j&&(j.d(1),j=null)},i(ce){w||(b(O),b(V),b(D.$$.fragment,ce),w=!0)},o(ce){M(O),M(V),M(D.$$.fragment,ce),w=!1},d(ce){ce&&m(e),O&&O.d(),V&&V.d(),C.d(),x(D),T&&T.d(),j&&j.d(),R=!1,B()}}}function Ai(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[ji]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Rr({props:r}),We.push(()=>$e(e,"show",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ye(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function Hi(n,e,t){let l;const s=qe("i18n");Ie(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const o=()=>{t(0,r=!1),t(1,i=null)};function a(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,o,a]}class zi extends Te{constructor(e){super(),Be(this,e,Hi,Ai,De,{show:0,codeExecution:1})}}function $l(n,e,t){const l=n.slice();return l[6]=e[t],l}function xl(n){let e,t=[],l=new Map,s,r=Ee(n[0]);const i=o=>o[6].id;for(let o=0;o<r.length;o+=1){let a=$l(n,r,o),f=i(a);l.set(f,t[o]=es(f,a))}return{c(){e=I("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=E(o,"DIV",{class:!0});var a=k(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(m),this.h()},h(){d(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(o,a){N(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(o,a){a&7&&(r=Ee(o[0]),ee(),t=Gt(t,a,i,1,o,r,l,e,yr,es,null,$l),te())},i(o){if(!s){for(let a=0;a<r.length;a+=1)b(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)M(t[a]);s=!1},d(o){o&&m(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Wi(n){let e,t;return e=new Wt({props:{className:"size-4"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ui(n){let e,t,l,s;const r=[Ji,Fi,qi],i=[];function o(a,f){var u,h;return(u=a[6].result)!=null&&u.error?0:(h=a[6].result)!=null&&h.output?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(a){t.l(a),l=fe()},m(a,f){i[e].m(a,f),N(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e!==u&&(ee(),M(i[u],1,1,()=>{i[u]=null}),te(),t=i[e],t||(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function qi(n){let e,t;return e=new wn({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Fi(n){let e,t;return e=new bn({props:{strokeWidth:"3",className:"size-3"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ji(n){let e,t;return e=new kn({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function es(n,e){let t,l,s,r,i,o,a,f=e[6].name+"",u,h,c,g,_,D;const p=[Ui,Wi],y=[];function w(B,O){var V;return(V=B[6])!=null&&V.result?0:1}r=w(e),i=y[r]=p[r](e);function R(){return e[4](e[6])}return{key:n,first:null,c(){t=I("div"),l=I("button"),s=I("div"),i.c(),o=A(),a=I("div"),u=W(f),c=A(),this.h()},l(B){t=E(B,"DIV",{class:!0});var O=k(t);l=E(O,"BUTTON",{class:!0});var V=k(l);s=E(V,"DIV",{class:!0});var L=k(s);i.l(L),L.forEach(m),o=H(V),a=E(V,"DIV",{class:!0});var S=k(a);u=U(S,f),S.forEach(m),V.forEach(m),c=H(O),O.forEach(m),this.h()},h(){var B;d(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),d(a,"class",h="flex-1 mx-2 line-clamp-1 code-execution-name "+((B=e[6])!=null&&B.result?"":"pulse")+" svelte-1gvtig2"),d(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),d(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(B,O){N(B,t,O),v(t,l),v(l,s),y[r].m(s,null),v(l,o),v(l,a),v(a,u),v(t,c),g=!0,_||(D=ge(l,"click",R),_=!0)},p(B,O){var L;e=B;let V=r;r=w(e),r===V?y[r].p(e,O):(ee(),M(y[V],1,1,()=>{y[V]=null}),te(),i=y[r],i?i.p(e,O):(i=y[r]=p[r](e),i.c()),b(i,1),i.m(s,null)),(!g||O&1)&&f!==(f=e[6].name+"")&&G(u,f),(!g||O&1&&h!==(h="flex-1 mx-2 line-clamp-1 code-execution-name "+((L=e[6])!=null&&L.result?"":"pulse")+" svelte-1gvtig2"))&&d(a,"class",h)},i(B){g||(b(i),g=!0)},o(B){M(i),g=!1},d(B){B&&m(t),y[r].d(),_=!1,D()}}}function Gi(n){let e,t,l,s,r;function i(f){n[3](f)}let o={codeExecution:n[1]};n[2]!==void 0&&(o.show=n[2]),e=new zi({props:o}),We.push(()=>$e(e,"show",i));let a=n[0].length>0&&xl(n);return{c(){X(e.$$.fragment),l=A(),a&&a.c(),s=fe()},l(f){Y(e.$$.fragment,f),l=H(f),a&&a.l(f),s=fe()},m(f,u){$(e,f,u),N(f,l,u),a&&a.m(f,u),N(f,s,u),r=!0},p(f,[u]){const h={};u&2&&(h.codeExecution=f[1]),!t&&u&4&&(t=!0,h.show=f[2],Ye(()=>t=!1)),e.$set(h),f[0].length>0?a?(a.p(f,u),u&1&&b(a,1)):(a=xl(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(ee(),M(a,1,1,()=>{a=null}),te())},i(f){r||(b(e.$$.fragment,f),b(a),r=!0)},o(f){M(e.$$.fragment,f),M(a),r=!1},d(f){f&&(m(l),m(s)),x(e,f),a&&a.d(f)}}}function Zi(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function o(f){r=f,t(2,r)}const a=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,o,a]}class Ki extends Te{constructor(e){super(),Be(this,e,Zi,Gi,De,{codeExecutions:0})}}function Qi(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){N(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function Xi(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Yi extends Te{constructor(e){super(),Be(this,e,Xi,Qi,De,{className:0,strokeWidth:1})}}function $i(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){N(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function xi(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class eo extends Te{constructor(e){super(),Be(this,e,xi,$i,De,{className:0,strokeWidth:1})}}function to(n){let e,t,l,s,r,i,o,a,f,u,h,c;s=new yt({props:{id:`${n[0]}-float-prompt`,content:n[4]}});const g=[ro,so],_=[];function D(y,w){return w&32&&(a=null),a==null&&(a=y[5].trim()===""),a?0:1}f=D(n,-1),u=_[f]=g[f](n);let p=n[6]&&ts(n);return{c(){e=I("div"),t=I("div"),l=I("div"),X(s.$$.fragment),r=A(),i=I("div"),o=I("div"),u.c(),h=A(),p&&p.c(),this.h()},l(y){e=E(y,"DIV",{class:!0});var w=k(e);t=E(w,"DIV",{class:!0});var R=k(t);l=E(R,"DIV",{class:!0});var B=k(l);Y(s.$$.fragment,B),B.forEach(m),R.forEach(m),r=H(w),i=E(w,"DIV",{class:!0});var O=k(i);o=E(O,"DIV",{class:!0,id:!0});var V=k(o);u.l(V),h=H(V),p&&p.l(V),V.forEach(m),O.forEach(m),w.forEach(m),this.h()},h(){d(l,"class","font-medium"),d(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(o,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),d(o,"id","response-container"),d(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(y,w){N(y,e,w),v(e,t),v(t,l),$(s,l,null),v(e,r),v(e,i),v(i,o),_[f].m(o,null),v(o,h),p&&p.m(o,null),c=!0},p(y,w){const R={};w&1&&(R.id=`${y[0]}-float-prompt`),w&16&&(R.content=y[4]),s.$set(R);let B=f;f=D(y,w),f===B?_[f].p(y,w):(ee(),M(_[B],1,1,()=>{_[B]=null}),te(),u=_[f],u?u.p(y,w):(u=_[f]=g[f](y),u.c()),b(u,1),u.m(o,h)),y[6]?p?p.p(y,w):(p=ts(y),p.c(),p.m(o,null)):p&&(p.d(1),p=null)},i(y){c||(b(s.$$.fragment,y),b(u),c=!0)},o(y){M(s.$$.fragment,y),M(u),c=!1},d(y){y&&m(e),x(s),_[f].d(),p&&p.d()}}}function lo(n){let e,t,l,s;const r=[io,no],i=[];function o(a,f){return a[1]?1:0}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(a){t.l(a),l=fe()},m(a,f){i[e].m(a,f),N(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(ee(),M(i[u],1,1,()=>{i[u]=null}),te(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function so(n){let e,t;return e=new yt({props:{id:`${n[0]}-float-response`,content:n[5]}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.id=`${l[0]}-float-response`),s&32&&(r.content=l[5]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ro(n){let e,t;return e=new Qt({props:{size:"sm"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ts(n){let e,t,l=n[7].t("Add")+"",s,r,i;return{c(){e=I("div"),t=I("button"),s=W(l),this.h()},l(o){e=E(o,"DIV",{class:!0});var a=k(e);t=E(a,"BUTTON",{class:!0});var f=k(t);s=U(f,l),f.forEach(m),a.forEach(m),this.h()},h(){d(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(e,"class","flex justify-end pt-3 text-sm font-medium")},m(o,a){N(o,e,a),v(e,t),v(t,s),r||(i=ge(t,"click",n[11]),r=!0)},p(o,a){a&128&&l!==(l=o[7].t("Add")+"")&&G(s,l)},d(o){o&&m(e),r=!1,i()}}}function no(n){let e,t,l,s,r,i,o,a,f,u,h;return{c(){e=I("div"),t=I("input"),s=A(),r=I("div"),i=I("button"),o=be("svg"),a=be("path"),this.h()},l(c){e=E(c,"DIV",{class:!0});var g=k(e);t=E(g,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=H(g),r=E(g,"DIV",{class:!0});var _=k(r);i=E(_,"BUTTON",{class:!0});var D=k(i);o=ke(D,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var p=k(o);a=ke(p,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(a).forEach(m),p.forEach(m),D.forEach(m),_.forEach(m),g.forEach(m),this.h()},h(){d(t,"type","text"),d(t,"id","floating-message-input"),d(t,"class","ml-5 bg-transparent outline-none w-full flex-1 text-sm"),d(t,"placeholder",l=n[7].t("Ask a question")),d(a,"fill-rule","evenodd"),d(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),d(a,"clip-rule","evenodd"),d(o,"xmlns","http://www.w3.org/2000/svg"),d(o,"viewBox","0 0 16 16"),d(o,"fill","currentColor"),d(o,"class","size-4"),d(i,"class",f=(n[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),d(r,"class","ml-1 mr-2"),d(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border dark:border-gray-800 w-72 rounded-full shadow-xl")},m(c,g){N(c,e,g),v(e,t),nt(t,n[3]),v(e,s),v(e,r),v(r,i),v(i,o),v(o,a),u||(h=[ge(t,"input",n[18]),ge(t,"keydown",n[19]),ge(i,"click",n[20])],u=!0)},p(c,g){g&128&&l!==(l=c[7].t("Ask a question"))&&d(t,"placeholder",l),g&8&&t.value!==c[3]&&nt(t,c[3]),g&8&&f!==(f=(c[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&d(i,"class",f)},i:ve,o:ve,d(c){c&&m(e),u=!1,et(h)}}}function io(n){let e,t,l,s,r,i="Ask",o,a,f,u,h,c="Explain",g,_,D;return l=new Yi({props:{className:"size-3 shrink-0"}}),f=new eo({props:{className:"size-3 shrink-0"}}),{c(){e=I("div"),t=I("button"),X(l.$$.fragment),s=A(),r=I("div"),r.textContent=i,o=A(),a=I("button"),X(f.$$.fragment),u=A(),h=I("div"),h.textContent=c,this.h()},l(p){e=E(p,"DIV",{class:!0});var y=k(e);t=E(y,"BUTTON",{class:!0});var w=k(t);Y(l.$$.fragment,w),s=H(w),r=E(w,"DIV",{class:!0,"data-svelte-h":!0}),Pe(r)!=="svelte-1ugwo9q"&&(r.textContent=i),w.forEach(m),o=H(y),a=E(y,"BUTTON",{class:!0});var R=k(a);Y(f.$$.fragment,R),u=H(R),h=E(R,"DIV",{class:!0,"data-svelte-h":!0}),Pe(h)!=="svelte-1sxc82g"&&(h.textContent=c),R.forEach(m),y.forEach(m),this.h()},h(){d(r,"class","shrink-0"),d(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded flex items-center gap-1 min-w-fit"),d(h,"class","shrink-0"),d(a,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded flex items-center gap-1 min-w-fit"),d(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(p,y){N(p,e,y),v(e,t),$(l,t,null),v(t,s),v(t,r),v(e,o),v(e,a),$(f,a,null),v(a,u),v(a,h),g=!0,_||(D=[ge(t,"click",n[16]),ge(a,"click",n[17])],_=!0)},p:ve,i(p){g||(b(l.$$.fragment,p),b(f.$$.fragment,p),g=!0)},o(p){M(l.$$.fragment,p),M(f.$$.fragment,p),g=!1},d(p){p&&m(e),x(l),x(f),_=!1,et(D)}}}function oo(n){let e,t,l,s,r;const i=[lo,to],o=[];function a(f,u){return f[5]===null?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=I("div"),l.c(),this.h()},l(f){e=E(f,"DIV",{id:!0,class:!0,style:!0});var u=k(e);l.l(u),u.forEach(m),this.h()},h(){d(e,"id",s=`floating-buttons-${n[0]}`),d(e,"class","absolute rounded-lg mt-1 text-xs z-[9999]"),St(e,"display","none")},m(f,u){N(f,e,u),o[t].m(e,null),r=!0},p(f,[u]){let h=t;t=a(f),t===h?o[t].p(f,u):(ee(),M(o[h],1,1,()=>{o[h]=null}),te(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),b(l,1),l.m(e,null)),(!r||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&d(e,"id",s)},i(f){r||(b(l),r=!0)},o(f){M(l),r=!1},d(f){f&&m(e),o[t].d()}}}function ao(n,e,t){let l;const s=qe("i18n");Ie(n,s,C=>t(7,l=C));let{id:r=""}=e,{model:i=null}=e,{messages:o=[]}=e,{onAdd:a=()=>{}}=e,f=!1,u="",h="",c="",g=null,_=!1;const D=async()=>{const C=document.getElementById("response-container");C.scrollHeight-C.clientHeight<=C.scrollTop+50&&(C.scrollTop=C.scrollHeight)},p=async()=>{if(!i){Le.error("Model not selected");return}t(4,c=`${h}
\`\`\`
${u}
\`\`\``),t(3,h=""),t(5,g="");const[C,T]=await _l(localStorage.token,{model:i,messages:[...o,{role:"user",content:c}].map(j=>({role:j.role,content:j.content})),stream:!0});if(C&&C.ok){const j=C.body.getReader(),q=new TextDecoder;await(async()=>{var ie,se;for(;;){const{done:oe,value:J}=await j.read();if(oe)break;const me=q.decode(J,{stream:!0}).split(`
`).filter(_e=>_e.trim()!=="");for(const _e of me)if(_e.startsWith("data: "))if(_e.startsWith("data: [DONE]")){t(6,_=!0),await Ne(),D();continue}else try{const Z=JSON.parse(_e.slice(6));Z.choices&&((se=(ie=Z.choices[0])==null?void 0:ie.delta)!=null&&se.content)&&(t(5,g+=Z.choices[0].delta.content),D())}catch(Z){console.error(Z)}}})()}else Le.error("An error occurred while fetching the explanation")},y=async()=>{if(!i){Le.error("Model not selected");return}t(4,c=`Explain this section to me in more detail

\`\`\`
${u}
\`\`\``),t(5,g="");const[C,T]=await _l(localStorage.token,{model:i,messages:[...o,{role:"user",content:c}].map(j=>({role:j.role,content:j.content})),stream:!0});if(C&&C.ok){const j=C.body.getReader(),q=new TextDecoder;await(async()=>{var ie,se;for(;;){const{done:oe,value:J}=await j.read();if(oe)break;const me=q.decode(J,{stream:!0}).split(`
`).filter(_e=>_e.trim()!=="");for(const _e of me)if(_e.startsWith("data: "))if(_e.startsWith("data: [DONE]")){t(6,_=!0),await Ne(),D();continue}else try{const Z=JSON.parse(_e.slice(6));Z.choices&&((se=(ie=Z.choices[0])==null?void 0:ie.delta)!=null&&se.content)&&(t(5,g+=Z.choices[0].delta.content),D())}catch(Z){console.error(Z)}}})()}else Le.error("An error occurred while fetching the explanation")},w=async()=>{a({modelId:i,parentId:r,messages:[{role:"user",content:c},{role:"assistant",content:g}]})},R=()=>{t(5,g=null),t(6,_=!1),t(1,f=!1),t(3,h="")},B=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Ne(),setTimeout(()=>{const C=document.getElementById("floating-message-input");C&&C.focus()},0)},O=()=>{t(2,u=window.getSelection().toString()),y()};function V(){h=this.value,t(3,h)}const L=C=>{C.key==="Enter"&&p()},S=()=>{p()};return n.$$set=C=>{"id"in C&&t(0,r=C.id),"model"in C&&t(12,i=C.model),"messages"in C&&t(13,o=C.messages),"onAdd"in C&&t(14,a=C.onAdd)},[r,f,u,h,c,g,_,l,s,p,y,w,i,o,a,R,B,O,V,L,S]}class fo extends Te{constructor(e){super(),Be(this,e,ao,oo,De,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function ls(n){var s;let e,t,l={id:n[0],model:(s=n[3])==null?void 0:s.id,messages:Jt(n[2],n[0]),onAdd:n[19]};return e=new fo({props:l}),n[20](e),{c(){X(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,i){$(e,r,i),t=!0},p(r,i){var a;const o={};i&1&&(o.id=r[0]),i&8&&(o.model=(a=r[3])==null?void 0:a.id),i&5&&(o.messages=Jt(r[2],r[0])),i&512&&(o.onAdd=r[19]),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){M(e.$$.fragment,r),t=!1},d(r){n[20](null),x(e,r)}}}function uo(n){let e,t,l,s,r;t=new yt({props:{id:n[0],content:n[1],model:n[3],save:n[5],sourceIds:(n[4]??[]).reduce(ss,[]),onSourceClick:n[7],onTaskClick:n[8]}}),t.$on("update",n[16]),t.$on("code",n[17]);let i=n[6]&&n[3]&&ls(n);return{c(){e=I("div"),X(t.$$.fragment),l=A(),i&&i.c(),s=fe()},l(o){e=E(o,"DIV",{});var a=k(e);Y(t.$$.fragment,a),a.forEach(m),l=H(o),i&&i.l(o),s=fe()},m(o,a){N(o,e,a),$(t,e,null),n[18](e),N(o,l,a),i&&i.m(o,a),N(o,s,a),r=!0},p(o,[a]){const f={};a&1&&(f.id=o[0]),a&2&&(f.content=o[1]),a&8&&(f.model=o[3]),a&32&&(f.save=o[5]),a&16&&(f.sourceIds=(o[4]??[]).reduce(ss,[])),a&128&&(f.onSourceClick=o[7]),a&256&&(f.onTaskClick=o[8]),t.$set(f),o[6]&&o[3]?i?(i.p(o,a),a&72&&b(i,1)):(i=ls(o),i.c(),b(i,1),i.m(s.parentNode,s)):i&&(ee(),M(i,1,1,()=>{i=null}),te())},i(o){r||(b(t.$$.fragment,o),b(i),r=!0)},o(o){M(t.$$.fragment,o),M(i),r=!1},d(o){o&&(m(e),m(l),m(s)),x(t),n[18](null),i&&i.d(o)}}}const ss=(n,e)=>{let t=[];return e.document.forEach((l,s)=>{var o,a;const r=(o=e.metadata)==null?void 0:o[s],i=(r==null?void 0:r.source)??"N/A";return r!=null&&r.name?(t.push(r.name),t):(i.startsWith("http://")||i.startsWith("https://")?t.push(i):t.push(((a=e==null?void 0:e.source)==null?void 0:a.name)??i),t)}),n=[...n,...t],n.filter((l,s)=>n.indexOf(l)===s)};function co(n,e,t){let l,s;Ie(n,Ir,T=>t(12,l=T)),Ie(n,xr,T=>t(13,s=T)),qe("i18n");const r=gt();let{id:i}=e,{content:o}=e,{history:a}=e,{model:f=null}=e,{sources:u=null}=e,{save:h=!1}=e,{floatingButtons:c=!0}=e,{onSourceClick:g=()=>{}}=e,{onTaskClick:_=()=>{}}=e,{onAddMessages:D=()=>{}}=e,p,y;const w=T=>{const j=document.getElementById(`floating-buttons-${i}`);if(!(p!=null&&p.contains(T.target))&&!(j!=null&&j.contains(T.target))){R();return}setTimeout(async()=>{if(await Ne(),!(p!=null&&p.contains(T.target)))return;let q=window.getSelection();if(q.toString().trim().length>0){const ie=q.getRangeAt(0).getBoundingClientRect(),se=p.getBoundingClientRect(),oe=ie.bottom-se.top,J=ie.left-se.left;if(j){j.style.display="block";const le=se.width-J;let me=l?window.innerWidth/2:window.innerWidth/3;if(le<me){const _e=se.right-ie.right;j.style.right=`${_e}px`,j.style.left="auto"}else j.style.left=`${J}px`,j.style.right="auto";j.style.top=`${oe+5}px`}}else R()},0)},R=()=>{const T=document.getElementById(`floating-buttons-${i}`);T&&(T.style.display="none"),y&&y.closeHandler()},B=T=>{T.key==="Escape"&&R()};bt(()=>{c&&(p==null||p.addEventListener("mouseup",w),document.addEventListener("mouseup",w),document.addEventListener("keydown",B))}),Qr(()=>{c&&(p==null||p.removeEventListener("mouseup",w),document.removeEventListener("mouseup",w),document.removeEventListener("keydown",B))});const O=T=>{r("update",T.detail)},V=T=>{const{lang:j,code:q}=T.detail;(["html","svg"].includes(j)||j==="xml"&&q.includes("svg"))&&!l&&s&&(en.set(!0),tn.set(!0))};function L(T){We[T?"unshift":"push"](()=>{p=T,t(10,p)})}const S=({modelId:T,parentId:j,messages:q})=>{console.log(T,j,q),D({modelId:T,parentId:j,messages:q}),R()};function C(T){We[T?"unshift":"push"](()=>{y=T,t(11,y)})}return n.$$set=T=>{"id"in T&&t(0,i=T.id),"content"in T&&t(1,o=T.content),"history"in T&&t(2,a=T.history),"model"in T&&t(3,f=T.model),"sources"in T&&t(4,u=T.sources),"save"in T&&t(5,h=T.save),"floatingButtons"in T&&t(6,c=T.floatingButtons),"onSourceClick"in T&&t(7,g=T.onSourceClick),"onTaskClick"in T&&t(8,_=T.onTaskClick),"onAddMessages"in T&&t(9,D=T.onAddMessages)},[i,o,a,f,u,h,c,g,_,D,p,y,l,s,r,R,O,V,L,S,C]}class ho extends Te{constructor(e){super(),Be(this,e,co,uo,De,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onTaskClick:8,onAddMessages:9})}}function rs(n,e,t){const l=n.slice();return l[75]=e[t],l}function Ut(n){var l,s,r;const e=n.slice(),t=(((l=e[12])==null?void 0:l.statusHistory)??[...(s=e[12])!=null&&s.status?[(r=e[12])==null?void 0:r.status]:[]]).at(-1);return e[78]=t,e}function ns(n,e,t){const l=n.slice();return l[79]=e[t],l}function mo(n){var s;let e,t=(((s=n[14])==null?void 0:s.name)??n[12].model)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(r){e=E(r,"SPAN",{class:!0});var i=k(e);l=U(i,t),i.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(r,i){N(r,e,i),v(e,l)},p(r,i){var o;i[0]&20480&&t!==(t=(((o=r[14])==null?void 0:o.name)??r[12].model)+"")&&G(l,t)},d(r){r&&m(e)}}}function is(n){let e,t,l;return t=new Re({props:{content:it(n[12].timestamp*1e3).format("LLLL"),$$slots:{default:[go]},$$scope:{ctx:n}}}),{c(){e=I("div"),X(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);Y(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){N(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&4096&&(i.content=it(s[12].timestamp*1e3).format("LLLL")),r[0]&4096|r[2]&1048576&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function go(n){let e,t=Pt(n[12].timestamp*1e3)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var r=k(e);l=U(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){N(s,e,r),v(e,l)},p(s,r){r[0]&4096&&t!==(t=Pt(s[12].timestamp*1e3)+"")&&G(l,t)},d(s){s&&m(e)}}}function _o(n){var i;let e,t,l,s;e=new Re({props:{content:((i=n[14])==null?void 0:i.name)??n[12].model,placement:"top-start",$$slots:{default:[mo]},$$scope:{ctx:n}}});let r=n[12].timestamp&&is(n);return{c(){X(e.$$.fragment),t=A(),r&&r.c(),l=fe()},l(o){Y(e.$$.fragment,o),t=H(o),r&&r.l(o),l=fe()},m(o,a){$(e,o,a),N(o,t,a),r&&r.m(o,a),N(o,l,a),s=!0},p(o,a){var u;const f={};a[0]&20480&&(f.content=((u=o[14])==null?void 0:u.name)??o[12].model),a[0]&20480|a[2]&1048576&&(f.$$scope={dirty:a,ctx:o}),e.$set(f),o[12].timestamp?r?(r.p(o,a),a[0]&4096&&b(r,1)):(r=is(o),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(ee(),M(r,1,1,()=>{r=null}),te())},i(o){s||(b(e.$$.fragment,o),b(r),s=!0)},o(o){M(e.$$.fragment,o),M(r),s=!1},d(o){o&&(m(t),m(l)),x(e,o),r&&r.d(o)}}}function os(n){let e,t,l=Ee(n[12].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=fs(ns(n,l,i));const r=i=>M(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=E(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,o){N(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&4096){l=Ee(i[12].files);let a;for(a=0;a<l.length;a+=1){const f=ns(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=fs(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(ee(),a=l.length;a<s.length;a+=1)r(a);te()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)M(s[o]);t=!1},d(i){i&&m(e),Ue(s,i)}}}function as(n){let e,t;return e=new Vr({props:{src:n[79].url,alt:n[12].content}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.src=l[79].url),s[0]&4096&&(r.alt=l[12].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function fs(n){let e,t,l,s=n[79].type==="image"&&as(n);return{c(){e=I("div"),s&&s.c(),t=A()},l(r){e=E(r,"DIV",{});var i=k(e);s&&s.l(i),t=H(i),i.forEach(m)},m(r,i){N(r,e,i),s&&s.m(e,null),v(e,t),l=!0},p(r,i){r[79].type==="image"?s?(s.p(r,i),i[0]&4096&&b(s,1)):(s=as(r),s.c(),b(s,1),s.m(e,t)):s&&(ee(),M(s,1,1,()=>{s=null}),te())},i(r){l||(b(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(e),s&&s.d()}}}function us(n){var s;let e,t,l=!((s=n[78])!=null&&s.hidden)&&cs(n);return{c(){l&&l.c(),e=fe()},l(r){l&&l.l(r),e=fe()},m(r,i){l&&l.m(r,i),N(r,e,i),t=!0},p(r,i){var o;(o=r[78])!=null&&o.hidden?l&&(ee(),M(l,1,1,()=>{l=null}),te()):l?(l.p(r,i),i[0]&4096&&b(l,1)):(l=cs(r),l.c(),b(l,1),l.m(e.parentNode,e))},i(r){t||(b(l),t=!0)},o(r){M(l),t=!1},d(r){r&&m(e),l&&l.d(r)}}}function cs(n){var u;let e,t,l,s,r,i=((u=n[78])==null?void 0:u.done)===!1&&ds();const o=[bo,po,vo],a=[];function f(h,c){var g,_,D;return((g=h[78])==null?void 0:g.action)==="web_search"&&((_=h[78])!=null&&_.urls)?0:((D=h[78])==null?void 0:D.action)==="knowledge_search"?1:2}return l=f(n),s=a[l]=o[l](n),{c(){e=I("div"),i&&i.c(),t=A(),s.c(),this.h()},l(h){e=E(h,"DIV",{class:!0});var c=k(e);i&&i.l(c),t=H(c),s.l(c),c.forEach(m),this.h()},h(){d(e,"class","status-description flex items-center gap-2 py-0.5")},m(h,c){N(h,e,c),i&&i.m(e,null),v(e,t),a[l].m(e,null),r=!0},p(h,c){var _;((_=h[78])==null?void 0:_.done)===!1?i?c[0]&4096&&b(i,1):(i=ds(),i.c(),b(i,1),i.m(e,t)):i&&(ee(),M(i,1,1,()=>{i=null}),te());let g=l;l=f(h),l===g?a[l].p(h,c):(ee(),M(a[g],1,1,()=>{a[g]=null}),te(),s=a[l],s?s.p(h,c):(s=a[l]=o[l](h),s.c()),b(s,1),s.m(e,null))},i(h){r||(b(i),b(s),r=!0)},o(h){M(i),M(s),r=!1},d(h){h&&m(e),i&&i.d(),a[l].d()}}}function ds(n){let e,t,l;return t=new Wt({props:{className:"size-4"}}),{c(){e=I("div"),X(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);Y(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","")},m(s,r){N(s,e,r),$(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function vo(n){let e,t,l,s;function r(a,f){var u,h,c;return f[0]&4096&&(l=null),l==null&&(l=!!((u=a[78])!=null&&u.description.includes("{{searchQuery}}"))),l?Io:((h=a[78])==null?void 0:h.description)==="No search query generated"?yo:((c=a[78])==null?void 0:c.description)==="Generating search query"?wo:ko}let i=r(n,[-1,-1,-1]),o=i(n);return{c(){e=I("div"),t=I("div"),o.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=k(e);t=E(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;d(t,"class",s=(((a=n[78])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){N(a,e,f),v(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&4096&&s!==(s=(((u=a[78])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",s)},i:ve,o:ve,d(a){a&&m(e),o.d()}}}function po(n){let e,t,l=n[24].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[78].query})+"",s,r;return{c(){e=I("div"),t=I("div"),s=W(l),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=k(e);t=E(o,"DIV",{class:!0});var a=k(t);s=U(a,l),a.forEach(m),o.forEach(m),this.h()},h(){var i;d(t,"class",r=(((i=n[78])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,o){N(i,e,o),v(e,t),v(t,s)},p(i,o){var a;o[0]&16781312&&l!==(l=i[24].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[78].query})+"")&&G(s,l),o[0]&4096&&r!==(r=(((a=i[78])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",r)},i:ve,o:ve,d(i){i&&m(e)}}}function bo(n){let e,t;return e=new $n({props:{status:n[78],$$slots:{default:[Vo]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.status=l[78]),s[0]&16781312|s[2]&1048576&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ko(n){var l;let e=((l=n[78])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=U(s,e)},m(s,r){N(s,t,r)},p(s,r){var i;r[0]&4096&&e!==(e=((i=s[78])==null?void 0:i.description)+"")&&G(t,e)},d(s){s&&m(t)}}}function wo(n){let e=n[24].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("Generating search query")+"")&&G(t,e)},d(l){l&&m(t)}}}function yo(n){let e=n[24].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("No search query generated")+"")&&G(t,e)},d(l){l&&m(t)}}}function Io(n){var l,s;let e=n[24].t((l=n[78])==null?void 0:l.description,{searchQuery:(s=n[78])==null?void 0:s.query})+"",t;return{c(){t=W(e)},l(r){t=U(r,e)},m(r,i){N(r,t,i)},p(r,i){var o,a;i[0]&16781312&&e!==(e=r[24].t((o=r[78])==null?void 0:o.description,{searchQuery:(a=r[78])==null?void 0:a.query})+"")&&G(t,e)},d(r){r&&m(t)}}}function Eo(n){var l;let e=((l=n[78])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=U(s,e)},m(s,r){N(s,t,r)},p(s,r){var i;r[0]&4096&&e!==(e=((i=s[78])==null?void 0:i.description)+"")&&G(t,e)},d(s){s&&m(t)}}}function Mo(n){let e=n[24].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("Generating search query")+"")&&G(t,e)},d(l){l&&m(t)}}}function No(n){let e=n[24].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("No search query generated")+"")&&G(t,e)},d(l){l&&m(t)}}}function Do(n){var l,s;let e=n[24].t((l=n[78])==null?void 0:l.description,{count:(s=n[78])==null?void 0:s.urls.length})+"",t;return{c(){t=W(e)},l(r){t=U(r,e)},m(r,i){N(r,t,i)},p(r,i){var o,a;i[0]&16781312&&e!==(e=r[24].t((o=r[78])==null?void 0:o.description,{count:(a=r[78])==null?void 0:a.urls.length})+"")&&G(t,e)},d(r){r&&m(t)}}}function Vo(n){let e,t,l,s;function r(a,f){var u,h,c;return f[0]&4096&&(l=null),l==null&&(l=!!((u=a[78])!=null&&u.description.includes("{{count}}"))),l?Do:((h=a[78])==null?void 0:h.description)==="No search query generated"?No:((c=a[78])==null?void 0:c.description)==="Generating search query"?Mo:Eo}let i=r(n,[-1,-1,-1]),o=i(n);return{c(){e=I("div"),t=I("div"),o.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=k(e);t=E(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;d(t,"class",s=(((a=n[78])==null?void 0:a.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){N(a,e,f),v(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&4096&&s!==(s=(((u=a[78])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&d(t,"class",s)},d(a){a&&m(e),o.d()}}}function Co(n){var _,D,p,y,w,R,B;let e,t,l,s,r,i,o;const a=[Ro,Bo],f=[];function u(O,V){return O[12].content===""&&!O[12].error?0:O[12].content&&O[12].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=a[t](n));let h=((_=n[12])==null?void 0:_.error)&&hs(n),c=(((D=n[12])==null?void 0:D.sources)||((p=n[12])==null?void 0:p.citations))&&(((B=(R=(w=(y=n[14])==null?void 0:y.info)==null?void 0:w.meta)==null?void 0:R.capabilities)==null?void 0:B.citations)??!0)&&ms(n),g=n[12].code_executions&&gs(n);return{c(){e=I("div"),l&&l.c(),s=A(),h&&h.c(),r=A(),c&&c.c(),i=A(),g&&g.c(),this.h()},l(O){e=E(O,"DIV",{class:!0,id:!0});var V=k(e);l&&l.l(V),s=H(V),h&&h.l(V),r=H(V),c&&c.l(V),i=H(V),g&&g.l(V),V.forEach(m),this.h()},h(){d(e,"class","w-full flex flex-col relative"),d(e,"id","response-content-container")},m(O,V){N(O,e,V),~t&&f[t].m(e,null),v(e,s),h&&h.m(e,null),v(e,r),c&&c.m(e,null),v(e,i),g&&g.m(e,null),o=!0},p(O,V){var S,C,T,j,q,ae,ie;let L=t;t=u(O),t===L?~t&&f[t].p(O,V):(l&&(ee(),M(f[L],1,1,()=>{f[L]=null}),te()),~t?(l=f[t],l?l.p(O,V):(l=f[t]=a[t](O),l.c()),b(l,1),l.m(e,s)):l=null),(S=O[12])!=null&&S.error?h?(h.p(O,V),V[0]&4096&&b(h,1)):(h=hs(O),h.c(),b(h,1),h.m(e,r)):h&&(ee(),M(h,1,1,()=>{h=null}),te()),((C=O[12])!=null&&C.sources||(T=O[12])!=null&&T.citations)&&(((ie=(ae=(q=(j=O[14])==null?void 0:j.info)==null?void 0:q.meta)==null?void 0:ae.capabilities)==null?void 0:ie.citations)??!0)?c?(c.p(O,V),V[0]&20480&&b(c,1)):(c=ms(O),c.c(),b(c,1),c.m(e,i)):c&&(ee(),M(c,1,1,()=>{c=null}),te()),O[12].code_executions?g?(g.p(O,V),V[0]&4096&&b(g,1)):(g=gs(O),g.c(),b(g,1),g.m(e,null)):g&&(ee(),M(g,1,1,()=>{g=null}),te())},i(O){o||(b(l),b(h),b(c),b(g),o=!0)},o(O){M(l),M(h),M(c),M(g),o=!1},d(O){O&&m(e),~t&&f[t].d(),h&&h.d(),c&&c.d(),g&&g.d()}}}function To(n){let e,t,l,s,r,i,o,a=n[24].t("Save As Copy")+"",f,u,h,c,g=n[24].t("Cancel")+"",_,D,p,y=n[24].t("Save")+"",w,R,B;return{c(){e=I("div"),t=I("textarea"),s=A(),r=I("div"),i=I("div"),o=I("button"),f=W(a),u=A(),h=I("div"),c=I("button"),_=W(g),D=A(),p=I("button"),w=W(y),this.h()},l(O){e=E(O,"DIV",{class:!0});var V=k(e);t=E(V,"TEXTAREA",{id:!0,class:!0}),k(t).forEach(m),s=H(V),r=E(V,"DIV",{class:!0});var L=k(r);i=E(L,"DIV",{});var S=k(i);o=E(S,"BUTTON",{id:!0,class:!0});var C=k(o);f=U(C,a),C.forEach(m),S.forEach(m),u=H(L),h=E(L,"DIV",{class:!0});var T=k(h);c=E(T,"BUTTON",{id:!0,class:!0});var j=k(c);_=U(j,g),j.forEach(m),D=H(T),p=E(T,"BUTTON",{id:!0,class:!0});var q=k(p);w=U(q,y),q.forEach(m),T.forEach(m),L.forEach(m),V.forEach(m),this.h()},h(){d(t,"id",l="message-edit-"+n[12].id),d(t,"class","bg-transparent outline-none w-full resize-none"),d(o,"id","save-new-message-button"),d(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(c,"id","close-edit-message-button"),d(c,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(p,"id","confirm-edit-message-button"),d(p,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(h,"class","flex space-x-1.5"),d(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(O,V){N(O,e,V),v(e,t),n[44](t),nt(t,n[15]),v(e,s),v(e,r),v(r,i),v(i,o),v(o,f),v(r,u),v(r,h),v(h,c),v(c,_),v(h,D),v(h,p),v(p,w),R||(B=[ge(t,"input",n[45]),ge(t,"input",$o),ge(t,"keydown",n[46]),ge(o,"click",n[47]),ge(c,"click",n[48]),ge(p,"click",n[49])],R=!0)},p(O,V){V[0]&4096&&l!==(l="message-edit-"+O[12].id)&&d(t,"id",l),V[0]&32768&&nt(t,O[15]),V[0]&16777216&&a!==(a=O[24].t("Save As Copy")+"")&&G(f,a),V[0]&16777216&&g!==(g=O[24].t("Cancel")+"")&&G(_,g),V[0]&16777216&&y!==(y=O[24].t("Save")+"")&&G(w,y)},i:ve,o:ve,d(O){O&&m(e),n[44](null),R=!1,et(B)}}}function Bo(n){var l;let e,t;return e=new ho({props:{id:n[12].id,history:n[0],content:n[12].content,sources:n[12].sources,floatingButtons:(l=n[12])==null?void 0:l.done,save:!n[11],model:n[14],onTaskClick:n[50],onSourceClick:n[51],onAddMessages:n[52]}}),e.$on("update",n[53]),e.$on("select",n[54]),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&4096&&(i.id=s[12].id),r[0]&1&&(i.history=s[0]),r[0]&4096&&(i.content=s[12].content),r[0]&4096&&(i.sources=s[12].sources),r[0]&4096&&(i.floatingButtons=(o=s[12])==null?void 0:o.done),r[0]&2048&&(i.save=!s[11]),r[0]&16384&&(i.model=s[14]),r[0]&512&&(i.onAddMessages=s[52]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Ro(n){let e,t;return e=new Qt({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function hs(n){var l,s;let e,t;return e=new ri({props:{content:((s=(l=n[12])==null?void 0:l.error)==null?void 0:s.content)??n[12].content}}),{c(){X(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,i){$(e,r,i),t=!0},p(r,i){var a,f;const o={};i[0]&4096&&(o.content=((f=(a=r[12])==null?void 0:a.error)==null?void 0:f.content)??r[12].content),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){M(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function ms(n){var l,s;let e,t;return e=new Bi({props:{sources:((l=n[12])==null?void 0:l.sources)??((s=n[12])==null?void 0:s.citations)}}),{c(){X(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,i){$(e,r,i),t=!0},p(r,i){var a,f;const o={};i[0]&4096&&(o.sources=((a=r[12])==null?void 0:a.sources)??((f=r[12])==null?void 0:f.citations)),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){M(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function gs(n){let e,t;return e=new Ki({props:{codeExecutions:n[12].code_executions}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.codeExecutions=l[12].code_executions),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function _s(n){let e,t,l,s=(n[12].done||n[1].length>1)&&vs(n),r=n[12].done&&n[20]&&Ts(n);return{c(){s&&s.c(),e=A(),r&&r.c(),t=fe()},l(i){s&&s.l(i),e=H(i),r&&r.l(i),t=fe()},m(i,o){s&&s.m(i,o),N(i,e,o),r&&r.m(i,o),N(i,t,o),l=!0},p(i,o){i[12].done||i[1].length>1?s?(s.p(i,o),o[0]&4098&&b(s,1)):(s=vs(i),s.c(),b(s,1),s.m(e.parentNode,e)):s&&(ee(),M(s,1,1,()=>{s=null}),te()),i[12].done&&i[20]?r?(r.p(i,o),o[0]&1052672&&b(r,1)):(r=Ts(i),r.c(),b(r,1),r.m(t.parentNode,t)):r&&(ee(),M(r,1,1,()=>{r=null}),te())},i(i){l||(b(s),b(r),l=!0)},o(i){M(s),M(r),l=!1},d(i){i&&(m(e),m(t)),s&&s.d(i),r&&r.d(i)}}}function vs(n){let e,t,l,s=n[1].length>1&&ps(n),r=n[12].done&&bs(n);return{c(){e=I("div"),s&&s.c(),t=A(),r&&r.c(),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=k(e);s&&s.l(o),t=H(o),r&&r.l(o),o.forEach(m),this.h()},h(){d(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(i,o){N(i,e,o),s&&s.m(e,null),v(e,t),r&&r.m(e,null),l=!0},p(i,o){i[1].length>1?s?s.p(i,o):(s=ps(i),s.c(),s.m(e,t)):s&&(s.d(1),s=null),i[12].done?r?(r.p(i,o),o[0]&4096&&b(r,1)):(r=bs(i),r.c(),b(r,1),r.m(e,null)):r&&(ee(),M(r,1,1,()=>{r=null}),te())},i(i){l||(b(r),l=!0)},o(i){M(r),l=!1},d(i){i&&m(e),s&&s.d(),r&&r.d()}}}function ps(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i=n[1].indexOf(n[12].id)+1+"",o,a,f=n[1].length+"",u,h,c,g='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',_,D;return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=A(),r=I("div"),o=W(i),a=W("/"),u=W(f),h=A(),c=I("button"),c.innerHTML=g,this.h()},l(p){e=E(p,"DIV",{class:!0,dir:!0});var y=k(e);t=E(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=H(y),r=E(y,"DIV",{class:!0});var w=k(r);o=U(w,i),a=U(w,"/"),u=U(w,f),w.forEach(m),h=H(y),c=E(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(c)!=="svelte-107ksnk"&&(c.innerHTML=g),y.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(r,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"),d(c,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center min-w-fit"),d(e,"dir","ltr")},m(p,y){N(p,e,y),v(e,t),v(e,s),v(e,r),v(r,o),v(r,a),v(r,u),v(e,h),v(e,c),_||(D=[ge(t,"click",n[55]),ge(c,"click",n[56])],_=!0)},p(p,y){y[0]&4098&&i!==(i=p[1].indexOf(p[12].id)+1+"")&&G(o,i),y[0]&2&&f!==(f=p[1].length+"")&&G(u,f)},d(p){p&&m(e),_=!1,et(D)}}}function bs(n){var _,D,p,y;let e,t,l,s,r,i,o,a,f,u=!n[11]&&ks(n);t=new Re({props:{content:n[24].t("Copy"),placement:"bottom",$$slots:{default:[Oo]},$$scope:{ctx:n}}}),s=new Re({props:{content:n[24].t("Read Aloud"),placement:"bottom",$$slots:{default:[Ao]},$$scope:{ctx:n}}});let h=((_=n[23])==null?void 0:_.features.enable_image_generation)&&(n[25].role==="admin"||((y=(p=(D=n[25])==null?void 0:D.permissions)==null?void 0:p.features)==null?void 0:y.image_generation))&&!n[11]&&ys(n),c=n[12].usage&&Is(n),g=!n[11]&&Es(n);return{c(){u&&u.c(),e=A(),X(t.$$.fragment),l=A(),X(s.$$.fragment),r=A(),h&&h.c(),i=A(),c&&c.c(),o=A(),g&&g.c(),a=fe()},l(w){u&&u.l(w),e=H(w),Y(t.$$.fragment,w),l=H(w),Y(s.$$.fragment,w),r=H(w),h&&h.l(w),i=H(w),c&&c.l(w),o=H(w),g&&g.l(w),a=fe()},m(w,R){u&&u.m(w,R),N(w,e,R),$(t,w,R),N(w,l,R),$(s,w,R),N(w,r,R),h&&h.m(w,R),N(w,i,R),c&&c.m(w,R),N(w,o,R),g&&g.m(w,R),N(w,a,R),f=!0},p(w,R){var V,L,S,C;w[11]?u&&(ee(),M(u,1,1,()=>{u=null}),te()):u?(u.p(w,R),R[0]&2048&&b(u,1)):(u=ks(w),u.c(),b(u,1),u.m(e.parentNode,e));const B={};R[0]&16777216&&(B.content=w[24].t("Copy")),R[0]&5120|R[2]&1048576&&(B.$$scope={dirty:R,ctx:w}),t.$set(B);const O={};R[0]&16777216&&(O.content=w[24].t("Read Aloud")),R[0]&398336|R[2]&1048576&&(O.$$scope={dirty:R,ctx:w}),s.$set(O),(V=w[23])!=null&&V.features.enable_image_generation&&(w[25].role==="admin"||(C=(S=(L=w[25])==null?void 0:L.permissions)==null?void 0:S.features)!=null&&C.image_generation)&&!w[11]?h?(h.p(w,R),R[0]&41945088&&b(h,1)):(h=ys(w),h.c(),b(h,1),h.m(i.parentNode,i)):h&&(ee(),M(h,1,1,()=>{h=null}),te()),w[12].usage?c?(c.p(w,R),R[0]&4096&&b(c,1)):(c=Is(w),c.c(),b(c,1),c.m(o.parentNode,o)):c&&(ee(),M(c,1,1,()=>{c=null}),te()),w[11]?g&&(ee(),M(g,1,1,()=>{g=null}),te()):g?(g.p(w,R),R[0]&2048&&b(g,1)):(g=Es(w),g.c(),b(g,1),g.m(a.parentNode,a))},i(w){f||(b(u),b(t.$$.fragment,w),b(s.$$.fragment,w),b(h),b(c),b(g),f=!0)},o(w){M(u),M(t.$$.fragment,w),M(s.$$.fragment,w),M(h),M(c),M(g),f=!1},d(w){w&&(m(e),m(l),m(r),m(i),m(o),m(a)),u&&u.d(w),x(t,w),x(s,w),h&&h.d(w),c&&c.d(w),g&&g.d(w)}}}function ks(n){var s,r,i;let e,t,l=(n[25].role==="user"?((i=(r=(s=n[25])==null?void 0:s.permissions)==null?void 0:r.chat)==null?void 0:i.edit)??!0:!0)&&ws(n);return{c(){l&&l.c(),e=fe()},l(o){l&&l.l(o),e=fe()},m(o,a){l&&l.m(o,a),N(o,e,a),t=!0},p(o,a){var f,u,h;o[25].role!=="user"||(((h=(u=(f=o[25])==null?void 0:f.permissions)==null?void 0:u.chat)==null?void 0:h.edit)??!0)?l?(l.p(o,a),a[0]&33554432&&b(l,1)):(l=ws(o),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ee(),M(l,1,1,()=>{l=null}),te())},i(o){t||(b(l),t=!0)},o(o){M(l),t=!1},d(o){o&&m(e),l&&l.d(o)}}}function ws(n){let e,t;return e=new Re({props:{content:n[24].t("Edit"),placement:"bottom",$$slots:{default:[So]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&16777216&&(r.content=l[24].t("Edit")),s[0]&1024|s[2]&1048576&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function So(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=k(e);t=ke(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,a){N(o,e,a),v(e,t),v(t,l),r||(i=ge(e,"click",n[57]),r=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function Oo(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=k(e);t=ke(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(o,a){N(o,e,a),v(e,t),v(t,l),r||(i=ge(e,"click",n[58]),r=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function Lo(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){N(l,e,s),v(e,t)},d(l){l&&m(e)}}}function Po(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){N(l,e,s),v(e,t)},d(l){l&&m(e)}}}function jo(n){let e,t,l,s,r,i;return{c(){e=be("svg"),t=be("style"),l=W(`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),s=be("circle"),r=be("circle"),i=be("circle"),this.h()},l(o){e=ke(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=k(e);t=ke(a,"style",{});var f=k(t);l=U(f,`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),f.forEach(m),s=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),r=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),i=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),a.forEach(m),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(r,"class","spinner_S1WN spinner_Km9P"),d(r,"cx","12"),d(r,"cy","12"),d(r,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){N(o,e,a),v(e,t),v(t,l),v(e,s),v(e,r),v(e,i)},d(o){o&&m(e)}}}function Ao(n){let e,t,l,s,r;function i(f,u){return f[18]?jo:f[17]?Po:Lo}let o=i(n),a=o(n);return{c(){e=I("button"),a.c(),this.h()},l(f){e=E(f,"BUTTON",{id:!0,class:!0});var u=k(e);a.l(u),u.forEach(m),this.h()},h(){d(e,"id",t="speak-button-"+n[12].id),d(e,"class",l=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){N(f,e,u),a.m(e,null),s||(r=ge(e,"click",n[59]),s=!0)},p(f,u){o!==(o=i(f))&&(a.d(1),a=o(f),a&&(a.c(),a.m(e,null))),u[0]&4096&&t!==(t="speak-button-"+f[12].id)&&d(e,"id",t),u[0]&1024&&l!==(l=(f[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",l)},d(f){f&&m(e),a.d(),s=!1,r()}}}function ys(n){let e,t;return e=new Re({props:{content:n[24].t("Generate Image"),placement:"bottom",$$slots:{default:[Wo]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&16777216&&(r.content=l[24].t("Generate Image")),s[0]&529408|s[2]&1048576&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ho(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){N(l,e,s),v(e,t)},d(l){l&&m(e)}}}function zo(n){let e,t,l,s,r,i;return{c(){e=be("svg"),t=be("style"),l=W(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=be("circle"),r=be("circle"),i=be("circle"),this.h()},l(o){e=ke(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=k(e);t=ke(a,"style",{});var f=k(t);l=U(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),r=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),i=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),a.forEach(m),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(r,"class","spinner_S1WN spinner_Km9P"),d(r,"cx","12"),d(r,"cy","12"),d(r,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){N(o,e,a),v(e,t),v(t,l),v(e,s),v(e,r),v(e,i)},d(o){o&&m(e)}}}function Wo(n){let e,t,l,s;function r(a,f){return a[19]?zo:Ho}let i=r(n),o=i(n);return{c(){e=I("button"),o.c(),this.h()},l(a){e=E(a,"BUTTON",{class:!0});var f=k(e);o.l(f),f.forEach(m),this.h()},h(){d(e,"class",t=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){N(a,e,f),o.m(e,null),l||(s=ge(e,"click",n[60]),l=!0)},p(a,f){i!==(i=r(a))&&(o.d(1),o=i(a),o&&(o.c(),o.m(e,null))),f[0]&1024&&t!==(t=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",t)},d(a){a&&m(e),o.d(),l=!1,s()}}}function Is(n){let e,t;return e=new Re({props:{content:n[12].usage?`<pre>${pt(JSON.stringify(n[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ss).map(Os).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[Uo]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.content=l[12].usage?`<pre>${pt(JSON.stringify(l[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ss).map(Os).join(`
`))}</pre>`:""),s[0]&5120|s[2]&1048576&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Uo(n){let e,t,l,s,r,i,o;return{c(){e=I("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=E(a,"BUTTON",{class:!0,id:!0});var f=k(e);t=ke(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),d(e,"id",r="info-"+n[12].id)},m(a,f){N(a,e,f),v(e,t),v(t,l),i||(o=ge(e,"click",n[61]),i=!0)},p(a,f){f[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&d(e,"class",s),f[0]&4096&&r!==(r="info-"+a[12].id)&&d(e,"id",r)},d(a){a&&m(e),i=!1,o()}}}function Es(n){var c;let e,t,l,s,r,i,o,a=(((c=n[23])==null?void 0:c.features.enable_message_rating)??!0)&&Ms(n),f=n[10]&&Ns(n);l=new Re({props:{content:n[24].t("Regenerate"),placement:"bottom",$$slots:{default:[Go]},$$scope:{ctx:n}}});let u=n[1].length>1&&Ds(n),h=n[10]&&Vs(n);return{c(){a&&a.c(),e=A(),f&&f.c(),t=A(),X(l.$$.fragment),s=A(),u&&u.c(),r=A(),h&&h.c(),i=fe()},l(g){a&&a.l(g),e=H(g),f&&f.l(g),t=H(g),Y(l.$$.fragment,g),s=H(g),u&&u.l(g),r=H(g),h&&h.l(g),i=fe()},m(g,_){a&&a.m(g,_),N(g,e,_),f&&f.m(g,_),N(g,t,_),$(l,g,_),N(g,s,_),u&&u.m(g,_),N(g,r,_),h&&h.m(g,_),N(g,i,_),o=!0},p(g,_){var p;((p=g[23])==null?void 0:p.features.enable_message_rating)??!0?a?(a.p(g,_),_[0]&8388608&&b(a,1)):(a=Ms(g),a.c(),b(a,1),a.m(e.parentNode,e)):a&&(ee(),M(a,1,1,()=>{a=null}),te()),g[10]?f?(f.p(g,_),_[0]&1024&&b(f,1)):(f=Ns(g),f.c(),b(f,1),f.m(t.parentNode,t)):f&&(ee(),M(f,1,1,()=>{f=null}),te());const D={};_[0]&16777216&&(D.content=g[24].t("Regenerate")),_[0]&1070336|_[2]&1048576&&(D.$$scope={dirty:_,ctx:g}),l.$set(D),g[1].length>1?u?(u.p(g,_),_[0]&2&&b(u,1)):(u=Ds(g),u.c(),b(u,1),u.m(r.parentNode,r)):u&&(ee(),M(u,1,1,()=>{u=null}),te()),g[10]?h?(h.p(g,_),_[0]&1024&&b(h,1)):(h=Vs(g),h.c(),b(h,1),h.m(i.parentNode,i)):h&&(ee(),M(h,1,1,()=>{h=null}),te())},i(g){o||(b(a),b(f),b(l.$$.fragment,g),b(u),b(h),o=!0)},o(g){M(a),M(f),M(l.$$.fragment,g),M(u),M(h),o=!1},d(g){g&&(m(e),m(t),m(s),m(r),m(i)),a&&a.d(g),f&&f.d(g),x(l,g),u&&u.d(g),h&&h.d(g)}}}function Ms(n){let e,t,l,s;return e=new Re({props:{content:n[24].t("Good Response"),placement:"bottom",$$slots:{default:[qo]},$$scope:{ctx:n}}}),l=new Re({props:{content:n[24].t("Bad Response"),placement:"bottom",$$slots:{default:[Fo]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment),t=A(),X(l.$$.fragment)},l(r){Y(e.$$.fragment,r),t=H(r),Y(l.$$.fragment,r)},m(r,i){$(e,r,i),N(r,t,i),$(l,r,i),s=!0},p(r,i){const o={};i[0]&16777216&&(o.content=r[24].t("Good Response")),i[0]&2102272|i[2]&1048576&&(o.$$scope={dirty:i,ctx:r}),e.$set(o);const a={};i[0]&16777216&&(a.content=r[24].t("Bad Response")),i[0]&2102272|i[2]&1048576&&(a.$$scope={dirty:i,ctx:r}),l.$set(a)},i(r){s||(b(e.$$.fragment,r),b(l.$$.fragment,r),s=!0)},o(r){M(e.$$.fragment,r),M(l.$$.fragment,r),s=!1},d(r){r&&m(t),x(e,r),x(l,r)}}}function qo(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=k(e);t=ke(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=ke(f,"path",{d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){var o,a;d(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=n[12])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[21]},m(o,a){N(o,e,a),v(e,t),v(t,l),r||(i=ge(e,"click",n[62]),r=!0)},p(o,a){var f,u;a[0]&5120&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",s),a[0]&2097152&&(e.disabled=o[21])},d(o){o&&m(e),r=!1,i()}}}function Fo(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=k(e);t=ke(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=ke(f,"path",{d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){var o,a;d(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=n[12])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[21]},m(o,a){N(o,e,a),v(e,t),v(t,l),r||(i=ge(e,"click",n[63]),r=!0)},p(o,a){var f,u;a[0]&5120&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",s),a[0]&2097152&&(e.disabled=o[21])},d(o){o&&m(e),r=!1,i()}}}function Ns(n){let e,t;return e=new Re({props:{content:n[24].t("Continue Response"),placement:"bottom",$$slots:{default:[Jo]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&16777216&&(r.content=l[24].t("Continue Response")),s[0]&1152|s[2]&1048576&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Jo(n){let e,t,l,s,r,i,o;return{c(){e=I("button"),t=be("svg"),l=be("path"),s=be("path"),this.h()},l(a){e=E(a,"BUTTON",{type:!0,id:!0,class:!0});var f=k(e);t=ke(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),s=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),d(s,"stroke-linecap","round"),d(s,"stroke-linejoin","round"),d(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"id","continue-response-button"),d(e,"class",r=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){N(a,e,f),v(e,t),v(t,l),v(t,s),i||(o=ge(e,"click",n[64]),i=!0)},p(a,f){f[0]&1024&&r!==(r=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function Go(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=E(o,"BUTTON",{type:!0,class:!0});var a=k(e);t=ke(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){N(o,e,a),v(e,t),v(t,l),r||(i=ge(e,"click",n[65]),r=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function Ds(n){let e,t;return e=new Re({props:{content:n[24].t("Delete"),placement:"bottom",$$slots:{default:[Zo]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&16777216&&(r.content=l[24].t("Delete")),s[0]&1024|s[2]&1048576&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Zo(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=E(o,"BUTTON",{type:!0,id:!0,class:!0});var a=k(e);t=ke(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"id","continue-response-button"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){N(o,e,a),v(e,t),v(t,l),r||(i=ge(e,"click",n[66]),r=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function Vs(n){var i;let e,t,l=Ee(((i=n[14])==null?void 0:i.actions)??[]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Cs(rs(n,l,o));const r=o=>M(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=fe()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=fe()},m(o,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,a);N(o,e,a),t=!0},p(o,a){var f;if(a[0]&21536){l=Ee(((f=o[14])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const h=rs(o,l,u);s[u]?(s[u].p(h,a),b(s[u],1)):(s[u]=Cs(h),s[u].c(),b(s[u],1),s[u].m(e.parentNode,e))}for(ee(),u=l.length;u<s.length;u+=1)r(u);te()}},i(o){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)M(s[a]);t=!1},d(o){o&&m(e),Ue(s,o)}}}function Ko(n){let e,t;return e=new ti({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Qo(n){let e,t,l,s,r;return{c(){e=I("div"),t=I("img"),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=k(e);t=E(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(m),this.h()},h(){Ot(t.src,l=n[75].icon_url)||d(t,"src",l),d(t,"class",s="w-4 h-4 "+(n[75].icon_url.includes("svg")?"dark:invert-[80%]":"")),St(t,"fill","currentColor"),d(t,"alt",r=n[75].name),d(e,"class","size-4")},m(i,o){N(i,e,o),v(e,t)},p(i,o){o[0]&16384&&!Ot(t.src,l=i[75].icon_url)&&d(t,"src",l),o[0]&16384&&s!==(s="w-4 h-4 "+(i[75].icon_url.includes("svg")?"dark:invert-[80%]":""))&&d(t,"class",s),o[0]&16384&&r!==(r=i[75].name)&&d(t,"alt",r)},i:ve,o:ve,d(i){i&&m(e)}}}function Xo(n){let e,t,l,s,r,i,o,a;const f=[Qo,Ko],u=[];function h(g,_){return g[75].icon_url?0:1}t=h(n),l=u[t]=f[t](n);function c(){return n[67](n[75])}return{c(){e=I("button"),l.c(),r=A(),this.h()},l(g){e=E(g,"BUTTON",{type:!0,class:!0});var _=k(e);l.l(_),_.forEach(m),r=H(g),this.h()},h(){d(e,"type","button"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(g,_){N(g,e,_),u[t].m(e,null),N(g,r,_),i=!0,o||(a=ge(e,"click",c),o=!0)},p(g,_){n=g;let D=t;t=h(n),t===D?u[t].p(n,_):(ee(),M(u[D],1,1,()=>{u[D]=null}),te(),l=u[t],l?l.p(n,_):(l=u[t]=f[t](n),l.c()),b(l,1),l.m(e,null)),(!i||_[0]&1024&&s!==(s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&d(e,"class",s)},i(g){i||(b(l),i=!0)},o(g){M(l),i=!1},d(g){g&&(m(e),m(r)),u[t].d(),o=!1,a()}}}function Cs(n){let e,t;return e=new Re({props:{content:n[75].name,placement:"bottom",$$slots:{default:[Xo]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.content=l[75].name),s[0]&21536|s[2]&1048576&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ts(n){let e,t,l,s;function r(a){n[68](a)}function i(a){n[69](a)}let o={};return n[12]!==void 0&&(o.message=n[12]),n[20]!==void 0&&(o.show=n[20]),e=new Jn({props:o}),We.push(()=>$e(e,"message",r)),We.push(()=>$e(e,"show",i)),e.$on("save",n[70]),{c(){X(e.$$.fragment)},l(a){Y(e.$$.fragment,a)},m(a,f){$(e,a,f),s=!0},p(a,f){const u={};!t&&f[0]&4096&&(t=!0,u.message=a[12],Ye(()=>t=!1)),!l&&f[0]&1048576&&(l=!0,u.show=a[20],Ye(()=>l=!1)),e.$set(u)},i(a){s||(b(e.$$.fragment,a),s=!0)},o(a){M(e.$$.fragment,a),s=!1},d(a){x(e,a)}}}function Bs(n){var ae,ie,se,oe,J,le,me,_e;let e,t,l,s,r,i,o,a,f,u=((ae=n[12])==null?void 0:ae.files)&&((ie=n[12].files)==null?void 0:ie.filter(Rs).length)>0,h,c,g,_,D,p,y,w,R,B,O,V;l=new Dr({props:{src:((J=(oe=(se=n[14])==null?void 0:se.info)==null?void 0:oe.meta)==null?void 0:J.profile_image_url)??(n[24].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`),className:"size-8"}}),o=new Zt({props:{$$slots:{default:[_o]},$$scope:{ctx:n}}});let L=u&&os(n),S=(((le=n[12])==null?void 0:le.statusHistory)??[...(me=n[12])!=null&&me.status?[(_e=n[12])==null?void 0:_e.status]:[]]).length>0&&us(Ut(n));const C=[To,Co],T=[];function j(Z,z){return Z[13]===!0?0:1}D=j(n),p=T[D]=C[D](n);let q=!n[13]&&_s(n);return{c(){e=I("div"),t=I("div"),X(l.$$.fragment),r=A(),i=I("div"),X(o.$$.fragment),a=A(),f=I("div"),L&&L.c(),h=A(),c=I("div"),g=I("div"),S&&S.c(),_=A(),p.c(),w=A(),q&&q.c(),this.h()},l(Z){e=E(Z,"DIV",{class:!0,id:!0,dir:!0});var z=k(e);t=E(z,"DIV",{class:!0});var ue=k(t);Y(l.$$.fragment,ue),ue.forEach(m),r=H(z),i=E(z,"DIV",{class:!0});var re=k(i);Y(o.$$.fragment,re),a=H(re),f=E(re,"DIV",{});var Q=k(f);L&&L.l(Q),h=H(Q),c=E(Q,"DIV",{class:!0});var P=k(c);g=E(P,"DIV",{});var K=k(g);S&&S.l(K),_=H(K),p.l(K),K.forEach(m),P.forEach(m),w=H(Q),q&&q.l(Q),Q.forEach(m),re.forEach(m),z.forEach(m),this.h()},h(){var Z;d(t,"class",s=fl(`flex-shrink-0 ${(((Z=n[22])==null?void 0:Z.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"),d(c,"class",y="chat-"+n[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),d(i,"class","flex-auto w-0 pl-1"),d(e,"class",R="flex w-full message-"+n[12].id+" svelte-1u5gq5j"),d(e,"id",B="message-"+n[12].id),d(e,"dir",O=n[22].chatDirection)},m(Z,z){N(Z,e,z),v(e,t),$(l,t,null),v(e,r),v(e,i),$(o,i,null),v(i,a),v(i,f),L&&L.m(f,null),v(f,h),v(f,c),v(c,g),S&&S.m(g,null),v(g,_),T[D].m(g,null),v(f,w),q&&q.m(f,null),V=!0},p(Z,z){var P,K,he,de,we,ce,ne,pe,Ve;const ue={};z[0]&16793600&&(ue.src=((he=(K=(P=Z[14])==null?void 0:P.info)==null?void 0:K.meta)==null?void 0:he.profile_image_url)??(Z[24].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`)),l.$set(ue),(!V||z[0]&4194304&&s!==(s=fl(`flex-shrink-0 ${(((de=Z[22])==null?void 0:de.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"))&&d(t,"class",s);const re={};z[0]&20480|z[2]&1048576&&(re.$$scope={dirty:z,ctx:Z}),o.$set(re),z[0]&4096&&(u=((we=Z[12])==null?void 0:we.files)&&((ce=Z[12].files)==null?void 0:ce.filter(Rs).length)>0),u?L?(L.p(Z,z),z[0]&4096&&b(L,1)):(L=os(Z),L.c(),b(L,1),L.m(f,h)):L&&(ee(),M(L,1,1,()=>{L=null}),te()),(((ne=Z[12])==null?void 0:ne.statusHistory)??[...(pe=Z[12])!=null&&pe.status?[(Ve=Z[12])==null?void 0:Ve.status]:[]]).length>0?S?(S.p(Ut(Z),z),z[0]&4096&&b(S,1)):(S=us(Ut(Z)),S.c(),b(S,1),S.m(g,_)):S&&(ee(),M(S,1,1,()=>{S=null}),te());let Q=D;D=j(Z),D===Q?T[D].p(Z,z):(ee(),M(T[Q],1,1,()=>{T[Q]=null}),te(),p=T[D],p?p.p(Z,z):(p=T[D]=C[D](Z),p.c()),b(p,1),p.m(g,null)),(!V||z[0]&4096&&y!==(y="chat-"+Z[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&d(c,"class",y),Z[13]?q&&(ee(),M(q,1,1,()=>{q=null}),te()):q?(q.p(Z,z),z[0]&8192&&b(q,1)):(q=_s(Z),q.c(),b(q,1),q.m(f,null)),(!V||z[0]&4096&&R!==(R="flex w-full message-"+Z[12].id+" svelte-1u5gq5j"))&&d(e,"class",R),(!V||z[0]&4096&&B!==(B="message-"+Z[12].id))&&d(e,"id",B),(!V||z[0]&4194304&&O!==(O=Z[22].chatDirection))&&d(e,"dir",O)},i(Z){V||(b(l.$$.fragment,Z),b(o.$$.fragment,Z),b(L),b(S),b(p),b(q),V=!0)},o(Z){M(l.$$.fragment,Z),M(o.$$.fragment,Z),M(L),M(S),M(p),M(q),V=!1},d(Z){Z&&m(e),x(l),x(o),L&&L.d(),S&&S.d(),T[D].d(),q&&q.d()}}}function Yo(n){let e=n[12].id,t,l,s=Bs(n);return{c(){s.c(),t=fe()},l(r){s.l(r),t=fe()},m(r,i){s.m(r,i),N(r,t,i),l=!0},p(r,i){i[0]&4096&&De(e,e=r[12].id)?(ee(),M(s,1,1,ve),te(),s=Bs(r),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(t),s.d(r)}}}const Rs=n=>n.type==="image",$o=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},Ss=n=>n.slice(2),Os=n=>n.endsWith(",")?n.slice(0,-1):n;function xo(n,e,t){let l,s,r,i,o,a;Ie(n,At,F=>t(43,l=F)),Ie(n,Ht,F=>t(22,s=F)),Ie(n,Er,F=>t(23,r=F)),Ie(n,cl,F=>t(73,i=F)),Ie(n,zt,F=>t(25,a=F));const f=qe("i18n");Ie(n,f,F=>t(24,o=F));const u=gt();let{chatId:h=""}=e,{history:c}=e,{messageId:g}=e,_=JSON.parse(JSON.stringify(c.messages[g])),{siblings:D}=e,{showPreviousMessage:p}=e,{showNextMessage:y}=e,{updateChat:w}=e,{editMessage:R}=e,{saveMessage:B}=e,{rateMessage:O}=e,{actionMessage:V}=e,{deleteMessage:L}=e,{submitMessage:S}=e,{continueResponse:C}=e,{regenerateResponse:T}=e,{addMessages:j}=e,{isLastMessage:q=!0}=e,{readOnly:ae=!1}=e,ie=null,se=!1,oe="",J,le={},me=!1,_e,Z=!1,z=!1,ue=!1;const re=async F=>{await Mr(F)&&Le.success(o.t("Copying to clipboard was successful!"))},Q=F=>new Promise(Me=>{_e=F;const ye=le[F];if(!ye)return Me();ye.play(),ye.onended=async()=>{await new Promise(Oe=>setTimeout(Oe,300)),Object.keys(le).length-1===F&&t(17,me=!1),Me()}}),P=async()=>{var F,Me,ye,Oe,Ke,Qe,Vt,ct,kt,Se,Je,rt,wt,Ct,Xt,Yt,$t,xt,el,tl,ll,sl,rl;if(me){try{speechSynthesis.cancel(),_e!==void 0&&le[_e]&&(le[_e].pause(),le[_e].currentTime=0)}catch{}t(17,me=!1),_e=void 0;return}if(!((_==null?void 0:_.content)??"").trim().length){Le.info(o.t("No content to speak"));return}if(t(17,me=!0),r.audio.tts.engine===""){let Ge=[];const _t=setInterval(()=>{var Ze,dt,Xe;if(Ge=speechSynthesis.getVoices(),Ge.length>0){clearInterval(_t);const ze=((Ze=Ge==null?void 0:Ge.filter(mt=>{var nl,il,ol,al;return mt.voiceURI===(((il=(nl=s==null?void 0:s.audio)==null?void 0:nl.tts)==null?void 0:il.voice)??((al=(ol=r==null?void 0:r.audio)==null?void 0:ol.tts)==null?void 0:al.voice))}))==null?void 0:Ze.at(0))??void 0;console.log(ze);const ht=new SpeechSynthesisUtterance(_.content);ht.rate=((Xe=(dt=s.audio)==null?void 0:dt.tts)==null?void 0:Xe.playbackRate)??1,console.log(ht),ht.onend=()=>{var mt;t(17,me=!1),s.conversationMode&&((mt=document.getElementById("voice-input-button"))==null||mt.click())},ze&&(ht.voice=ze),speechSynthesis.speak(ht)}},100)}else{t(18,Z=!0);const Ge=fn(_.content,((Me=(F=r==null?void 0:r.audio)==null?void 0:F.tts)==null?void 0:Me.split_on)??"punctuation");if(!Ge.length){console.log("No content to speak"),Le.info(o.t("No content to speak")),t(17,me=!1),t(18,Z=!1);return}console.debug("Prepared message content for TTS",Ge),le=Ge.reduce((Ze,dt,Xe)=>(Ze[Xe]=null,Ze),{});let _t=Promise.resolve();if(((Oe=(ye=s.audio)==null?void 0:ye.tts)==null?void 0:Oe.engine)==="browser-kokoro"){i||(await cl.set(new Mn({dtype:((Vt=(Qe=(Ke=s.audio)==null?void 0:Ke.tts)==null?void 0:Qe.engineConfig)==null?void 0:Vt.dtype)??"fp32"})),await i.init());for(const[Ze,dt]of Ge.entries()){const Xe=await i.generate({text:dt,voice:((kt=(ct=s==null?void 0:s.audio)==null?void 0:ct.tts)==null?void 0:kt.voice)??((Je=(Se=r==null?void 0:r.audio)==null?void 0:Se.tts)==null?void 0:Je.voice)}).catch(ze=>{console.error(ze),Le.error(`${ze}`),t(17,me=!1),t(18,Z=!1)});if(Xe){const ze=new Audio(Xe);ze.playbackRate=((wt=(rt=s.audio)==null?void 0:rt.tts)==null?void 0:wt.playbackRate)??1,le[Ze]=ze,t(18,Z=!1),_t=_t.then(()=>Q(Ze))}}}else for(const[Ze,dt]of Ge.entries()){const Xe=await dn(localStorage.token,((Xt=(Ct=s==null?void 0:s.audio)==null?void 0:Ct.tts)==null?void 0:Xt.defaultVoice)===r.audio.tts.voice?(($t=(Yt=s==null?void 0:s.audio)==null?void 0:Yt.tts)==null?void 0:$t.voice)??((el=(xt=r==null?void 0:r.audio)==null?void 0:xt.tts)==null?void 0:el.voice):(ll=(tl=r==null?void 0:r.audio)==null?void 0:tl.tts)==null?void 0:ll.voice,dt).catch(ze=>{console.error(ze),Le.error(`${ze}`),t(17,me=!1),t(18,Z=!1)});if(Xe){const ze=await Xe.blob(),ht=URL.createObjectURL(ze),mt=new Audio(ht);mt.playbackRate=((rl=(sl=s.audio)==null?void 0:sl.tts)==null?void 0:rl.playbackRate)??1,le[Ze]=mt,t(18,Z=!1),_t=_t.then(()=>Q(Ze))}}}},K=async()=>{t(13,se=!0),t(15,oe=_.content),await Ne(),t(16,J.style.height="",J),t(16,J.style.height=`${J.scrollHeight}px`,J)},he=async()=>{R(_.id,oe||"",!1),t(13,se=!1),t(15,oe=""),await Ne()},de=async()=>{R(_.id,oe||""),t(13,se=!1),t(15,oe=""),await Ne()},we=async()=>{t(13,se=!1),t(15,oe=""),await Ne()},ce=async F=>{t(19,z=!0);const Me=await hn(localStorage.token,F.content).catch(ye=>{Le.error(`${ye}`)});if(console.log(Me),Me){const ye=Me.map(Oe=>({type:"image",url:`${Oe.url}`}));B(F.id,{...F,files:ye})}t(19,z=!1)};let ne=!1;const pe=async(F=null,Me=null)=>{var kt;t(21,ne=!0),console.log("Feedback",F,Me);const ye={..._,annotation:{...(_==null?void 0:_.annotation)??{},...F!==null?{rating:F}:{},...Me||{}}},Oe=await nn(localStorage.token,h).catch(Se=>{Le.error(`${Se}`)});if(!Oe)return;const Ke=Jt(c,_.id);let Qe={type:"rating",data:{...ye!=null&&ye.annotation?ye.annotation:{},model_id:(_==null?void 0:_.selectedModelId)??_.model,...c.messages[_.parentId].childrenIds.length>1?{sibling_model_ids:c.messages[_.parentId].childrenIds.filter(Se=>Se!==_.id).map(Se=>{var Je;return((Je=c.messages[Se])==null?void 0:Je.selectedModelId)??c.messages[Se].model})}:{}},meta:{arena:_?_.arena:!1,model_id:_.model,message_id:_.id,message_index:Ke.length,chat_id:h},snapshot:{chat:Oe}};const Vt=[Qe.data.model_id,...Qe.data.sibling_model_ids??[]].reduce((Se,Je)=>{var wt;const rt=l.find(Ct=>Ct.id===Je);return rt?Se[rt.id]=((wt=rt==null?void 0:rt.info)==null?void 0:wt.base_model_id)??null:console.warn(`Model with ID ${Je} not found`),Se},{});Qe.meta.base_models=Vt;let ct=null;if(_!=null&&_.feedbackId?ct=await gl(localStorage.token,_.feedbackId,Qe).catch(Se=>{Le.error(`${Se}`)}):(ct=await un(localStorage.token,Qe).catch(Se=>{Le.error(`${Se}`)}),ct&&(ye.feedbackId=ct.id)),console.log(ye),B(_.id,ye),await Ne(),!Me&&(t(20,ue=!0),!((kt=ye.annotation)!=null&&kt.tags))){const Se=await cn(localStorage.token,_.model,Ke,h).catch(Je=>(console.error(Je),[]));console.log(Se),Se&&(ye.annotation.tags=Se,Qe.data.tags=Se,B(_.id,ye),await gl(localStorage.token,ye.feedbackId,Qe).catch(Je=>{Le.error(`${Je}`)}))}t(21,ne=!1)},Ve=async()=>{L(_.id)};bt(async()=>{await Ne()});function je(F){We[F?"unshift":"push"](()=>{J=F,t(16,J)})}function Ce(){oe=this.value,t(15,oe)}const Ae=F=>{var Oe,Ke;F.key==="Escape"&&((Oe=document.getElementById("close-edit-message-button"))==null||Oe.click());const Me=F.metaKey||F.ctrlKey,ye=F.key==="Enter";Me&&ye&&((Ke=document.getElementById("confirm-edit-message-button"))==null||Ke.click())},He=()=>{de()},Fe=()=>{we()},tt=()=>{he()},lt=async F=>{console.log(F)},ot=async F=>{console.log(F);let Me=document.getElementById(`source-${F}`);const ye=document.getElementById("collapsible-sources");Me?Me.click():ye&&(ye.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(Oe=>{requestAnimationFrame(()=>{requestAnimationFrame(Oe)})}),Me=document.getElementById(`source-${F}`),Me&&Me.click())},at=({modelId:F,parentId:Me,messages:ye})=>{j({modelId:F,parentId:Me,messages:ye})},xe=F=>{const{raw:Me,oldContent:ye,newContent:Oe}=F.detail;t(0,c.messages[_.id].content=c.messages[_.id].content.replace(Me,Me.replace(ye,Oe)),c),w()},ft=F=>{var Oe;const{type:Me,content:ye}=F.detail;if(Me==="explain")S(_.id,`Explain this section to me in more detail

\`\`\`
${ye}
\`\`\``);else if(Me==="ask"){const Ke=((Oe=F.detail)==null?void 0:Oe.input)??"";S(_.id,`\`\`\`
${ye}
\`\`\`
${Ke}`)}},ut=()=>{p(_)},st=()=>{y(_)},It=()=>{K()},Et=()=>{re(_.content)},Mt=()=>{Z||P()},Nt=()=>{z||ce(_)},Dt=()=>{console.log(_)},Or=async()=>{await pe(1),window.setTimeout(()=>{var F;(F=document.getElementById(`message-feedback-${_.id}`))==null||F.scrollIntoView()},0)},Lr=async()=>{await pe(-1),window.setTimeout(()=>{var F;(F=document.getElementById(`message-feedback-${_.id}`))==null||F.scrollIntoView()},0)},Pr=()=>{C()},jr=()=>{t(20,ue=!1),T(_),((ie==null?void 0:ie.actions)??[]).forEach(F=>{u("action",{id:F.id,event:{id:"regenerate-response",data:{messageId:_.id}}})})},Ar=()=>{Ve()},Hr=F=>{V(F.id,_)};function zr(F){_=F,t(12,_),t(0,c),t(38,g)}function Wr(F){ue=F,t(20,ue)}const Ur=async F=>{await pe(null,{...F.detail})};return n.$$set=F=>{"chatId"in F&&t(37,h=F.chatId),"history"in F&&t(0,c=F.history),"messageId"in F&&t(38,g=F.messageId),"siblings"in F&&t(1,D=F.siblings),"showPreviousMessage"in F&&t(2,p=F.showPreviousMessage),"showNextMessage"in F&&t(3,y=F.showNextMessage),"updateChat"in F&&t(4,w=F.updateChat),"editMessage"in F&&t(39,R=F.editMessage),"saveMessage"in F&&t(40,B=F.saveMessage),"rateMessage"in F&&t(41,O=F.rateMessage),"actionMessage"in F&&t(5,V=F.actionMessage),"deleteMessage"in F&&t(42,L=F.deleteMessage),"submitMessage"in F&&t(6,S=F.submitMessage),"continueResponse"in F&&t(7,C=F.continueResponse),"regenerateResponse"in F&&t(8,T=F.regenerateResponse),"addMessages"in F&&t(9,j=F.addMessages),"isLastMessage"in F&&t(10,q=F.isLastMessage),"readOnly"in F&&t(11,ae=F.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&4097|n.$$.dirty[1]&128&&c.messages&&JSON.stringify(_)!==JSON.stringify(c.messages[g])&&t(12,_=JSON.parse(JSON.stringify(c.messages[g]))),n.$$.dirty[0]&4096|n.$$.dirty[1]&4096&&t(14,ie=l.find(F=>F.id===_.model)),n.$$.dirty[0]&8192&&(se||(async()=>await Ne())())},[c,D,p,y,w,V,S,C,T,j,q,ae,_,se,ie,oe,J,me,Z,z,ue,ne,s,r,o,a,f,u,re,P,K,he,de,we,ce,pe,Ve,h,g,R,B,O,L,l,je,Ce,Ae,He,Fe,tt,lt,ot,at,xe,ft,ut,st,It,Et,Mt,Nt,Dt,Or,Lr,Pr,jr,Ar,Hr,zr,Wr,Ur]}class Sr extends Te{constructor(e){super(),Be(this,e,xo,Yo,De,{chatId:37,history:0,messageId:38,siblings:1,showPreviousMessage:2,showNextMessage:3,updateChat:4,editMessage:39,saveMessage:40,rateMessage:41,actionMessage:5,deleteMessage:42,submitMessage:6,continueResponse:7,regenerateResponse:8,addMessages:9,isLastMessage:10,readOnly:11},null,[-1,-1,-1])}}function ea(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){N(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function ta(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class la extends Te{constructor(e){super(),Be(this,e,ta,ea,De,{className:0,strokeWidth:1})}}function qt(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[16]=t,e}function Ls(n,e,t){const l=n.slice();return l[36]=e[t],l}function Ft(n){const e=n.slice(),t=e[19][e[36]].messageIds[e[20][e[36]]];return e[39]=t,e}function Ps(n){let e,t,l,s,r,i=Ee(Object.keys(n[19])),o=[];for(let u=0;u<i.length;u+=1)o[u]=zs(Ls(n,i,u));const a=u=>M(o[u],1,1,()=>{o[u]=null});let f=!n[4]&&Ws(n);return{c(){e=I("div"),t=I("div");for(let u=0;u<o.length;u+=1)o[u].c();s=A(),f&&f.c(),this.h()},l(u){e=E(u,"DIV",{});var h=k(e);t=E(h,"DIV",{class:!0,id:!0});var c=k(t);for(let g=0;g<o.length;g+=1)o[g].l(c);c.forEach(m),s=H(h),f&&f.l(h),h.forEach(m),this.h()},h(){d(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),d(t,"id",l="responses-container-"+n[1]+"-"+n[18].id)},m(u,h){N(u,e,h),v(e,t);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(t,null);v(e,s),f&&f.m(e,null),r=!0},p(u,h){if(h[0]&54132727){i=Ee(Object.keys(u[19]));let c;for(c=0;c<i.length;c+=1){const g=Ls(u,i,c);o[c]?(o[c].p(g,h),b(o[c],1)):(o[c]=zs(g),o[c].c(),b(o[c],1),o[c].m(t,null))}for(ee(),c=i.length;c<o.length;c+=1)a(c);te()}(!r||h[0]&262146&&l!==(l="responses-container-"+u[1]+"-"+u[18].id))&&d(t,"id",l),u[4]?f&&(ee(),M(f,1,1,()=>{f=null}),te()):f?(f.p(u,h),h[0]&16&&b(f,1)):(f=Ws(u),f.c(),b(f,1),f.m(e,null))},i(u){if(!r){for(let h=0;h<i.length;h+=1)b(o[h]);b(f),r=!0}},o(u){o=o.filter(Boolean);for(let h=0;h<o.length;h+=1)M(o[h]);M(f),r=!1},d(u){u&&m(e),Ue(o,u),f&&f.d()}}}function js(n){let e,t=n[0].currentId,l,s,r,i,o,a=Hs(n);function f(){return n[32](n[39])}return{c(){e=I("div"),a.c(),l=A(),this.h()},l(u){e=E(u,"DIV",{class:!0});var h=k(e);a.l(h),l=H(h),h.forEach(m),this.h()},h(){var u;d(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[36]?`border-gray-100 dark:border-gray-800 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-50 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,h){N(u,e,h),a.m(e,null),v(e,l),r=!0,i||(o=ge(e,"click",f),i=!0)},p(u,h){var c;n=u,h[0]&1&&De(t,t=n[0].currentId)?(ee(),M(a,1,1,ve),te(),a=Hs(n),a.c(),b(a,1),a.m(e,l)):a.p(n,h),(!r||h[0]&2621445&&s!==(s="snap-center w-full max-w-full m-1 border "+(((c=n[0].messages[n[2]])==null?void 0:c.modelIdx)==n[36]?`border-gray-100 dark:border-gray-800 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-50 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&d(e,"class",s)},i(u){r||(b(a),r=!0)},o(u){M(a),r=!1},d(u){u&&m(e),a.d(u),i=!1,o()}}}function As(n){let e,t;function l(){return n[29](n[36])}function s(){return n[30](n[36])}function r(...i){return n[31](n[36],...i)}return e=new Sr({props:{chatId:n[1],history:n[0],messageId:n[39],isLastMessage:!0,siblings:n[19][n[36]].messageIds,showPreviousMessage:l,showNextMessage:s,updateChat:n[5],editMessage:n[6],saveMessage:n[7],rateMessage:n[8],deleteMessage:n[11],actionMessage:n[9],submitMessage:n[10],continueResponse:n[12],regenerateResponse:r,addMessages:n[14],readOnly:n[4]}}),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),t=!0},p(i,o){n=i;const a={};o[0]&2&&(a.chatId=n[1]),o[0]&1&&(a.history=n[0]),o[0]&1572864&&(a.messageId=n[39]),o[0]&524288&&(a.siblings=n[19][n[36]].messageIds),o[0]&524288&&(a.showPreviousMessage=l),o[0]&524288&&(a.showNextMessage=s),o[0]&32&&(a.updateChat=n[5]),o[0]&64&&(a.editMessage=n[6]),o[0]&128&&(a.saveMessage=n[7]),o[0]&256&&(a.rateMessage=n[8]),o[0]&2048&&(a.deleteMessage=n[11]),o[0]&512&&(a.actionMessage=n[9]),o[0]&1024&&(a.submitMessage=n[10]),o[0]&4096&&(a.continueResponse=n[12]),o[0]&1581056&&(a.regenerateResponse=r),o[0]&16384&&(a.addMessages=n[14]),o[0]&16&&(a.readOnly=n[4]),e.$set(a)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){M(e.$$.fragment,i),t=!1},d(i){x(e,i)}}}function Hs(n){let e,t,l=n[16]&&As(n);return{c(){l&&l.c(),e=fe()},l(s){l&&l.l(s),e=fe()},m(s,r){l&&l.m(s,r),N(s,e,r),t=!0},p(s,r){s[16]?l?(l.p(s,r),r[0]&65536&&b(l,1)):(l=As(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ee(),M(l,1,1,()=>{l=null}),te())},i(s){t||(b(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function zs(n){let e,t,l=n[20][n[36]]!==void 0&&n[19][n[36]].messageIds.length>0&&js(Ft(n));return{c(){l&&l.c(),e=fe()},l(s){l&&l.l(s),e=fe()},m(s,r){l&&l.m(s,r),N(s,e,r),t=!0},p(s,r){s[20][s[36]]!==void 0&&s[19][s[36]].messageIds.length>0?l?(l.p(Ft(s),r),r[0]&1572864&&b(l,1)):(l=js(Ft(s)),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ee(),M(l,1,1,()=>{l=null}),te())},i(s){t||(b(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Ws(n){let e=!Object.keys(n[19]).find(n[28]),t,l,s=e&&Us(n);return{c(){s&&s.c(),t=fe()},l(r){s&&s.l(r),t=fe()},m(r,i){s&&s.m(r,i),N(r,t,i),l=!0},p(r,i){i[0]&1572865&&(e=!Object.keys(r[19]).find(r[28])),e?s?(s.p(r,i),i[0]&1572865&&b(s,1)):(s=Us(r),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(ee(),M(s,1,1,()=>{s=null}),te())},i(r){l||(b(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(t),s&&s.d(r)}}}function Us(n){var o,a;let e,t,l,s,r=((a=(o=n[0].messages[n[2]])==null?void 0:o.merged)==null?void 0:a.status)&&qs(qt(n)),i=n[3]&&Js(n);return{c(){e=I("div"),t=I("div"),r&&r.c(),l=A(),i&&i.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=k(e);t=E(u,"DIV",{class:!0});var h=k(t);r&&r.l(h),h.forEach(m),l=H(u),i&&i.l(u),u.forEach(m),this.h()},h(){d(t,"class","w-full"),d(e,"class","flex justify-end")},m(f,u){N(f,e,u),v(e,t),r&&r.m(t,null),v(e,l),i&&i.m(e,null),s=!0},p(f,u){var h,c;(c=(h=f[0].messages[f[2]])==null?void 0:h.merged)!=null&&c.status?r?(r.p(qt(f),u),u[0]&5&&b(r,1)):(r=qs(qt(f)),r.c(),b(r,1),r.m(t,null)):r&&(ee(),M(r,1,1,()=>{r=null}),te()),f[3]?i?(i.p(f,u),u[0]&8&&b(i,1)):(i=Js(f),i.c(),b(i,1),i.m(e,null)):i&&(ee(),M(i,1,1,()=>{i=null}),te())},i(f){s||(b(r),b(i),s=!0)},o(f){M(r),M(i),s=!1},d(f){f&&m(e),r&&r.d(),i&&i.d()}}}function qs(n){let e,t,l,s,r,i,o;t=new Zt({props:{$$slots:{default:[sa]},$$scope:{ctx:n}}});const a=[na,ra],f=[];function u(h,c){var g;return(((g=h[16])==null?void 0:g.content)??"")===""?0:1}return r=u(n),i=f[r]=a[r](n),{c(){e=I("div"),X(t.$$.fragment),l=A(),s=I("div"),i.c(),this.h()},l(h){e=E(h,"DIV",{class:!0});var c=k(e);Y(t.$$.fragment,c),l=H(c),s=E(c,"DIV",{class:!0});var g=k(s);i.l(g),g.forEach(m),c.forEach(m),this.h()},h(){d(s,"class","mt-1 markdown-prose w-full min-w-full"),d(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(h,c){N(h,e,c),$(t,e,null),v(e,l),v(e,s),f[r].m(s,null),o=!0},p(h,c){const g={};c[0]&5|c[1]&512&&(g.$$scope={dirty:c,ctx:h}),t.$set(g);let _=r;r=u(h),r===_?f[r].p(h,c):(ee(),M(f[_],1,1,()=>{f[_]=null}),te(),i=f[r],i?i.p(h,c):(i=f[r]=a[r](h),i.c()),b(i,1),i.m(s,null))},i(h){o||(b(t.$$.fragment,h),b(i),o=!0)},o(h){M(t.$$.fragment,h),M(i),o=!1},d(h){h&&m(e),x(t),f[r].d()}}}function Fs(n){let e,t=it(n[16].timestamp*1e3).format("LT")+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var r=k(e);l=U(r,t),r.forEach(m),this.h()},h(){d(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){N(s,e,r),v(e,l)},p(s,r){r[0]&5&&t!==(t=it(s[16].timestamp*1e3).format("LT")+"")&&G(l,t)},d(s){s&&m(e)}}}function sa(n){let e,t,l=n[16].timestamp&&Fs(n);return{c(){e=W(`Merged Response

									`),l&&l.c(),t=fe()},l(s){e=U(s,`Merged Response

									`),l&&l.l(s),t=fe()},m(s,r){N(s,e,r),l&&l.m(s,r),N(s,t,r)},p(s,r){s[16].timestamp?l?l.p(s,r):(l=Fs(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&(m(e),m(t)),l&&l.d(s)}}}function ra(n){let e,t;return e=new yt({props:{id:"merged",content:n[16].content??""}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[16].content??""),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function na(n){let e,t;return e=new Qt({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Js(n){let e,t,l;return t=new Re({props:{content:n[22].t("Merge Responses"),placement:"bottom",$$slots:{default:[ia]},$$scope:{ctx:n}}}),{c(){e=I("div"),X(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);Y(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","flex-shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){N(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&4194304&&(i.content=s[22].t("Merge Responses")),r[1]&512&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function ia(n){let e,t,l,s,r;return t=new la({props:{className:" size-5 "}}),{c(){e=I("button"),X(t.$$.fragment),this.h()},l(i){e=E(i,"BUTTON",{type:!0,id:!0,class:!0});var o=k(e);Y(t.$$.fragment,o),o.forEach(m),this.h()},h(){d(e,"type","button"),d(e,"id","merge-response-button"),d(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,o){N(i,e,o),$(t,e,null),l=!0,s||(r=ge(e,"click",n[33]),s=!0)},p:ve,i(i){l||(b(t.$$.fragment,i),l=!0)},o(i){M(t.$$.fragment,i),l=!1},d(i){i&&m(e),x(t),s=!1,r()}}}function oa(n){let e,t,l=n[18]&&Ps(n);return{c(){l&&l.c(),e=fe()},l(s){l&&l.l(s),e=fe()},m(s,r){l&&l.m(s,r),N(s,e,r),t=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&b(l,1)):(l=Ps(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ee(),M(l,1,1,()=>{l=null}),te())},i(s){t||(b(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function aa(n,e,t){let l,s;Ie(n,Ir,z=>t(21,l=z));const r=qe("i18n");Ie(n,r,z=>t(22,s=z)),it.extend(Nr);let{chatId:i}=e,{history:o}=e,{messageId:a}=e,{isLastMessage:f}=e,{readOnly:u=!1}=e,{updateChat:h}=e,{editMessage:c}=e,{saveMessage:g}=e,{rateMessage:_}=e,{actionMessage:D}=e,{submitMessage:p}=e,{deleteMessage:y}=e,{continueResponse:w}=e,{regenerateResponse:R}=e,{mergeResponses:B}=e,{addMessages:O}=e,{triggerScroll:V}=e;gt();let L,S,C={},T={},j=JSON.parse(JSON.stringify(o.messages[a]));const q=async z=>{t(20,T[z]=Math.max(0,T[z]-1),T);let ue=C[z].messageIds[T[z]];console.log(ue);let re=o.messages[ue].childrenIds;for(;re.length!==0;)ue=re.at(-1),re=o.messages[ue].childrenIds;t(0,o.currentId=ue,o),await Ne(),await h(),V()},ae=async z=>{t(20,T[z]=Math.min(C[z].messageIds.length-1,T[z]+1),T);let ue=C[z].messageIds[T[z]];console.log(ue);let re=o.messages[ue].childrenIds;for(;re.length!==0;)ue=re.at(-1),re=o.messages[ue].childrenIds;t(0,o.currentId=ue,o),await Ne(),await h(),V()},ie=async()=>{console.log("multiresponse:initHandler"),await Ne(),t(17,L=a),t(18,S=o.messages[a].parentId?o.messages[o.messages[a].parentId]:null),t(19,C=S==null?void 0:S.models.reduce((z,ue,re)=>{let Q=S==null?void 0:S.childrenIds.map(P=>o.messages[P]).filter(P=>(P==null?void 0:P.modelIdx)===re).map(P=>P.id);if(Q.length===0){let P=S==null?void 0:S.childrenIds.map(K=>o.messages[K]).filter(K=>(K==null?void 0:K.model)===ue);P.forEach(K=>{K.modelIdx=re}),Q=P.map(K=>K.id)}return{...z,[re]:{messageIds:Q}}},{})),t(20,T=S==null?void 0:S.models.reduce((z,ue,re)=>{const Q=C[re].messageIds.findIndex(P=>P===a);return Q!==-1?{...z,[re]:Q}:{...z,[re]:C[re].messageIds.length-1}},{})),console.log(C,T),await Ne()},se=async()=>{const z=Object.keys(C).map(ue=>{const{messageIds:re}=C[ue],Q=re[T[ue]];return o.messages[Q].content});B(a,z,i)};bt(async()=>{await ie(),await Ne();const z=document.getElementById(`message-${a}`);z&&z.scrollIntoView({block:"start"})});const oe=z=>{var Q;const{messageIds:ue}=C[z],re=ue[T[z]];return!((Q=o.messages[re])!=null&&Q.done)},J=z=>q(z),le=z=>ae(z),me=async(z,ue)=>{R(ue),await Ne(),t(20,T[z]=C[z].messageIds.length-1,T)},_e=async z=>{if(a!=z){let ue=z,re=o.messages[ue].childrenIds;for(;re.length!==0;)ue=re.at(-1),re=o.messages[ue].childrenIds;t(0,o.currentId=ue,o),await Ne(),await h(),V()}},Z=()=>{se()};return n.$$set=z=>{"chatId"in z&&t(1,i=z.chatId),"history"in z&&t(0,o=z.history),"messageId"in z&&t(2,a=z.messageId),"isLastMessage"in z&&t(3,f=z.isLastMessage),"readOnly"in z&&t(4,u=z.readOnly),"updateChat"in z&&t(5,h=z.updateChat),"editMessage"in z&&t(6,c=z.editMessage),"saveMessage"in z&&t(7,g=z.saveMessage),"rateMessage"in z&&t(8,_=z.rateMessage),"actionMessage"in z&&t(9,D=z.actionMessage),"submitMessage"in z&&t(10,p=z.submitMessage),"deleteMessage"in z&&t(11,y=z.deleteMessage),"continueResponse"in z&&t(12,w=z.continueResponse),"regenerateResponse"in z&&t(13,R=z.regenerateResponse),"mergeResponses"in z&&t(27,B=z.mergeResponses),"addMessages"in z&&t(14,O=z.addMessages),"triggerScroll"in z&&t(15,V=z.triggerScroll)},n.$$.update=()=>{n.$$.dirty[0]&65541&&o.messages&&JSON.stringify(j)!==JSON.stringify(o.messages[a])&&t(16,j=JSON.parse(JSON.stringify(o.messages[a])))},[o,i,a,f,u,h,c,g,_,D,p,y,w,R,O,V,j,L,S,C,T,l,s,r,q,ae,se,B,oe,J,le,me,_e,Z]}class fa extends Te{constructor(e){super(),Be(this,e,aa,oa,De,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:27,addMessages:14,triggerScroll:15},null,[-1,-1])}}function Gs(n,e,t){const l=n.slice();return l[38]=e[t],l}function Zs(n){var r,i,o,a;let e,t,l,s;return t=new Dr({props:{src:n[6].user?((o=(i=(r=n[12].find(n[24]))==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??"/user.png":((a=n[0])==null?void 0:a.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=I("div"),X(t.$$.fragment),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=k(e);Y(t.$$.fragment,u),u.forEach(m),this.h()},h(){var f;d(e,"class",l=`flex-shrink-0 ${(((f=n[11])==null?void 0:f.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)},m(f,u){N(f,e,u),$(t,e,null),s=!0},p(f,u){var c,g,_,D,p;const h={};u[0]&4161&&(h.src=f[6].user?((_=(g=(c=f[12].find(f[24]))==null?void 0:c.info)==null?void 0:g.meta)==null?void 0:_.profile_image_url)??"/user.png":((D=f[0])==null?void 0:D.profile_image_url)??"/user.png"),t.$set(h),(!s||u[0]&2048&&l!==(l=`flex-shrink-0 ${(((p=f[11])==null?void 0:p.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`))&&d(e,"class",l)},i(f){s||(b(t.$$.fragment,f),s=!0)},o(f){M(t.$$.fragment,f),s=!1},d(f){f&&m(e),x(t)}}}function Ks(n){let e,t,l;return t=new Zt({props:{$$slots:{default:[ma]},$$scope:{ctx:n}}}),{c(){e=I("div"),X(t.$$.fragment)},l(s){e=E(s,"DIV",{});var r=k(e);Y(t.$$.fragment,r),r.forEach(m)},m(s,r){N(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&11329|r[1]&1024&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function ua(n){let e=n[10].t("You")+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&1024&&e!==(e=l[10].t("You")+"")&&G(t,e)},d(l){l&&m(t)}}}function ca(n){let e=n[0].name+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&G(t,e)},d(l){l&&m(t)}}}function da(n){var o;let e=n[10].t("You")+"",t,l,s,r=(((o=n[6])==null?void 0:o.user)??"")+"",i;return{c(){t=W(e),l=A(),s=I("span"),i=W(r),this.h()},l(a){t=U(a,e),l=H(a),s=E(a,"SPAN",{class:!0});var f=k(s);i=U(f,r),f.forEach(m),this.h()},h(){d(s,"class","text-gray-500 text-sm font-medium")},m(a,f){N(a,t,f),N(a,l,f),N(a,s,f),v(s,i)},p(a,f){var u;f[0]&1024&&e!==(e=a[10].t("You")+"")&&G(t,e),f[0]&64&&r!==(r=(((u=a[6])==null?void 0:u.user)??"")+"")&&G(i,r)},d(a){a&&(m(t),m(l),m(s))}}}function Qs(n){let e,t,l;return t=new Re({props:{content:it(n[6].timestamp*1e3).format("LLLL"),$$slots:{default:[ha]},$$scope:{ctx:n}}}),{c(){e=I("div"),X(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);Y(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){N(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&64&&(i.content=it(s[6].timestamp*1e3).format("LLLL")),r[0]&64|r[1]&1024&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function ha(n){let e,t=Pt(n[6].timestamp*1e3)+"",l;return{c(){e=I("span"),l=W(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var r=k(e);l=U(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){N(s,e,r),v(e,l)},p(s,r){r[0]&64&&t!==(t=Pt(s[6].timestamp*1e3)+"")&&G(l,t)},d(s){s&&m(e)}}}function ma(n){let e,t,l;function s(a,f){return a[6].user?da:a[11].showUsername||a[13].name!==a[0].name?ca:ua}let r=s(n),i=r(n),o=n[6].timestamp&&Qs(n);return{c(){i.c(),e=A(),o&&o.c(),t=fe()},l(a){i.l(a),e=H(a),o&&o.l(a),t=fe()},m(a,f){i.m(a,f),N(a,e,f),o&&o.m(a,f),N(a,t,f),l=!0},p(a,f){r===(r=s(a))&&i?i.p(a,f):(i.d(1),i=r(a),i&&(i.c(),i.m(e.parentNode,e))),a[6].timestamp?o?(o.p(a,f),f[0]&64&&b(o,1)):(o=Qs(a),o.c(),b(o,1),o.m(t.parentNode,t)):o&&(ee(),M(o,1,1,()=>{o=null}),te())},i(a){l||(b(o),l=!0)},o(a){M(o),l=!1},d(a){a&&(m(e),m(t)),i.d(a),o&&o.d(a)}}}function Xs(n){let e,t,l=Ee(n[6].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Ys(Gs(n,l,i));const r=i=>M(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=E(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,o){N(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&2112){l=Ee(i[6].files);let a;for(a=0;a<l.length;a+=1){const f=Gs(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=Ys(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(ee(),a=l.length;a<s.length;a+=1)r(a);te()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)M(s[o]);t=!1},d(i){i&&m(e),Ue(s,i)}}}function ga(n){var l;let e,t;return e=new pn({props:{item:n[38],url:n[38].url,name:n[38].name,type:n[38].type,size:(l=n[38])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&64&&(i.item=s[38]),r[0]&64&&(i.url=s[38].url),r[0]&64&&(i.name=s[38].name),r[0]&64&&(i.type=s[38].type),r[0]&64&&(i.size=(o=s[38])==null?void 0:o.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function _a(n){let e,t;return e=new Vr({props:{src:n[38].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&64&&(r.src=l[38].url),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ys(n){let e,t,l,s,r,i;const o=[_a,ga],a=[];function f(u,h){return u[38].type==="image"?0:1}return t=f(n),l=a[t]=o[t](n),{c(){e=I("div"),l.c(),s=A(),this.h()},l(u){e=E(u,"DIV",{class:!0});var h=k(e);l.l(h),s=H(h),h.forEach(m),this.h()},h(){var u;d(e,"class",r=((u=n[11])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,h){N(u,e,h),a[t].m(e,null),v(e,s),i=!0},p(u,h){var g;let c=t;t=f(u),t===c?a[t].p(u,h):(ee(),M(a[c],1,1,()=>{a[c]=null}),te(),l=a[t],l?l.p(u,h):(l=a[t]=o[t](u),l.c()),b(l,1),l.m(e,s)),(!i||h[0]&2048&&r!==(r=((g=u[11])==null?void 0:g.chatBubble)??!0?"self-end":""))&&d(e,"class",r)},i(u){i||(b(l),i=!0)},o(u){M(l),i=!1},d(u){u&&m(e),a[t].d()}}}function $s(n){let e,t,l,s;const r=[pa,va],i=[];function o(a,f){return a[7]===!0?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(a){t.l(a),l=fe()},m(a,f){i[e].m(a,f),N(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(ee(),M(i[u],1,1,()=>{i[u]=null}),te(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function va(n){var B,O;let e,t,l,s,r,i,o,a,f,u,h,c,g,_,D=n[6].content&&xs(n),p=!(((B=n[11])==null?void 0:B.chatBubble)??!0)&&er(n),y=!n[5]&&lr(n);u=new Re({props:{content:n[10].t("Copy"),placement:"bottom",$$slots:{default:[ka]},$$scope:{ctx:n}}});let w=!n[4]&&!n[5]&&sr(n),R=(((O=n[11])==null?void 0:O.chatBubble)??!0)&&rr(n);return{c(){e=I("div"),t=I("div"),l=I("div"),D&&D.c(),i=A(),o=I("div"),p&&p.c(),a=A(),y&&y.c(),f=A(),X(u.$$.fragment),h=A(),w&&w.c(),c=A(),R&&R.c(),this.h()},l(V){e=E(V,"DIV",{class:!0});var L=k(e);t=E(L,"DIV",{class:!0});var S=k(t);l=E(S,"DIV",{class:!0});var C=k(l);D&&D.l(C),C.forEach(m),S.forEach(m),i=H(L),o=E(L,"DIV",{class:!0});var T=k(o);p&&p.l(T),a=H(T),y&&y.l(T),f=H(T),Y(u.$$.fragment,T),h=H(T),w&&w.l(T),c=H(T),R&&R.l(T),T.forEach(m),L.forEach(m),this.h()},h(){var V,L,S;d(l,"class",s="rounded-3xl "+(((V=n[11])==null?void 0:V.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[6].files?"rounded-tr-lg":""}`:" w-full")),d(t,"class",r="flex "+(((L=n[11])==null?void 0:L.chatBubble)??!0?"justify-end pb-1":"w-full")),d(o,"class",g="flex "+(((S=n[11])==null?void 0:S.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),d(e,"class","w-full")},m(V,L){N(V,e,L),v(e,t),v(t,l),D&&D.m(l,null),v(e,i),v(e,o),p&&p.m(o,null),v(o,a),y&&y.m(o,null),v(o,f),$(u,o,null),v(o,h),w&&w.m(o,null),v(o,c),R&&R.m(o,null),_=!0},p(V,L){var C,T,j,q,ae;V[6].content?D?(D.p(V,L),L[0]&64&&b(D,1)):(D=xs(V),D.c(),b(D,1),D.m(l,null)):D&&(ee(),M(D,1,1,()=>{D=null}),te()),(!_||L[0]&2112&&s!==(s="rounded-3xl "+(((C=V[11])==null?void 0:C.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${V[6].files?"rounded-tr-lg":""}`:" w-full")))&&d(l,"class",s),(!_||L[0]&2048&&r!==(r="flex "+(((T=V[11])==null?void 0:T.chatBubble)??!0?"justify-end pb-1":"w-full")))&&d(t,"class",r),((j=V[11])==null?void 0:j.chatBubble)??!0?p&&(p.d(1),p=null):p?p.p(V,L):(p=er(V),p.c(),p.m(o,a)),V[5]?y&&(ee(),M(y,1,1,()=>{y=null}),te()):y?(y.p(V,L),L[0]&32&&b(y,1)):(y=lr(V),y.c(),b(y,1),y.m(o,f));const S={};L[0]&1024&&(S.content=V[10].t("Copy")),L[0]&64|L[1]&1024&&(S.$$scope={dirty:L,ctx:V}),u.$set(S),!V[4]&&!V[5]?w?(w.p(V,L),L[0]&48&&b(w,1)):(w=sr(V),w.c(),b(w,1),w.m(o,c)):w&&(ee(),M(w,1,1,()=>{w=null}),te()),((q=V[11])==null?void 0:q.chatBubble)??!0?R?R.p(V,L):(R=rr(V),R.c(),R.m(o,null)):R&&(R.d(1),R=null),(!_||L[0]&2048&&g!==(g="flex "+(((ae=V[11])==null?void 0:ae.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&d(o,"class",g)},i(V){_||(b(D),b(y),b(u.$$.fragment,V),b(w),_=!0)},o(V){M(D),M(y),M(u.$$.fragment,V),M(w),_=!1},d(V){V&&m(e),D&&D.d(),p&&p.d(),y&&y.d(),x(u),w&&w.d(),R&&R.d()}}}function pa(n){let e,t,l,s,r,i,o,a,f=n[10].t("Save")+"",u,h,c,g,_=n[10].t("Cancel")+"",D,p,y,w=n[10].t("Send")+"",R,B,O;return{c(){e=I("div"),t=I("div"),l=I("textarea"),r=A(),i=I("div"),o=I("div"),a=I("button"),u=W(f),h=A(),c=I("div"),g=I("button"),D=W(_),p=A(),y=I("button"),R=W(w),this.h()},l(V){e=E(V,"DIV",{class:!0});var L=k(e);t=E(L,"DIV",{class:!0});var S=k(t);l=E(S,"TEXTAREA",{id:!0,class:!0}),k(l).forEach(m),S.forEach(m),r=H(L),i=E(L,"DIV",{class:!0});var C=k(i);o=E(C,"DIV",{});var T=k(o);a=E(T,"BUTTON",{id:!0,class:!0});var j=k(a);u=U(j,f),j.forEach(m),T.forEach(m),h=H(C),c=E(C,"DIV",{class:!0});var q=k(c);g=E(q,"BUTTON",{id:!0,class:!0});var ae=k(g);D=U(ae,_),ae.forEach(m),p=H(q),y=E(q,"BUTTON",{id:!0,class:!0});var ie=k(y);R=U(ie,w),ie.forEach(m),q.forEach(m),C.forEach(m),L.forEach(m),this.h()},h(){d(l,"id",s="message-edit-"+n[6].id),d(l,"class","bg-transparent outline-none w-full resize-none"),d(t,"class","max-h-96 overflow-auto"),d(a,"id","save-edit-message-button"),d(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(g,"id","close-edit-message-button"),d(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(y,"id","confirm-edit-message-button"),d(y,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(c,"class","flex space-x-1.5"),d(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(V,L){N(V,e,L),v(e,t),v(t,l),n[25](l),nt(l,n[8]),v(e,r),v(e,i),v(i,o),v(o,a),v(a,u),v(i,h),v(i,c),v(c,g),v(g,D),v(c,p),v(c,y),v(y,R),B||(O=[ge(l,"input",n[26]),ge(l,"input",Ia),ge(l,"keydown",n[27]),ge(a,"click",n[28]),ge(g,"click",n[29]),ge(y,"click",n[30])],B=!0)},p(V,L){L[0]&64&&s!==(s="message-edit-"+V[6].id)&&d(l,"id",s),L[0]&256&&nt(l,V[8]),L[0]&1024&&f!==(f=V[10].t("Save")+"")&&G(u,f),L[0]&1024&&_!==(_=V[10].t("Cancel")+"")&&G(D,_),L[0]&1024&&w!==(w=V[10].t("Send")+"")&&G(R,w)},i:ve,o:ve,d(V){V&&m(e),n[25](null),B=!1,et(O)}}}function xs(n){let e,t;return e=new yt({props:{id:n[6].id,content:n[6].content}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&64&&(r.id=l[6].id),s[0]&64&&(r.content=l[6].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function er(n){let e,t=n[1].length>1&&tr(n);return{c(){t&&t.c(),e=fe()},l(l){t&&t.l(l),e=fe()},m(l,s){t&&t.m(l,s),N(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=tr(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function tr(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i=n[1].indexOf(n[6].id)+1+"",o,a,f=n[1].length+"",u,h,c,g='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',_,D;return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=A(),r=I("div"),o=W(i),a=W("/"),u=W(f),h=A(),c=I("button"),c.innerHTML=g,this.h()},l(p){e=E(p,"DIV",{class:!0,dir:!0});var y=k(e);t=E(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(t)!=="svelte-buado9"&&(t.innerHTML=l),s=H(y),r=E(y,"DIV",{class:!0});var w=k(r);o=U(w,i),a=U(w,"/"),u=U(w,f),w.forEach(m),h=H(y),c=E(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(c)!=="svelte-4phel2"&&(c.innerHTML=g),y.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(r,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),d(c,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(p,y){N(p,e,y),v(e,t),v(e,s),v(e,r),v(r,o),v(r,a),v(r,u),v(e,h),v(e,c),_||(D=[ge(t,"click",n[31]),ge(c,"click",n[32])],_=!0)},p(p,y){y[0]&66&&i!==(i=p[1].indexOf(p[6].id)+1+"")&&G(o,i),y[0]&2&&f!==(f=p[1].length+"")&&G(u,f)},d(p){p&&m(e),_=!1,et(D)}}}function lr(n){let e,t;return e=new Re({props:{content:n[10].t("Edit"),placement:"bottom",$$slots:{default:[ba]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&1024&&(r.content=l[10].t("Edit")),s[1]&1024&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ba(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=E(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(r,i){N(r,e,i),l||(s=ge(e,"click",n[33]),l=!0)},p:ve,d(r){r&&m(e),l=!1,s()}}}function ka(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=E(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){N(r,e,i),l||(s=ge(e,"click",n[34]),l=!0)},p:ve,d(r){r&&m(e),l=!1,s()}}}function sr(n){let e,t;return e=new Re({props:{content:n[10].t("Delete"),placement:"bottom",$$slots:{default:[wa]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&1024&&(r.content=l[10].t("Delete")),s[1]&1024&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function wa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=E(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(e)!=="svelte-zh6wtu"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1 rounded dark:hover:text-white hover:text-black transition")},m(r,i){N(r,e,i),l||(s=ge(e,"click",n[35]),l=!0)},p:ve,d(r){r&&m(e),l=!1,s()}}}function rr(n){let e,t=n[1].length>1&&nr(n);return{c(){t&&t.c(),e=fe()},l(l){t&&t.l(l),e=fe()},m(l,s){t&&t.m(l,s),N(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=nr(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function nr(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i=n[1].indexOf(n[6].id)+1+"",o,a,f=n[1].length+"",u,h,c,g='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',_,D;return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=A(),r=I("div"),o=W(i),a=W("/"),u=W(f),h=A(),c=I("button"),c.innerHTML=g,this.h()},l(p){e=E(p,"DIV",{class:!0,dir:!0});var y=k(e);t=E(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(t)!=="svelte-buado9"&&(t.innerHTML=l),s=H(y),r=E(y,"DIV",{class:!0});var w=k(r);o=U(w,i),a=U(w,"/"),u=U(w,f),w.forEach(m),h=H(y),c=E(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(c)!=="svelte-4phel2"&&(c.innerHTML=g),y.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(r,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),d(c,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(p,y){N(p,e,y),v(e,t),v(e,s),v(e,r),v(r,o),v(r,a),v(r,u),v(e,h),v(e,c),_||(D=[ge(t,"click",n[36]),ge(c,"click",n[37])],_=!0)},p(p,y){y[0]&66&&i!==(i=p[1].indexOf(p[6].id)+1+"")&&G(o,i),y[0]&2&&f!==(f=p[1].length+"")&&G(u,f)},d(p){p&&m(e),_=!1,et(D)}}}function ya(n){var D,p;let e,t,l,s,r,i,o,a,f,u,h=!(((D=n[11])==null?void 0:D.chatBubble)??!0)&&Zs(n),c=!(((p=n[11])==null?void 0:p.chatBubble)??!0)&&Ks(n),g=n[6].files&&Xs(n),_=n[6].content!==""&&$s(n);return{c(){e=I("div"),h&&h.c(),t=A(),l=I("div"),c&&c.c(),s=A(),r=I("div"),g&&g.c(),i=A(),_&&_.c(),this.h()},l(y){e=E(y,"DIV",{class:!0,dir:!0,id:!0});var w=k(e);h&&h.l(w),t=H(w),l=E(w,"DIV",{class:!0});var R=k(l);c&&c.l(R),s=H(R),r=E(R,"DIV",{class:!0});var B=k(r);g&&g.l(B),i=H(B),_&&_.l(B),B.forEach(m),R.forEach(m),w.forEach(m),this.h()},h(){d(r,"class",o="chat-"+n[6].role+" w-full min-w-full markdown-prose"),d(l,"class","flex-auto w-0 max-w-full pl-1"),d(e,"class","flex w-full user-message"),d(e,"dir",a=n[11].chatDirection),d(e,"id",f="message-"+n[6].id)},m(y,w){N(y,e,w),h&&h.m(e,null),v(e,t),v(e,l),c&&c.m(l,null),v(l,s),v(l,r),g&&g.m(r,null),v(r,i),_&&_.m(r,null),u=!0},p(y,w){var R,B;((R=y[11])==null?void 0:R.chatBubble)??!0?h&&(ee(),M(h,1,1,()=>{h=null}),te()):h?(h.p(y,w),w[0]&2048&&b(h,1)):(h=Zs(y),h.c(),b(h,1),h.m(e,t)),((B=y[11])==null?void 0:B.chatBubble)??!0?c&&(ee(),M(c,1,1,()=>{c=null}),te()):c?(c.p(y,w),w[0]&2048&&b(c,1)):(c=Ks(y),c.c(),b(c,1),c.m(l,s)),y[6].files?g?(g.p(y,w),w[0]&64&&b(g,1)):(g=Xs(y),g.c(),b(g,1),g.m(r,i)):g&&(ee(),M(g,1,1,()=>{g=null}),te()),y[6].content!==""?_?(_.p(y,w),w[0]&64&&b(_,1)):(_=$s(y),_.c(),b(_,1),_.m(r,null)):_&&(ee(),M(_,1,1,()=>{_=null}),te()),(!u||w[0]&64&&o!==(o="chat-"+y[6].role+" w-full min-w-full markdown-prose"))&&d(r,"class",o),(!u||w[0]&2048&&a!==(a=y[11].chatDirection))&&d(e,"dir",a),(!u||w[0]&64&&f!==(f="message-"+y[6].id))&&d(e,"id",f)},i(y){u||(b(h),b(c),b(g),b(_),u=!0)},o(y){M(h),M(c),M(g),M(_),u=!1},d(y){y&&m(e),h&&h.d(),c&&c.d(),g&&g.d(),_&&_.d()}}}const Ia=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`};function Ea(n,e,t){let l,s,r,i;Ie(n,Ht,Q=>t(11,s=Q)),Ie(n,At,Q=>t(12,r=Q)),Ie(n,zt,Q=>t(13,i=Q));const o=qe("i18n");Ie(n,o,Q=>t(10,l=Q)),it.extend(Nr);let{user:a}=e,{history:f}=e,{messageId:u}=e,{siblings:h}=e,{showPreviousMessage:c}=e,{showNextMessage:g}=e,{editMessage:_}=e,{deleteMessage:D}=e,{isFirstMessage:p}=e,{readOnly:y}=e,w=!1,R="",B,O=JSON.parse(JSON.stringify(f.messages[u]));const V=async Q=>{await Mr(Q)&&Le.success(l.t("Copying to clipboard was successful!"))},L=async()=>{t(7,w=!0),t(8,R=O.content),await Ne(),t(9,B.style.height="",B),t(9,B.style.height=`${B.scrollHeight}px`,B),B==null||B.focus()},S=async(Q=!0)=>{_(O.id,R,Q),t(7,w=!1),t(8,R="")},C=()=>{t(7,w=!1),t(8,R="")},T=async()=>{D(O.id)};bt(()=>{});const j=Q=>Q.id===O.user;function q(Q){We[Q?"unshift":"push"](()=>{B=Q,t(9,B)})}function ae(){R=this.value,t(8,R)}const ie=Q=>{var he,de;Q.key==="Escape"&&((he=document.getElementById("close-edit-message-button"))==null||he.click());const P=Q.metaKey||Q.ctrlKey,K=Q.key==="Enter";P&&K&&((de=document.getElementById("confirm-edit-message-button"))==null||de.click())},se=()=>{S(!1)},oe=()=>{C()},J=()=>{S()},le=()=>{c(O)},me=()=>{g(O)},_e=()=>{L()},Z=()=>{V(O.content)},z=()=>{T()},ue=()=>{c(O)},re=()=>{g(O)};return n.$$set=Q=>{"user"in Q&&t(0,a=Q.user),"history"in Q&&t(20,f=Q.history),"messageId"in Q&&t(21,u=Q.messageId),"siblings"in Q&&t(1,h=Q.siblings),"showPreviousMessage"in Q&&t(2,c=Q.showPreviousMessage),"showNextMessage"in Q&&t(3,g=Q.showNextMessage),"editMessage"in Q&&t(22,_=Q.editMessage),"deleteMessage"in Q&&t(23,D=Q.deleteMessage),"isFirstMessage"in Q&&t(4,p=Q.isFirstMessage),"readOnly"in Q&&t(5,y=Q.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&3145792&&f.messages&&JSON.stringify(O)!==JSON.stringify(f.messages[u])&&t(6,O=JSON.parse(JSON.stringify(f.messages[u])))},[a,h,c,g,p,y,O,w,R,B,l,s,r,i,o,V,L,S,C,T,f,u,_,D,j,q,ae,ie,se,oe,J,le,me,_e,Z,z,ue,re]}class Ma extends Te{constructor(e){super(),Be(this,e,Ea,ya,De,{user:0,history:20,messageId:21,siblings:1,showPreviousMessage:2,showNextMessage:3,editMessage:22,deleteMessage:23,isFirstMessage:4,readOnly:5},null,[-1,-1])}}function ir(n){let e,t,l,s;const r=[Va,Da,Na],i=[];function o(a,f){var u,h;return a[0].messages[a[3]].role==="user"?0:(((h=(u=a[0].messages[a[0].messages[a[3]].parentId])==null?void 0:u.models)==null?void 0:h.length)??1)===1?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(a){t.l(a),l=fe()},m(a,f){i[e].m(a,f),N(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(ee(),M(i[u],1,1,()=>{i[u]=null}),te(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function Na(n){var i;let e,t,l;function s(o){n[21](o)}let r={chatId:n[1],messageId:n[3],isLastMessage:n[3]===((i=n[0])==null?void 0:i.currentId),updateChat:n[7],editMessage:n[8],saveMessage:n[9],rateMessage:n[11],actionMessage:n[12],submitMessage:n[13],deleteMessage:n[10],continueResponse:n[15],regenerateResponse:n[14],mergeResponses:n[16],triggerScroll:n[18],addMessages:n[17],readOnly:n[19]};return n[0]!==void 0&&(r.history=n[0]),e=new fa({props:r}),We.push(()=>$e(e,"history",s)),{c(){X(e.$$.fragment)},l(o){Y(e.$$.fragment,o)},m(o,a){$(e,o,a),l=!0},p(o,a){var u;const f={};a&2&&(f.chatId=o[1]),a&8&&(f.messageId=o[3]),a&9&&(f.isLastMessage=o[3]===((u=o[0])==null?void 0:u.currentId)),a&128&&(f.updateChat=o[7]),a&256&&(f.editMessage=o[8]),a&512&&(f.saveMessage=o[9]),a&2048&&(f.rateMessage=o[11]),a&4096&&(f.actionMessage=o[12]),a&8192&&(f.submitMessage=o[13]),a&1024&&(f.deleteMessage=o[10]),a&32768&&(f.continueResponse=o[15]),a&16384&&(f.regenerateResponse=o[14]),a&65536&&(f.mergeResponses=o[16]),a&262144&&(f.triggerScroll=o[18]),a&131072&&(f.addMessages=o[17]),a&524288&&(f.readOnly=o[19]),!t&&a&1&&(t=!0,f.history=o[0],Ye(()=>t=!1)),e.$set(f)},i(o){l||(b(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){x(e,o)}}}function Da(n){var l;let e,t;return e=new Sr({props:{chatId:n[1],history:n[0],messageId:n[3],isLastMessage:n[3]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[],showPreviousMessage:n[5],showNextMessage:n[6],updateChat:n[7],editMessage:n[8],saveMessage:n[9],rateMessage:n[11],actionMessage:n[12],submitMessage:n[13],deleteMessage:n[10],continueResponse:n[15],regenerateResponse:n[14],addMessages:n[17],readOnly:n[19]}}),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&9&&(i.isLastMessage=s[3]===s[0].currentId),r&9&&(i.siblings=((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]),r&32&&(i.showPreviousMessage=s[5]),r&64&&(i.showNextMessage=s[6]),r&128&&(i.updateChat=s[7]),r&256&&(i.editMessage=s[8]),r&512&&(i.saveMessage=s[9]),r&2048&&(i.rateMessage=s[11]),r&4096&&(i.actionMessage=s[12]),r&8192&&(i.submitMessage=s[13]),r&1024&&(i.deleteMessage=s[10]),r&32768&&(i.continueResponse=s[15]),r&16384&&(i.regenerateResponse=s[14]),r&131072&&(i.addMessages=s[17]),r&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Va(n){var l;let e,t;return e=new Ma({props:{user:n[4],history:n[0],messageId:n[3],isFirstMessage:n[2]===0,siblings:n[0].messages[n[3]].parentId!==null?((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(or).map(ar)??[],showPreviousMessage:n[5],showNextMessage:n[6],editMessage:n[8],deleteMessage:n[10],readOnly:n[19]}}),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r&16&&(i.user=s[4]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&4&&(i.isFirstMessage=s[2]===0),r&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]:Object.values(s[0].messages).filter(or).map(ar)??[]),r&32&&(i.showPreviousMessage=s[5]),r&64&&(i.showNextMessage=s[6]),r&256&&(i.editMessage=s[8]),r&1024&&(i.deleteMessage=s[10]),r&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Ca(n){let e,t,l,s=n[0].messages[n[3]]&&ir(n);return{c(){e=I("div"),s&&s.c(),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=k(e);s&&s.l(i),i.forEach(m),this.h()},h(){var r;d(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[20])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){N(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var o;r[0].messages[r[3]]?s?(s.p(r,i),i&9&&b(s,1)):(s=ir(r),s.c(),b(s,1),s.m(e,null)):s&&(ee(),M(s,1,1,()=>{s=null}),te()),(!l||i&1048576&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((o=r[20])==null?void 0:o.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&d(e,"class",t)},i(r){l||(b(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(e),s&&s.d()}}}const or=n=>n.parentId===null,ar=n=>n.id;function Ta(n,e,t){let l;Ie(n,Ht,C=>t(20,l=C)),gt(),qe("i18n");let{chatId:s}=e,{idx:r=0}=e,{history:i}=e,{messageId:o}=e,{user:a}=e,{showPreviousMessage:f}=e,{showNextMessage:u}=e,{updateChat:h}=e,{editMessage:c}=e,{saveMessage:g}=e,{deleteMessage:_}=e,{rateMessage:D}=e,{actionMessage:p}=e,{submitMessage:y}=e,{regenerateResponse:w}=e,{continueResponse:R}=e,{mergeResponses:B}=e,{addMessages:O}=e,{triggerScroll:V}=e,{readOnly:L=!1}=e;function S(C){i=C,t(0,i)}return n.$$set=C=>{"chatId"in C&&t(1,s=C.chatId),"idx"in C&&t(2,r=C.idx),"history"in C&&t(0,i=C.history),"messageId"in C&&t(3,o=C.messageId),"user"in C&&t(4,a=C.user),"showPreviousMessage"in C&&t(5,f=C.showPreviousMessage),"showNextMessage"in C&&t(6,u=C.showNextMessage),"updateChat"in C&&t(7,h=C.updateChat),"editMessage"in C&&t(8,c=C.editMessage),"saveMessage"in C&&t(9,g=C.saveMessage),"deleteMessage"in C&&t(10,_=C.deleteMessage),"rateMessage"in C&&t(11,D=C.rateMessage),"actionMessage"in C&&t(12,p=C.actionMessage),"submitMessage"in C&&t(13,y=C.submitMessage),"regenerateResponse"in C&&t(14,w=C.regenerateResponse),"continueResponse"in C&&t(15,R=C.continueResponse),"mergeResponses"in C&&t(16,B=C.mergeResponses),"addMessages"in C&&t(17,O=C.addMessages),"triggerScroll"in C&&t(18,V=C.triggerScroll),"readOnly"in C&&t(19,L=C.readOnly)},[i,s,r,o,a,f,u,h,c,g,_,D,p,y,w,R,B,O,V,L,l,S]}class Ba extends Te{constructor(e){super(),Be(this,e,Ta,Ca,De,{chatId:1,idx:2,history:0,messageId:3,user:4,showPreviousMessage:5,showNextMessage:6,updateChat:7,editMessage:8,saveMessage:9,deleteMessage:10,rateMessage:11,actionMessage:12,submitMessage:13,regenerateResponse:14,continueResponse:15,mergeResponses:16,addMessages:17,triggerScroll:18,readOnly:19})}}function Ra(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){N(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function Sa(n,e,t){let{className:l="size-3"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Oa extends Te{constructor(e){super(),Be(this,e,Sa,Ra,De,{className:0,strokeWidth:1})}}function fr(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function La(n){let e,t,l,s;return{c(){e=I("div"),t=W(n[3]),l=W("  v"),s=W(dl),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=k(e);t=U(i,n[3]),l=U(i,"  v"),s=U(i,dl),i.forEach(m),this.h()},h(){d(e,"class","flex w-full text-center items-center justify-center self-start text-gray-400 dark:text-gray-600")},m(r,i){N(r,e,i),v(e,t),v(e,l),v(e,s)},p(r,i){i&8&&G(t,r[3])},i:ve,o:ve,d(r){r&&m(e)}}}function Pa(n){let e,t,l=n[2].t("Suggested")+"",s,r;return e=new Oa({}),{c(){X(e.$$.fragment),t=A(),s=W(l)},l(i){Y(e.$$.fragment,i),t=H(i),s=U(i,l)},m(i,o){$(e,i,o),N(i,t,o),N(i,s,o),r=!0},p(i,o){(!r||o&4)&&l!==(l=i[2].t("Suggested")+"")&&G(s,l)},i(i){r||(b(e.$$.fragment,i),r=!0)},o(i){M(e.$$.fragment,i),r=!1},d(i){i&&(m(t),m(s)),x(e,i)}}}function ur(n){let e=[],t=new Map,l,s=Ee(n[1]);const r=i=>i[13].id||i[13].content;for(let i=0;i<s.length;i+=1){let o=fr(n,s,i),a=r(o);t.set(a,e[i]=cr(a,o))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=fe()},l(i){for(let o=0;o<e.length;o+=1)e[o].l(i);l=fe()},m(i,o){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(i,o);N(i,l,o)},p(i,o){o&38&&(s=Ee(i[1]),e=Gt(e,o,r,1,i,s,t,l.parentNode,$r,cr,l,fr))},d(i){i&&m(l);for(let o=0;o<e.length;o+=1)e[o].d(i)}}}function ja(n){let e,t=n[13].content+"",l,s,r,i=n[2].t("Prompt")+"",o;return{c(){e=I("div"),l=W(t),s=A(),r=I("div"),o=W(i),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=k(e);l=U(f,t),f.forEach(m),s=H(a),r=E(a,"DIV",{class:!0});var u=k(r);o=U(u,i),u.forEach(m),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){N(a,e,f),v(e,l),N(a,s,f),N(a,r,f),v(r,o)},p(a,f){f&2&&t!==(t=a[13].content+"")&&G(l,t),f&4&&i!==(i=a[2].t("Prompt")+"")&&G(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function Aa(n){let e,t=n[13].title[0]+"",l,s,r,i=n[13].title[1]+"",o;return{c(){e=I("div"),l=W(t),s=A(),r=I("div"),o=W(i),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=k(e);l=U(f,t),f.forEach(m),s=H(a),r=E(a,"DIV",{class:!0});var u=k(r);o=U(u,i),u.forEach(m),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){N(a,e,f),v(e,l),N(a,s,f),N(a,r,f),v(r,o)},p(a,f){f&2&&t!==(t=a[13].title[0]+"")&&G(l,t),f&2&&i!==(i=a[13].title[1]+"")&&G(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function cr(n,e){let t,l,s,r,i;function o(h,c){return h[13].title&&h[13].title[0]!==""?Aa:ja}let a=o(e),f=a(e);function u(){return e[9](e[13])}return{key:n,first:null,c(){t=I("button"),l=I("div"),f.c(),s=A(),this.h()},l(h){t=E(h,"BUTTON",{class:!0,style:!0});var c=k(t);l=E(c,"DIV",{class:!0});var g=k(l);f.l(g),g.forEach(m),s=H(c),c.forEach(m),this.h()},h(){d(l,"class","flex flex-col text-left"),d(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),St(t,"animation-delay",e[15]*60+"ms"),this.first=t},m(h,c){N(h,t,c),v(t,l),f.m(l,null),v(t,s),r||(i=ge(t,"click",u),r=!0)},p(h,c){e=h,a===(a=o(e))&&f?f.p(e,c):(f.d(1),f=a(e),f&&(f.c(),f.m(l,null))),c&2&&St(t,"animation-delay",e[15]*60+"ms")},d(h){h&&m(t),f.d(),r=!1,i()}}}function Ha(n){let e,t,l,s,r,i,o;const a=[Pa,La],f=[];function u(c,g){return c[1].length>0?0:1}t=u(n),l=f[t]=a[t](n);let h=n[1].length>0&&ur(n);return{c(){e=I("div"),l.c(),s=A(),r=I("div"),h&&h.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var g=k(e);l.l(g),g.forEach(m),s=H(c),r=E(c,"DIV",{class:!0});var _=k(r);h&&h.l(_),_.forEach(m),this.h()},h(){d(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-400 dark:text-gray-600"),d(r,"class",i="h-40 overflow-auto scrollbar-none "+n[0]+" items-start svelte-1co34if")},m(c,g){N(c,e,g),f[t].m(e,null),N(c,s,g),N(c,r,g),h&&h.m(r,null),o=!0},p(c,[g]){let _=t;t=u(c),t===_?f[t].p(c,g):(ee(),M(f[_],1,1,()=>{f[_]=null}),te(),l=f[t],l?l.p(c,g):(l=f[t]=a[t](c),l.c()),b(l,1),l.m(e,null)),c[1].length>0?h?h.p(c,g):(h=ur(c),h.c(),h.m(r,null)):h&&(h.d(1),h=null),(!o||g&1&&i!==(i="h-40 overflow-auto scrollbar-none "+c[0]+" items-start svelte-1co34if"))&&d(r,"class",i)},i(c){o||(b(l),o=!0)},o(c){M(l),o=!1},d(c){c&&(m(e),m(s),m(r)),f[t].d(),h&&h.d()}}}function za(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function Wa(n,e,t){let l,s;Ie(n,ln,p=>t(3,s=p));const r=qe("i18n");Ie(n,r,p=>t(2,l=p));const i=gt();let{suggestionPrompts:o=[]}=e,{className:a=""}=e,{inputValue:f=""}=e,u=[];const h={keys:["content","title"],threshold:.5};let c,g=[];const _=p=>{if(p.length>500)t(1,g=[]);else{const y=p.trim()?c.search(p.trim()).map(w=>w.item):u;za(g,y)||t(1,g=y)}},D=p=>i("select",p.content);return n.$$set=p=>{"suggestionPrompts"in p&&t(6,o=p.suggestionPrompts),"className"in p&&t(0,a=p.className),"inputValue"in p&&t(7,f=p.inputValue)},n.$$.update=()=>{n.$$.dirty&192&&o&&(t(8,u=[...o??[]].sort(()=>Math.random()-.5)),_(f)),n.$$.dirty&256&&(c=new In(u,h)),n.$$.dirty&128&&_(f)},[a,g,l,s,r,i,o,f,u,D]}class Ua extends Te{constructor(e){super(),Be(this,e,Wa,Ha,De,{suggestionPrompts:6,className:0,inputValue:7})}}function qa(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){N(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function Fa(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Ja extends Te{constructor(e){super(),Be(this,e,Fa,qa,De,{className:0,strokeWidth:1})}}function dr(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function Ga(n){let e,t;return{c(){e=I("img"),this.h()},l(l){e=E(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;d(e,"crossorigin","anonymous"),Ot(e.src,t=((r=(s=(l=n[13])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[4].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`))||d(e,"src",t),d(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none"),d(e,"alt","logo"),d(e,"draggable","false")},m(l,s){N(l,e,s)},p(l,s){var r,i,o;s&17&&!Ot(e.src,t=((o=(i=(r=l[13])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??(l[4].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`))&&d(e,"src",t)},d(l){l&&m(e)}}}function hr(n){var a,f,u;let e,t,l,s,r,i;t=new Re({props:{content:jt.parse(pt(((u=(f=(a=n[0][n[3]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[Ga]},$$scope:{ctx:n}}});function o(){return n[11](n[15])}return{c(){e=I("button"),X(t.$$.fragment),l=A()},l(h){e=E(h,"BUTTON",{});var c=k(e);Y(t.$$.fragment,c),l=H(c),c.forEach(m)},m(h,c){N(h,e,c),$(t,e,null),v(e,l),s=!0,r||(i=ge(e,"click",o),r=!0)},p(h,c){var _,D,p;n=h;const g={};c&9&&(g.content=jt.parse(pt(((p=(D=(_=n[0][n[3]])==null?void 0:_.info)==null?void 0:D.meta)==null?void 0:p.description)??""))),c&65553&&(g.$$scope={dirty:c,ctx:n}),t.$set(g)},i(h){s||(b(t.$$.fragment,h),s=!0)},o(h){M(t.$$.fragment,h),s=!1},d(h){h&&m(e),x(t),r=!1,i()}}}function mr(n){let e,t;return e=new Re({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-fit",placement:"top-start",$$slots:{default:[Za]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Za(n){let e,t,l,s;return t=new Ja({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=I("div"),X(t.$$.fragment),l=W(" Temporary Chat"),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=k(e);Y(t.$$.fragment,i),l=U(i," Temporary Chat"),i.forEach(m),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(r,i){N(r,e,i),$(t,e,null),v(e,l),s=!0},p:ve,i(r){s||(b(t.$$.fragment,r),s=!0)},o(r){M(t.$$.fragment,r),s=!1},d(r){r&&m(e),x(t)}}}function Ka(n){let e=n[4].t("Hello, {{name}}",{name:n[6].name})+"",t;return{c(){t=W(e)},l(l){t=U(l,e)},m(l,s){N(l,t,s)},p(l,s){s&80&&e!==(e=l[4].t("Hello, {{name}}",{name:l[6].name})+"")&&G(t,e)},d(l){l&&m(t)}}}function Qa(n){var l;let e=((l=n[0][n[3]])==null?void 0:l.name)+"",t;return{c(){t=W(e)},l(s){t=U(s,e)},m(s,r){N(s,t,r)},p(s,r){var i;r&9&&e!==(e=((i=s[0][s[3]])==null?void 0:i.name)+"")&&G(t,e)},d(s){s&&m(t)}}}function Xa(n){let e,t=n[4].t("How can I help you today?")+"",l;return{c(){e=I("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=k(e);l=U(r,t),r.forEach(m),this.h()},h(){d(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){N(s,e,r),v(e,l)},p(s,r){r&16&&t!==(t=s[4].t("How can I help you today?")+"")&&G(l,t)},d(s){s&&m(e)}}}function Ya(n){var o,a,f,u,h,c;let e,t,l=jt.parse(pt((f=(a=(o=n[0][n[3]])==null?void 0:o.info)==null?void 0:a.meta)==null?void 0:f.description))+"",s,r,i=((c=(h=(u=n[0][n[3]])==null?void 0:u.info)==null?void 0:h.meta)==null?void 0:c.user)&&gr(n);return{c(){e=I("div"),t=new Xr(!1),s=A(),i&&i.c(),r=fe(),this.h()},l(g){e=E(g,"DIV",{class:!0});var _=k(e);t=Yr(_,!1),_.forEach(m),s=H(g),i&&i.l(g),r=fe(),this.h()},h(){t.a=null,d(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(g,_){N(g,e,_),t.m(l,e),N(g,s,_),i&&i.m(g,_),N(g,r,_)},p(g,_){var D,p,y,w,R,B;_&9&&l!==(l=jt.parse(pt((y=(p=(D=g[0][g[3]])==null?void 0:D.info)==null?void 0:p.meta)==null?void 0:y.description))+"")&&t.p(l),(B=(R=(w=g[0][g[3]])==null?void 0:w.info)==null?void 0:R.meta)!=null&&B.user?i?i.p(g,_):(i=gr(g),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(g){g&&(m(e),m(s),m(r)),i&&i.d(g)}}}function gr(n){let e,t;function l(i,o){var a,f,u;return(u=(f=(a=i[0][i[3]])==null?void 0:a.info)==null?void 0:f.meta)!=null&&u.user.community?xa:$a}let s=l(n),r=s(n);return{c(){e=I("div"),t=W(`By
								`),r.c(),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=k(e);t=U(o,`By
								`),r.l(o),o.forEach(m),this.h()},h(){d(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,o){N(i,e,o),v(e,t),r.m(e,null)},p(i,o){s===(s=l(i))&&r?r.p(i,o):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function $a(n){var l,s,r;let e=((r=(s=(l=n[0][n[3]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=W(e)},l(i){t=U(i,e)},m(i,o){N(i,t,o)},p(i,o){var a,f,u;o&9&&e!==(e=((u=(f=(a=i[0][i[3]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&G(t,e)},d(i){i&&m(t)}}}function xa(n){var r,i,o,a,f,u,h,c,g;let e,t=((o=(i=(r=n[0][n[3]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&o.user.name?(u=(f=(a=n[0][n[3]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(g=(c=(h=n[0][n[3]])==null?void 0:h.info)==null?void 0:c.meta)==null?void 0:g.user.username}`)+"",l,s;return{c(){e=I("a"),l=W(t),this.h()},l(_){e=E(_,"A",{href:!0});var D=k(e);l=U(D,t),D.forEach(m),this.h()},h(){var _,D,p;d(e,"href",s="https://openwebui.com/m/"+((p=(D=(_=n[0][n[3]])==null?void 0:_.info)==null?void 0:D.meta)==null?void 0:p.user.username))},m(_,D){N(_,e,D),v(e,l)},p(_,D){var p,y,w,R,B,O,V,L,S,C,T,j;D&9&&t!==(t=((w=(y=(p=_[0][_[3]])==null?void 0:p.info)==null?void 0:y.meta)!=null&&w.user.name?(O=(B=(R=_[0][_[3]])==null?void 0:R.info)==null?void 0:B.meta)==null?void 0:O.user.name:`@${(S=(L=(V=_[0][_[3]])==null?void 0:V.info)==null?void 0:L.meta)==null?void 0:S.user.username}`)+"")&&G(l,t),D&9&&s!==(s="https://openwebui.com/m/"+((j=(T=(C=_[0][_[3]])==null?void 0:C.info)==null?void 0:T.meta)==null?void 0:j.user.username))&&d(e,"href",s)},d(_){_&&m(e)}}}function _r(n){var ae,ie,se,oe;let e,t,l,s,r,i,o,a,f,u,h,c,g,_,D,p,y,w,R=Ee(n[0]),B=[];for(let J=0;J<R.length;J+=1)B[J]=hr(dr(n,R,J));const O=J=>M(B[J],1,1,()=>{B[J]=null});let V=n[5]&&mr(n);function L(J,le){var me;return(me=J[0][J[3]])!=null&&me.name?Qa:Ka}let S=L(n),C=S(n);function T(J,le){var me,_e,Z;return((Z=(_e=(me=J[0][J[3]])==null?void 0:me.info)==null?void 0:_e.meta)==null?void 0:Z.description)??null?Ya:Xa}let j=T(n),q=j(n);return p=new Ua({props:{className:"grid grid-cols-2",suggestionPrompts:((se=(ie=(ae=n[0][n[3]])==null?void 0:ae.info)==null?void 0:ie.meta)==null?void 0:se.suggestion_prompts)??((oe=n[7])==null?void 0:oe.default_prompt_suggestions)??[]}}),p.$on("select",n[12]),{c(){e=I("div"),t=I("div"),l=I("div");for(let J=0;J<B.length;J+=1)B[J].c();r=A(),V&&V.c(),i=A(),o=I("div"),a=I("div"),f=I("div"),C.c(),h=A(),c=I("div"),q.c(),_=A(),D=I("div"),X(p.$$.fragment),this.h()},l(J){e=E(J,"DIV",{class:!0});var le=k(e);t=E(le,"DIV",{class:!0});var me=k(t);l=E(me,"DIV",{class:!0});var _e=k(l);for(let P=0;P<B.length;P+=1)B[P].l(_e);_e.forEach(m),me.forEach(m),r=H(le),V&&V.l(le),i=H(le),o=E(le,"DIV",{class:!0});var Z=k(o);a=E(Z,"DIV",{});var z=k(a);f=E(z,"DIV",{class:!0});var ue=k(f);C.l(ue),ue.forEach(m),h=H(z),c=E(z,"DIV",{});var re=k(c);q.l(re),re.forEach(m),z.forEach(m),Z.forEach(m),_=H(le),D=E(le,"DIV",{class:!0});var Q=k(D);Y(p.$$.fragment,Q),Q.forEach(m),le.forEach(m),this.h()},h(){d(l,"class","flex -space-x-4 mb-0.5"),d(t,"class","flex justify-start"),d(f,"class","capitalize line-clamp-1"),d(o,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),d(D,"class","w-full font-primary"),d(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(J,le){N(J,e,le),v(e,t),v(t,l);for(let me=0;me<B.length;me+=1)B[me]&&B[me].m(l,null);v(e,r),V&&V.m(e,null),v(e,i),v(e,o),v(o,a),v(a,f),C.m(f,null),v(a,h),v(a,c),q.m(c,null),v(e,_),v(e,D),$(p,D,null),w=!0},p(J,le){var _e,Z,z,ue;if(le&25){R=Ee(J[0]);let re;for(re=0;re<R.length;re+=1){const Q=dr(J,R,re);B[re]?(B[re].p(Q,le),b(B[re],1)):(B[re]=hr(Q),B[re].c(),b(B[re],1),B[re].m(l,null))}for(ee(),re=R.length;re<B.length;re+=1)O(re);te()}J[5]?V?le&32&&b(V,1):(V=mr(J),V.c(),b(V,1),V.m(e,i)):V&&(ee(),M(V,1,1,()=>{V=null}),te()),S===(S=L(J))&&C?C.p(J,le):(C.d(1),C=S(J),C&&(C.c(),C.m(f,null))),j===(j=T(J))&&q?q.p(J,le):(q.d(1),q=j(J),q&&(q.c(),q.m(c,null)));const me={};le&137&&(me.suggestionPrompts=((z=(Z=(_e=J[0][J[3]])==null?void 0:_e.info)==null?void 0:Z.meta)==null?void 0:z.suggestion_prompts)??((ue=J[7])==null?void 0:ue.default_prompt_suggestions)??[]),p.$set(me)},i(J){if(!w){for(let le=0;le<R.length;le+=1)b(B[le]);J&&(s||Tt(()=>{s=Bt(l,Rt,{duration:200}),s.start()})),b(V),J&&(u||Tt(()=>{u=Bt(f,Rt,{duration:200}),u.start()})),J&&(g||Tt(()=>{g=Bt(c,Rt,{duration:200,delay:200}),g.start()})),b(p.$$.fragment,J),J&&(y||Tt(()=>{y=Bt(D,Rt,{duration:200,delay:300}),y.start()})),w=!0}},o(J){B=B.filter(Boolean);for(let le=0;le<B.length;le+=1)M(B[le]);M(V),M(p.$$.fragment,J),w=!1},d(J){J&&m(e),Ue(B,J),V&&V.d(),C.d(),q.d(),x(p)}}}function ef(n){let e=n[2],t,l,s=_r(n);return{c(){s.c(),t=fe()},l(r){s.l(r),t=fe()},m(r,i){s.m(r,i),N(r,t,i),l=!0},p(r,[i]){i&4&&De(e,e=r[2])?(ee(),M(s,1,1,ve),te(),s=_r(r),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(t),s.d(r)}}}function tf(n,e,t){let l,s,r,i,o;Ie(n,At,p=>t(10,l=p)),Ie(n,sn,p=>t(5,r=p)),Ie(n,zt,p=>t(6,i=p)),Ie(n,Er,p=>t(7,o=p));const a=qe("i18n");Ie(n,a,p=>t(4,s=p));let{modelIds:f=[]}=e,{models:u=[]}=e,{submitPrompt:h}=e,c=!1,g=0;bt(()=>{t(2,c=!0)});const _=p=>{t(3,g=p)},D=p=>{h(p.detail)};return n.$$set=p=>{"modelIds"in p&&t(9,f=p.modelIds),"models"in p&&t(0,u=p.models),"submitPrompt"in p&&t(1,h=p.submitPrompt)},n.$$.update=()=>{n.$$.dirty&1536&&t(0,u=f.map(p=>l.find(y=>y.id===p))),n.$$.dirty&513&&f.length>0&&t(3,g=u.length-1)},[u,h,c,g,s,r,i,o,a,f,l,_,D]}class lf extends Te{constructor(e){super(),Be(this,e,tf,ef,De,{modelIds:9,models:0,submitPrompt:1})}}function vr(n,e,t){const l=n.slice();return l[40]=e[t],l[42]=t,l}function sf(n){let e,t=n[3],l,s=wr(n);return{c(){e=I("div"),s.c(),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=k(e);s.l(i),i.forEach(m),this.h()},h(){d(e,"class","w-full pt-2")},m(r,i){N(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&8&&De(t,t=r[3])?(ee(),M(s,1,1,ve),te(),s=wr(r),s.c(),b(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(e),s.d(r)}}}function rf(n){let e,t;return e=new lf({props:{modelIds:n[5],submitPrompt:n[32]}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&32&&(r.modelIds=l[5]),s[0]&32770&&(r.submitPrompt=l[32]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function pr(n){let e,t;return e=new yn({props:{$$slots:{default:[nf]},$$scope:{ctx:n}}}),e.$on("visible",n[33]),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[1]&4096&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function nf(n){let e,t,l,s,r="Loading...",i;return t=new Wt({props:{className:" size-4"}}),{c(){e=I("div"),X(t.$$.fragment),l=A(),s=I("div"),s.textContent=r,this.h()},l(o){e=E(o,"DIV",{class:!0});var a=k(e);Y(t.$$.fragment,a),l=H(a),s=E(a,"DIV",{class:!0,"data-svelte-h":!0}),Pe(s)!=="svelte-17uns3n"&&(s.textContent=r),a.forEach(m),this.h()},h(){d(s,"class",""),d(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){N(o,e,a),$(t,e,null),v(e,l),v(e,s),i=!0},p:ve,i(o){i||(b(t.$$.fragment,o),i=!0)},o(o){M(t.$$.fragment,o),i=!1},d(o){o&&m(e),x(t)}}}function br(n,e){let t,l,s,r;function i(a){e[34](a)}let o={chatId:e[3],messageId:e[40].id,idx:e[42],user:e[4],showPreviousMessage:e[19],showNextMessage:e[20],updateChat:e[18],editMessage:e[22],deleteMessage:e[25],rateMessage:e[21],actionMessage:e[23],saveMessage:e[24],submitMessage:e[9],regenerateResponse:e[7],continueResponse:e[6],mergeResponses:e[8],addMessages:e[10],triggerScroll:e[26],readOnly:e[11]};return e[0]!==void 0&&(o.history=e[0]),l=new Ba({props:o}),We.push(()=>$e(l,"history",i)),{key:n,first:null,c(){t=fe(),X(l.$$.fragment),this.h()},l(a){t=fe(),Y(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,f){N(a,t,f),$(l,a,f),r=!0},p(a,f){e=a;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&8192&&(u.messageId=e[40].id),f[0]&8192&&(u.idx=e[42]),f[0]&16&&(u.user=e[4]),f[0]&512&&(u.submitMessage=e[9]),f[0]&128&&(u.regenerateResponse=e[7]),f[0]&64&&(u.continueResponse=e[6]),f[0]&256&&(u.mergeResponses=e[8]),f[0]&1024&&(u.addMessages=e[10]),f[0]&2048&&(u.readOnly=e[11]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ye(()=>s=!1)),l.$set(u)},i(a){r||(b(l.$$.fragment,a),r=!0)},o(a){M(l.$$.fragment,a),r=!1},d(a){a&&m(t),x(l,a)}}}function kr(n){let e;return{c(){e=I("div"),this.h()},l(t){e=E(t,"DIV",{class:!0}),k(e).forEach(m),this.h()},h(){d(e,"class","pb-6")},m(t,l){N(t,e,l)},d(t){t&&m(e)}}}function wr(n){var D;let e,t=((D=n[13].at(0))==null?void 0:D.parentId)!==null,l,s=[],r=new Map,i,o,a,f,u,h=t&&pr(n),c=Ee(n[13]);const g=p=>p[40].id;for(let p=0;p<c.length;p+=1){let y=vr(n,c,p),w=g(y);r.set(w,s[p]=br(w,y))}let _=n[12]&&kr();return{c(){e=I("div"),h&&h.c(),l=A();for(let p=0;p<s.length;p+=1)s[p].c();i=A(),o=I("div"),a=A(),_&&_.c(),f=fe(),this.h()},l(p){e=E(p,"DIV",{class:!0});var y=k(e);h&&h.l(y),l=H(y);for(let w=0;w<s.length;w+=1)s[w].l(y);y.forEach(m),i=H(p),o=E(p,"DIV",{class:!0}),k(o).forEach(m),a=H(p),_&&_.l(p),f=fe(),this.h()},h(){d(e,"class","w-full"),d(o,"class","pb-12")},m(p,y){N(p,e,y),h&&h.m(e,null),v(e,l);for(let w=0;w<s.length;w+=1)s[w]&&s[w].m(e,null);N(p,i,y),N(p,o,y),N(p,a,y),_&&_.m(p,y),N(p,f,y),u=!0},p(p,y){var w;y[0]&8192&&(t=((w=p[13].at(0))==null?void 0:w.parentId)!==null),t?h?(h.p(p,y),y[0]&8192&&b(h,1)):(h=pr(p),h.c(),b(h,1),h.m(e,l)):h&&(ee(),M(h,1,1,()=>{h=null}),te()),y[0]&133967833&&(c=Ee(p[13]),ee(),s=Gt(s,y,g,1,p,c,r,e,yr,br,null,vr),te()),p[12]?_||(_=kr(),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i(p){if(!u){b(h);for(let y=0;y<c.length;y+=1)b(s[y]);u=!0}},o(p){M(h);for(let y=0;y<s.length;y+=1)M(s[y]);u=!1},d(p){p&&(m(e),m(i),m(o),m(a),m(f)),h&&h.d();for(let y=0;y<s.length;y+=1)s[y].d();_&&_.d(p)}}}function of(n){let e,t,l,s,r;const i=[rf,sf],o=[];function a(f,u){var h;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((h=f[0])==null?void 0:h.messages)??{}).length==0),t?0:1}return l=a(n,[-1,-1]),s=o[l]=i[l](n),{c(){e=I("div"),s.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=k(e);s.l(u),u.forEach(m),this.h()},h(){d(e,"class",n[2])},m(f,u){N(f,e,u),o[l].m(e,null),r=!0},p(f,u){let h=l;l=a(f,u),l===h?o[l].p(f,u):(ee(),M(o[h],1,1,()=>{o[h]=null}),te(),s=o[l],s?s.p(f,u):(s=o[l]=i[l](f),s.c()),b(s,1),s.m(e,null)),(!r||u[0]&4)&&d(e,"class",f[2])},i(f){r||(b(s),r=!0)},o(f){M(s),r=!1},d(f){f&&m(e),o[l].d()}}}function af(n,e,t){let l,s,r,i;Ie(n,Ht,P=>t(35,l=P)),Ie(n,hl,P=>t(36,s=P)),Ie(n,zt,P=>t(37,r=P)),gt();const o=qe("i18n");Ie(n,o,P=>t(15,i=P));let{className:a="h-full flex pt-8"}=e,{chatId:f=""}=e,{user:u=r}=e,{prompt:h}=e,{history:c={}}=e,{selectedModels:g}=e,_=[],{sendPrompt:D}=e,{continueResponse:p}=e,{regenerateResponse:y}=e,{mergeResponses:w}=e,{chatActionHandler:R}=e,{showMessage:B=()=>{}}=e,{submitMessage:O=()=>{}}=e,{addMessages:V=()=>{}}=e,{readOnly:L=!1}=e,{bottomPadding:S=!1}=e,{autoScroll:C}=e,T=20,j=!1;const q=async()=>{const P=document.getElementById("messages-container");P.scrollTop=P.scrollTop+100,t(14,j=!0),t(31,T+=20),await Ne(),t(14,j=!1)},ae=()=>{const P=document.getElementById("messages-container");P.scrollTop=P.scrollHeight},ie=async()=>{t(0,c),await Ne(),await on(localStorage.token,f,{history:c,messages:_}),hl.set(1),await rn.set(await an(localStorage.token,s))},se=async P=>{if(P.parentId!==null){let K=c.messages[P.parentId].childrenIds[Math.max(c.messages[P.parentId].childrenIds.indexOf(P.id)-1,0)];if(P.id!==K){let he=c.messages[K].childrenIds;for(;he.length!==0;)K=he.at(-1),he=c.messages[K].childrenIds;t(0,c.currentId=K,c)}}else{let K=Object.values(c.messages).filter(de=>de.parentId===null).map(de=>de.id),he=K[Math.max(K.indexOf(P.id)-1,0)];if(P.id!==he){let de=c.messages[he].childrenIds;for(;de.length!==0;)he=de.at(-1),de=c.messages[he].childrenIds;t(0,c.currentId=he,c)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(27,C=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{ae()},100)}},oe=async P=>{if(P.parentId!==null){let K=c.messages[P.parentId].childrenIds[Math.min(c.messages[P.parentId].childrenIds.indexOf(P.id)+1,c.messages[P.parentId].childrenIds.length-1)];if(P.id!==K){let he=c.messages[K].childrenIds;for(;he.length!==0;)K=he.at(-1),he=c.messages[K].childrenIds;t(0,c.currentId=K,c)}}else{let K=Object.values(c.messages).filter(de=>de.parentId===null).map(de=>de.id),he=K[Math.min(K.indexOf(P.id)+1,K.length-1)];if(P.id!==he){let de=c.messages[he].childrenIds;for(;de.length!==0;)he=de.at(-1),de=c.messages[he].childrenIds;t(0,c.currentId=he,c)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(27,C=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{ae()},100)}},J=async(P,K)=>{t(0,c.messages[P].annotation={...c.messages[P].annotation,rating:K},c),await ie()},le=async(P,K,he=!0)=>{if(c.messages[P].role==="user")if(he){let de=K,we=ml(),ce={id:we,parentId:c.messages[P].parentId,childrenIds:[],role:"user",content:de,...c.messages[P].files&&{files:c.messages[P].files},models:g},ne=c.messages[P].parentId;ne!==null&&t(0,c.messages[ne].childrenIds=[...c.messages[ne].childrenIds,we],c),t(0,c.messages[we]=ce,c),t(0,c.currentId=we,c),await Ne(),await D(c,de,we)}else t(0,c.messages[P].content=K,c),await ie();else if(he){const de=ml(),we=c.messages[P],ce=we.parentId,ne={...we,id:de,parentId:ce,childrenIds:[],files:void 0,content:K,timestamp:Math.floor(Date.now()/1e3)};t(0,c.messages[de]=ne,c),t(0,c.currentId=de,c),ce!==null&&t(0,c.messages[ce].childrenIds=[...c.messages[ce].childrenIds,de],c),await ie()}else t(0,c.messages[P].originalContent=c.messages[P].content,c),t(0,c.messages[P].content=K,c),await ie()},me=async(P,K,he=null)=>{await R(f,P,K.model,K.id,he)},_e=async(P,K)=>{t(0,c.messages[P]=K,c),await ie()},Z=async P=>{const K=c.messages[P],he=K.parentId,de=K.childrenIds??[],we=de.flatMap(ce=>{var ne;return((ne=c.messages[ce])==null?void 0:ne.childrenIds)??[]});he&&c.messages[he]&&t(0,c.messages[he].childrenIds=[...c.messages[he].childrenIds.filter(ce=>ce!==P),...we],c),we.forEach(ce=>{c.messages[ce]&&t(0,c.messages[ce].parentId=he,c)}),[P,...de].forEach(ce=>{delete c.messages[ce]}),await Ne(),B({id:he}),await ie()},z=()=>{if(C){const P=document.getElementById("messages-container");t(27,C=P.scrollHeight-P.scrollTop<=P.clientHeight+50),setTimeout(()=>{ae()},100)}},ue=async P=>{let K=P;if(P.includes("{{CLIPBOARD}}")){const de=await navigator.clipboard.readText().catch(we=>(Le.error(i.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));K=P.replaceAll("{{CLIPBOARD}}",de)}t(1,h=K),await Ne();const he=document.getElementById("chat-input-container");he&&(t(1,h=P),he.style.height="",he.style.height=Math.min(he.scrollHeight,200)+"px",he.focus()),await Ne()},re=P=>{console.log("visible"),j||q()};function Q(P){c=P,t(0,c)}return n.$$set=P=>{"className"in P&&t(2,a=P.className),"chatId"in P&&t(3,f=P.chatId),"user"in P&&t(4,u=P.user),"prompt"in P&&t(1,h=P.prompt),"history"in P&&t(0,c=P.history),"selectedModels"in P&&t(5,g=P.selectedModels),"sendPrompt"in P&&t(28,D=P.sendPrompt),"continueResponse"in P&&t(6,p=P.continueResponse),"regenerateResponse"in P&&t(7,y=P.regenerateResponse),"mergeResponses"in P&&t(8,w=P.mergeResponses),"chatActionHandler"in P&&t(29,R=P.chatActionHandler),"showMessage"in P&&t(30,B=P.showMessage),"submitMessage"in P&&t(9,O=P.submitMessage),"addMessages"in P&&t(10,V=P.addMessages),"readOnly"in P&&t(11,L=P.readOnly),"bottomPadding"in P&&t(12,S=P.bottomPadding),"autoScroll"in P&&t(27,C=P.autoScroll)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&1)if(c.currentId){let P=[],K=c.messages[c.currentId];for(;K&&P.length<=T;)P.unshift({...K}),K=K.parentId!==null?c.messages[K.parentId]:null;t(13,_=P)}else t(13,_=[]);n.$$.dirty[0]&134221824&&C&&S&&(async()=>(await Ne(),ae()))()},[c,h,a,f,u,g,p,y,w,O,V,L,S,_,j,i,o,q,ie,se,oe,J,le,me,_e,Z,z,C,D,R,B,T,ue,re,Q]}class Uf extends Te{constructor(e){super(),Be(this,e,af,of,De,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,sendPrompt:28,continueResponse:6,regenerateResponse:7,mergeResponses:8,chatActionHandler:29,showMessage:30,submitMessage:9,addMessages:10,readOnly:11,bottomPadding:12,autoScroll:27},null,[-1,-1])}}export{Ja as E,Mn as K,Uf as M,Ua as S};
//# sourceMappingURL=Messages.DrfmHWIR.js.map
