import{s as De,e as y,k as j,c as I,a as k,d as g,o as H,f as h,i as C,g as _,n as ve,t as U,b as W,I as Pe,C as nt,u as me,h as G,R as We,H as Ye,j as Me,p as qe,B as mt,q as vt,y as ze,A as Ke,r as Vn,v as Cn,w as Bn,x as Tn,E as be,F as ke,l as ue,J as Bt,D as Ne,O as On,an as Yt,T as Tt,Q as Dt,ai as Rn,aj as Sn}from"./scheduler.Dg_Xn4WQ.js";import{S as Be,i as Te,b as X,d as Y,m as $,t as b,a as D,e as x,f as Qe,g as te,c as le,h as Vt}from"./index.gNonUo3Z.js";import{e as ye,u as qt,o as fn,d as Ln}from"./each.dwVHsGX8.js";import{m as Lt,b as $t,h as un,g as Pn,F as jn,G as Hn,k as Pt,e as cn,u as jt,c as Ot,W as An,a as xt,l as zn,z as el,B as Un}from"./index.C2zJs1dP.js";import{t as Le}from"./Toaster.svelte_svelte_type_style_lang.CM0nbnqF.js";import{f as Wn,u as qn,i as Fn}from"./index.PGXp80Wq.js";import{b as Wt,m as dn,w as Jn,f as _t,r as Rt,l as hn,v as tl}from"./index.bquoJ5FE.js";import{d as rt}from"./relativeTime.BDz4fsXT.js";import{s as Gn}from"./index.CftsCmmZ.js";import{i as Zn}from"./index.fgGhQYcZ.js";import{ai as Kn,ag as kt,af as mn,ae as Ft,ah as gn}from"./Markdown._3svO0p6.js";import{T as Oe}from"./Tooltip.FP-CxtJW.js";import{T as Qn}from"./Tags.DSRhrO-S.js";import{S as Ht}from"./Spinner.C_k6OlPC.js";import{C as _n}from"./ChevronDown.CTso00xK.js";import{C as vn}from"./ChevronUp.CZxmUr6g.js";import{M as Xn}from"./MagnifyingGlass.CVR_fwbs.js";import{C as pn}from"./Collapsible.B_qz9Oj5.js";import{I as Yn,F as $n}from"./FileItem.CxuTeboj.js";import{M as bn}from"./Modal.DLh1UrlN.js";import{B as Jt}from"./Badge.DCgPuNVo.js";import{C as xn}from"./Check.CByLijz6.js";import{X as er}from"./XMark.B1BmN65L.js";import{E as tr}from"./EllipsisHorizontal.Dc0c2jlw.js";import{m as St}from"./marked.esm._0_gBwjO.js";import{c as ll}from"./index.TNrF8u2r.js";import{u as sl,c as lr}from"./index.DDUbMGLd.js";import{b as sr}from"./index.ttVds5UM.js";import{L as nr}from"./Loader.o4ZrhuUY.js";import{f as Ct}from"./index.nST1YYiD.js";import{F as rr}from"./fuse.CU2r43ac.js";function ir(r){let e,t,l,s,n,i,a,o,f,u,d,c,m,v,M,p,E,w,R,T,B,V,L,O,N,S;return{c(){e=y("div"),t=y("div"),l=y("div"),s=y("div"),i=j(),a=y("div"),o=y("div"),u=j(),d=y("div"),m=j(),v=y("div"),M=y("div"),E=j(),w=y("div"),T=j(),B=y("div"),L=j(),O=y("div"),this.h()},l(z){e=I(z,"DIV",{class:!0});var q=k(e);t=I(q,"DIV",{class:!0});var ie=k(t);l=I(ie,"DIV",{class:!0});var ae=k(l);s=I(ae,"DIV",{class:!0}),k(s).forEach(g),i=H(ae),a=I(ae,"DIV",{class:!0});var se=k(a);o=I(se,"DIV",{class:!0}),k(o).forEach(g),u=H(se),d=I(se,"DIV",{class:!0}),k(d).forEach(g),se.forEach(g),m=H(ae),v=I(ae,"DIV",{class:!0});var oe=k(v);M=I(oe,"DIV",{class:!0}),k(M).forEach(g),E=H(oe),w=I(oe,"DIV",{class:!0}),k(w).forEach(g),T=H(oe),B=I(oe,"DIV",{class:!0}),k(B).forEach(g),oe.forEach(g),L=H(ae),O=I(ae,"DIV",{class:!0}),k(O).forEach(g),ae.forEach(g),ie.forEach(g),q.forEach(g),this.h()},h(){h(s,"class",n=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded mr-14"),h(o,"class",f=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2"),h(d,"class",c=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1"),h(a,"class","grid grid-cols-3 gap-4"),h(M,"class",p=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1"),h(w,"class",R=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2"),h(B,"class",V=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1 mr-4"),h(v,"class","grid grid-cols-4 gap-4"),h(O,"class",N=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded"),h(l,"class",S=(r[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),h(t,"class","animate-pulse flex w-full"),h(e,"class","w-full mt-2 mb-2")},m(z,q){C(z,e,q),_(e,t),_(t,l),_(l,s),_(l,i),_(l,a),_(a,o),_(a,u),_(a,d),_(l,m),_(l,v),_(v,M),_(v,E),_(v,w),_(v,T),_(v,B),_(l,L),_(l,O)},p(z,[q]){q&1&&n!==(n=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded mr-14")&&h(s,"class",n),q&1&&f!==(f=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2")&&h(o,"class",f),q&1&&c!==(c=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1")&&h(d,"class",c),q&1&&p!==(p=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1")&&h(M,"class",p),q&1&&R!==(R=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2")&&h(w,"class",R),q&1&&V!==(V=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1 mr-4")&&h(B,"class",V),q&1&&N!==(N=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded")&&h(O,"class",N),q&1&&S!==(S=(z[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&h(l,"class",S)},i:ve,o:ve,d(z){z&&g(e)}}}function ar(r,e,t){let{size:l="md"}=e;return r.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class Gt extends Be{constructor(e){super(),Te(this,e,ar,ir,De,{size:0})}}function nl(r,e,t){const l=r.slice();return l[23]=e[t],l}function rl(r,e,t){const l=r.slice();return l[26]=e[t],l}function il(r){var s;let e,t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((s=r[7])==null?void 0:s.name)??r[7].id:r[1].selectedModelId})+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(n){e=I(n,"DIV",{class:!0});var i=k(e);l=W(i,t),i.forEach(g),this.h()},h(){h(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(n,i){C(n,e,i),_(e,l)},p(n,i){var a;i&386&&t!==(t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((a=n[7])==null?void 0:a.name)??n[7].id:n[1].selectedModelId})+"")&&G(l,t)},d(n){n&&g(e)}}}function al(r){let e,t=r[26]+"",l,s,n,i,a,o;function f(){return r[12](r[26])}return{c(){e=y("button"),l=U(t),s=j(),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var d=k(e);l=W(d,t),s=H(d),d.forEach(g),this.h()},h(){var u,d;h(e,"class",n="size-7 text-sm border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[6]===r[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white disabled:dark:bg-gray-900"),e.disabled=i=((d=(u=r[1])==null?void 0:u.annotation)==null?void 0:d.rating)===-1?r[26]>5:r[26]<6},m(u,d){C(u,e,d),_(e,l),_(e,s),a||(o=me(e,"click",f),a=!0)},p(u,d){var c,m;r=u,d&64&&n!==(n="size-7 text-sm border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[6]===r[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white disabled:dark:bg-gray-900")&&h(e,"class",n),d&2&&i!==(i=((m=(c=r[1])==null?void 0:c.annotation)==null?void 0:m.rating)===-1?r[26]>5:r[26]<6)&&(e.disabled=i)},d(u){u&&g(e),a=!1,o()}}}function ol(r){let e,t=r[8].t("Why?")+"",l,s,n,i=ye(r[3]),a=[];for(let o=0;o<i.length;o+=1)a[o]=fl(nl(r,i,o));return{c(){e=y("div"),l=U(t),s=j(),n=y("div");for(let o=0;o<a.length;o+=1)a[o].c();this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);l=W(f,t),f.forEach(g),s=H(o),n=I(o,"DIV",{class:!0});var u=k(n);for(let d=0;d<a.length;d+=1)a[d].l(u);u.forEach(g),this.h()},h(){h(e,"class","text-sm mt-1.5 font-medium"),h(n,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(o,f){C(o,e,f),_(e,l),C(o,s,f),C(o,n,f);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(n,null)},p(o,f){if(f&256&&t!==(t=o[8].t("Why?")+"")&&G(l,t),f&280){i=ye(o[3]);let u;for(u=0;u<i.length;u+=1){const d=nl(o,i,u);a[u]?a[u].p(d,f):(a[u]=fl(d),a[u].c(),a[u].m(n,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=i.length}},d(o){o&&(g(e),g(s),g(n)),We(a,o)}}}function or(r){let e=r[23]+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&G(t,e)},d(l){l&&g(t)}}}function fr(r){let e=r[8].t("Other")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&G(t,e)},d(l){l&&g(t)}}}function ur(r){let e=r[8].t("Being lazy")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&G(t,e)},d(l){l&&g(t)}}}function cr(r){let e=r[8].t("Refused when it shouldn't have")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&G(t,e)},d(l){l&&g(t)}}}function dr(r){let e=r[8].t("Didn't fully follow instructions")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&G(t,e)},d(l){l&&g(t)}}}function hr(r){let e=r[8].t("Not factually correct")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&G(t,e)},d(l){l&&g(t)}}}function mr(r){let e=r[8].t("Not helpful")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&G(t,e)},d(l){l&&g(t)}}}function gr(r){let e=r[8].t("Too verbose")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&G(t,e)},d(l){l&&g(t)}}}function _r(r){let e=r[8].t("Don't like the style")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&G(t,e)},d(l){l&&g(t)}}}function vr(r){let e=r[8].t("Thorough explanation")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&G(t,e)},d(l){l&&g(t)}}}function pr(r){let e=r[8].t("Attention to detail")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&G(t,e)},d(l){l&&g(t)}}}function br(r){let e=r[8].t("Positive attitude")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&G(t,e)},d(l){l&&g(t)}}}function kr(r){let e=r[8].t("Showcased creativity")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&G(t,e)},d(l){l&&g(t)}}}function wr(r){let e=r[8].t("Followed instructions perfectly")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&G(t,e)},d(l){l&&g(t)}}}function yr(r){let e=r[8].t("Accurate information")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&G(t,e)},d(l){l&&g(t)}}}function fl(r){let e,t,l,s,n;function i(u,d){return u[23]==="accurate_information"?yr:u[23]==="followed_instructions_perfectly"?wr:u[23]==="showcased_creativity"?kr:u[23]==="positive_attitude"?br:u[23]==="attention_to_detail"?pr:u[23]==="thorough_explanation"?vr:u[23]==="dont_like_the_style"?_r:u[23]==="too_verbose"?gr:u[23]==="not_helpful"?mr:u[23]==="not_factually_correct"?hr:u[23]==="didnt_fully_follow_instructions"?dr:u[23]==="refused_when_it_shouldnt_have"?cr:u[23]==="being_lazy"?ur:u[23]==="other"?fr:or}let a=i(r),o=a(r);function f(){return r[13](r[23])}return{c(){e=y("button"),o.c(),t=j(),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var d=k(e);o.l(d),t=H(d),d.forEach(g),this.h()},h(){h(e,"class",l="px-3 py-0.5 border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[4]===r[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,d){C(u,e,d),o.m(e,null),_(e,t),s||(n=me(e,"click",f),s=!0)},p(u,d){r=u,a===(a=i(r))&&o?o.p(r,d):(o.d(1),o=a(r),o&&(o.c(),o.m(e,t))),d&24&&l!==(l="px-3 py-0.5 border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[4]===r[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&h(e,"class",l)},d(u){u&&g(e),o.d(),s=!1,n()}}}function Ir(r){var fe;let e,t,l,s,n=r[8].t("How would you rate this response?")+"",i,a,o,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,d,c,m,v,M,p,E,w=r[8].t("Awful")+"",R,T,B,V,L=r[8].t("Amazing")+"",O,N,S,z,q,ie,ae,se,oe,J,ee,ge,_e,K=r[8].t("Save")+"",A,de,re,Q,P,Z=((fe=r[1])==null?void 0:fe.arena)&&il(r),he=ye(Array.from({length:10}).map(ul)),ce=[];for(let ne=0;ne<he.length;ne+=1)ce[ne]=al(rl(r,he,ne));let we=r[3].length>0&&ol(r);return ee=new Qn({props:{tags:r[2]}}),ee.$on("delete",r[15]),ee.$on("add",r[16]),{c(){Z&&Z.c(),e=j(),t=y("div"),l=y("div"),s=y("div"),i=U(n),a=j(),o=y("button"),o.innerHTML=f,u=j(),d=y("div"),c=y("div"),m=y("div");for(let ne=0;ne<ce.length;ne+=1)ce[ne].c();v=j(),M=y("div"),p=y("div"),E=U("1 - "),R=U(w),T=j(),B=y("div"),V=U("10 - "),O=U(L),N=j(),S=y("div"),we&&we.c(),z=j(),q=y("div"),ie=y("textarea"),se=j(),oe=y("div"),J=y("div"),X(ee.$$.fragment),ge=j(),_e=y("button"),A=U(K),this.h()},l(ne){Z&&Z.l(ne),e=H(ne),t=I(ne,"DIV",{class:!0,id:!0});var pe=k(t);l=I(pe,"DIV",{class:!0});var Ve=k(l);s=I(Ve,"DIV",{class:!0});var je=k(s);i=W(je,n),je.forEach(g),a=H(Ve),o=I(Ve,"BUTTON",{"data-svelte-h":!0}),Pe(o)!=="svelte-1ew22ui"&&(o.innerHTML=f),Ve.forEach(g),u=H(pe),d=I(pe,"DIV",{class:!0});var Ce=k(d);c=I(Ce,"DIV",{class:!0});var He=k(c);m=I(He,"DIV",{class:!0});var Ae=k(m);for(let et=0;et<ce.length;et+=1)ce[et].l(Ae);Ae.forEach(g),v=H(He),M=I(He,"DIV",{class:!0});var Fe=k(M);p=I(Fe,"DIV",{});var $e=k(p);E=W($e,"1 - "),R=W($e,w),$e.forEach(g),T=H(Fe),B=I(Fe,"DIV",{});var xe=k(B);V=W(xe,"10 - "),O=W(xe,L),xe.forEach(g),Fe.forEach(g),He.forEach(g),Ce.forEach(g),N=H(pe),S=I(pe,"DIV",{});var it=k(S);we&&we.l(it),it.forEach(g),z=H(pe),q=I(pe,"DIV",{class:!0});var at=k(q);ie=I(at,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),k(ie).forEach(g),at.forEach(g),se=H(pe),oe=I(pe,"DIV",{class:!0});var Xe=k(oe);J=I(Xe,"DIV",{class:!0});var ot=k(J);Y(ee.$$.fragment,ot),ot.forEach(g),ge=H(Xe),_e=I(Xe,"BUTTON",{class:!0});var ft=k(_e);A=W(ft,K),ft.forEach(g),Xe.forEach(g),pe.forEach(g),this.h()},h(){h(s,"class","text-sm font-medium"),h(l,"class","flex justify-between items-center"),h(m,"class","mt-1.5 w-fit flex gap-1 pb-5"),h(M,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),h(c,"class","relative w-fit"),h(d,"class","w-full flex justify-center"),h(ie,"class","w-full text-sm px-1 py-2 bg-transparent outline-none resize-none rounded-xl"),h(ie,"placeholder",ae=r[8].t("Feel free to add specific details")),h(ie,"rows","3"),h(q,"class","mt-2"),h(J,"class","flex items-end group"),h(_e,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(oe,"class","mt-2 gap-1.5 flex justify-between"),h(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-50 dark:border-gray-850"),h(t,"id",de="message-feedback-"+r[1].id)},m(ne,pe){Z&&Z.m(ne,pe),C(ne,e,pe),C(ne,t,pe),_(t,l),_(l,s),_(s,i),_(l,a),_(l,o),_(t,u),_(t,d),_(d,c),_(c,m);for(let Ve=0;Ve<ce.length;Ve+=1)ce[Ve]&&ce[Ve].m(m,null);_(c,v),_(c,M),_(M,p),_(p,E),_(p,R),_(M,T),_(M,B),_(B,V),_(B,O),_(t,N),_(t,S),we&&we.m(S,null),_(t,z),_(t,q),_(q,ie),nt(ie,r[5]),_(t,se),_(t,oe),_(oe,J),$(ee,J,null),_(oe,ge),_(oe,_e),_(_e,A),re=!0,Q||(P=[me(o,"click",r[11]),me(ie,"input",r[14]),me(_e,"click",r[17])],Q=!0)},p(ne,[pe]){var je;if((je=ne[1])!=null&&je.arena?Z?Z.p(ne,pe):(Z=il(ne),Z.c(),Z.m(e.parentNode,e)):Z&&(Z.d(1),Z=null),(!re||pe&256)&&n!==(n=ne[8].t("How would you rate this response?")+"")&&G(i,n),pe&66){he=ye(Array.from({length:10}).map(ul));let Ce;for(Ce=0;Ce<he.length;Ce+=1){const He=rl(ne,he,Ce);ce[Ce]?ce[Ce].p(He,pe):(ce[Ce]=al(He),ce[Ce].c(),ce[Ce].m(m,null))}for(;Ce<ce.length;Ce+=1)ce[Ce].d(1);ce.length=he.length}(!re||pe&256)&&w!==(w=ne[8].t("Awful")+"")&&G(R,w),(!re||pe&256)&&L!==(L=ne[8].t("Amazing")+"")&&G(O,L),ne[3].length>0?we?we.p(ne,pe):(we=ol(ne),we.c(),we.m(S,null)):we&&(we.d(1),we=null),(!re||pe&256&&ae!==(ae=ne[8].t("Feel free to add specific details")))&&h(ie,"placeholder",ae),pe&32&&nt(ie,ne[5]);const Ve={};pe&4&&(Ve.tags=ne[2]),ee.$set(Ve),(!re||pe&256)&&K!==(K=ne[8].t("Save")+"")&&G(A,K),(!re||pe&2&&de!==(de="message-feedback-"+ne[1].id))&&h(t,"id",de)},i(ne){re||(b(ee.$$.fragment,ne),re=!0)},o(ne){D(ee.$$.fragment,ne),re=!1},d(ne){ne&&(g(e),g(t)),Z&&Z.d(ne),We(ce,ne),we&&we.d(),x(ee),Q=!1,Ye(P)}}}const ul=(r,e)=>e+1;function Mr(r,e,t){let l,s;Me(r,Lt,S=>t(18,s=S));const n=qe("i18n");Me(r,n,S=>t(8,l=S));const i=mt();let{message:a}=e,{show:o=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],d=[],c=[],m=null,v="",M=null,p=null;const E=()=>{var S,z,q,ie,ae;m||t(4,m=((S=a==null?void 0:a.annotation)==null?void 0:S.reason)??""),v||t(5,v=((z=a==null?void 0:a.annotation)==null?void 0:z.comment)??""),t(2,d=(((q=a==null?void 0:a.annotation)==null?void 0:q.tags)??[]).map(se=>({name:se}))),M||t(6,M=((ae=(ie=a==null?void 0:a.annotation)==null?void 0:ie.details)==null?void 0:ae.rating)??null)};vt(()=>{a!=null&&a.arena&&(t(7,p=s.find(S=>S.id===a.selectedModelId)),Le.success(l.t('This response was generated by "{{model}}"',{model:p?(p==null?void 0:p.name)??p.id:a.selectedModelId})))});const w=()=>{console.log("saveHandler"),i("save",{reason:m,comment:v,tags:d.map(S=>S.name),details:{rating:M}}),Le.success(l.t("Thanks for your feedback!")),t(0,o=!1)},R=()=>{t(0,o=!1)},T=S=>{t(6,M=S)},B=S=>{t(4,m=S)};function V(){v=this.value,t(5,v)}const L=S=>{t(2,d=d.filter(z=>z.name.replaceAll(" ","_").toLowerCase()!==S.detail.replaceAll(" ","_").toLowerCase()))},O=S=>{t(2,d=[...d,{name:S.detail}])},N=()=>{w()};return r.$$set=S=>{"message"in S&&t(1,a=S.message),"show"in S&&t(0,o=S.show)},r.$$.update=()=>{var S,z;r.$$.dirty&2&&(((S=a==null?void 0:a.annotation)==null?void 0:S.rating)===1?t(3,c=f):((z=a==null?void 0:a.annotation)==null?void 0:z.rating)===-1&&t(3,c=u)),r.$$.dirty&2&&a&&E()},[o,a,d,c,m,v,M,p,l,n,w,R,T,B,V,L,O,N]}class Er extends Be{constructor(e){super(),Te(this,e,Mr,Ir,De,{message:1,show:0})}}function cl(r,e,t){const l=r.slice();return l[5]=e[t],l[7]=t,l}function Nr(r){let e,t;return e=new _n({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Dr(r){let e,t;return e=new vn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Vr(r){let e,t,l,s,n;const i=r[2].default,a=Vn(i,r,r[4],null),o=[Dr,Nr],f=[];function u(d,c){return d[1]?0:1}return l=u(r),s=f[l]=o[l](r),{c(){e=y("div"),a&&a.c(),t=j(),s.c(),this.h()},l(d){e=I(d,"DIV",{class:!0});var c=k(e);a&&a.l(c),t=H(c),s.l(c),c.forEach(g),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(d,c){C(d,e,c),a&&a.m(e,null),_(e,t),f[l].m(e,null),n=!0},p(d,c){a&&a.p&&(!n||c&16)&&Cn(a,i,d,d[4],n?Tn(i,d[4],c,null):Bn(d[4]),null);let m=l;l=u(d),l!==m&&(te(),D(f[m],1,1,()=>{f[m]=null}),le(),s=f[l],s||(s=f[l]=o[l](d),s.c()),b(s,1),s.m(e,null))},i(d){n||(b(a,d),b(s),n=!0)},o(d){D(a,d),D(s),n=!1},d(d){d&&g(e),a&&a.d(d),f[l].d()}}}function dl(r){let e,t,l,s,n,i=r[0].query+"",a,o,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',d,c;return l=new Xn({}),{c(){e=y("a"),t=y("div"),X(l.$$.fragment),s=j(),n=y("div"),a=U(i),o=j(),f=y("div"),f.innerHTML=u,this.h()},l(m){e=I(m,"A",{href:!0,target:!0,class:!0});var v=k(e);t=I(v,"DIV",{class:!0});var M=k(t);Y(l.$$.fragment,M),s=H(M),n=I(M,"DIV",{class:!0});var p=k(n);a=W(p,i),p.forEach(g),M.forEach(g),o=H(v),f=I(v,"DIV",{class:!0,"data-svelte-h":!0}),Pe(f)!=="svelte-14xjows"&&(f.innerHTML=u),v.forEach(g),this.h()},h(){h(n,"class","line-clamp-1"),h(t,"class","flex gap-2 items-center"),h(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",d="https://www.google.com/search?q="+r[0].query),h(e,"target","_blank"),h(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(m,v){C(m,e,v),_(e,t),$(l,t,null),_(t,s),_(t,n),_(n,a),_(e,o),_(e,f),c=!0},p(m,v){(!c||v&1)&&i!==(i=m[0].query+"")&&G(a,i),(!c||v&1&&d!==(d="https://www.google.com/search?q="+m[0].query))&&h(e,"href",d)},i(m){c||(b(l.$$.fragment,m),c=!0)},o(m){D(l.$$.fragment,m),c=!1},d(m){m&&g(e),x(l)}}}function hl(r){let e,t,l=r[5]+"",s,n,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',o,f,u;return{c(){e=y("a"),t=y("div"),s=U(l),n=j(),i=y("div"),i.innerHTML=a,o=j(),this.h()},l(d){e=I(d,"A",{href:!0,target:!0,class:!0});var c=k(e);t=I(c,"DIV",{class:!0});var m=k(t);s=W(m,l),m.forEach(g),n=H(c),i=I(c,"DIV",{class:!0,"data-svelte-h":!0}),Pe(i)!=="svelte-14xjows"&&(i.innerHTML=a),o=H(c),c.forEach(g),this.h()},h(){h(t,"class","line-clamp-1"),h(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",f=r[5]),h(e,"target","_blank"),h(e,"class",u="flex w-full items-center p-3 px-4 "+(r[7]===r[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(d,c){C(d,e,c),_(e,t),_(t,s),_(e,n),_(e,i),_(e,o)},p(d,c){c&1&&l!==(l=d[5]+"")&&G(s,l),c&1&&f!==(f=d[5])&&h(e,"href",f),c&1&&u!==(u="flex w-full items-center p-3 px-4 "+(d[7]===d[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&h(e,"class",u)},d(d){d&&g(e)}}}function Cr(r){var a;let e,t,l,s=((a=r[0])==null?void 0:a.query)&&dl(r),n=ye(r[0].urls),i=[];for(let o=0;o<n.length;o+=1)i[o]=hl(cl(r,n,o));return{c(){e=y("div"),s&&s.c(),t=j();for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=I(o,"DIV",{class:!0,slot:!0});var f=k(e);s&&s.l(f),t=H(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(g),this.h()},h(){h(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),h(e,"slot","content")},m(o,f){C(o,e,f),s&&s.m(e,null),_(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(o,f){var u;if((u=o[0])!=null&&u.query?s?(s.p(o,f),f&1&&b(s,1)):(s=dl(o),s.c(),b(s,1),s.m(e,t)):s&&(te(),D(s,1,1,()=>{s=null}),le()),f&1){n=ye(o[0].urls);let d;for(d=0;d<n.length;d+=1){const c=cl(o,n,d);i[d]?i[d].p(c,f):(i[d]=hl(c),i[d].c(),i[d].m(e,null))}for(;d<i.length;d+=1)i[d].d(1);i.length=n.length}},i(o){l||(b(s),l=!0)},o(o){D(s),l=!1},d(o){o&&g(e),s&&s.d(),We(i,o)}}}function Br(r){let e,t,l;function s(i){r[3](i)}let n={className:"w-full space-y-1",$$slots:{content:[Cr],default:[Vr]},$$scope:{ctx:r}};return r[1]!==void 0&&(n.open=r[1]),e=new pn({props:n}),ze.push(()=>Qe(e,"open",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,a){$(e,i,a),l=!0},p(i,[a]){const o={};a&19&&(o.$$scope={dirty:a,ctx:i}),!t&&a&2&&(t=!0,o.open=i[1],Ke(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function Tr(r,e,t){let{$$slots:l={},$$scope:s}=e,{status:n={urls:[],query:""}}=e,i=!1;function a(o){i=o,t(1,i)}return r.$$set=o=>{"status"in o&&t(0,n=o.status),"$$scope"in o&&t(4,s=o.$$scope)},[n,i,l,a,s]}class Or extends Be{constructor(e){super(),Te(this,e,Tr,Br,De,{status:0})}}function Rr(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function Sr(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Lr extends Be{constructor(e){super(),Te(this,e,Sr,Rr,De,{className:0,strokeWidth:1})}}function Pr(r){let e,t,l,s,n,i=(typeof r[0]=="string"?r[0]:JSON.stringify(r[0]))+"",a,o;return l=new Yn({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=y("div"),t=y("div"),X(l.$$.fragment),s=j(),n=y("div"),a=U(i),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);t=I(u,"DIV",{class:!0});var d=k(t);Y(l.$$.fragment,d),d.forEach(g),s=H(u),n=I(u,"DIV",{class:!0});var c=k(n);a=W(c,i),c.forEach(g),u.forEach(g),this.h()},h(){h(t,"class","self-start mt-0.5"),h(n,"class","self-center text-sm"),h(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){C(f,e,u),_(e,t),$(l,t,null),_(e,s),_(e,n),_(n,a),o=!0},p(f,[u]){(!o||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&G(a,i)},i(f){o||(b(l.$$.fragment,f),o=!0)},o(f){D(l.$$.fragment,f),o=!1},d(f){f&&g(e),x(l)}}}function jr(r,e,t){let{content:l=""}=e;return r.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}class Hr extends Be{constructor(e){super(),Te(this,e,jr,Pr,De,{content:0})}}function ml(r,e,t){const l=r.slice();return l[9]=e[t],l[11]=t,l}function Ar(r){const e=r.slice(),t=Yr(e[9].distance);return e[12]=t,e}function zr(r){let e,t=r[4].t("No source available")+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(g),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&16&&t!==(t=s[4].t("No source available")+"")&&G(l,t)},i:ve,o:ve,d(s){s&&g(e)}}}function Ur(r){let e,t,l,s;e=new Oe({props:{className:"w-fit",content:r[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Wr]},$$scope:{ctx:r}}});let n=r[2]&&_l(r);return{c(){X(e.$$.fragment),t=j(),n&&n.c(),l=ue()},l(i){Y(e.$$.fragment,i),t=H(i),n&&n.l(i),l=ue()},m(i,a){$(e,i,a),C(i,t,a),n&&n.m(i,a),C(i,l,a),s=!0},p(i,a){const o={};a&16&&(o.content=i[4].t("Open file")),a&8216&&(o.$$scope={dirty:a,ctx:i}),e.$set(o),i[2]?n?(n.p(i,a),a&4&&b(n,1)):(n=_l(i),n.c(),b(n,1),n.m(l.parentNode,l)):n&&(te(),D(n,1,1,()=>{n=null}),le())},i(i){s||(b(e.$$.fragment,i),b(n),s=!0)},o(i){D(e.$$.fragment,i),D(n),s=!1},d(i){i&&(g(t),g(l)),x(e,i),n&&n.d(i)}}}function gl(r){let e,t,l=r[4].t("page")+"",s,n,i=r[9].metadata.page+1+"",a,o;return{c(){e=y("span"),t=U("("),s=U(l),n=j(),a=U(i),o=U(")"),this.h()},l(f){e=I(f,"SPAN",{class:!0});var u=k(e);t=W(u,"("),s=W(u,l),n=H(u),a=W(u,i),o=W(u,")"),u.forEach(g),this.h()},h(){h(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){C(f,e,u),_(e,t),_(e,s),_(e,n),_(e,a),_(e,o)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&G(s,l),u&8&&i!==(i=f[9].metadata.page+1+"")&&G(a,i)},d(f){f&&g(e)}}}function Wr(r){var o,f,u,d;let e,t,l=(((f=(o=r[9])==null?void 0:o.metadata)==null?void 0:f.name)??r[9].source.name)+"",s,n,i,a=((d=(u=r[9])==null?void 0:u.metadata)==null?void 0:d.page)&&gl(r);return{c(){e=y("div"),t=y("a"),s=U(l),i=j(),a&&a.c(),this.h()},l(c){e=I(c,"DIV",{class:!0});var m=k(e);t=I(m,"A",{class:!0,href:!0,target:!0});var v=k(t);s=W(v,l),v.forEach(g),i=H(m),a&&a.l(m),m.forEach(g),this.h()},h(){var c,m,v,M,p,E,w,R;h(t,"class","hover:text-gray-500 hover:dark:text-gray-100 underline flex-grow"),h(t,"href",n=(m=(c=r[9])==null?void 0:c.metadata)!=null&&m.file_id?`${$t}/files/${(M=(v=r[9])==null?void 0:v.metadata)==null?void 0:M.file_id}/content${((E=(p=r[9])==null?void 0:p.metadata)==null?void 0:E.page)!==void 0?`#page=${r[9].metadata.page+1}`:""}`:(R=(w=r[9].source)==null?void 0:w.url)!=null&&R.includes("http")?r[9].source.url:"#"),h(t,"target","_blank"),h(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(c,m){C(c,e,m),_(e,t),_(t,s),_(e,i),a&&a.m(e,null)},p(c,m){var v,M,p,E,w,R,T,B,V,L,O,N;m&8&&l!==(l=(((M=(v=c[9])==null?void 0:v.metadata)==null?void 0:M.name)??c[9].source.name)+"")&&G(s,l),m&8&&n!==(n=(E=(p=c[9])==null?void 0:p.metadata)!=null&&E.file_id?`${$t}/files/${(R=(w=c[9])==null?void 0:w.metadata)==null?void 0:R.file_id}/content${((B=(T=c[9])==null?void 0:T.metadata)==null?void 0:B.page)!==void 0?`#page=${c[9].metadata.page+1}`:""}`:(L=(V=c[9].source)==null?void 0:V.url)!=null&&L.includes("http")?c[9].source.url:"#")&&h(t,"href",n),(N=(O=c[9])==null?void 0:O.metadata)!=null&&N.page?a?a.p(c,m):(a=gl(c),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(c){c&&g(e),a&&a.d()}}}function _l(r){let e,t=r[4].t("Relevance")+"",l,s,n,i,a,o;const f=[Fr,qr],u=[];function d(c,m){return c[9].distance!==void 0?0:1}return n=d(r),i=u[n]=f[n](r),{c(){e=y("div"),l=U(t),s=j(),i.c(),a=ue(),this.h()},l(c){e=I(c,"DIV",{class:!0});var m=k(e);l=W(m,t),m.forEach(g),s=H(c),i.l(c),a=ue(),this.h()},h(){h(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(c,m){C(c,e,m),_(e,l),C(c,s,m),u[n].m(c,m),C(c,a,m),o=!0},p(c,m){(!o||m&16)&&t!==(t=c[4].t("Relevance")+"")&&G(l,t);let v=n;n=d(c),n===v?u[n].p(c,m):(te(),D(u[v],1,1,()=>{u[v]=null}),le(),i=u[n],i?i.p(c,m):(i=u[n]=f[n](c),i.c()),b(i,1),i.m(a.parentNode,a))},i(c){o||(b(i),o=!0)},o(c){D(i),o=!1},d(c){c&&(g(e),g(s),g(a)),u[n].d(c)}}}function qr(r){let e,t=r[4].t("No distance available")+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(g),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&16&&t!==(t=s[4].t("No distance available")+"")&&G(l,t)},i:ve,o:ve,d(s){s&&g(e)}}}function Fr(r){let e,t;return e=new Oe({props:{className:"w-fit",content:r[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Gr]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s&16&&(n.content=l[4].t("Semantic distance to query")),s&8202&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Jr(r){let e,t=r[9].distance.toFixed(4)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var n=k(e);l=W(n,t),n.forEach(g),this.h()},h(){h(e,"class","text-gray-500 dark:text-gray-500")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&8&&t!==(t=s[9].distance.toFixed(4)+"")&&G(l,t)},d(s){s&&g(e)}}}function vl(r){let e,t=r[12].toFixed(2)+"",l,s,n,i,a,o,f=r[9].distance.toFixed(4)+"",u,d;return{c(){e=y("span"),l=U(t),s=U("%"),i=j(),a=y("span"),o=U("("),u=U(f),d=U(")"),this.h()},l(c){e=I(c,"SPAN",{class:!0});var m=k(e);l=W(m,t),s=W(m,"%"),m.forEach(g),i=H(c),a=I(c,"SPAN",{class:!0});var v=k(a);o=W(v,"("),u=W(v,f),d=W(v,")"),v.forEach(g),this.h()},h(){h(e,"class",n=`px-1 rounded font-medium ${kl(r[12])}`),h(a,"class","text-gray-500 dark:text-gray-500")},m(c,m){C(c,e,m),_(e,l),_(e,s),C(c,i,m),C(c,a,m),_(a,o),_(a,u),_(a,d)},p(c,m){m&8&&t!==(t=c[12].toFixed(2)+"")&&G(l,t),m&8&&n!==(n=`px-1 rounded font-medium ${kl(c[12])}`)&&h(e,"class",n),m&8&&f!==(f=c[9].distance.toFixed(4)+"")&&G(u,f)},d(c){c&&(g(e),g(i),g(a))}}}function Gr(r){let e;function t(i,a){return i[1]?vl:Jr}function l(i,a){return a===vl?Ar(i):i}let s=t(r),n=s(l(r,s));return{c(){e=y("div"),n.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);n.l(a),a.forEach(g),this.h()},h(){h(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,a){C(i,e,a),n.m(e,null)},p(i,a){s===(s=t(i))&&n?n.p(l(i,s),a):(n.d(1),n=s(l(i,s)),n&&(n.c(),n.m(e,null)))},d(i){i&&g(e),n.d()}}}function Zr(r){let e,t,l=r[9].document+"",s,n;return{c(){e=y("pre"),t=U("                "),s=U(l),n=U(`
              `),this.h()},l(i){e=I(i,"PRE",{class:!0});var a=k(e);t=W(a,"                "),s=W(a,l),n=W(a,`
              `),a.forEach(g),this.h()},h(){h(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,a){C(i,e,a),_(e,t),_(e,s),_(e,n)},p(i,a){a&8&&l!==(l=i[9].document+"")&&G(s,l)},d(i){i&&g(e)}}}function Kr(r){let e,t,l;return{c(){e=y("iframe"),this.h()},l(s){e=I(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),k(e).forEach(g),this.h()},h(){h(e,"class","w-full border-0 h-auto rounded-none"),h(e,"sandbox","allow-scripts allow-forms allow-same-origin"),h(e,"srcdoc",t=r[9].document),h(e,"title",l=r[4].t("Content"))},m(s,n){C(s,e,n)},p(s,n){n&8&&t!==(t=s[9].document)&&h(e,"srcdoc",t),n&16&&l!==(l=s[4].t("Content"))&&h(e,"title",l)},d(s){s&&g(e)}}}function pl(r){let e;return{c(){e=y("hr"),this.h()},l(t){e=I(t,"HR",{class:!0}),this.h()},h(){h(e,"class","dark:border-gray-850 my-3")},m(t,l){C(t,e,l)},d(t){t&&g(e)}}}function bl(r){let e,t,l=r[4].t("Source")+"",s,n,i,a,o,f,u,d=r[4].t("Content")+"",c,m,v,M,p;const E=[Ur,zr],w=[];function R(O,N){var S;return(S=O[9].source)!=null&&S.name?0:1}i=R(r),a=w[i]=E[i](r);function T(O,N){var S;return(S=O[9].metadata)!=null&&S.html?Kr:Zr}let B=T(r),V=B(r),L=r[11]!==r[3].length-1&&pl();return{c(){e=y("div"),t=y("div"),s=U(l),n=j(),a.c(),o=j(),f=y("div"),u=y("div"),c=U(d),m=j(),V.c(),v=j(),L&&L.c(),M=ue(),this.h()},l(O){e=I(O,"DIV",{class:!0});var N=k(e);t=I(N,"DIV",{class:!0});var S=k(t);s=W(S,l),S.forEach(g),n=H(N),a.l(N),N.forEach(g),o=H(O),f=I(O,"DIV",{class:!0});var z=k(f);u=I(z,"DIV",{class:!0});var q=k(u);c=W(q,d),q.forEach(g),m=H(z),V.l(z),z.forEach(g),v=H(O),L&&L.l(O),M=ue(),this.h()},h(){h(t,"class","text-sm font-medium dark:text-gray-300"),h(e,"class","flex flex-col w-full"),h(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),h(f,"class","flex flex-col w-full")},m(O,N){C(O,e,N),_(e,t),_(t,s),_(e,n),w[i].m(e,null),C(O,o,N),C(O,f,N),_(f,u),_(u,c),_(f,m),V.m(f,null),C(O,v,N),L&&L.m(O,N),C(O,M,N),p=!0},p(O,N){(!p||N&16)&&l!==(l=O[4].t("Source")+"")&&G(s,l);let S=i;i=R(O),i===S?w[i].p(O,N):(te(),D(w[S],1,1,()=>{w[S]=null}),le(),a=w[i],a?a.p(O,N):(a=w[i]=E[i](O),a.c()),b(a,1),a.m(e,null)),(!p||N&16)&&d!==(d=O[4].t("Content")+"")&&G(c,d),B===(B=T(O))&&V?V.p(O,N):(V.d(1),V=B(O),V&&(V.c(),V.m(f,null))),O[11]!==O[3].length-1?L||(L=pl(),L.c(),L.m(M.parentNode,M)):L&&(L.d(1),L=null)},i(O){p||(b(a),p=!0)},o(O){D(a),p=!1},d(O){O&&(g(e),g(o),g(f),g(v),g(M)),w[i].d(),V.d(),L&&L.d(O)}}}function Qr(r){let e,t,l,s=r[4].t("Citation")+"",n,i,a,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,d,c,m,v,M=ye(r[3]),p=[];for(let w=0;w<M.length;w+=1)p[w]=bl(ml(r,M,w));const E=w=>D(p[w],1,1,()=>{p[w]=null});return{c(){e=y("div"),t=y("div"),l=y("div"),n=U(s),i=j(),a=y("button"),a.innerHTML=o,f=j(),u=y("div"),d=y("div");for(let w=0;w<p.length;w+=1)p[w].c();this.h()},l(w){e=I(w,"DIV",{});var R=k(e);t=I(R,"DIV",{class:!0});var T=k(t);l=I(T,"DIV",{class:!0});var B=k(l);n=W(B,s),B.forEach(g),i=H(T),a=I(T,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(a)!=="svelte-745w2y"&&(a.innerHTML=o),T.forEach(g),f=H(R),u=I(R,"DIV",{class:!0});var V=k(u);d=I(V,"DIV",{class:!0});var L=k(d);for(let O=0;O<p.length;O+=1)p[O].l(L);L.forEach(g),V.forEach(g),R.forEach(g),this.h()},h(){h(l,"class","text-lg font-medium self-center capitalize"),h(a,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(d,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(w,R){C(w,e,R),_(e,t),_(t,l),_(l,n),_(t,i),_(t,a),_(e,f),_(e,u),_(u,d);for(let T=0;T<p.length;T+=1)p[T]&&p[T].m(d,null);c=!0,m||(v=me(a,"click",r[7]),m=!0)},p(w,R){if((!c||R&16)&&s!==(s=w[4].t("Citation")+"")&&G(n,s),R&30){M=ye(w[3]);let T;for(T=0;T<M.length;T+=1){const B=ml(w,M,T);p[T]?(p[T].p(B,R),b(p[T],1)):(p[T]=bl(B),p[T].c(),b(p[T],1),p[T].m(d,null))}for(te(),T=M.length;T<p.length;T+=1)E(T);le()}},i(w){if(!c){for(let R=0;R<M.length;R+=1)b(p[R]);c=!0}},o(w){p=p.filter(Boolean);for(let R=0;R<p.length;R+=1)D(p[R]);c=!1},d(w){w&&g(e),We(p,w),m=!1,v()}}}function Xr(r){let e,t,l;function s(i){r[8](i)}let n={size:"lg",$$slots:{default:[Qr]},$$scope:{ctx:r}};return r[0]!==void 0&&(n.show=r[0]),e=new bn({props:n}),ze.push(()=>Qe(e,"show",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,a){$(e,i,a),l=!0},p(i,[a]){const o={};a&8223&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.show=i[0],Ke(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function Yr(r){return r<0?0:r>1?100:Math.round(r*1e4)/100}function kl(r){return r>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":r>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":r>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function $r(r,e,t){let l;const s=qe("i18n");Me(r,s,c=>t(4,l=c));let{show:n=!1}=e,{citation:i}=e,{showPercentage:a=!1}=e,{showRelevance:o=!0}=e,f=[];const u=()=>{t(0,n=!1)};function d(c){n=c,t(0,n)}return r.$$set=c=>{"show"in c&&t(0,n=c.show),"citation"in c&&t(6,i=c.citation),"showPercentage"in c&&t(1,a=c.showPercentage),"showRelevance"in c&&t(2,o=c.showRelevance)},r.$$.update=()=>{var c;r.$$.dirty&72&&i&&(t(3,f=(c=i.document)==null?void 0:c.map((m,v)=>{var M,p;return{source:i.source,document:m,metadata:(M=i.metadata)==null?void 0:M[v],distance:(p=i.distances)==null?void 0:p[v]}})),f.every(m=>m.distance!==void 0)&&t(3,f=f.sort((m,v)=>(v.distance??1/0)-(m.distance??1/0))))},[n,a,o,f,l,s,i,u,d]}class xr extends Be{constructor(e){super(),Te(this,e,$r,Xr,De,{show:0,citation:6,showPercentage:1,showRelevance:2})}}function wl(r,e,t){const l=r.slice();return l[17]=e[t],l[19]=t,l}function yl(r,e,t){const l=r.slice();return l[17]=e[t],l[19]=t,l}function Il(r,e,t){const l=r.slice();return l[17]=e[t],l[19]=t,l}function Ml(r){let e,t,l,s;const n=[ti,ei],i=[];function a(o,f){return o[0].length<=3?0:1}return t=a(r),l=i[t]=n[t](r),{c(){e=y("div"),l.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(g),this.h()},h(){h(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(o,f){C(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t===u?i[t].p(o,f):(te(),D(i[u],1,1,()=>{i[u]=null}),le(),l=i[t],l?l.p(o,f):(l=i[t]=n[t](o),l.c()),b(l,1),l.m(e,null))},i(o){s||(b(l),s=!0)},o(o){D(l),s=!1},d(o){o&&g(e),i[t].d()}}}function ei(r){let e,t,l;function s(i){r[16](i)}let n={className:"w-full",$$slots:{content:[ri],default:[ni]},$$scope:{ctx:r}};return r[5]!==void 0&&(n.open=r[5]),e=new pn({props:n}),ze.push(()=>Qe(e,"open",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,a){$(e,i,a),l=!0},p(i,a){const o={};a&4194425&&(o.$$scope={dirty:a,ctx:i}),!t&&a&32&&(t=!0,o.open=i[5],Ke(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function ti(r){let e,t=ye(r[0]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Bl(Il(r,t,s));return{c(){e=y("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);for(let i=0;i<l.length;i+=1)l[i].l(n);n.forEach(g),this.h()},h(){h(e,"class","flex text-xs font-medium")},m(s,n){C(s,e,n);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,n){if(n&25){t=ye(s[0]);let i;for(i=0;i<t.length;i+=1){const a=Il(s,t,i);l[i]?l[i].p(a,n):(l[i]=Bl(a),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:ve,o:ve,d(s){s&&g(e),We(l,s)}}}function El(r){let e,t=r[19]+1+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(g),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){C(s,e,n),_(e,l)},d(s){s&&g(e)}}}function Nl(r){let e,t=r[0].every(r[11]),l,s,n=r[17].source.name+"",i,a,o,f,u=t&&El(r);function d(){return r[15](r[17])}return{c(){e=y("button"),u&&u.c(),l=j(),s=y("div"),i=U(n),a=j(),this.h()},l(c){e=I(c,"BUTTON",{class:!0});var m=k(e);u&&u.l(m),l=H(m),s=I(m,"DIV",{class:!0});var v=k(s);i=W(v,n),v.forEach(g),a=H(m),m.forEach(g),this.h()},h(){h(s,"class","flex-1 mx-1 line-clamp-1 truncate"),h(e,"class","no-toggle outline-none flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(c,m){C(c,e,m),u&&u.m(e,null),_(e,l),_(e,s),_(s,i),_(e,a),o||(f=[me(e,"click",d),me(e,"pointerup",fi)],o=!0)},p(c,m){r=c,m&1&&(t=r[0].every(r[11])),t?u||(u=El(r),u.c(),u.m(e,l)):u&&(u.d(1),u=null),m&1&&n!==(n=r[17].source.name+"")&&G(i,n)},d(c){c&&g(e),u&&u.d(),o=!1,Ye(f)}}}function li(r){let e,t;return e=new _n({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function si(r){let e,t;return e=new vn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ni(r){let e,t,l,s=r[6].t("References from")+"",n,i,a,o,f,u,d,c=r[6].t("and")+"",m,v,M=r[0].length-2+"",p,E,w,R=r[6].t("more")+"",T,B,V,L,O,N,S=ye(r[0].slice(0,2)),z=[];for(let se=0;se<S.length;se+=1)z[se]=Nl(wl(r,S,se));const q=[si,li],ie=[];function ae(se,oe){return se[5]?0:1}return L=ae(r),O=ie[L]=q[L](r),{c(){e=y("div"),t=y("div"),l=y("span"),n=U(s),i=j(),a=y("div"),o=y("div");for(let se=0;se<z.length;se+=1)z[se].c();f=j(),u=y("div"),d=y("span"),m=U(c),v=j(),p=U(M),E=j(),w=y("span"),T=U(R),B=j(),V=y("div"),O.c(),this.h()},l(se){e=I(se,"DIV",{class:!0});var oe=k(e);t=I(oe,"DIV",{class:!0});var J=k(t);l=I(J,"SPAN",{class:!0});var ee=k(l);n=W(ee,s),ee.forEach(g),i=H(J),a=I(J,"DIV",{class:!0});var ge=k(a);o=I(ge,"DIV",{class:!0});var _e=k(o);for(let Q=0;Q<z.length;Q+=1)z[Q].l(_e);_e.forEach(g),ge.forEach(g),f=H(J),u=I(J,"DIV",{class:!0});var K=k(u);d=I(K,"SPAN",{class:!0});var A=k(d);m=W(A,c),A.forEach(g),v=H(K),p=W(K,M),E=H(K),w=I(K,"SPAN",{});var de=k(w);T=W(de,R),de.forEach(g),K.forEach(g),J.forEach(g),B=H(oe),V=I(oe,"DIV",{class:!0});var re=k(V);O.l(re),re.forEach(g),oe.forEach(g),this.h()},h(){h(l,"class","whitespace-nowrap hidden sm:inline"),h(o,"class","flex text-xs font-medium items-center"),h(a,"class","flex items-center"),h(d,"class","hidden sm:inline"),h(u,"class","flex items-center gap-1 whitespace-nowrap"),h(t,"class","flex-grow flex items-center gap-1 overflow-hidden"),h(V,"class","flex-shrink-0"),h(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(se,oe){C(se,e,oe),_(e,t),_(t,l),_(l,n),_(t,i),_(t,a),_(a,o);for(let J=0;J<z.length;J+=1)z[J]&&z[J].m(o,null);_(t,f),_(t,u),_(u,d),_(d,m),_(u,v),_(u,p),_(u,E),_(u,w),_(w,T),_(e,B),_(e,V),ie[L].m(V,null),N=!0},p(se,oe){if((!N||oe&64)&&s!==(s=se[6].t("References from")+"")&&G(n,s),oe&25){S=ye(se[0].slice(0,2));let ee;for(ee=0;ee<S.length;ee+=1){const ge=wl(se,S,ee);z[ee]?z[ee].p(ge,oe):(z[ee]=Nl(ge),z[ee].c(),z[ee].m(o,null))}for(;ee<z.length;ee+=1)z[ee].d(1);z.length=S.length}(!N||oe&64)&&c!==(c=se[6].t("and")+"")&&G(m,c),(!N||oe&1)&&M!==(M=se[0].length-2+"")&&G(p,M),(!N||oe&64)&&R!==(R=se[6].t("more")+"")&&G(T,R);let J=L;L=ae(se),L!==J&&(te(),D(ie[J],1,1,()=>{ie[J]=null}),le(),O=ie[L],O||(O=ie[L]=q[L](se),O.c()),b(O,1),O.m(V,null))},i(se){N||(b(O),N=!0)},o(se){D(O),N=!1},d(se){se&&g(e),We(z,se),ie[L].d()}}}function Dl(r){let e,t=r[19]+1+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(g),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){C(s,e,n),_(e,l)},d(s){s&&g(e)}}}function Vl(r){let e,t=r[0].every(r[10]),l,s,n=r[17].source.name+"",i,a,o,f,u=t&&Dl(r);function d(){return r[14](r[17])}return{c(){e=y("button"),u&&u.c(),l=j(),s=y("div"),i=U(n),a=j(),this.h()},l(c){e=I(c,"BUTTON",{class:!0});var m=k(e);u&&u.l(m),l=H(m),s=I(m,"DIV",{class:!0});var v=k(s);i=W(v,n),v.forEach(g),a=H(m),m.forEach(g),this.h()},h(){h(s,"class","flex-1 mx-1 line-clamp-1 truncate"),h(e,"class","no-toggle outline-none flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(c,m){C(c,e,m),u&&u.m(e,null),_(e,l),_(e,s),_(s,i),_(e,a),o||(f=me(e,"click",d),o=!0)},p(c,m){r=c,m&1&&(t=r[0].every(r[10])),t?u||(u=Dl(r),u.c(),u.m(e,l)):u&&(u.d(1),u=null),m&1&&n!==(n=r[17].source.name+"")&&G(i,n)},d(c){c&&g(e),u&&u.d(),o=!1,f()}}}function ri(r){let e,t,l=ye(r[0]),s=[];for(let n=0;n<l.length;n+=1)s[n]=Vl(yl(r,l,n));return{c(){e=y("div"),t=y("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=I(n,"DIV",{slot:!0});var i=k(e);t=I(i,"DIV",{class:!0});var a=k(t);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(g),i.forEach(g),this.h()},h(){h(t,"class","flex text-xs font-medium"),h(e,"slot","content")},m(n,i){C(n,e,i),_(e,t);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null)},p(n,i){if(i&25){l=ye(n[0]);let a;for(a=0;a<l.length;a+=1){const o=yl(n,l,a);s[a]?s[a].p(o,i):(s[a]=Vl(o),s[a].c(),s[a].m(t,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=l.length}},d(n){n&&g(e),We(s,n)}}}function Cl(r){let e,t=r[19]+1+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(g),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){C(s,e,n),_(e,l)},d(s){s&&g(e)}}}function Bl(r){let e,t=r[0].every(r[9]),l,s,n=r[17].source.name+"",i,a,o,f,u,d=t&&Cl(r);function c(){return r[13](r[17])}return{c(){e=y("button"),d&&d.c(),l=j(),s=y("div"),i=U(n),a=j(),this.h()},l(m){e=I(m,"BUTTON",{id:!0,class:!0});var v=k(e);d&&d.l(v),l=H(v),s=I(v,"DIV",{class:!0});var M=k(s);i=W(M,n),M.forEach(g),a=H(v),v.forEach(g),this.h()},h(){h(s,"class","flex-1 mx-1 line-clamp-1 text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),h(e,"id",o=`source-${r[17].source.name}`),h(e,"class","no-toggle outline-none flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(m,v){C(m,e,v),d&&d.m(e,null),_(e,l),_(e,s),_(s,i),_(e,a),f||(u=me(e,"click",c),f=!0)},p(m,v){r=m,v&1&&(t=r[0].every(r[9])),t?d||(d=Cl(r),d.c(),d.m(e,l)):d&&(d.d(1),d=null),v&1&&n!==(n=r[17].source.name+"")&&G(i,n),v&1&&o!==(o=`source-${r[17].source.name}`)&&h(e,"id",o)},d(m){m&&g(e),d&&d.d(),f=!1,u()}}}function ii(r){let e,t,l,s,n;function i(f){r[12](f)}let a={citation:r[4],showPercentage:r[1],showRelevance:r[2]};r[3]!==void 0&&(a.show=r[3]),e=new xr({props:a}),ze.push(()=>Qe(e,"show",i));let o=r[0].length>0&&Ml(r);return{c(){X(e.$$.fragment),l=j(),o&&o.c(),s=ue()},l(f){Y(e.$$.fragment,f),l=H(f),o&&o.l(f),s=ue()},m(f,u){$(e,f,u),C(f,l,u),o&&o.m(f,u),C(f,s,u),n=!0},p(f,[u]){const d={};u&16&&(d.citation=f[4]),u&2&&(d.showPercentage=f[1]),u&4&&(d.showRelevance=f[2]),!t&&u&8&&(t=!0,d.show=f[3],Ke(()=>t=!1)),e.$set(d),f[0].length>0?o?(o.p(f,u),u&1&&b(o,1)):(o=Ml(f),o.c(),b(o,1),o.m(s.parentNode,s)):o&&(te(),D(o,1,1,()=>{o=null}),le())},i(f){n||(b(e.$$.fragment,f),b(o),n=!0)},o(f){D(e.$$.fragment,f),D(o),n=!1},d(f){f&&(g(l),g(s)),x(e,f),o&&o.d(f)}}}function ai(r){const e=r.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function oi(r){return r.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const fi=r=>{r.stopPropagation()};function ui(r,e,t){let l;const s=qe("i18n");Me(r,s,T=>t(6,l=T));let{sources:n=[]}=e,i=[],a=!1,o=!0,f=!1,u=null,d=!1;const c=T=>T.distances!==void 0,m=T=>T.distances!==void 0,v=T=>T.distances!==void 0;function M(T){f=T,t(3,f)}const p=T=>{t(3,f=!0),t(4,u=T)},E=T=>{t(3,f=!0),t(4,u=T)},w=T=>{t(3,f=!0),t(4,u=T)};function R(T){d=T,t(5,d)}return r.$$set=T=>{"sources"in T&&t(8,n=T.sources)},r.$$.update=()=>{r.$$.dirty&257&&(t(0,i=n.reduce((T,B)=>(Object.keys(B).length===0||B.document.forEach((V,L)=>{var ie,ae;const O=(ie=B.metadata)==null?void 0:ie[L],N=(ae=B.distances)==null?void 0:ae[L],S=(O==null?void 0:O.source)??"N/A";let z=B==null?void 0:B.source;O!=null&&O.name&&(z={...z,name:O.name}),(S.startsWith("http://")||S.startsWith("https://"))&&(z={...z,name:S,url:S});const q=T.find(se=>se.id===S);q?(q.document.push(V),q.metadata.push(O),N!==void 0&&q.distances.push(N)):T.push({id:S,source:z,document:[V],metadata:O?[O]:[],distances:N!==void 0?[N]:void 0})}),T),[])),t(2,o=ai(i)),t(1,a=oi(i)))},[i,a,o,f,u,d,l,s,n,c,m,v,M,p,E,w,R]}class ci extends Be{constructor(e){super(),Te(this,e,ui,ii,De,{sources:8})}}function Tl(r,e,t){const l=r.slice();return l[6]=e[t],l}function Ol(r){let e,t,l,s;const n=[mi,hi,di],i=[];function a(o,f){var u,d;return(u=o[1].result)!=null&&u.error?0:(d=o[1].result)!=null&&d.output?1:2}return t=a(r),l=i[t]=n[t](r),{c(){e=y("div"),l.c()},l(o){e=I(o,"DIV",{});var f=k(e);l.l(f),f.forEach(g)},m(o,f){C(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t!==u&&(te(),D(i[u],1,1,()=>{i[u]=null}),le(),l=i[t],l||(l=i[t]=n[t](o),l.c()),b(l,1),l.m(e,null))},i(o){s||(b(l),s=!0)},o(o){D(l),s=!1},d(o){o&&g(e),i[t].d()}}}function di(r){let e,t;return e=new Jt({props:{type:"warning",content:"incomplete"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function hi(r){let e,t;return e=new Jt({props:{type:"success",content:"success"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function mi(r){let e,t;return e=new Jt({props:{type:"error",content:"error"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Rl(r){let e,t,l;return t=new Ht({props:{className:"size-4"}}),{c(){e=y("div"),X(t.$$.fragment)},l(s){e=I(s,"DIV",{});var n=k(e);Y(t.$$.fragment,n),n.forEach(g)},m(s,n){C(s,e,n),$(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),x(t)}}}function gi(r){let e=r[2].t("Code execution")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&G(t,e)},d(l){l&&g(t)}}}function _i(r){var i;let e=r[2].t("Code execution")+"",t,l,s=((i=r[1])==null?void 0:i.name)+"",n;return{c(){t=U(e),l=U(": "),n=U(s)},l(a){t=W(a,e),l=W(a,": "),n=W(a,s)},m(a,o){C(a,t,o),C(a,l,o),C(a,n,o)},p(a,o){var f;o&4&&e!==(e=a[2].t("Code execution")+"")&&G(t,e),o&2&&s!==(s=((f=a[1])==null?void 0:f.name)+"")&&G(n,s)},d(a){a&&(g(t),g(l),g(n))}}}function Sl(r){var n,i,a,o;let e,t,l=((i=(n=r[1])==null?void 0:n.result)==null?void 0:i.error)&&Ll(r),s=((o=(a=r[1])==null?void 0:a.result)==null?void 0:o.output)&&Pl(r);return{c(){e=y("div"),l&&l.c(),t=j(),s&&s.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);l&&l.l(u),t=H(u),s&&s.l(u),u.forEach(g),this.h()},h(){h(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){C(f,e,u),l&&l.m(e,null),_(e,t),s&&s.m(e,null)},p(f,u){var d,c,m,v;(c=(d=f[1])==null?void 0:d.result)!=null&&c.error?l?l.p(f,u):(l=Ll(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(v=(m=f[1])==null?void 0:m.result)!=null&&v.output?s?s.p(f,u):(s=Pl(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&g(e),l&&l.d(),s&&s.d()}}}function Ll(r){var f,u;let e,t,l=r[2].t("ERROR")+"",s,n,i,a=((u=(f=r[1])==null?void 0:f.result)==null?void 0:u.error)+"",o;return{c(){e=y("div"),t=y("div"),s=U(l),n=j(),i=y("div"),o=U(a),this.h()},l(d){e=I(d,"DIV",{});var c=k(e);t=I(c,"DIV",{class:!0});var m=k(t);s=W(m,l),m.forEach(g),n=H(c),i=I(c,"DIV",{class:!0});var v=k(i);o=W(v,a),v.forEach(g),c.forEach(g),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(d,c){C(d,e,c),_(e,t),_(t,s),_(e,n),_(e,i),_(i,o)},p(d,c){var m,v;c&4&&l!==(l=d[2].t("ERROR")+"")&&G(s,l),c&2&&a!==(a=((v=(m=d[1])==null?void 0:m.result)==null?void 0:v.error)+"")&&G(o,a)},d(d){d&&g(e)}}}function Pl(r){var f,u;let e,t,l=r[2].t("OUTPUT")+"",s,n,i,a=((u=(f=r[1])==null?void 0:f.result)==null?void 0:u.output)+"",o;return{c(){e=y("div"),t=y("div"),s=U(l),n=j(),i=y("div"),o=U(a),this.h()},l(d){e=I(d,"DIV",{});var c=k(e);t=I(c,"DIV",{class:!0});var m=k(t);s=W(m,l),m.forEach(g),n=H(c),i=I(c,"DIV",{class:!0});var v=k(i);o=W(v,a),v.forEach(g),c.forEach(g),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(d,c){C(d,e,c),_(e,t),_(t,s),_(e,n),_(e,i),_(i,o)},p(d,c){var m,v;c&4&&l!==(l=d[2].t("OUTPUT")+"")&&G(s,l),c&2&&a!==(a=((v=(m=d[1])==null?void 0:m.result)==null?void 0:v.output)+"")&&G(o,a)},d(d){d&&g(e)}}}function jl(r){var d,c;let e,t,l,s,n=r[2].t("Files")+"",i,a,o,f=ye((c=(d=r[1])==null?void 0:d.result)==null?void 0:c.files),u=[];for(let m=0;m<f.length;m+=1)u[m]=Hl(Tl(r,f,m));return{c(){e=y("div"),t=y("hr"),l=j(),s=y("div"),i=U(n),a=j(),o=y("ul");for(let m=0;m<u.length;m+=1)u[m].c();this.h()},l(m){e=I(m,"DIV",{class:!0});var v=k(e);t=I(v,"HR",{class:!0}),l=H(v),s=I(v,"DIV",{class:!0});var M=k(s);i=W(M,n),M.forEach(g),a=H(v),o=I(v,"UL",{class:!0});var p=k(o);for(let E=0;E<u.length;E+=1)u[E].l(p);p.forEach(g),v.forEach(g),this.h()},h(){h(t,"class","dark:border-gray-850 my-2"),h(s,"class","text-sm font-medium dark:text-gray-300"),h(o,"class","mt-1 list-disc pl-4 text-xs"),h(e,"class","flex flex-col w-full")},m(m,v){C(m,e,v),_(e,t),_(e,l),_(e,s),_(s,i),_(e,a),_(e,o);for(let M=0;M<u.length;M+=1)u[M]&&u[M].m(o,null)},p(m,v){var M,p;if(v&4&&n!==(n=m[2].t("Files")+"")&&G(i,n),v&2){f=ye((p=(M=m[1])==null?void 0:M.result)==null?void 0:p.files);let E;for(E=0;E<f.length;E+=1){const w=Tl(m,f,E);u[E]?u[E].p(w,v):(u[E]=Hl(w),u[E].c(),u[E].m(o,null))}for(;E<u.length;E+=1)u[E].d(1);u.length=f.length}},d(m){m&&g(e),We(u,m)}}}function Hl(r){let e,t,l=r[6].name+"",s,n,i;return{c(){e=y("li"),t=y("a"),s=U(l),i=j(),this.h()},l(a){e=I(a,"LI",{});var o=k(e);t=I(o,"A",{href:!0,target:!0});var f=k(t);s=W(f,l),f.forEach(g),i=H(o),o.forEach(g),this.h()},h(){h(t,"href",n=r[6].url),h(t,"target","_blank")},m(a,o){C(a,e,o),_(e,t),_(t,s),_(e,i)},p(a,o){o&2&&l!==(l=a[6].name+"")&&G(s,l),o&2&&n!==(n=a[6].url)&&h(t,"href",n)},d(a){a&&g(e)}}}function vi(r){var q,ie,ae,se,oe,J,ee,ge,_e,K,A,de,re,Q,P,Z,he,ce,we;let e,t,l,s,n,i,a,o,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',d,c,m,v,M,p,E,w,R,T,B=((q=r[1])==null?void 0:q.result)&&Ol(r),V=!((ie=r[1])!=null&&ie.result)&&Rl();function L(fe,ne){var pe;return(pe=fe[1])!=null&&pe.name?_i:gi}let O=L(r),N=O(r);M=new Kn({props:{id:"code-exec-"+((ae=r[1])==null?void 0:ae.id)+"-code",lang:((se=r[1])==null?void 0:se.language)??"",code:((oe=r[1])==null?void 0:oe.code)??"",className:"",editorClassName:(J=r[1])!=null&&J.result&&((ge=(ee=r[1])==null?void 0:ee.result)!=null&&ge.error||(K=(_e=r[1])==null?void 0:_e.result)!=null&&K.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let S=((A=r[1])==null?void 0:A.result)&&(((re=(de=r[1])==null?void 0:de.result)==null?void 0:re.error)||((P=(Q=r[1])==null?void 0:Q.result)==null?void 0:P.output))&&Sl(r),z=((he=(Z=r[1])==null?void 0:Z.result)==null?void 0:he.files)&&((we=(ce=r[1])==null?void 0:ce.result)==null?void 0:we.files.length)>0&&jl(r);return{c(){e=y("div"),t=y("div"),l=y("div"),B&&B.c(),s=j(),n=y("div"),V&&V.c(),i=j(),a=y("div"),N.c(),o=j(),f=y("button"),f.innerHTML=u,d=j(),c=y("div"),m=y("div"),v=y("div"),X(M.$$.fragment),p=j(),S&&S.c(),E=j(),z&&z.c(),this.h()},l(fe){e=I(fe,"DIV",{});var ne=k(e);t=I(ne,"DIV",{class:!0});var pe=k(t);l=I(pe,"DIV",{class:!0});var Ve=k(l);B&&B.l(Ve),s=H(Ve),n=I(Ve,"DIV",{class:!0});var je=k(n);V&&V.l(je),i=H(je),a=I(je,"DIV",{});var Ce=k(a);N.l(Ce),Ce.forEach(g),je.forEach(g),Ve.forEach(g),o=H(pe),f=I(pe,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(f)!=="svelte-vnrwun"&&(f.innerHTML=u),pe.forEach(g),d=H(ne),c=I(ne,"DIV",{class:!0});var He=k(c);m=I(He,"DIV",{class:!0});var Ae=k(m);v=I(Ae,"DIV",{class:!0});var Fe=k(v);Y(M.$$.fragment,Fe),Fe.forEach(g),p=H(Ae),S&&S.l(Ae),E=H(Ae),z&&z.l(Ae),Ae.forEach(g),He.forEach(g),ne.forEach(g),this.h()},h(){h(n,"class","flex gap-2 items-center"),h(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),h(f,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(v,"class","flex flex-col w-full"),h(m,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(c,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(fe,ne){C(fe,e,ne),_(e,t),_(t,l),B&&B.m(l,null),_(l,s),_(l,n),V&&V.m(n,null),_(n,i),_(n,a),N.m(a,null),_(t,o),_(t,f),_(e,d),_(e,c),_(c,m),_(m,v),$(M,v,null),_(m,p),S&&S.m(m,null),_(m,E),z&&z.m(m,null),w=!0,R||(T=me(f,"click",r[4]),R=!0)},p(fe,ne){var Ve,je,Ce,He,Ae,Fe,$e,xe,it,at,Xe,ot,ft,et,wt,yt,It,Mt,Et;(Ve=fe[1])!=null&&Ve.result?B?(B.p(fe,ne),ne&2&&b(B,1)):(B=Ol(fe),B.c(),b(B,1),B.m(l,s)):B&&(te(),D(B,1,1,()=>{B=null}),le()),(je=fe[1])!=null&&je.result?V&&(te(),D(V,1,1,()=>{V=null}),le()):V?ne&2&&b(V,1):(V=Rl(),V.c(),b(V,1),V.m(n,i)),O===(O=L(fe))&&N?N.p(fe,ne):(N.d(1),N=O(fe),N&&(N.c(),N.m(a,null)));const pe={};ne&2&&(pe.id="code-exec-"+((Ce=fe[1])==null?void 0:Ce.id)+"-code"),ne&2&&(pe.lang=((He=fe[1])==null?void 0:He.language)??""),ne&2&&(pe.code=((Ae=fe[1])==null?void 0:Ae.code)??""),ne&2&&(pe.editorClassName=(Fe=fe[1])!=null&&Fe.result&&((xe=($e=fe[1])==null?void 0:$e.result)!=null&&xe.error||(at=(it=fe[1])==null?void 0:it.result)!=null&&at.output)?"rounded-b-none":""),M.$set(pe),(Xe=fe[1])!=null&&Xe.result&&((ft=(ot=fe[1])==null?void 0:ot.result)!=null&&ft.error||(wt=(et=fe[1])==null?void 0:et.result)!=null&&wt.output)?S?S.p(fe,ne):(S=Sl(fe),S.c(),S.m(m,E)):S&&(S.d(1),S=null),(It=(yt=fe[1])==null?void 0:yt.result)!=null&&It.files&&((Et=(Mt=fe[1])==null?void 0:Mt.result)==null?void 0:Et.files.length)>0?z?z.p(fe,ne):(z=jl(fe),z.c(),z.m(m,null)):z&&(z.d(1),z=null)},i(fe){w||(b(B),b(V),b(M.$$.fragment,fe),w=!0)},o(fe){D(B),D(V),D(M.$$.fragment,fe),w=!1},d(fe){fe&&g(e),B&&B.d(),V&&V.d(),N.d(),x(M),S&&S.d(),z&&z.d(),R=!1,T()}}}function pi(r){let e,t,l;function s(i){r[5](i)}let n={size:"lg",$$slots:{default:[vi]},$$scope:{ctx:r}};return r[0]!==void 0&&(n.show=r[0]),e=new bn({props:n}),ze.push(()=>Qe(e,"show",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,a){$(e,i,a),l=!0},p(i,[a]){const o={};a&519&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.show=i[0],Ke(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function bi(r,e,t){let l;const s=qe("i18n");Me(r,s,f=>t(2,l=f));let{show:n=!1}=e,{codeExecution:i=null}=e;const a=()=>{t(0,n=!1),t(1,i=null)};function o(f){n=f,t(0,n)}return r.$$set=f=>{"show"in f&&t(0,n=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[n,i,l,s,a,o]}class ki extends Be{constructor(e){super(),Te(this,e,bi,pi,De,{show:0,codeExecution:1})}}function Al(r,e,t){const l=r.slice();return l[6]=e[t],l}function zl(r){let e,t=[],l=new Map,s,n=ye(r[0]);const i=a=>a[6].id;for(let a=0;a<n.length;a+=1){let o=Al(r,n,a),f=i(o);l.set(f,t[a]=Ul(f,o))}return{c(){e=y("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=I(a,"DIV",{class:!0});var o=k(e);for(let f=0;f<t.length;f+=1)t[f].l(o);o.forEach(g),this.h()},h(){h(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(a,o){C(a,e,o);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(a,o){o&7&&(n=ye(a[0]),te(),t=qt(t,o,i,1,a,n,l,e,fn,Ul,null,Al),le())},i(a){if(!s){for(let o=0;o<n.length;o+=1)b(t[o]);s=!0}},o(a){for(let o=0;o<t.length;o+=1)D(t[o]);s=!1},d(a){a&&g(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function wi(r){let e,t;return e=new Ht({props:{className:"size-4"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function yi(r){let e,t,l,s;const n=[Ei,Mi,Ii],i=[];function a(o,f){var u,d;return(u=o[6].result)!=null&&u.error?0:(d=o[6].result)!=null&&d.output?1:2}return e=a(r),t=i[e]=n[e](r),{c(){t.c(),l=ue()},l(o){t.l(o),l=ue()},m(o,f){i[e].m(o,f),C(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e!==u&&(te(),D(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t||(t=i[e]=n[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&g(l),i[e].d(o)}}}function Ii(r){let e,t;return e=new tr({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Mi(r){let e,t;return e=new xn({props:{strokeWidth:"3",className:"size-3"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ei(r){let e,t;return e=new er({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ul(r,e){let t,l,s,n,i,a,o,f=e[6].name+"",u,d,c,m,v,M;const p=[yi,wi],E=[];function w(T,B){var V;return(V=T[6])!=null&&V.result?0:1}n=w(e),i=E[n]=p[n](e);function R(){return e[4](e[6])}return{key:r,first:null,c(){t=y("div"),l=y("button"),s=y("div"),i.c(),a=j(),o=y("div"),u=U(f),c=j(),this.h()},l(T){t=I(T,"DIV",{class:!0});var B=k(t);l=I(B,"BUTTON",{class:!0});var V=k(l);s=I(V,"DIV",{class:!0});var L=k(s);i.l(L),L.forEach(g),a=H(V),o=I(V,"DIV",{class:!0});var O=k(o);u=W(O,f),O.forEach(g),V.forEach(g),c=H(B),B.forEach(g),this.h()},h(){var T;h(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),h(o,"class",d="flex-1 mx-2 line-clamp-1 code-execution-name "+((T=e[6])!=null&&T.result?"":"pulse")+" svelte-1gvtig2"),h(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),h(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(T,B){C(T,t,B),_(t,l),_(l,s),E[n].m(s,null),_(l,a),_(l,o),_(o,u),_(t,c),m=!0,v||(M=me(l,"click",R),v=!0)},p(T,B){var L;e=T;let V=n;n=w(e),n===V?E[n].p(e,B):(te(),D(E[V],1,1,()=>{E[V]=null}),le(),i=E[n],i?i.p(e,B):(i=E[n]=p[n](e),i.c()),b(i,1),i.m(s,null)),(!m||B&1)&&f!==(f=e[6].name+"")&&G(u,f),(!m||B&1&&d!==(d="flex-1 mx-2 line-clamp-1 code-execution-name "+((L=e[6])!=null&&L.result?"":"pulse")+" svelte-1gvtig2"))&&h(o,"class",d)},i(T){m||(b(i),m=!0)},o(T){D(i),m=!1},d(T){T&&g(t),E[n].d(),v=!1,M()}}}function Ni(r){let e,t,l,s,n;function i(f){r[3](f)}let a={codeExecution:r[1]};r[2]!==void 0&&(a.show=r[2]),e=new ki({props:a}),ze.push(()=>Qe(e,"show",i));let o=r[0].length>0&&zl(r);return{c(){X(e.$$.fragment),l=j(),o&&o.c(),s=ue()},l(f){Y(e.$$.fragment,f),l=H(f),o&&o.l(f),s=ue()},m(f,u){$(e,f,u),C(f,l,u),o&&o.m(f,u),C(f,s,u),n=!0},p(f,[u]){const d={};u&2&&(d.codeExecution=f[1]),!t&&u&4&&(t=!0,d.show=f[2],Ke(()=>t=!1)),e.$set(d),f[0].length>0?o?(o.p(f,u),u&1&&b(o,1)):(o=zl(f),o.c(),b(o,1),o.m(s.parentNode,s)):o&&(te(),D(o,1,1,()=>{o=null}),le())},i(f){n||(b(e.$$.fragment,f),b(o),n=!0)},o(f){D(e.$$.fragment,f),D(o),n=!1},d(f){f&&(g(l),g(s)),x(e,f),o&&o.d(f)}}}function Di(r,e,t){let{codeExecutions:l=[]}=e,s=null,n=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function a(f){n=f,t(2,n)}const o=f=>{t(1,s=f),t(2,n=!0)};return r.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},r.$$.update=()=>{r.$$.dirty&1&&l&&i()},[l,s,n,a,o]}class Vi extends Be{constructor(e){super(),Te(this,e,Di,Ni,De,{codeExecutions:0})}}function Ci(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function Bi(r,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Ti extends Be{constructor(e){super(),Te(this,e,Bi,Ci,De,{className:0,strokeWidth:1})}}function Oi(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function Ri(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Si extends Be{constructor(e){super(),Te(this,e,Ri,Oi,De,{className:0,strokeWidth:1})}}function Li(r){let e,t,l,s,n,i,a,o,f,u,d,c;s=new kt({props:{id:`${r[0]}-float-prompt`,content:r[4]}});const m=[Hi,ji],v=[];function M(E,w){return w&32&&(o=null),o==null&&(o=E[5].trim()===""),o?0:1}f=M(r,-1),u=v[f]=m[f](r);let p=r[6]&&Wl(r);return{c(){e=y("div"),t=y("div"),l=y("div"),X(s.$$.fragment),n=j(),i=y("div"),a=y("div"),u.c(),d=j(),p&&p.c(),this.h()},l(E){e=I(E,"DIV",{class:!0});var w=k(e);t=I(w,"DIV",{class:!0});var R=k(t);l=I(R,"DIV",{class:!0});var T=k(l);Y(s.$$.fragment,T),T.forEach(g),R.forEach(g),n=H(w),i=I(w,"DIV",{class:!0});var B=k(i);a=I(B,"DIV",{class:!0,id:!0});var V=k(a);u.l(V),d=H(V),p&&p.l(V),V.forEach(g),B.forEach(g),w.forEach(g),this.h()},h(){h(l,"class","font-medium"),h(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(a,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),h(a,"id","response-container"),h(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(E,w){C(E,e,w),_(e,t),_(t,l),$(s,l,null),_(e,n),_(e,i),_(i,a),v[f].m(a,null),_(a,d),p&&p.m(a,null),c=!0},p(E,w){const R={};w&1&&(R.id=`${E[0]}-float-prompt`),w&16&&(R.content=E[4]),s.$set(R);let T=f;f=M(E,w),f===T?v[f].p(E,w):(te(),D(v[T],1,1,()=>{v[T]=null}),le(),u=v[f],u?u.p(E,w):(u=v[f]=m[f](E),u.c()),b(u,1),u.m(a,d)),E[6]?p?p.p(E,w):(p=Wl(E),p.c(),p.m(a,null)):p&&(p.d(1),p=null)},i(E){c||(b(s.$$.fragment,E),b(u),c=!0)},o(E){D(s.$$.fragment,E),D(u),c=!1},d(E){E&&g(e),x(s),v[f].d(),p&&p.d()}}}function Pi(r){let e,t,l,s;const n=[zi,Ai],i=[];function a(o,f){return o[1]?1:0}return e=a(r),t=i[e]=n[e](r),{c(){t.c(),l=ue()},l(o){t.l(o),l=ue()},m(o,f){i[e].m(o,f),C(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(te(),D(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t?t.p(o,f):(t=i[e]=n[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&g(l),i[e].d(o)}}}function ji(r){let e,t;return e=new kt({props:{id:`${r[0]}-float-response`,content:r[5]}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s&1&&(n.id=`${l[0]}-float-response`),s&32&&(n.content=l[5]),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Hi(r){let e,t;return e=new Gt({props:{size:"sm"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Wl(r){let e,t,l=r[7].t("Add")+"",s,n,i;return{c(){e=y("div"),t=y("button"),s=U(l),this.h()},l(a){e=I(a,"DIV",{class:!0});var o=k(e);t=I(o,"BUTTON",{class:!0});var f=k(t);s=W(f,l),f.forEach(g),o.forEach(g),this.h()},h(){h(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(e,"class","flex justify-end pt-3 text-sm font-medium")},m(a,o){C(a,e,o),_(e,t),_(t,s),n||(i=me(t,"click",r[11]),n=!0)},p(a,o){o&128&&l!==(l=a[7].t("Add")+"")&&G(s,l)},d(a){a&&g(e),n=!1,i()}}}function Ai(r){let e,t,l,s,n,i,a,o,f,u,d;return{c(){e=y("div"),t=y("input"),s=j(),n=y("div"),i=y("button"),a=be("svg"),o=be("path"),this.h()},l(c){e=I(c,"DIV",{class:!0});var m=k(e);t=I(m,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=H(m),n=I(m,"DIV",{class:!0});var v=k(n);i=I(v,"BUTTON",{class:!0});var M=k(i);a=ke(M,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var p=k(a);o=ke(p,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(o).forEach(g),p.forEach(g),M.forEach(g),v.forEach(g),m.forEach(g),this.h()},h(){h(t,"type","text"),h(t,"id","floating-message-input"),h(t,"class","ml-5 bg-transparent outline-none w-full flex-1 text-sm"),h(t,"placeholder",l=r[7].t("Ask a question")),h(o,"fill-rule","evenodd"),h(o,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),h(o,"clip-rule","evenodd"),h(a,"xmlns","http://www.w3.org/2000/svg"),h(a,"viewBox","0 0 16 16"),h(a,"fill","currentColor"),h(a,"class","size-4"),h(i,"class",f=(r[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),h(n,"class","ml-1 mr-2"),h(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border dark:border-gray-800 w-72 rounded-full shadow-xl")},m(c,m){C(c,e,m),_(e,t),nt(t,r[3]),_(e,s),_(e,n),_(n,i),_(i,a),_(a,o),u||(d=[me(t,"input",r[18]),me(t,"keydown",r[19]),me(i,"click",r[20])],u=!0)},p(c,m){m&128&&l!==(l=c[7].t("Ask a question"))&&h(t,"placeholder",l),m&8&&t.value!==c[3]&&nt(t,c[3]),m&8&&f!==(f=(c[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&h(i,"class",f)},i:ve,o:ve,d(c){c&&g(e),u=!1,Ye(d)}}}function zi(r){let e,t,l,s,n,i="Ask",a,o,f,u,d,c="Explain",m,v,M;return l=new Ti({props:{className:"size-3 shrink-0"}}),f=new Si({props:{className:"size-3 shrink-0"}}),{c(){e=y("div"),t=y("button"),X(l.$$.fragment),s=j(),n=y("div"),n.textContent=i,a=j(),o=y("button"),X(f.$$.fragment),u=j(),d=y("div"),d.textContent=c,this.h()},l(p){e=I(p,"DIV",{class:!0});var E=k(e);t=I(E,"BUTTON",{class:!0});var w=k(t);Y(l.$$.fragment,w),s=H(w),n=I(w,"DIV",{class:!0,"data-svelte-h":!0}),Pe(n)!=="svelte-1ugwo9q"&&(n.textContent=i),w.forEach(g),a=H(E),o=I(E,"BUTTON",{class:!0});var R=k(o);Y(f.$$.fragment,R),u=H(R),d=I(R,"DIV",{class:!0,"data-svelte-h":!0}),Pe(d)!=="svelte-1sxc82g"&&(d.textContent=c),R.forEach(g),E.forEach(g),this.h()},h(){h(n,"class","shrink-0"),h(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded flex items-center gap-1 min-w-fit"),h(d,"class","shrink-0"),h(o,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded flex items-center gap-1 min-w-fit"),h(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(p,E){C(p,e,E),_(e,t),$(l,t,null),_(t,s),_(t,n),_(e,a),_(e,o),$(f,o,null),_(o,u),_(o,d),m=!0,v||(M=[me(t,"click",r[16]),me(o,"click",r[17])],v=!0)},p:ve,i(p){m||(b(l.$$.fragment,p),b(f.$$.fragment,p),m=!0)},o(p){D(l.$$.fragment,p),D(f.$$.fragment,p),m=!1},d(p){p&&g(e),x(l),x(f),v=!1,Ye(M)}}}function Ui(r){let e,t,l,s,n;const i=[Pi,Li],a=[];function o(f,u){return f[5]===null?0:1}return t=o(r),l=a[t]=i[t](r),{c(){e=y("div"),l.c(),this.h()},l(f){e=I(f,"DIV",{id:!0,class:!0,style:!0});var u=k(e);l.l(u),u.forEach(g),this.h()},h(){h(e,"id",s=`floating-buttons-${r[0]}`),h(e,"class","absolute rounded-lg mt-1 text-xs z-[9999]"),Bt(e,"display","none")},m(f,u){C(f,e,u),a[t].m(e,null),n=!0},p(f,[u]){let d=t;t=o(f),t===d?a[t].p(f,u):(te(),D(a[d],1,1,()=>{a[d]=null}),le(),l=a[t],l?l.p(f,u):(l=a[t]=i[t](f),l.c()),b(l,1),l.m(e,null)),(!n||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&h(e,"id",s)},i(f){n||(b(l),n=!0)},o(f){D(l),n=!1},d(f){f&&g(e),a[t].d()}}}function Wi(r,e,t){let l;const s=qe("i18n");Me(r,s,N=>t(7,l=N));let{id:n=""}=e,{model:i=null}=e,{messages:a=[]}=e,{onAdd:o=()=>{}}=e,f=!1,u="",d="",c="",m=null,v=!1;const M=async()=>{const N=document.getElementById("response-container");N.scrollHeight-N.clientHeight<=N.scrollTop+50&&(N.scrollTop=N.scrollHeight)},p=async()=>{if(!i){Le.error("Model not selected");return}t(4,c=`${d}
\`\`\`
${u}
\`\`\``),t(3,d=""),t(5,m="");const[N,S]=await ll(localStorage.token,{model:i,messages:[...a,{role:"user",content:c}].map(z=>({role:z.role,content:z.content})),stream:!0});if(N&&N.ok){const z=N.body.getReader(),q=new TextDecoder;await(async()=>{var ae,se;for(;;){const{done:oe,value:J}=await z.read();if(oe)break;const ge=q.decode(J,{stream:!0}).split(`
`).filter(_e=>_e.trim()!=="");for(const _e of ge)if(_e.startsWith("data: "))if(_e.startsWith("data: [DONE]")){t(6,v=!0),await Ne(),M();continue}else try{const K=JSON.parse(_e.slice(6));K.choices&&((se=(ae=K.choices[0])==null?void 0:ae.delta)!=null&&se.content)&&(t(5,m+=K.choices[0].delta.content),M())}catch(K){console.error(K)}}})()}else Le.error("An error occurred while fetching the explanation")},E=async()=>{if(!i){Le.error("Model not selected");return}t(4,c=`Explain this section to me in more detail

\`\`\`
${u}
\`\`\``),t(5,m="");const[N,S]=await ll(localStorage.token,{model:i,messages:[...a,{role:"user",content:c}].map(z=>({role:z.role,content:z.content})),stream:!0});if(N&&N.ok){const z=N.body.getReader(),q=new TextDecoder;await(async()=>{var ae,se;for(;;){const{done:oe,value:J}=await z.read();if(oe)break;const ge=q.decode(J,{stream:!0}).split(`
`).filter(_e=>_e.trim()!=="");for(const _e of ge)if(_e.startsWith("data: "))if(_e.startsWith("data: [DONE]")){t(6,v=!0),await Ne(),M();continue}else try{const K=JSON.parse(_e.slice(6));K.choices&&((se=(ae=K.choices[0])==null?void 0:ae.delta)!=null&&se.content)&&(t(5,m+=K.choices[0].delta.content),M())}catch(K){console.error(K)}}})()}else Le.error("An error occurred while fetching the explanation")},w=async()=>{o({modelId:i,parentId:n,messages:[{role:"user",content:c},{role:"assistant",content:m}]})},R=()=>{t(5,m=null),t(6,v=!1),t(1,f=!1),t(3,d="")},T=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Ne(),setTimeout(()=>{const N=document.getElementById("floating-message-input");N&&N.focus()},0)},B=()=>{t(2,u=window.getSelection().toString()),E()};function V(){d=this.value,t(3,d)}const L=N=>{N.key==="Enter"&&p()},O=()=>{p()};return r.$$set=N=>{"id"in N&&t(0,n=N.id),"model"in N&&t(12,i=N.model),"messages"in N&&t(13,a=N.messages),"onAdd"in N&&t(14,o=N.onAdd)},[n,f,u,d,c,m,v,l,s,p,E,w,i,a,o,R,T,B,V,L,O]}class qi extends Be{constructor(e){super(),Te(this,e,Wi,Ui,De,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function ql(r){var s;let e,t,l={id:r[0],model:(s=r[3])==null?void 0:s.id,messages:Wt(r[2],r[0]),onAdd:r[18]};return e=new qi({props:l}),r[19](e),{c(){X(e.$$.fragment)},l(n){Y(e.$$.fragment,n)},m(n,i){$(e,n,i),t=!0},p(n,i){var o;const a={};i&1&&(a.id=n[0]),i&8&&(a.model=(o=n[3])==null?void 0:o.id),i&5&&(a.messages=Wt(n[2],n[0])),i&256&&(a.onAdd=n[18]),e.$set(a)},i(n){t||(b(e.$$.fragment,n),t=!0)},o(n){D(e.$$.fragment,n),t=!1},d(n){r[19](null),x(e,n)}}}function Fi(r){let e,t,l,s,n;t=new kt({props:{id:r[0],content:r[1],model:r[3],save:r[5],sourceIds:(r[4]??[]).reduce(Fl,[]),onSourceClick:r[7]}}),t.$on("update",r[15]),t.$on("code",r[16]);let i=r[6]&&r[3]&&ql(r);return{c(){e=y("div"),X(t.$$.fragment),l=j(),i&&i.c(),s=ue()},l(a){e=I(a,"DIV",{});var o=k(e);Y(t.$$.fragment,o),o.forEach(g),l=H(a),i&&i.l(a),s=ue()},m(a,o){C(a,e,o),$(t,e,null),r[17](e),C(a,l,o),i&&i.m(a,o),C(a,s,o),n=!0},p(a,[o]){const f={};o&1&&(f.id=a[0]),o&2&&(f.content=a[1]),o&8&&(f.model=a[3]),o&32&&(f.save=a[5]),o&16&&(f.sourceIds=(a[4]??[]).reduce(Fl,[])),o&128&&(f.onSourceClick=a[7]),t.$set(f),a[6]&&a[3]?i?(i.p(a,o),o&72&&b(i,1)):(i=ql(a),i.c(),b(i,1),i.m(s.parentNode,s)):i&&(te(),D(i,1,1,()=>{i=null}),le())},i(a){n||(b(t.$$.fragment,a),b(i),n=!0)},o(a){D(t.$$.fragment,a),D(i),n=!1},d(a){a&&(g(e),g(l),g(s)),x(t),r[17](null),i&&i.d(a)}}}const Fl=(r,e)=>{let t=[];return e.document.forEach((l,s)=>{var a,o;const n=(a=e.metadata)==null?void 0:a[s],i=(n==null?void 0:n.source)??"N/A";return n!=null&&n.name?(t.push(n.name),t):(i.startsWith("http://")||i.startsWith("https://")?t.push(i):t.push(((o=e==null?void 0:e.source)==null?void 0:o.name)??i),t)}),r=[...r,...t],r.filter((l,s)=>r.indexOf(l)===s)};function Ji(r,e,t){let l,s;Me(r,un,N=>t(11,l=N)),Me(r,Pn,N=>t(12,s=N)),qe("i18n");const n=mt();let{id:i}=e,{content:a}=e,{history:o}=e,{model:f=null}=e,{sources:u=null}=e,{save:d=!1}=e,{floatingButtons:c=!0}=e,{onSourceClick:m=()=>{}}=e,{onAddMessages:v=()=>{}}=e,M,p;const E=N=>{const S=document.getElementById(`floating-buttons-${i}`);if(!(M!=null&&M.contains(N.target))&&!(S!=null&&S.contains(N.target))){w();return}setTimeout(async()=>{if(await Ne(),!(M!=null&&M.contains(N.target)))return;let z=window.getSelection();if(z.toString().trim().length>0){const ie=z.getRangeAt(0).getBoundingClientRect(),ae=M.getBoundingClientRect(),se=ie.bottom-ae.top,oe=ie.left-ae.left;if(S){S.style.display="block";const J=ae.width-oe;let ee=l?window.innerWidth/2:window.innerWidth/3;if(J<ee){const ge=ae.right-ie.right;S.style.right=`${ge}px`,S.style.left="auto"}else S.style.left=`${oe}px`,S.style.right="auto";S.style.top=`${se+5}px`}}else w()},0)},w=()=>{const N=document.getElementById(`floating-buttons-${i}`);N&&(N.style.display="none"),p&&p.closeHandler()},R=N=>{N.key==="Escape"&&w()};vt(()=>{c&&(M==null||M.addEventListener("mouseup",E),document.addEventListener("mouseup",E),document.addEventListener("keydown",R))}),On(()=>{c&&(M==null||M.removeEventListener("mouseup",E),document.removeEventListener("mouseup",E),document.removeEventListener("keydown",R))});const T=N=>{n("update",N.detail)},B=N=>{const{lang:S,code:z}=N.detail;(["html","svg"].includes(S)||S==="xml"&&z.includes("svg"))&&!l&&s&&(jn.set(!0),Hn.set(!0))};function V(N){ze[N?"unshift":"push"](()=>{M=N,t(9,M)})}const L=({modelId:N,parentId:S,messages:z})=>{console.log(N,S,z),v({modelId:N,parentId:S,messages:z}),w()};function O(N){ze[N?"unshift":"push"](()=>{p=N,t(10,p)})}return r.$$set=N=>{"id"in N&&t(0,i=N.id),"content"in N&&t(1,a=N.content),"history"in N&&t(2,o=N.history),"model"in N&&t(3,f=N.model),"sources"in N&&t(4,u=N.sources),"save"in N&&t(5,d=N.save),"floatingButtons"in N&&t(6,c=N.floatingButtons),"onSourceClick"in N&&t(7,m=N.onSourceClick),"onAddMessages"in N&&t(8,v=N.onAddMessages)},[i,a,o,f,u,d,c,m,v,M,p,l,s,n,w,T,B,V,L,O]}class Gi extends Be{constructor(e){super(),Te(this,e,Ji,Fi,De,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onAddMessages:8})}}function Jl(r,e,t){const l=r.slice();return l[73]=e[t],l}function At(r){var l,s,n;const e=r.slice(),t=(((l=e[12])==null?void 0:l.statusHistory)??[...(s=e[12])!=null&&s.status?[(n=e[12])==null?void 0:n.status]:[]]).at(-1);return e[76]=t,e}function Gl(r,e,t){const l=r.slice();return l[77]=e[t],l}function Zi(r){var s;let e,t=(((s=r[14])==null?void 0:s.name)??r[12].model)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(n){e=I(n,"SPAN",{class:!0});var i=k(e);l=W(i,t),i.forEach(g),this.h()},h(){h(e,"class","line-clamp-1")},m(n,i){C(n,e,i),_(e,l)},p(n,i){var a;i[0]&20480&&t!==(t=(((a=n[14])==null?void 0:a.name)??n[12].model)+"")&&G(l,t)},d(n){n&&g(e)}}}function Zl(r){let e,t,l;return t=new Oe({props:{content:rt(r[12].timestamp*1e3).format("LLLL"),$$slots:{default:[Ki]},$$scope:{ctx:r}}}),{c(){e=y("div"),X(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);Y(t.$$.fragment,n),n.forEach(g),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,n){C(s,e,n),$(t,e,null),l=!0},p(s,n){const i={};n[0]&4096&&(i.content=rt(s[12].timestamp*1e3).format("LLLL")),n[0]&4096|n[2]&262144&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),x(t)}}}function Ki(r){let e,t=Rt(r[12].timestamp*1e3)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var n=k(e);l=W(n,t),n.forEach(g),this.h()},h(){h(e,"class","line-clamp-1")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n[0]&4096&&t!==(t=Rt(s[12].timestamp*1e3)+"")&&G(l,t)},d(s){s&&g(e)}}}function Qi(r){var i;let e,t,l,s;e=new Oe({props:{content:((i=r[14])==null?void 0:i.name)??r[12].model,placement:"top-start",$$slots:{default:[Zi]},$$scope:{ctx:r}}});let n=r[12].timestamp&&Zl(r);return{c(){X(e.$$.fragment),t=j(),n&&n.c(),l=ue()},l(a){Y(e.$$.fragment,a),t=H(a),n&&n.l(a),l=ue()},m(a,o){$(e,a,o),C(a,t,o),n&&n.m(a,o),C(a,l,o),s=!0},p(a,o){var u;const f={};o[0]&20480&&(f.content=((u=a[14])==null?void 0:u.name)??a[12].model),o[0]&20480|o[2]&262144&&(f.$$scope={dirty:o,ctx:a}),e.$set(f),a[12].timestamp?n?(n.p(a,o),o[0]&4096&&b(n,1)):(n=Zl(a),n.c(),b(n,1),n.m(l.parentNode,l)):n&&(te(),D(n,1,1,()=>{n=null}),le())},i(a){s||(b(e.$$.fragment,a),b(n),s=!0)},o(a){D(e.$$.fragment,a),D(n),s=!1},d(a){a&&(g(t),g(l)),x(e,a),n&&n.d(a)}}}function Kl(r){let e,t,l=ye(r[12].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Xl(Gl(r,l,i));const n=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(g),this.h()},h(){h(e,"class","my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,a){C(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&4096){l=ye(i[12].files);let o;for(o=0;o<l.length;o+=1){const f=Gl(i,l,o);s[o]?(s[o].p(f,a),b(s[o],1)):(s[o]=Xl(f),s[o].c(),b(s[o],1),s[o].m(e,null))}for(te(),o=l.length;o<s.length;o+=1)n(o);le()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(i){i&&g(e),We(s,i)}}}function Ql(r){let e,t;return e=new gn({props:{src:r[77].url,alt:r[12].content}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.src=l[77].url),s[0]&4096&&(n.alt=l[12].content),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Xl(r){let e,t,l,s=r[77].type==="image"&&Ql(r);return{c(){e=y("div"),s&&s.c(),t=j()},l(n){e=I(n,"DIV",{});var i=k(e);s&&s.l(i),t=H(i),i.forEach(g)},m(n,i){C(n,e,i),s&&s.m(e,null),_(e,t),l=!0},p(n,i){n[77].type==="image"?s?(s.p(n,i),i[0]&4096&&b(s,1)):(s=Ql(n),s.c(),b(s,1),s.m(e,t)):s&&(te(),D(s,1,1,()=>{s=null}),le())},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&g(e),s&&s.d()}}}function Yl(r){var s;let e,t,l=!((s=r[76])!=null&&s.hidden)&&$l(r);return{c(){l&&l.c(),e=ue()},l(n){l&&l.l(n),e=ue()},m(n,i){l&&l.m(n,i),C(n,e,i),t=!0},p(n,i){var a;(a=n[76])!=null&&a.hidden?l&&(te(),D(l,1,1,()=>{l=null}),le()):l?(l.p(n,i),i[0]&4096&&b(l,1)):(l=$l(n),l.c(),b(l,1),l.m(e.parentNode,e))},i(n){t||(b(l),t=!0)},o(n){D(l),t=!1},d(n){n&&g(e),l&&l.d(n)}}}function $l(r){var u;let e,t,l,s,n,i=((u=r[76])==null?void 0:u.done)===!1&&xl();const a=[$i,Yi,Xi],o=[];function f(d,c){var m,v,M;return((m=d[76])==null?void 0:m.action)==="web_search"&&((v=d[76])!=null&&v.urls)?0:((M=d[76])==null?void 0:M.action)==="knowledge_search"?1:2}return l=f(r),s=o[l]=a[l](r),{c(){e=y("div"),i&&i.c(),t=j(),s.c(),this.h()},l(d){e=I(d,"DIV",{class:!0});var c=k(e);i&&i.l(c),t=H(c),s.l(c),c.forEach(g),this.h()},h(){h(e,"class","status-description flex items-center gap-2 py-0.5")},m(d,c){C(d,e,c),i&&i.m(e,null),_(e,t),o[l].m(e,null),n=!0},p(d,c){var v;((v=d[76])==null?void 0:v.done)===!1?i?c[0]&4096&&b(i,1):(i=xl(),i.c(),b(i,1),i.m(e,t)):i&&(te(),D(i,1,1,()=>{i=null}),le());let m=l;l=f(d),l===m?o[l].p(d,c):(te(),D(o[m],1,1,()=>{o[m]=null}),le(),s=o[l],s?s.p(d,c):(s=o[l]=a[l](d),s.c()),b(s,1),s.m(e,null))},i(d){n||(b(i),b(s),n=!0)},o(d){D(i),D(s),n=!1},d(d){d&&g(e),i&&i.d(),o[l].d()}}}function xl(r){let e,t,l;return t=new Ht({props:{className:"size-4"}}),{c(){e=y("div"),X(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);Y(t.$$.fragment,n),n.forEach(g),this.h()},h(){h(e,"class","")},m(s,n){C(s,e,n),$(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),x(t)}}}function Xi(r){let e,t,l,s;function n(o,f){var u,d,c;return f[0]&4096&&(l=null),l==null&&(l=!!((u=o[76])!=null&&u.description.includes("{{searchQuery}}"))),l?la:((d=o[76])==null?void 0:d.description)==="No search query generated"?ta:((c=o[76])==null?void 0:c.description)==="Generating search query"?ea:xi}let i=n(r,[-1,-1,-1]),a=i(r);return{c(){e=y("div"),t=y("div"),a.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);t=I(f,"DIV",{class:!0});var u=k(t);a.l(u),u.forEach(g),f.forEach(g),this.h()},h(){var o;h(t,"class",s=(((o=r[76])==null?void 0:o.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(o,f){C(o,e,f),_(e,t),a.m(t,null)},p(o,f){var u;i===(i=n(o,f))&&a?a.p(o,f):(a.d(1),a=i(o),a&&(a.c(),a.m(t,null))),f[0]&4096&&s!==(s=(((u=o[76])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",s)},i:ve,o:ve,d(o){o&&g(e),a.d()}}}function Yi(r){let e,t,l=r[24].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:r[76].query})+"",s,n;return{c(){e=y("div"),t=y("div"),s=U(l),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);t=I(a,"DIV",{class:!0});var o=k(t);s=W(o,l),o.forEach(g),a.forEach(g),this.h()},h(){var i;h(t,"class",n=(((i=r[76])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,a){C(i,e,a),_(e,t),_(t,s)},p(i,a){var o;a[0]&16781312&&l!==(l=i[24].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[76].query})+"")&&G(s,l),a[0]&4096&&n!==(n=(((o=i[76])==null?void 0:o.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",n)},i:ve,o:ve,d(i){i&&g(e)}}}function $i(r){let e,t;return e=new Or({props:{status:r[76],$$slots:{default:[aa]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.status=l[76]),s[0]&16781312|s[2]&262144&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function xi(r){var l;let e=((l=r[76])==null?void 0:l.description)+"",t;return{c(){t=U(e)},l(s){t=W(s,e)},m(s,n){C(s,t,n)},p(s,n){var i;n[0]&4096&&e!==(e=((i=s[76])==null?void 0:i.description)+"")&&G(t,e)},d(s){s&&g(t)}}}function ea(r){let e=r[24].t("Generating search query")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("Generating search query")+"")&&G(t,e)},d(l){l&&g(t)}}}function ta(r){let e=r[24].t("No search query generated")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("No search query generated")+"")&&G(t,e)},d(l){l&&g(t)}}}function la(r){var l,s;let e=r[24].t((l=r[76])==null?void 0:l.description,{searchQuery:(s=r[76])==null?void 0:s.query})+"",t;return{c(){t=U(e)},l(n){t=W(n,e)},m(n,i){C(n,t,i)},p(n,i){var a,o;i[0]&16781312&&e!==(e=n[24].t((a=n[76])==null?void 0:a.description,{searchQuery:(o=n[76])==null?void 0:o.query})+"")&&G(t,e)},d(n){n&&g(t)}}}function sa(r){var l;let e=((l=r[76])==null?void 0:l.description)+"",t;return{c(){t=U(e)},l(s){t=W(s,e)},m(s,n){C(s,t,n)},p(s,n){var i;n[0]&4096&&e!==(e=((i=s[76])==null?void 0:i.description)+"")&&G(t,e)},d(s){s&&g(t)}}}function na(r){let e=r[24].t("Generating search query")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("Generating search query")+"")&&G(t,e)},d(l){l&&g(t)}}}function ra(r){let e=r[24].t("No search query generated")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("No search query generated")+"")&&G(t,e)},d(l){l&&g(t)}}}function ia(r){var l,s;let e=r[24].t((l=r[76])==null?void 0:l.description,{count:(s=r[76])==null?void 0:s.urls.length})+"",t;return{c(){t=U(e)},l(n){t=W(n,e)},m(n,i){C(n,t,i)},p(n,i){var a,o;i[0]&16781312&&e!==(e=n[24].t((a=n[76])==null?void 0:a.description,{count:(o=n[76])==null?void 0:o.urls.length})+"")&&G(t,e)},d(n){n&&g(t)}}}function aa(r){let e,t,l,s;function n(o,f){var u,d,c;return f[0]&4096&&(l=null),l==null&&(l=!!((u=o[76])!=null&&u.description.includes("{{count}}"))),l?ia:((d=o[76])==null?void 0:d.description)==="No search query generated"?ra:((c=o[76])==null?void 0:c.description)==="Generating search query"?na:sa}let i=n(r,[-1,-1,-1]),a=i(r);return{c(){e=y("div"),t=y("div"),a.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);t=I(f,"DIV",{class:!0});var u=k(t);a.l(u),u.forEach(g),f.forEach(g),this.h()},h(){var o;h(t,"class",s=(((o=r[76])==null?void 0:o.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(o,f){C(o,e,f),_(e,t),a.m(t,null)},p(o,f){var u;i===(i=n(o,f))&&a?a.p(o,f):(a.d(1),a=i(o),a&&(a.c(),a.m(t,null))),f[0]&4096&&s!==(s=(((u=o[76])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&h(t,"class",s)},d(o){o&&g(e),a.d()}}}function oa(r){var v,M,p,E,w,R,T;let e,t,l,s,n,i,a;const o=[ca,ua],f=[];function u(B,V){return B[12].content===""&&!B[12].error?0:B[12].content&&B[12].error!==!0?1:-1}~(t=u(r))&&(l=f[t]=o[t](r));let d=((v=r[12])==null?void 0:v.error)&&es(r),c=(((M=r[12])==null?void 0:M.sources)||((p=r[12])==null?void 0:p.citations))&&(((T=(R=(w=(E=r[14])==null?void 0:E.info)==null?void 0:w.meta)==null?void 0:R.capabilities)==null?void 0:T.citations)??!0)&&ts(r),m=r[12].code_executions&&ls(r);return{c(){e=y("div"),l&&l.c(),s=j(),d&&d.c(),n=j(),c&&c.c(),i=j(),m&&m.c(),this.h()},l(B){e=I(B,"DIV",{class:!0,id:!0});var V=k(e);l&&l.l(V),s=H(V),d&&d.l(V),n=H(V),c&&c.l(V),i=H(V),m&&m.l(V),V.forEach(g),this.h()},h(){h(e,"class","w-full flex flex-col relative"),h(e,"id","response-content-container")},m(B,V){C(B,e,V),~t&&f[t].m(e,null),_(e,s),d&&d.m(e,null),_(e,n),c&&c.m(e,null),_(e,i),m&&m.m(e,null),a=!0},p(B,V){var O,N,S,z,q,ie,ae;let L=t;t=u(B),t===L?~t&&f[t].p(B,V):(l&&(te(),D(f[L],1,1,()=>{f[L]=null}),le()),~t?(l=f[t],l?l.p(B,V):(l=f[t]=o[t](B),l.c()),b(l,1),l.m(e,s)):l=null),(O=B[12])!=null&&O.error?d?(d.p(B,V),V[0]&4096&&b(d,1)):(d=es(B),d.c(),b(d,1),d.m(e,n)):d&&(te(),D(d,1,1,()=>{d=null}),le()),((N=B[12])!=null&&N.sources||(S=B[12])!=null&&S.citations)&&(((ae=(ie=(q=(z=B[14])==null?void 0:z.info)==null?void 0:q.meta)==null?void 0:ie.capabilities)==null?void 0:ae.citations)??!0)?c?(c.p(B,V),V[0]&20480&&b(c,1)):(c=ts(B),c.c(),b(c,1),c.m(e,i)):c&&(te(),D(c,1,1,()=>{c=null}),le()),B[12].code_executions?m?(m.p(B,V),V[0]&4096&&b(m,1)):(m=ls(B),m.c(),b(m,1),m.m(e,null)):m&&(te(),D(m,1,1,()=>{m=null}),le())},i(B){a||(b(l),b(d),b(c),b(m),a=!0)},o(B){D(l),D(d),D(c),D(m),a=!1},d(B){B&&g(e),~t&&f[t].d(),d&&d.d(),c&&c.d(),m&&m.d()}}}function fa(r){let e,t,l,s,n,i,a,o=r[24].t("Save As Copy")+"",f,u,d,c,m=r[24].t("Cancel")+"",v,M,p,E=r[24].t("Save")+"",w,R,T;return{c(){e=y("div"),t=y("textarea"),s=j(),n=y("div"),i=y("div"),a=y("button"),f=U(o),u=j(),d=y("div"),c=y("button"),v=U(m),M=j(),p=y("button"),w=U(E),this.h()},l(B){e=I(B,"DIV",{class:!0});var V=k(e);t=I(V,"TEXTAREA",{id:!0,class:!0}),k(t).forEach(g),s=H(V),n=I(V,"DIV",{class:!0});var L=k(n);i=I(L,"DIV",{});var O=k(i);a=I(O,"BUTTON",{id:!0,class:!0});var N=k(a);f=W(N,o),N.forEach(g),O.forEach(g),u=H(L),d=I(L,"DIV",{class:!0});var S=k(d);c=I(S,"BUTTON",{id:!0,class:!0});var z=k(c);v=W(z,m),z.forEach(g),M=H(S),p=I(S,"BUTTON",{id:!0,class:!0});var q=k(p);w=W(q,E),q.forEach(g),S.forEach(g),L.forEach(g),V.forEach(g),this.h()},h(){h(t,"id",l="message-edit-"+r[12].id),h(t,"class","bg-transparent outline-none w-full resize-none"),h(a,"id","save-new-message-button"),h(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(c,"id","close-edit-message-button"),h(c,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(p,"id","confirm-edit-message-button"),h(p,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(d,"class","flex space-x-1.5"),h(n,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(B,V){C(B,e,V),_(e,t),r[44](t),nt(t,r[15]),_(e,s),_(e,n),_(n,i),_(i,a),_(a,f),_(n,u),_(n,d),_(d,c),_(c,v),_(d,M),_(d,p),_(p,w),R||(T=[me(t,"input",r[45]),me(t,"input",Ta),me(t,"keydown",r[46]),me(a,"click",r[47]),me(c,"click",r[48]),me(p,"click",r[49])],R=!0)},p(B,V){V[0]&4096&&l!==(l="message-edit-"+B[12].id)&&h(t,"id",l),V[0]&32768&&nt(t,B[15]),V[0]&16777216&&o!==(o=B[24].t("Save As Copy")+"")&&G(f,o),V[0]&16777216&&m!==(m=B[24].t("Cancel")+"")&&G(v,m),V[0]&16777216&&E!==(E=B[24].t("Save")+"")&&G(w,E)},i:ve,o:ve,d(B){B&&g(e),r[44](null),R=!1,Ye(T)}}}function ua(r){var l;let e,t;return e=new Gi({props:{id:r[12].id,history:r[0],content:r[12].content,sources:r[12].sources,floatingButtons:(l=r[12])==null?void 0:l.done,save:!r[11],model:r[14],onSourceClick:r[50],onAddMessages:r[51]}}),e.$on("update",r[52]),e.$on("select",r[53]),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,n){$(e,s,n),t=!0},p(s,n){var a;const i={};n[0]&4096&&(i.id=s[12].id),n[0]&1&&(i.history=s[0]),n[0]&4096&&(i.content=s[12].content),n[0]&4096&&(i.sources=s[12].sources),n[0]&4096&&(i.floatingButtons=(a=s[12])==null?void 0:a.done),n[0]&2048&&(i.save=!s[11]),n[0]&16384&&(i.model=s[14]),n[0]&512&&(i.onAddMessages=s[51]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function ca(r){let e,t;return e=new Gt({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function es(r){var l,s;let e,t;return e=new Hr({props:{content:((s=(l=r[12])==null?void 0:l.error)==null?void 0:s.content)??r[12].content}}),{c(){X(e.$$.fragment)},l(n){Y(e.$$.fragment,n)},m(n,i){$(e,n,i),t=!0},p(n,i){var o,f;const a={};i[0]&4096&&(a.content=((f=(o=n[12])==null?void 0:o.error)==null?void 0:f.content)??n[12].content),e.$set(a)},i(n){t||(b(e.$$.fragment,n),t=!0)},o(n){D(e.$$.fragment,n),t=!1},d(n){x(e,n)}}}function ts(r){var l,s;let e,t;return e=new ci({props:{sources:((l=r[12])==null?void 0:l.sources)??((s=r[12])==null?void 0:s.citations)}}),{c(){X(e.$$.fragment)},l(n){Y(e.$$.fragment,n)},m(n,i){$(e,n,i),t=!0},p(n,i){var o,f;const a={};i[0]&4096&&(a.sources=((o=n[12])==null?void 0:o.sources)??((f=n[12])==null?void 0:f.citations)),e.$set(a)},i(n){t||(b(e.$$.fragment,n),t=!0)},o(n){D(e.$$.fragment,n),t=!1},d(n){x(e,n)}}}function ls(r){let e,t;return e=new Vi({props:{codeExecutions:r[12].code_executions}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.codeExecutions=l[12].code_executions),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ss(r){let e,t,l,s=(r[12].done||r[1].length>1)&&ns(r),n=r[12].done&&r[20]&&vs(r);return{c(){s&&s.c(),e=j(),n&&n.c(),t=ue()},l(i){s&&s.l(i),e=H(i),n&&n.l(i),t=ue()},m(i,a){s&&s.m(i,a),C(i,e,a),n&&n.m(i,a),C(i,t,a),l=!0},p(i,a){i[12].done||i[1].length>1?s?(s.p(i,a),a[0]&4098&&b(s,1)):(s=ns(i),s.c(),b(s,1),s.m(e.parentNode,e)):s&&(te(),D(s,1,1,()=>{s=null}),le()),i[12].done&&i[20]?n?(n.p(i,a),a[0]&1052672&&b(n,1)):(n=vs(i),n.c(),b(n,1),n.m(t.parentNode,t)):n&&(te(),D(n,1,1,()=>{n=null}),le())},i(i){l||(b(s),b(n),l=!0)},o(i){D(s),D(n),l=!1},d(i){i&&(g(e),g(t)),s&&s.d(i),n&&n.d(i)}}}function ns(r){let e,t,l,s=r[1].length>1&&rs(r),n=r[12].done&&is(r);return{c(){e=y("div"),s&&s.c(),t=j(),n&&n.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);s&&s.l(a),t=H(a),n&&n.l(a),a.forEach(g),this.h()},h(){h(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(i,a){C(i,e,a),s&&s.m(e,null),_(e,t),n&&n.m(e,null),l=!0},p(i,a){i[1].length>1?s?s.p(i,a):(s=rs(i),s.c(),s.m(e,t)):s&&(s.d(1),s=null),i[12].done?n?(n.p(i,a),a[0]&4096&&b(n,1)):(n=is(i),n.c(),b(n,1),n.m(e,null)):n&&(te(),D(n,1,1,()=>{n=null}),le())},i(i){l||(b(n),l=!0)},o(i){D(n),l=!1},d(i){i&&g(e),s&&s.d(),n&&n.d()}}}function rs(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[12].id)+1+"",a,o,f=r[1].length+"",u,d,c,m='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',v,M;return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=j(),n=y("div"),a=U(i),o=U("/"),u=U(f),d=j(),c=y("button"),c.innerHTML=m,this.h()},l(p){e=I(p,"DIV",{class:!0,dir:!0});var E=k(e);t=I(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=H(E),n=I(E,"DIV",{class:!0});var w=k(n);a=W(w,i),o=W(w,"/"),u=W(w,f),w.forEach(g),d=H(E),c=I(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(c)!=="svelte-107ksnk"&&(c.innerHTML=m),E.forEach(g),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"),h(c,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center min-w-fit"),h(e,"dir","ltr")},m(p,E){C(p,e,E),_(e,t),_(e,s),_(e,n),_(n,a),_(n,o),_(n,u),_(e,d),_(e,c),v||(M=[me(t,"click",r[54]),me(c,"click",r[55])],v=!0)},p(p,E){E[0]&4098&&i!==(i=p[1].indexOf(p[12].id)+1+"")&&G(a,i),E[0]&2&&f!==(f=p[1].length+"")&&G(u,f)},d(p){p&&g(e),v=!1,Ye(M)}}}function is(r){var v,M,p,E;let e,t,l,s,n,i,a,o,f,u=!r[11]&&as(r);t=new Oe({props:{content:r[24].t("Copy"),placement:"bottom",$$slots:{default:[ha]},$$scope:{ctx:r}}}),s=new Oe({props:{content:r[24].t("Read Aloud"),placement:"bottom",$$slots:{default:[va]},$$scope:{ctx:r}}});let d=((v=r[23])==null?void 0:v.features.enable_image_generation)&&(r[25].role==="admin"||((E=(p=(M=r[25])==null?void 0:M.permissions)==null?void 0:p.features)==null?void 0:E.image_generation))&&!r[11]&&fs(r),c=r[12].usage&&us(r),m=!r[11]&&cs(r);return{c(){u&&u.c(),e=j(),X(t.$$.fragment),l=j(),X(s.$$.fragment),n=j(),d&&d.c(),i=j(),c&&c.c(),a=j(),m&&m.c(),o=ue()},l(w){u&&u.l(w),e=H(w),Y(t.$$.fragment,w),l=H(w),Y(s.$$.fragment,w),n=H(w),d&&d.l(w),i=H(w),c&&c.l(w),a=H(w),m&&m.l(w),o=ue()},m(w,R){u&&u.m(w,R),C(w,e,R),$(t,w,R),C(w,l,R),$(s,w,R),C(w,n,R),d&&d.m(w,R),C(w,i,R),c&&c.m(w,R),C(w,a,R),m&&m.m(w,R),C(w,o,R),f=!0},p(w,R){var V,L,O,N;w[11]?u&&(te(),D(u,1,1,()=>{u=null}),le()):u?(u.p(w,R),R[0]&2048&&b(u,1)):(u=as(w),u.c(),b(u,1),u.m(e.parentNode,e));const T={};R[0]&16777216&&(T.content=w[24].t("Copy")),R[0]&5120|R[2]&262144&&(T.$$scope={dirty:R,ctx:w}),t.$set(T);const B={};R[0]&16777216&&(B.content=w[24].t("Read Aloud")),R[0]&398336|R[2]&262144&&(B.$$scope={dirty:R,ctx:w}),s.$set(B),(V=w[23])!=null&&V.features.enable_image_generation&&(w[25].role==="admin"||(N=(O=(L=w[25])==null?void 0:L.permissions)==null?void 0:O.features)!=null&&N.image_generation)&&!w[11]?d?(d.p(w,R),R[0]&41945088&&b(d,1)):(d=fs(w),d.c(),b(d,1),d.m(i.parentNode,i)):d&&(te(),D(d,1,1,()=>{d=null}),le()),w[12].usage?c?(c.p(w,R),R[0]&4096&&b(c,1)):(c=us(w),c.c(),b(c,1),c.m(a.parentNode,a)):c&&(te(),D(c,1,1,()=>{c=null}),le()),w[11]?m&&(te(),D(m,1,1,()=>{m=null}),le()):m?(m.p(w,R),R[0]&2048&&b(m,1)):(m=cs(w),m.c(),b(m,1),m.m(o.parentNode,o))},i(w){f||(b(u),b(t.$$.fragment,w),b(s.$$.fragment,w),b(d),b(c),b(m),f=!0)},o(w){D(u),D(t.$$.fragment,w),D(s.$$.fragment,w),D(d),D(c),D(m),f=!1},d(w){w&&(g(e),g(l),g(n),g(i),g(a),g(o)),u&&u.d(w),x(t,w),x(s,w),d&&d.d(w),c&&c.d(w),m&&m.d(w)}}}function as(r){var s,n,i;let e,t,l=(r[25].role==="user"?((i=(n=(s=r[25])==null?void 0:s.permissions)==null?void 0:n.chat)==null?void 0:i.edit)??!0:!0)&&os(r);return{c(){l&&l.c(),e=ue()},l(a){l&&l.l(a),e=ue()},m(a,o){l&&l.m(a,o),C(a,e,o),t=!0},p(a,o){var f,u,d;a[25].role!=="user"||(((d=(u=(f=a[25])==null?void 0:f.permissions)==null?void 0:u.chat)==null?void 0:d.edit)??!0)?l?(l.p(a,o),o[0]&33554432&&b(l,1)):(l=os(a),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(te(),D(l,1,1,()=>{l=null}),le())},i(a){t||(b(l),t=!0)},o(a){D(l),t=!1},d(a){a&&g(e),l&&l.d(a)}}}function os(r){let e,t;return e=new Oe({props:{content:r[24].t("Edit"),placement:"bottom",$$slots:{default:[da]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&16777216&&(n.content=l[24].t("Edit")),s[0]&1024|s[2]&262144&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function da(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=k(e);t=ke(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),f.forEach(g),o.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[56]),n=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",s)},d(a){a&&g(e),n=!1,i()}}}function ha(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=k(e);t=ke(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),f.forEach(g),o.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[57]),n=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&h(e,"class",s)},d(a){a&&g(e),n=!1,i()}}}function ma(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){C(l,e,s),_(e,t)},d(l){l&&g(e)}}}function ga(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){C(l,e,s),_(e,t)},d(l){l&&g(e)}}}function _a(r){let e,t,l,s,n,i;return{c(){e=be("svg"),t=be("style"),l=U(`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),s=be("circle"),n=be("circle"),i=be("circle"),this.h()},l(a){e=ke(a,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var o=k(e);t=ke(o,"style",{});var f=k(t);l=W(f,`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),f.forEach(g),s=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(g),n=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(n).forEach(g),i=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(g),o.forEach(g),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(n,"class","spinner_S1WN spinner_Km9P"),h(n,"cx","12"),h(n,"cy","12"),h(n,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(a,o){C(a,e,o),_(e,t),_(t,l),_(e,s),_(e,n),_(e,i)},d(a){a&&g(e)}}}function va(r){let e,t,l,s,n;function i(f,u){return f[18]?_a:f[17]?ga:ma}let a=i(r),o=a(r);return{c(){e=y("button"),o.c(),this.h()},l(f){e=I(f,"BUTTON",{id:!0,class:!0});var u=k(e);o.l(u),u.forEach(g),this.h()},h(){h(e,"id",t="speak-button-"+r[12].id),h(e,"class",l=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){C(f,e,u),o.m(e,null),s||(n=me(e,"click",r[58]),s=!0)},p(f,u){a!==(a=i(f))&&(o.d(1),o=a(f),o&&(o.c(),o.m(e,null))),u[0]&4096&&t!==(t="speak-button-"+f[12].id)&&h(e,"id",t),u[0]&1024&&l!==(l=(f[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",l)},d(f){f&&g(e),o.d(),s=!1,n()}}}function fs(r){let e,t;return e=new Oe({props:{content:r[24].t("Generate Image"),placement:"bottom",$$slots:{default:[ka]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&16777216&&(n.content=l[24].t("Generate Image")),s[0]&529408|s[2]&262144&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function pa(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){C(l,e,s),_(e,t)},d(l){l&&g(e)}}}function ba(r){let e,t,l,s,n,i;return{c(){e=be("svg"),t=be("style"),l=U(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=be("circle"),n=be("circle"),i=be("circle"),this.h()},l(a){e=ke(a,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var o=k(e);t=ke(o,"style",{});var f=k(t);l=W(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(g),s=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(g),n=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(n).forEach(g),i=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(g),o.forEach(g),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(n,"class","spinner_S1WN spinner_Km9P"),h(n,"cx","12"),h(n,"cy","12"),h(n,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(a,o){C(a,e,o),_(e,t),_(t,l),_(e,s),_(e,n),_(e,i)},d(a){a&&g(e)}}}function ka(r){let e,t,l,s;function n(o,f){return o[19]?ba:pa}let i=n(r),a=i(r);return{c(){e=y("button"),a.c(),this.h()},l(o){e=I(o,"BUTTON",{class:!0});var f=k(e);a.l(f),f.forEach(g),this.h()},h(){h(e,"class",t=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,f){C(o,e,f),a.m(e,null),l||(s=me(e,"click",r[59]),l=!0)},p(o,f){i!==(i=n(o))&&(a.d(1),a=i(o),a&&(a.c(),a.m(e,null))),f[0]&1024&&t!==(t=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",t)},d(o){o&&g(e),a.d(),l=!1,s()}}}function us(r){let e,t;return e=new Oe({props:{content:r[12].usage?`<pre>${_t(JSON.stringify(r[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(ks).map(ws).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[wa]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.content=l[12].usage?`<pre>${_t(JSON.stringify(l[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(ks).map(ws).join(`
`))}</pre>`:""),s[0]&5120|s[2]&262144&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function wa(r){let e,t,l,s,n,i,a;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=I(o,"BUTTON",{class:!0,id:!0});var f=k(e);t=ke(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),u.forEach(g),f.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),h(e,"id",n="info-"+r[12].id)},m(o,f){C(o,e,f),_(e,t),_(t,l),i||(a=me(e,"click",r[60]),i=!0)},p(o,f){f[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&h(e,"class",s),f[0]&4096&&n!==(n="info-"+o[12].id)&&h(e,"id",n)},d(o){o&&g(e),i=!1,a()}}}function cs(r){var c;let e,t,l,s,n,i,a,o=(((c=r[23])==null?void 0:c.features.enable_message_rating)??!0)&&ds(r),f=r[10]&&hs(r);l=new Oe({props:{content:r[24].t("Regenerate"),placement:"bottom",$$slots:{default:[Ea]},$$scope:{ctx:r}}});let u=r[1].length>1&&ms(r),d=r[10]&&gs(r);return{c(){o&&o.c(),e=j(),f&&f.c(),t=j(),X(l.$$.fragment),s=j(),u&&u.c(),n=j(),d&&d.c(),i=ue()},l(m){o&&o.l(m),e=H(m),f&&f.l(m),t=H(m),Y(l.$$.fragment,m),s=H(m),u&&u.l(m),n=H(m),d&&d.l(m),i=ue()},m(m,v){o&&o.m(m,v),C(m,e,v),f&&f.m(m,v),C(m,t,v),$(l,m,v),C(m,s,v),u&&u.m(m,v),C(m,n,v),d&&d.m(m,v),C(m,i,v),a=!0},p(m,v){var p;((p=m[23])==null?void 0:p.features.enable_message_rating)??!0?o?(o.p(m,v),v[0]&8388608&&b(o,1)):(o=ds(m),o.c(),b(o,1),o.m(e.parentNode,e)):o&&(te(),D(o,1,1,()=>{o=null}),le()),m[10]?f?(f.p(m,v),v[0]&1024&&b(f,1)):(f=hs(m),f.c(),b(f,1),f.m(t.parentNode,t)):f&&(te(),D(f,1,1,()=>{f=null}),le());const M={};v[0]&16777216&&(M.content=m[24].t("Regenerate")),v[0]&1070336|v[2]&262144&&(M.$$scope={dirty:v,ctx:m}),l.$set(M),m[1].length>1?u?(u.p(m,v),v[0]&2&&b(u,1)):(u=ms(m),u.c(),b(u,1),u.m(n.parentNode,n)):u&&(te(),D(u,1,1,()=>{u=null}),le()),m[10]?d?(d.p(m,v),v[0]&1024&&b(d,1)):(d=gs(m),d.c(),b(d,1),d.m(i.parentNode,i)):d&&(te(),D(d,1,1,()=>{d=null}),le())},i(m){a||(b(o),b(f),b(l.$$.fragment,m),b(u),b(d),a=!0)},o(m){D(o),D(f),D(l.$$.fragment,m),D(u),D(d),a=!1},d(m){m&&(g(e),g(t),g(s),g(n),g(i)),o&&o.d(m),f&&f.d(m),x(l,m),u&&u.d(m),d&&d.d(m)}}}function ds(r){let e,t,l,s;return e=new Oe({props:{content:r[24].t("Good Response"),placement:"bottom",$$slots:{default:[ya]},$$scope:{ctx:r}}}),l=new Oe({props:{content:r[24].t("Bad Response"),placement:"bottom",$$slots:{default:[Ia]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment),t=j(),X(l.$$.fragment)},l(n){Y(e.$$.fragment,n),t=H(n),Y(l.$$.fragment,n)},m(n,i){$(e,n,i),C(n,t,i),$(l,n,i),s=!0},p(n,i){const a={};i[0]&16777216&&(a.content=n[24].t("Good Response")),i[0]&2102272|i[2]&262144&&(a.$$scope={dirty:i,ctx:n}),e.$set(a);const o={};i[0]&16777216&&(o.content=n[24].t("Bad Response")),i[0]&2102272|i[2]&262144&&(o.$$scope={dirty:i,ctx:n}),l.$set(o)},i(n){s||(b(e.$$.fragment,n),b(l.$$.fragment,n),s=!0)},o(n){D(e.$$.fragment,n),D(l.$$.fragment,n),s=!1},d(n){n&&g(t),x(e,n),x(l,n)}}}function ya(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=k(e);t=ke(o,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=ke(f,"path",{d:!0}),k(l).forEach(g),f.forEach(g),o.forEach(g),this.h()},h(){var a,o;h(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((o=(a=r[12])==null?void 0:a.annotation)==null?void 0:o.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=r[21]},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[61]),n=!0)},p(a,o){var f,u;o[0]&5120&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=a[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),o[0]&2097152&&(e.disabled=a[21])},d(a){a&&g(e),n=!1,i()}}}function Ia(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=k(e);t=ke(o,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=ke(f,"path",{d:!0}),k(l).forEach(g),f.forEach(g),o.forEach(g),this.h()},h(){var a,o;h(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((o=(a=r[12])==null?void 0:a.annotation)==null?void 0:o.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=r[21]},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[62]),n=!0)},p(a,o){var f,u;o[0]&5120&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=a[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),o[0]&2097152&&(e.disabled=a[21])},d(a){a&&g(e),n=!1,i()}}}function hs(r){let e,t;return e=new Oe({props:{content:r[24].t("Continue Response"),placement:"bottom",$$slots:{default:[Ma]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&16777216&&(n.content=l[24].t("Continue Response")),s[0]&1152|s[2]&262144&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ma(r){let e,t,l,s,n,i,a;return{c(){e=y("button"),t=be("svg"),l=be("path"),s=be("path"),this.h()},l(o){e=I(o,"BUTTON",{type:!0,id:!0,class:!0});var f=k(e);t=ke(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),s=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(g),u.forEach(g),f.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),h(s,"stroke-linecap","round"),h(s,"stroke-linejoin","round"),h(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","continue-response-button"),h(e,"class",n=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,f){C(o,e,f),_(e,t),_(t,l),_(t,s),i||(a=me(e,"click",r[63]),i=!0)},p(o,f){f[0]&1024&&n!==(n=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",n)},d(o){o&&g(e),i=!1,a()}}}function Ea(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{type:!0,class:!0});var o=k(e);t=ke(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),f.forEach(g),o.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[64]),n=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(a){a&&g(e),n=!1,i()}}}function ms(r){let e,t;return e=new Oe({props:{content:r[24].t("Delete"),placement:"bottom",$$slots:{default:[Na]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&16777216&&(n.content=l[24].t("Delete")),s[0]&1024|s[2]&262144&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Na(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{type:!0,id:!0,class:!0});var o=k(e);t=ke(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),f.forEach(g),o.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","continue-response-button"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[65]),n=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(a){a&&g(e),n=!1,i()}}}function gs(r){var i;let e,t,l=ye(((i=r[14])==null?void 0:i.actions)??[]),s=[];for(let a=0;a<l.length;a+=1)s[a]=_s(Jl(r,l,a));const n=a=>D(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=ue()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=ue()},m(a,o){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(a,o);C(a,e,o),t=!0},p(a,o){var f;if(o[0]&21536){l=ye(((f=a[14])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const d=Jl(a,l,u);s[u]?(s[u].p(d,o),b(s[u],1)):(s[u]=_s(d),s[u].c(),b(s[u],1),s[u].m(e.parentNode,e))}for(te(),u=l.length;u<s.length;u+=1)n(u);le()}},i(a){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(a){a&&g(e),We(s,a)}}}function Da(r){let e,t;return e=new Lr({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Va(r){let e,t,l,s,n;return{c(){e=y("div"),t=y("img"),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);t=I(a,"IMG",{src:!0,class:!0,style:!0,alt:!0}),a.forEach(g),this.h()},h(){Tt(t.src,l=r[73].icon_url)||h(t,"src",l),h(t,"class",s="w-4 h-4 "+(r[73].icon_url.includes("svg")?"dark:invert-[80%]":"")),Bt(t,"fill","currentColor"),h(t,"alt",n=r[73].name),h(e,"class","size-4")},m(i,a){C(i,e,a),_(e,t)},p(i,a){a[0]&16384&&!Tt(t.src,l=i[73].icon_url)&&h(t,"src",l),a[0]&16384&&s!==(s="w-4 h-4 "+(i[73].icon_url.includes("svg")?"dark:invert-[80%]":""))&&h(t,"class",s),a[0]&16384&&n!==(n=i[73].name)&&h(t,"alt",n)},i:ve,o:ve,d(i){i&&g(e)}}}function Ca(r){let e,t,l,s,n,i,a,o;const f=[Va,Da],u=[];function d(m,v){return m[73].icon_url?0:1}t=d(r),l=u[t]=f[t](r);function c(){return r[66](r[73])}return{c(){e=y("button"),l.c(),n=j(),this.h()},l(m){e=I(m,"BUTTON",{type:!0,class:!0});var v=k(e);l.l(v),v.forEach(g),n=H(m),this.h()},h(){h(e,"type","button"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(m,v){C(m,e,v),u[t].m(e,null),C(m,n,v),i=!0,a||(o=me(e,"click",c),a=!0)},p(m,v){r=m;let M=t;t=d(r),t===M?u[t].p(r,v):(te(),D(u[M],1,1,()=>{u[M]=null}),le(),l=u[t],l?l.p(r,v):(l=u[t]=f[t](r),l.c()),b(l,1),l.m(e,null)),(!i||v[0]&1024&&s!==(s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&h(e,"class",s)},i(m){i||(b(l),i=!0)},o(m){D(l),i=!1},d(m){m&&(g(e),g(n)),u[t].d(),a=!1,o()}}}function _s(r){let e,t;return e=new Oe({props:{content:r[73].name,placement:"bottom",$$slots:{default:[Ca]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&16384&&(n.content=l[73].name),s[0]&21536|s[2]&262144&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function vs(r){let e,t,l,s;function n(o){r[67](o)}function i(o){r[68](o)}let a={};return r[12]!==void 0&&(a.message=r[12]),r[20]!==void 0&&(a.show=r[20]),e=new Er({props:a}),ze.push(()=>Qe(e,"message",n)),ze.push(()=>Qe(e,"show",i)),e.$on("save",r[69]),{c(){X(e.$$.fragment)},l(o){Y(e.$$.fragment,o)},m(o,f){$(e,o,f),s=!0},p(o,f){const u={};!t&&f[0]&4096&&(t=!0,u.message=o[12],Ke(()=>t=!1)),!l&&f[0]&1048576&&(l=!0,u.show=o[20],Ke(()=>l=!1)),e.$set(u)},i(o){s||(b(e.$$.fragment,o),s=!0)},o(o){D(e.$$.fragment,o),s=!1},d(o){x(e,o)}}}function ps(r){var ie,ae,se,oe,J,ee,ge,_e;let e,t,l,s,n,i,a,o,f,u=((ie=r[12])==null?void 0:ie.files)&&((ae=r[12].files)==null?void 0:ae.filter(bs).length)>0,d,c,m,v,M,p,E,w,R,T,B,V;l=new mn({props:{src:((J=(oe=(se=r[14])==null?void 0:se.info)==null?void 0:oe.meta)==null?void 0:J.profile_image_url)??(r[24].language==="dg-DG"?"/doge.png":`${Ot}/static/favicon.png`),className:"size-8"}}),a=new Ft({props:{$$slots:{default:[Qi]},$$scope:{ctx:r}}});let L=u&&Kl(r),O=(((ee=r[12])==null?void 0:ee.statusHistory)??[...(ge=r[12])!=null&&ge.status?[(_e=r[12])==null?void 0:_e.status]:[]]).length>0&&Yl(At(r));const N=[fa,oa],S=[];function z(K,A){return K[13]===!0?0:1}M=z(r),p=S[M]=N[M](r);let q=!r[13]&&ss(r);return{c(){e=y("div"),t=y("div"),X(l.$$.fragment),n=j(),i=y("div"),X(a.$$.fragment),o=j(),f=y("div"),L&&L.c(),d=j(),c=y("div"),m=y("div"),O&&O.c(),v=j(),p.c(),w=j(),q&&q.c(),this.h()},l(K){e=I(K,"DIV",{class:!0,id:!0,dir:!0});var A=k(e);t=I(A,"DIV",{class:!0});var de=k(t);Y(l.$$.fragment,de),de.forEach(g),n=H(A),i=I(A,"DIV",{class:!0});var re=k(i);Y(a.$$.fragment,re),o=H(re),f=I(re,"DIV",{});var Q=k(f);L&&L.l(Q),d=H(Q),c=I(Q,"DIV",{class:!0});var P=k(c);m=I(P,"DIV",{});var Z=k(m);O&&O.l(Z),v=H(Z),p.l(Z),Z.forEach(g),P.forEach(g),w=H(Q),q&&q.l(Q),Q.forEach(g),re.forEach(g),A.forEach(g),this.h()},h(){var K;h(t,"class",s=Yt(`flex-shrink-0 ${(((K=r[22])==null?void 0:K.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"),h(c,"class",E="chat-"+r[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),h(i,"class","flex-auto w-0 pl-1"),h(e,"class",R="flex w-full message-"+r[12].id+" svelte-1u5gq5j"),h(e,"id",T="message-"+r[12].id),h(e,"dir",B=r[22].chatDirection)},m(K,A){C(K,e,A),_(e,t),$(l,t,null),_(e,n),_(e,i),$(a,i,null),_(i,o),_(i,f),L&&L.m(f,null),_(f,d),_(f,c),_(c,m),O&&O.m(m,null),_(m,v),S[M].m(m,null),_(f,w),q&&q.m(f,null),V=!0},p(K,A){var P,Z,he,ce,we,fe,ne,pe,Ve;const de={};A[0]&16793600&&(de.src=((he=(Z=(P=K[14])==null?void 0:P.info)==null?void 0:Z.meta)==null?void 0:he.profile_image_url)??(K[24].language==="dg-DG"?"/doge.png":`${Ot}/static/favicon.png`)),l.$set(de),(!V||A[0]&4194304&&s!==(s=Yt(`flex-shrink-0 ${(((ce=K[22])==null?void 0:ce.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"))&&h(t,"class",s);const re={};A[0]&20480|A[2]&262144&&(re.$$scope={dirty:A,ctx:K}),a.$set(re),A[0]&4096&&(u=((we=K[12])==null?void 0:we.files)&&((fe=K[12].files)==null?void 0:fe.filter(bs).length)>0),u?L?(L.p(K,A),A[0]&4096&&b(L,1)):(L=Kl(K),L.c(),b(L,1),L.m(f,d)):L&&(te(),D(L,1,1,()=>{L=null}),le()),(((ne=K[12])==null?void 0:ne.statusHistory)??[...(pe=K[12])!=null&&pe.status?[(Ve=K[12])==null?void 0:Ve.status]:[]]).length>0?O?(O.p(At(K),A),A[0]&4096&&b(O,1)):(O=Yl(At(K)),O.c(),b(O,1),O.m(m,v)):O&&(te(),D(O,1,1,()=>{O=null}),le());let Q=M;M=z(K),M===Q?S[M].p(K,A):(te(),D(S[Q],1,1,()=>{S[Q]=null}),le(),p=S[M],p?p.p(K,A):(p=S[M]=N[M](K),p.c()),b(p,1),p.m(m,null)),(!V||A[0]&4096&&E!==(E="chat-"+K[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&h(c,"class",E),K[13]?q&&(te(),D(q,1,1,()=>{q=null}),le()):q?(q.p(K,A),A[0]&8192&&b(q,1)):(q=ss(K),q.c(),b(q,1),q.m(f,null)),(!V||A[0]&4096&&R!==(R="flex w-full message-"+K[12].id+" svelte-1u5gq5j"))&&h(e,"class",R),(!V||A[0]&4096&&T!==(T="message-"+K[12].id))&&h(e,"id",T),(!V||A[0]&4194304&&B!==(B=K[22].chatDirection))&&h(e,"dir",B)},i(K){V||(b(l.$$.fragment,K),b(a.$$.fragment,K),b(L),b(O),b(p),b(q),V=!0)},o(K){D(l.$$.fragment,K),D(a.$$.fragment,K),D(L),D(O),D(p),D(q),V=!1},d(K){K&&g(e),x(l),x(a),L&&L.d(),O&&O.d(),S[M].d(),q&&q.d()}}}function Ba(r){let e=r[12].id,t,l,s=ps(r);return{c(){s.c(),t=ue()},l(n){s.l(n),t=ue()},m(n,i){s.m(n,i),C(n,t,i),l=!0},p(n,i){i[0]&4096&&De(e,e=n[12].id)?(te(),D(s,1,1,ve),le(),s=ps(n),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(n,i)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&g(t),s.d(n)}}}const bs=r=>r.type==="image",Ta=r=>{r.target.style.height="",r.target.style.height=`${r.target.scrollHeight}px`},ks=r=>r.slice(2),ws=r=>r.endsWith(",")?r.slice(0,-1):r;function Oa(r,e,t){let l,s,n,i,a;Me(r,Lt,F=>t(43,l=F)),Me(r,Pt,F=>t(22,s=F)),Me(r,cn,F=>t(23,n=F)),Me(r,jt,F=>t(25,a=F));const o=qe("i18n");Me(r,o,F=>t(24,i=F));const f=mt();let{chatId:u=""}=e,{history:d}=e,{messageId:c}=e,m=JSON.parse(JSON.stringify(d.messages[c])),{siblings:v}=e,{showPreviousMessage:M}=e,{showNextMessage:p}=e,{updateChat:E}=e,{editMessage:w}=e,{saveMessage:R}=e,{rateMessage:T}=e,{actionMessage:B}=e,{deleteMessage:V}=e,{submitMessage:L}=e,{continueResponse:O}=e,{regenerateResponse:N}=e,{addMessages:S}=e,{isLastMessage:z=!0}=e,{readOnly:q=!1}=e,ie=null,ae=!1,se="",oe,J={},ee=!1,ge,_e=!1,K=!1,A=!1;const de=async F=>{await dn(F)&&Le.success(i.t("Copying to clipboard was successful!"))},re=F=>new Promise(Ee=>{ge=F;const Ie=J[F];if(!Ie)return Ee();Ie.play(),Ie.onended=async()=>{await new Promise(Se=>setTimeout(Se,300)),Object.keys(J).length-1===F&&t(17,ee=!1),Ee()}}),Q=async()=>{var F,Ee,Ie,Se,Ge,Ze,Nt,ut,pt,Re,Je,tt;if(ee){try{speechSynthesis.cancel(),ge!==void 0&&J[ge]&&(J[ge].pause(),J[ge].currentTime=0)}catch{}t(17,ee=!1),ge=void 0;return}if(!((m==null?void 0:m.content)??"").trim().length){Le.info(i.t("No content to speak"));return}if(t(17,ee=!0),n.audio.tts.engine!==""){t(18,_e=!0);const Ue=Jn(m.content,((Ee=(F=n==null?void 0:n.audio)==null?void 0:F.tts)==null?void 0:Ee.split_on)??"punctuation");if(!Ue.length){console.log("No content to speak"),Le.info(i.t("No content to speak")),t(17,ee=!1),t(18,_e=!1);return}console.debug("Prepared message content for TTS",Ue),J=Ue.reduce((lt,bt,ct)=>(lt[ct]=null,lt),{});let gt=Promise.resolve();for(const[lt,bt]of Ue.entries()){const ct=await Gn(localStorage.token,((Se=(Ie=s==null?void 0:s.audio)==null?void 0:Ie.tts)==null?void 0:Se.defaultVoice)===n.audio.tts.voice?((Ze=(Ge=s==null?void 0:s.audio)==null?void 0:Ge.tts)==null?void 0:Ze.voice)??((ut=(Nt=n==null?void 0:n.audio)==null?void 0:Nt.tts)==null?void 0:ut.voice):(Re=(pt=n==null?void 0:n.audio)==null?void 0:pt.tts)==null?void 0:Re.voice,bt).catch(st=>{console.error(st),Le.error(`${st}`),t(17,ee=!1),t(18,_e=!1)});if(ct){const st=await ct.blob(),dt=URL.createObjectURL(st),ht=new Audio(dt);ht.playbackRate=((tt=(Je=s.audio)==null?void 0:Je.tts)==null?void 0:tt.playbackRate)??1,J[lt]=ht,t(18,_e=!1),gt=gt.then(()=>re(lt))}}}else{let Ue=[];const gt=setInterval(()=>{var lt,bt,ct;if(Ue=speechSynthesis.getVoices(),Ue.length>0){clearInterval(gt);const st=((lt=Ue==null?void 0:Ue.filter(ht=>{var Zt,Kt,Qt,Xt;return ht.voiceURI===(((Kt=(Zt=s==null?void 0:s.audio)==null?void 0:Zt.tts)==null?void 0:Kt.voice)??((Xt=(Qt=n==null?void 0:n.audio)==null?void 0:Qt.tts)==null?void 0:Xt.voice))}))==null?void 0:lt.at(0))??void 0;console.log(st);const dt=new SpeechSynthesisUtterance(m.content);dt.rate=((ct=(bt=s.audio)==null?void 0:bt.tts)==null?void 0:ct.playbackRate)??1,console.log(dt),dt.onend=()=>{var ht;t(17,ee=!1),s.conversationMode&&((ht=document.getElementById("voice-input-button"))==null||ht.click())},st&&(dt.voice=st),speechSynthesis.speak(dt)}},100)}},P=async()=>{t(13,ae=!0),t(15,se=m.content),await Ne(),t(16,oe.style.height="",oe),t(16,oe.style.height=`${oe.scrollHeight}px`,oe)},Z=async()=>{w(m.id,se||"",!1),t(13,ae=!1),t(15,se=""),await Ne()},he=async()=>{w(m.id,se||""),t(13,ae=!1),t(15,se=""),await Ne()},ce=async()=>{t(13,ae=!1),t(15,se=""),await Ne()},we=async F=>{t(19,K=!0);const Ee=await Zn(localStorage.token,F.content).catch(Ie=>{Le.error(`${Ie}`)});if(console.log(Ee),Ee){const Ie=Ee.map(Se=>({type:"image",url:`${Se.url}`}));R(F.id,{...F,files:Ie})}t(19,K=!1)};let fe=!1;const ne=async(F=null,Ee=null)=>{var pt;t(21,fe=!0),console.log("Feedback",F,Ee);const Ie={...m,annotation:{...(m==null?void 0:m.annotation)??{},...F!==null?{rating:F}:{},...Ee||{}}},Se=await Wn(localStorage.token,u).catch(Re=>{Le.error(`${Re}`)});if(!Se)return;const Ge=Wt(d,m.id);let Ze={type:"rating",data:{...Ie!=null&&Ie.annotation?Ie.annotation:{},model_id:(m==null?void 0:m.selectedModelId)??m.model,...d.messages[m.parentId].childrenIds.length>1?{sibling_model_ids:d.messages[m.parentId].childrenIds.filter(Re=>Re!==m.id).map(Re=>{var Je;return((Je=d.messages[Re])==null?void 0:Je.selectedModelId)??d.messages[Re].model})}:{}},meta:{arena:m?m.arena:!1,model_id:m.model,message_id:m.id,message_index:Ge.length,chat_id:u},snapshot:{chat:Se}};const Nt=[Ze.data.model_id,...Ze.data.sibling_model_ids??[]].reduce((Re,Je)=>{var Ue;const tt=l.find(gt=>gt.id===Je);return tt?Re[tt.id]=((Ue=tt==null?void 0:tt.info)==null?void 0:Ue.base_model_id)??null:console.warn(`Model with ID ${Je} not found`),Re},{});Ze.meta.base_models=Nt;let ut=null;if(m!=null&&m.feedbackId?ut=await sl(localStorage.token,m.feedbackId,Ze).catch(Re=>{Le.error(`${Re}`)}):(ut=await lr(localStorage.token,Ze).catch(Re=>{Le.error(`${Re}`)}),ut&&(Ie.feedbackId=ut.id)),console.log(Ie),R(m.id,Ie),await Ne(),!Ee&&(t(20,A=!0),!((pt=Ie.annotation)!=null&&pt.tags))){const Re=await sr(localStorage.token,m.model,Ge,u).catch(Je=>(console.error(Je),[]));console.log(Re),Re&&(Ie.annotation.tags=Re,Ze.data.tags=Re,R(m.id,Ie),await sl(localStorage.token,Ie.feedbackId,Ze).catch(Je=>{Le.error(`${Je}`)}))}t(21,fe=!1)},pe=async()=>{V(m.id)};vt(async()=>{await Ne()});function Ve(F){ze[F?"unshift":"push"](()=>{oe=F,t(16,oe)})}function je(){se=this.value,t(15,se)}const Ce=F=>{var Se,Ge;F.key==="Escape"&&((Se=document.getElementById("close-edit-message-button"))==null||Se.click());const Ee=F.metaKey||F.ctrlKey,Ie=F.key==="Enter";Ee&&Ie&&((Ge=document.getElementById("confirm-edit-message-button"))==null||Ge.click())},He=()=>{he()},Ae=()=>{ce()},Fe=()=>{Z()},$e=F=>{console.log(F);const Ee=document.getElementById(`source-${F}`);Ee&&Ee.click()},xe=({modelId:F,parentId:Ee,messages:Ie})=>{S({modelId:F,parentId:Ee,messages:Ie})},it=F=>{const{raw:Ee,oldContent:Ie,newContent:Se}=F.detail;t(0,d.messages[m.id].content=d.messages[m.id].content.replace(Ee,Ee.replace(Ie,Se)),d),E()},at=F=>{var Se;const{type:Ee,content:Ie}=F.detail;if(Ee==="explain")L(m.id,`Explain this section to me in more detail

\`\`\`
${Ie}
\`\`\``);else if(Ee==="ask"){const Ge=((Se=F.detail)==null?void 0:Se.input)??"";L(m.id,`\`\`\`
${Ie}
\`\`\`
${Ge}`)}},Xe=()=>{M(m)},ot=()=>{p(m)},ft=()=>{P()},et=()=>{de(m.content)},wt=()=>{_e||Q()},yt=()=>{K||we(m)},It=()=>{console.log(m)},Mt=async()=>{await ne(1),window.setTimeout(()=>{var F;(F=document.getElementById(`message-feedback-${m.id}`))==null||F.scrollIntoView()},0)},Et=async()=>{await ne(-1),window.setTimeout(()=>{var F;(F=document.getElementById(`message-feedback-${m.id}`))==null||F.scrollIntoView()},0)},wn=()=>{O()},yn=()=>{t(20,A=!1),N(m),((ie==null?void 0:ie.actions)??[]).forEach(F=>{f("action",{id:F.id,event:{id:"regenerate-response",data:{messageId:m.id}}})})},In=()=>{pe()},Mn=F=>{B(F.id,m)};function En(F){m=F,t(12,m),t(0,d),t(38,c)}function Nn(F){A=F,t(20,A)}const Dn=async F=>{await ne(null,{...F.detail})};return r.$$set=F=>{"chatId"in F&&t(37,u=F.chatId),"history"in F&&t(0,d=F.history),"messageId"in F&&t(38,c=F.messageId),"siblings"in F&&t(1,v=F.siblings),"showPreviousMessage"in F&&t(2,M=F.showPreviousMessage),"showNextMessage"in F&&t(3,p=F.showNextMessage),"updateChat"in F&&t(4,E=F.updateChat),"editMessage"in F&&t(39,w=F.editMessage),"saveMessage"in F&&t(40,R=F.saveMessage),"rateMessage"in F&&t(41,T=F.rateMessage),"actionMessage"in F&&t(5,B=F.actionMessage),"deleteMessage"in F&&t(42,V=F.deleteMessage),"submitMessage"in F&&t(6,L=F.submitMessage),"continueResponse"in F&&t(7,O=F.continueResponse),"regenerateResponse"in F&&t(8,N=F.regenerateResponse),"addMessages"in F&&t(9,S=F.addMessages),"isLastMessage"in F&&t(10,z=F.isLastMessage),"readOnly"in F&&t(11,q=F.readOnly)},r.$$.update=()=>{r.$$.dirty[0]&4097|r.$$.dirty[1]&128&&d.messages&&JSON.stringify(m)!==JSON.stringify(d.messages[c])&&t(12,m=JSON.parse(JSON.stringify(d.messages[c]))),r.$$.dirty[0]&4096|r.$$.dirty[1]&4096&&t(14,ie=l.find(F=>F.id===m.model)),r.$$.dirty[0]&8192&&(ae||(async()=>await Ne())())},[d,v,M,p,E,B,L,O,N,S,z,q,m,ae,ie,se,oe,ee,_e,K,A,fe,s,n,i,a,o,f,de,Q,P,Z,he,ce,we,ne,pe,u,c,w,R,T,V,l,Ve,je,Ce,He,Ae,Fe,$e,xe,it,at,Xe,ot,ft,et,wt,yt,It,Mt,Et,wn,yn,In,Mn,En,Nn,Dn]}class kn extends Be{constructor(e){super(),Te(this,e,Oa,Ba,De,{chatId:37,history:0,messageId:38,siblings:1,showPreviousMessage:2,showNextMessage:3,updateChat:4,editMessage:39,saveMessage:40,rateMessage:41,actionMessage:5,deleteMessage:42,submitMessage:6,continueResponse:7,regenerateResponse:8,addMessages:9,isLastMessage:10,readOnly:11},null,[-1,-1,-1])}}function Ra(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function Sa(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class La extends Be{constructor(e){super(),Te(this,e,Sa,Ra,De,{className:0,strokeWidth:1})}}function zt(r){var l;const e=r.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[16]=t,e}function ys(r,e,t){const l=r.slice();return l[36]=e[t],l}function Ut(r){const e=r.slice(),t=e[19][e[36]].messageIds[e[20][e[36]]];return e[39]=t,e}function Is(r){let e,t,l,s,n,i=ye(Object.keys(r[19])),a=[];for(let u=0;u<i.length;u+=1)a[u]=Ds(ys(r,i,u));const o=u=>D(a[u],1,1,()=>{a[u]=null});let f=!r[4]&&Vs(r);return{c(){e=y("div"),t=y("div");for(let u=0;u<a.length;u+=1)a[u].c();s=j(),f&&f.c(),this.h()},l(u){e=I(u,"DIV",{});var d=k(e);t=I(d,"DIV",{class:!0,id:!0});var c=k(t);for(let m=0;m<a.length;m+=1)a[m].l(c);c.forEach(g),s=H(d),f&&f.l(d),d.forEach(g),this.h()},h(){h(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),h(t,"id",l="responses-container-"+r[1]+"-"+r[18].id)},m(u,d){C(u,e,d),_(e,t);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(t,null);_(e,s),f&&f.m(e,null),n=!0},p(u,d){if(d[0]&54132727){i=ye(Object.keys(u[19]));let c;for(c=0;c<i.length;c+=1){const m=ys(u,i,c);a[c]?(a[c].p(m,d),b(a[c],1)):(a[c]=Ds(m),a[c].c(),b(a[c],1),a[c].m(t,null))}for(te(),c=i.length;c<a.length;c+=1)o(c);le()}(!n||d[0]&262146&&l!==(l="responses-container-"+u[1]+"-"+u[18].id))&&h(t,"id",l),u[4]?f&&(te(),D(f,1,1,()=>{f=null}),le()):f?(f.p(u,d),d[0]&16&&b(f,1)):(f=Vs(u),f.c(),b(f,1),f.m(e,null))},i(u){if(!n){for(let d=0;d<i.length;d+=1)b(a[d]);b(f),n=!0}},o(u){a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)D(a[d]);D(f),n=!1},d(u){u&&g(e),We(a,u),f&&f.d()}}}function Ms(r){let e,t=r[0].currentId,l,s,n,i,a,o=Ns(r);function f(){return r[32](r[39])}return{c(){e=y("div"),o.c(),l=j(),this.h()},l(u){e=I(u,"DIV",{class:!0});var d=k(e);o.l(d),l=H(d),d.forEach(g),this.h()},h(){var u;h(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=r[0].messages[r[2]])==null?void 0:u.modelIdx)==r[36]?`border-gray-100 dark:border-gray-800 border-[1.5px] ${r[21]?"min-w-full":"min-w-80"}`:`border-gray-50 dark:border-gray-850 border-dashed ${r[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,d){C(u,e,d),o.m(e,null),_(e,l),n=!0,i||(a=me(e,"click",f),i=!0)},p(u,d){var c;r=u,d[0]&1&&De(t,t=r[0].currentId)?(te(),D(o,1,1,ve),le(),o=Ns(r),o.c(),b(o,1),o.m(e,l)):o.p(r,d),(!n||d[0]&2621445&&s!==(s="snap-center w-full max-w-full m-1 border "+(((c=r[0].messages[r[2]])==null?void 0:c.modelIdx)==r[36]?`border-gray-100 dark:border-gray-800 border-[1.5px] ${r[21]?"min-w-full":"min-w-80"}`:`border-gray-50 dark:border-gray-850 border-dashed ${r[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&h(e,"class",s)},i(u){n||(b(o),n=!0)},o(u){D(o),n=!1},d(u){u&&g(e),o.d(u),i=!1,a()}}}function Es(r){let e,t;function l(){return r[29](r[36])}function s(){return r[30](r[36])}function n(...i){return r[31](r[36],...i)}return e=new kn({props:{chatId:r[1],history:r[0],messageId:r[39],isLastMessage:!0,siblings:r[19][r[36]].messageIds,showPreviousMessage:l,showNextMessage:s,updateChat:r[5],editMessage:r[6],saveMessage:r[7],rateMessage:r[8],deleteMessage:r[11],actionMessage:r[9],submitMessage:r[10],continueResponse:r[12],regenerateResponse:n,addMessages:r[14],readOnly:r[4]}}),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,a){$(e,i,a),t=!0},p(i,a){r=i;const o={};a[0]&2&&(o.chatId=r[1]),a[0]&1&&(o.history=r[0]),a[0]&1572864&&(o.messageId=r[39]),a[0]&524288&&(o.siblings=r[19][r[36]].messageIds),a[0]&524288&&(o.showPreviousMessage=l),a[0]&524288&&(o.showNextMessage=s),a[0]&32&&(o.updateChat=r[5]),a[0]&64&&(o.editMessage=r[6]),a[0]&128&&(o.saveMessage=r[7]),a[0]&256&&(o.rateMessage=r[8]),a[0]&2048&&(o.deleteMessage=r[11]),a[0]&512&&(o.actionMessage=r[9]),a[0]&1024&&(o.submitMessage=r[10]),a[0]&4096&&(o.continueResponse=r[12]),a[0]&1581056&&(o.regenerateResponse=n),a[0]&16384&&(o.addMessages=r[14]),a[0]&16&&(o.readOnly=r[4]),e.$set(o)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){x(e,i)}}}function Ns(r){let e,t,l=r[16]&&Es(r);return{c(){l&&l.c(),e=ue()},l(s){l&&l.l(s),e=ue()},m(s,n){l&&l.m(s,n),C(s,e,n),t=!0},p(s,n){s[16]?l?(l.p(s,n),n[0]&65536&&b(l,1)):(l=Es(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(te(),D(l,1,1,()=>{l=null}),le())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function Ds(r){let e,t,l=r[20][r[36]]!==void 0&&r[19][r[36]].messageIds.length>0&&Ms(Ut(r));return{c(){l&&l.c(),e=ue()},l(s){l&&l.l(s),e=ue()},m(s,n){l&&l.m(s,n),C(s,e,n),t=!0},p(s,n){s[20][s[36]]!==void 0&&s[19][s[36]].messageIds.length>0?l?(l.p(Ut(s),n),n[0]&1572864&&b(l,1)):(l=Ms(Ut(s)),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(te(),D(l,1,1,()=>{l=null}),le())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function Vs(r){let e=!Object.keys(r[19]).find(r[28]),t,l,s=e&&Cs(r);return{c(){s&&s.c(),t=ue()},l(n){s&&s.l(n),t=ue()},m(n,i){s&&s.m(n,i),C(n,t,i),l=!0},p(n,i){i[0]&1572865&&(e=!Object.keys(n[19]).find(n[28])),e?s?(s.p(n,i),i[0]&1572865&&b(s,1)):(s=Cs(n),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(te(),D(s,1,1,()=>{s=null}),le())},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&g(t),s&&s.d(n)}}}function Cs(r){var a,o;let e,t,l,s,n=((o=(a=r[0].messages[r[2]])==null?void 0:a.merged)==null?void 0:o.status)&&Bs(zt(r)),i=r[3]&&Os(r);return{c(){e=y("div"),t=y("div"),n&&n.c(),l=j(),i&&i.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);t=I(u,"DIV",{class:!0});var d=k(t);n&&n.l(d),d.forEach(g),l=H(u),i&&i.l(u),u.forEach(g),this.h()},h(){h(t,"class","w-full"),h(e,"class","flex justify-end")},m(f,u){C(f,e,u),_(e,t),n&&n.m(t,null),_(e,l),i&&i.m(e,null),s=!0},p(f,u){var d,c;(c=(d=f[0].messages[f[2]])==null?void 0:d.merged)!=null&&c.status?n?(n.p(zt(f),u),u[0]&5&&b(n,1)):(n=Bs(zt(f)),n.c(),b(n,1),n.m(t,null)):n&&(te(),D(n,1,1,()=>{n=null}),le()),f[3]?i?(i.p(f,u),u[0]&8&&b(i,1)):(i=Os(f),i.c(),b(i,1),i.m(e,null)):i&&(te(),D(i,1,1,()=>{i=null}),le())},i(f){s||(b(n),b(i),s=!0)},o(f){D(n),D(i),s=!1},d(f){f&&g(e),n&&n.d(),i&&i.d()}}}function Bs(r){let e,t,l,s,n,i,a;t=new Ft({props:{$$slots:{default:[Pa]},$$scope:{ctx:r}}});const o=[Ha,ja],f=[];function u(d,c){var m;return(((m=d[16])==null?void 0:m.content)??"")===""?0:1}return n=u(r),i=f[n]=o[n](r),{c(){e=y("div"),X(t.$$.fragment),l=j(),s=y("div"),i.c(),this.h()},l(d){e=I(d,"DIV",{class:!0});var c=k(e);Y(t.$$.fragment,c),l=H(c),s=I(c,"DIV",{class:!0});var m=k(s);i.l(m),m.forEach(g),c.forEach(g),this.h()},h(){h(s,"class","mt-1 markdown-prose w-full min-w-full"),h(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(d,c){C(d,e,c),$(t,e,null),_(e,l),_(e,s),f[n].m(s,null),a=!0},p(d,c){const m={};c[0]&5|c[1]&512&&(m.$$scope={dirty:c,ctx:d}),t.$set(m);let v=n;n=u(d),n===v?f[n].p(d,c):(te(),D(f[v],1,1,()=>{f[v]=null}),le(),i=f[n],i?i.p(d,c):(i=f[n]=o[n](d),i.c()),b(i,1),i.m(s,null))},i(d){a||(b(t.$$.fragment,d),b(i),a=!0)},o(d){D(t.$$.fragment,d),D(i),a=!1},d(d){d&&g(e),x(t),f[n].d()}}}function Ts(r){let e,t=rt(r[16].timestamp*1e3).format("LT")+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var n=k(e);l=W(n,t),n.forEach(g),this.h()},h(){h(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n[0]&5&&t!==(t=rt(s[16].timestamp*1e3).format("LT")+"")&&G(l,t)},d(s){s&&g(e)}}}function Pa(r){let e,t,l=r[16].timestamp&&Ts(r);return{c(){e=U(`Merged Response

									`),l&&l.c(),t=ue()},l(s){e=W(s,`Merged Response

									`),l&&l.l(s),t=ue()},m(s,n){C(s,e,n),l&&l.m(s,n),C(s,t,n)},p(s,n){s[16].timestamp?l?l.p(s,n):(l=Ts(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&(g(e),g(t)),l&&l.d(s)}}}function ja(r){let e,t;return e=new kt({props:{id:"merged",content:r[16].content??""}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&5&&(n.content=l[16].content??""),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ha(r){let e,t;return e=new Gt({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Os(r){let e,t,l;return t=new Oe({props:{content:r[22].t("Merge Responses"),placement:"bottom",$$slots:{default:[Aa]},$$scope:{ctx:r}}}),{c(){e=y("div"),X(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);Y(t.$$.fragment,n),n.forEach(g),this.h()},h(){h(e,"class","flex-shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,n){C(s,e,n),$(t,e,null),l=!0},p(s,n){const i={};n[0]&4194304&&(i.content=s[22].t("Merge Responses")),n[1]&512&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),x(t)}}}function Aa(r){let e,t,l,s,n;return t=new La({props:{className:" size-5 "}}),{c(){e=y("button"),X(t.$$.fragment),this.h()},l(i){e=I(i,"BUTTON",{type:!0,id:!0,class:!0});var a=k(e);Y(t.$$.fragment,a),a.forEach(g),this.h()},h(){h(e,"type","button"),h(e,"id","merge-response-button"),h(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,a){C(i,e,a),$(t,e,null),l=!0,s||(n=me(e,"click",r[33]),s=!0)},p:ve,i(i){l||(b(t.$$.fragment,i),l=!0)},o(i){D(t.$$.fragment,i),l=!1},d(i){i&&g(e),x(t),s=!1,n()}}}function za(r){let e,t,l=r[18]&&Is(r);return{c(){l&&l.c(),e=ue()},l(s){l&&l.l(s),e=ue()},m(s,n){l&&l.m(s,n),C(s,e,n),t=!0},p(s,n){s[18]?l?(l.p(s,n),n[0]&262144&&b(l,1)):(l=Is(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(te(),D(l,1,1,()=>{l=null}),le())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function Ua(r,e,t){let l,s;Me(r,un,A=>t(21,l=A));const n=qe("i18n");Me(r,n,A=>t(22,s=A)),rt.extend(hn);let{chatId:i}=e,{history:a}=e,{messageId:o}=e,{isLastMessage:f}=e,{readOnly:u=!1}=e,{updateChat:d}=e,{editMessage:c}=e,{saveMessage:m}=e,{rateMessage:v}=e,{actionMessage:M}=e,{submitMessage:p}=e,{deleteMessage:E}=e,{continueResponse:w}=e,{regenerateResponse:R}=e,{mergeResponses:T}=e,{addMessages:B}=e,{triggerScroll:V}=e;mt();let L,O,N={},S={},z=JSON.parse(JSON.stringify(a.messages[o]));const q=async A=>{t(20,S[A]=Math.max(0,S[A]-1),S);let de=N[A].messageIds[S[A]];console.log(de);let re=a.messages[de].childrenIds;for(;re.length!==0;)de=re.at(-1),re=a.messages[de].childrenIds;t(0,a.currentId=de,a),await Ne(),await d(),V()},ie=async A=>{t(20,S[A]=Math.min(N[A].messageIds.length-1,S[A]+1),S);let de=N[A].messageIds[S[A]];console.log(de);let re=a.messages[de].childrenIds;for(;re.length!==0;)de=re.at(-1),re=a.messages[de].childrenIds;t(0,a.currentId=de,a),await Ne(),await d(),V()},ae=async()=>{console.log("multiresponse:initHandler"),await Ne(),t(17,L=o),t(18,O=a.messages[o].parentId?a.messages[a.messages[o].parentId]:null),t(19,N=O==null?void 0:O.models.reduce((A,de,re)=>{let Q=O==null?void 0:O.childrenIds.map(P=>a.messages[P]).filter(P=>(P==null?void 0:P.modelIdx)===re).map(P=>P.id);if(Q.length===0){let P=O==null?void 0:O.childrenIds.map(Z=>a.messages[Z]).filter(Z=>(Z==null?void 0:Z.model)===de);P.forEach(Z=>{Z.modelIdx=re}),Q=P.map(Z=>Z.id)}return{...A,[re]:{messageIds:Q}}},{})),t(20,S=O==null?void 0:O.models.reduce((A,de,re)=>{const Q=N[re].messageIds.findIndex(P=>P===o);return Q!==-1?{...A,[re]:Q}:{...A,[re]:N[re].messageIds.length-1}},{})),console.log(N,S),await Ne()},se=async()=>{const A=Object.keys(N).map(de=>{const{messageIds:re}=N[de],Q=re[S[de]];return a.messages[Q].content});T(o,A,i)};vt(async()=>{await ae(),await Ne();const A=document.getElementById(`message-${o}`);A&&A.scrollIntoView({block:"start"})});const oe=A=>{var Q;const{messageIds:de}=N[A],re=de[S[A]];return!((Q=a.messages[re])!=null&&Q.done)},J=A=>q(A),ee=A=>ie(A),ge=async(A,de)=>{R(de),await Ne(),t(20,S[A]=N[A].messageIds.length-1,S)},_e=async A=>{if(o!=A){let de=A,re=a.messages[de].childrenIds;for(;re.length!==0;)de=re.at(-1),re=a.messages[de].childrenIds;t(0,a.currentId=de,a),await Ne(),await d(),V()}},K=()=>{se()};return r.$$set=A=>{"chatId"in A&&t(1,i=A.chatId),"history"in A&&t(0,a=A.history),"messageId"in A&&t(2,o=A.messageId),"isLastMessage"in A&&t(3,f=A.isLastMessage),"readOnly"in A&&t(4,u=A.readOnly),"updateChat"in A&&t(5,d=A.updateChat),"editMessage"in A&&t(6,c=A.editMessage),"saveMessage"in A&&t(7,m=A.saveMessage),"rateMessage"in A&&t(8,v=A.rateMessage),"actionMessage"in A&&t(9,M=A.actionMessage),"submitMessage"in A&&t(10,p=A.submitMessage),"deleteMessage"in A&&t(11,E=A.deleteMessage),"continueResponse"in A&&t(12,w=A.continueResponse),"regenerateResponse"in A&&t(13,R=A.regenerateResponse),"mergeResponses"in A&&t(27,T=A.mergeResponses),"addMessages"in A&&t(14,B=A.addMessages),"triggerScroll"in A&&t(15,V=A.triggerScroll)},r.$$.update=()=>{r.$$.dirty[0]&65541&&a.messages&&JSON.stringify(z)!==JSON.stringify(a.messages[o])&&t(16,z=JSON.parse(JSON.stringify(a.messages[o])))},[a,i,o,f,u,d,c,m,v,M,p,E,w,R,B,V,z,L,O,N,S,l,s,n,q,ie,se,T,oe,J,ee,ge,_e,K]}class Wa extends Be{constructor(e){super(),Te(this,e,Ua,za,De,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:27,addMessages:14,triggerScroll:15},null,[-1,-1])}}function Rs(r,e,t){const l=r.slice();return l[38]=e[t],l}function Ss(r){var n,i,a,o;let e,t,l,s;return t=new mn({props:{src:r[6].user?((a=(i=(n=r[12].find(r[24]))==null?void 0:n.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??"/user.png":((o=r[0])==null?void 0:o.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=y("div"),X(t.$$.fragment),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);Y(t.$$.fragment,u),u.forEach(g),this.h()},h(){var f;h(e,"class",l=`flex-shrink-0 ${(((f=r[11])==null?void 0:f.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)},m(f,u){C(f,e,u),$(t,e,null),s=!0},p(f,u){var c,m,v,M,p;const d={};u[0]&4161&&(d.src=f[6].user?((v=(m=(c=f[12].find(f[24]))==null?void 0:c.info)==null?void 0:m.meta)==null?void 0:v.profile_image_url)??"/user.png":((M=f[0])==null?void 0:M.profile_image_url)??"/user.png"),t.$set(d),(!s||u[0]&2048&&l!==(l=`flex-shrink-0 ${(((p=f[11])==null?void 0:p.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`))&&h(e,"class",l)},i(f){s||(b(t.$$.fragment,f),s=!0)},o(f){D(t.$$.fragment,f),s=!1},d(f){f&&g(e),x(t)}}}function Ls(r){let e,t,l;return t=new Ft({props:{$$slots:{default:[Za]},$$scope:{ctx:r}}}),{c(){e=y("div"),X(t.$$.fragment)},l(s){e=I(s,"DIV",{});var n=k(e);Y(t.$$.fragment,n),n.forEach(g)},m(s,n){C(s,e,n),$(t,e,null),l=!0},p(s,n){const i={};n[0]&11329|n[1]&1024&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),x(t)}}}function qa(r){let e=r[10].t("You")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&1024&&e!==(e=l[10].t("You")+"")&&G(t,e)},d(l){l&&g(t)}}}function Fa(r){let e=r[0].name+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&G(t,e)},d(l){l&&g(t)}}}function Ja(r){var a;let e=r[10].t("You")+"",t,l,s,n=(((a=r[6])==null?void 0:a.user)??"")+"",i;return{c(){t=U(e),l=j(),s=y("span"),i=U(n),this.h()},l(o){t=W(o,e),l=H(o),s=I(o,"SPAN",{class:!0});var f=k(s);i=W(f,n),f.forEach(g),this.h()},h(){h(s,"class","text-gray-500 text-sm font-medium")},m(o,f){C(o,t,f),C(o,l,f),C(o,s,f),_(s,i)},p(o,f){var u;f[0]&1024&&e!==(e=o[10].t("You")+"")&&G(t,e),f[0]&64&&n!==(n=(((u=o[6])==null?void 0:u.user)??"")+"")&&G(i,n)},d(o){o&&(g(t),g(l),g(s))}}}function Ps(r){let e,t,l;return t=new Oe({props:{content:rt(r[6].timestamp*1e3).format("LLLL"),$$slots:{default:[Ga]},$$scope:{ctx:r}}}),{c(){e=y("div"),X(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);Y(t.$$.fragment,n),n.forEach(g),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,n){C(s,e,n),$(t,e,null),l=!0},p(s,n){const i={};n[0]&64&&(i.content=rt(s[6].timestamp*1e3).format("LLLL")),n[0]&64|n[1]&1024&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),x(t)}}}function Ga(r){let e,t=Rt(r[6].timestamp*1e3)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var n=k(e);l=W(n,t),n.forEach(g),this.h()},h(){h(e,"class","line-clamp-1")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n[0]&64&&t!==(t=Rt(s[6].timestamp*1e3)+"")&&G(l,t)},d(s){s&&g(e)}}}function Za(r){let e,t,l;function s(o,f){return o[6].user?Ja:o[11].showUsername||o[13].name!==o[0].name?Fa:qa}let n=s(r),i=n(r),a=r[6].timestamp&&Ps(r);return{c(){i.c(),e=j(),a&&a.c(),t=ue()},l(o){i.l(o),e=H(o),a&&a.l(o),t=ue()},m(o,f){i.m(o,f),C(o,e,f),a&&a.m(o,f),C(o,t,f),l=!0},p(o,f){n===(n=s(o))&&i?i.p(o,f):(i.d(1),i=n(o),i&&(i.c(),i.m(e.parentNode,e))),o[6].timestamp?a?(a.p(o,f),f[0]&64&&b(a,1)):(a=Ps(o),a.c(),b(a,1),a.m(t.parentNode,t)):a&&(te(),D(a,1,1,()=>{a=null}),le())},i(o){l||(b(a),l=!0)},o(o){D(a),l=!1},d(o){o&&(g(e),g(t)),i.d(o),a&&a.d(o)}}}function js(r){let e,t,l=ye(r[6].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Hs(Rs(r,l,i));const n=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(g),this.h()},h(){h(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,a){C(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&2112){l=ye(i[6].files);let o;for(o=0;o<l.length;o+=1){const f=Rs(i,l,o);s[o]?(s[o].p(f,a),b(s[o],1)):(s[o]=Hs(f),s[o].c(),b(s[o],1),s[o].m(e,null))}for(te(),o=l.length;o<s.length;o+=1)n(o);le()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(i){i&&g(e),We(s,i)}}}function Ka(r){var l;let e,t;return e=new $n({props:{item:r[38],url:r[38].url,name:r[38].name,type:r[38].type,size:(l=r[38])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,n){$(e,s,n),t=!0},p(s,n){var a;const i={};n[0]&64&&(i.item=s[38]),n[0]&64&&(i.url=s[38].url),n[0]&64&&(i.name=s[38].name),n[0]&64&&(i.type=s[38].type),n[0]&64&&(i.size=(a=s[38])==null?void 0:a.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Qa(r){let e,t;return e=new gn({props:{src:r[38].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&64&&(n.src=l[38].url),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Hs(r){let e,t,l,s,n,i;const a=[Qa,Ka],o=[];function f(u,d){return u[38].type==="image"?0:1}return t=f(r),l=o[t]=a[t](r),{c(){e=y("div"),l.c(),s=j(),this.h()},l(u){e=I(u,"DIV",{class:!0});var d=k(e);l.l(d),s=H(d),d.forEach(g),this.h()},h(){var u;h(e,"class",n=((u=r[11])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,d){C(u,e,d),o[t].m(e,null),_(e,s),i=!0},p(u,d){var m;let c=t;t=f(u),t===c?o[t].p(u,d):(te(),D(o[c],1,1,()=>{o[c]=null}),le(),l=o[t],l?l.p(u,d):(l=o[t]=a[t](u),l.c()),b(l,1),l.m(e,s)),(!i||d[0]&2048&&n!==(n=((m=u[11])==null?void 0:m.chatBubble)??!0?"self-end":""))&&h(e,"class",n)},i(u){i||(b(l),i=!0)},o(u){D(l),i=!1},d(u){u&&g(e),o[t].d()}}}function Xa(r){var T,B;let e,t,l,s,n,i,a,o,f,u,d,c,m,v,M=r[6].content&&As(r),p=!(((T=r[11])==null?void 0:T.chatBubble)??!0)&&zs(r),E=!r[5]&&Ws(r);u=new Oe({props:{content:r[10].t("Copy"),placement:"bottom",$$slots:{default:[xa]},$$scope:{ctx:r}}});let w=!r[4]&&!r[5]&&qs(r),R=(((B=r[11])==null?void 0:B.chatBubble)??!0)&&Fs(r);return{c(){e=y("div"),t=y("div"),l=y("div"),M&&M.c(),i=j(),a=y("div"),p&&p.c(),o=j(),E&&E.c(),f=j(),X(u.$$.fragment),d=j(),w&&w.c(),c=j(),R&&R.c(),this.h()},l(V){e=I(V,"DIV",{class:!0});var L=k(e);t=I(L,"DIV",{class:!0});var O=k(t);l=I(O,"DIV",{class:!0});var N=k(l);M&&M.l(N),N.forEach(g),O.forEach(g),i=H(L),a=I(L,"DIV",{class:!0});var S=k(a);p&&p.l(S),o=H(S),E&&E.l(S),f=H(S),Y(u.$$.fragment,S),d=H(S),w&&w.l(S),c=H(S),R&&R.l(S),S.forEach(g),L.forEach(g),this.h()},h(){var V,L,O;h(l,"class",s="rounded-3xl "+(((V=r[11])==null?void 0:V.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${r[6].files?"rounded-tr-lg":""}`:" w-full")),h(t,"class",n="flex "+(((L=r[11])==null?void 0:L.chatBubble)??!0?"justify-end pb-1":"w-full")),h(a,"class",m="flex "+(((O=r[11])==null?void 0:O.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),h(e,"class","w-full")},m(V,L){C(V,e,L),_(e,t),_(t,l),M&&M.m(l,null),_(e,i),_(e,a),p&&p.m(a,null),_(a,o),E&&E.m(a,null),_(a,f),$(u,a,null),_(a,d),w&&w.m(a,null),_(a,c),R&&R.m(a,null),v=!0},p(V,L){var N,S,z,q,ie;V[6].content?M?(M.p(V,L),L[0]&64&&b(M,1)):(M=As(V),M.c(),b(M,1),M.m(l,null)):M&&(te(),D(M,1,1,()=>{M=null}),le()),(!v||L[0]&2112&&s!==(s="rounded-3xl "+(((N=V[11])==null?void 0:N.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${V[6].files?"rounded-tr-lg":""}`:" w-full")))&&h(l,"class",s),(!v||L[0]&2048&&n!==(n="flex "+(((S=V[11])==null?void 0:S.chatBubble)??!0?"justify-end pb-1":"w-full")))&&h(t,"class",n),((z=V[11])==null?void 0:z.chatBubble)??!0?p&&(p.d(1),p=null):p?p.p(V,L):(p=zs(V),p.c(),p.m(a,o)),V[5]?E&&(te(),D(E,1,1,()=>{E=null}),le()):E?(E.p(V,L),L[0]&32&&b(E,1)):(E=Ws(V),E.c(),b(E,1),E.m(a,f));const O={};L[0]&1024&&(O.content=V[10].t("Copy")),L[0]&64|L[1]&1024&&(O.$$scope={dirty:L,ctx:V}),u.$set(O),!V[4]&&!V[5]?w?(w.p(V,L),L[0]&48&&b(w,1)):(w=qs(V),w.c(),b(w,1),w.m(a,c)):w&&(te(),D(w,1,1,()=>{w=null}),le()),((q=V[11])==null?void 0:q.chatBubble)??!0?R?R.p(V,L):(R=Fs(V),R.c(),R.m(a,null)):R&&(R.d(1),R=null),(!v||L[0]&2048&&m!==(m="flex "+(((ie=V[11])==null?void 0:ie.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&h(a,"class",m)},i(V){v||(b(M),b(E),b(u.$$.fragment,V),b(w),v=!0)},o(V){D(M),D(E),D(u.$$.fragment,V),D(w),v=!1},d(V){V&&g(e),M&&M.d(),p&&p.d(),E&&E.d(),x(u),w&&w.d(),R&&R.d()}}}function Ya(r){let e,t,l,s,n,i,a,o,f=r[10].t("Save")+"",u,d,c,m,v=r[10].t("Cancel")+"",M,p,E,w=r[10].t("Send")+"",R,T,B;return{c(){e=y("div"),t=y("div"),l=y("textarea"),n=j(),i=y("div"),a=y("div"),o=y("button"),u=U(f),d=j(),c=y("div"),m=y("button"),M=U(v),p=j(),E=y("button"),R=U(w),this.h()},l(V){e=I(V,"DIV",{class:!0});var L=k(e);t=I(L,"DIV",{class:!0});var O=k(t);l=I(O,"TEXTAREA",{id:!0,class:!0}),k(l).forEach(g),O.forEach(g),n=H(L),i=I(L,"DIV",{class:!0});var N=k(i);a=I(N,"DIV",{});var S=k(a);o=I(S,"BUTTON",{id:!0,class:!0});var z=k(o);u=W(z,f),z.forEach(g),S.forEach(g),d=H(N),c=I(N,"DIV",{class:!0});var q=k(c);m=I(q,"BUTTON",{id:!0,class:!0});var ie=k(m);M=W(ie,v),ie.forEach(g),p=H(q),E=I(q,"BUTTON",{id:!0,class:!0});var ae=k(E);R=W(ae,w),ae.forEach(g),q.forEach(g),N.forEach(g),L.forEach(g),this.h()},h(){h(l,"id",s="message-edit-"+r[6].id),h(l,"class","bg-transparent outline-none w-full resize-none"),h(t,"class","max-h-96 overflow-auto"),h(o,"id","save-edit-message-button"),h(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(m,"id","close-edit-message-button"),h(m,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(E,"id","confirm-edit-message-button"),h(E,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(c,"class","flex space-x-1.5"),h(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(V,L){C(V,e,L),_(e,t),_(t,l),r[25](l),nt(l,r[8]),_(e,n),_(e,i),_(i,a),_(a,o),_(o,u),_(i,d),_(i,c),_(c,m),_(m,M),_(c,p),_(c,E),_(E,R),T||(B=[me(l,"input",r[26]),me(l,"input",lo),me(l,"keydown",r[27]),me(o,"click",r[28]),me(m,"click",r[29]),me(E,"click",r[30])],T=!0)},p(V,L){L[0]&64&&s!==(s="message-edit-"+V[6].id)&&h(l,"id",s),L[0]&256&&nt(l,V[8]),L[0]&1024&&f!==(f=V[10].t("Save")+"")&&G(u,f),L[0]&1024&&v!==(v=V[10].t("Cancel")+"")&&G(M,v),L[0]&1024&&w!==(w=V[10].t("Send")+"")&&G(R,w)},i:ve,o:ve,d(V){V&&g(e),r[25](null),T=!1,Ye(B)}}}function As(r){let e,t;return e=new kt({props:{id:r[6].id,content:r[6].content}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&64&&(n.id=l[6].id),s[0]&64&&(n.content=l[6].content),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function zs(r){let e,t=r[1].length>1&&Us(r);return{c(){t&&t.c(),e=ue()},l(l){t&&t.l(l),e=ue()},m(l,s){t&&t.m(l,s),C(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=Us(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&g(e),t&&t.d(l)}}}function Us(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[6].id)+1+"",a,o,f=r[1].length+"",u,d,c,m='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',v,M;return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=j(),n=y("div"),a=U(i),o=U("/"),u=U(f),d=j(),c=y("button"),c.innerHTML=m,this.h()},l(p){e=I(p,"DIV",{class:!0,dir:!0});var E=k(e);t=I(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=H(E),n=I(E,"DIV",{class:!0});var w=k(n);a=W(w,i),o=W(w,"/"),u=W(w,f),w.forEach(g),d=H(E),c=I(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(c)!=="svelte-107ksnk"&&(c.innerHTML=m),E.forEach(g),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),h(c,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(p,E){C(p,e,E),_(e,t),_(e,s),_(e,n),_(n,a),_(n,o),_(n,u),_(e,d),_(e,c),v||(M=[me(t,"click",r[31]),me(c,"click",r[32])],v=!0)},p(p,E){E[0]&66&&i!==(i=p[1].indexOf(p[6].id)+1+"")&&G(a,i),E[0]&2&&f!==(f=p[1].length+"")&&G(u,f)},d(p){p&&g(e),v=!1,Ye(M)}}}function Ws(r){let e,t;return e=new Oe({props:{content:r[10].t("Edit"),placement:"bottom",$$slots:{default:[$a]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&1024&&(n.content=l[10].t("Edit")),s[1]&1024&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function $a(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(n){e=I(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(e)!=="svelte-stq9y8"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(n,i){C(n,e,i),l||(s=me(e,"click",r[33]),l=!0)},p:ve,d(n){n&&g(e),l=!1,s()}}}function xa(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(n){e=I(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(e)!=="svelte-1f3wx5s"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(n,i){C(n,e,i),l||(s=me(e,"click",r[34]),l=!0)},p:ve,d(n){n&&g(e),l=!1,s()}}}function qs(r){let e,t;return e=new Oe({props:{content:r[10].t("Delete"),placement:"bottom",$$slots:{default:[eo]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&1024&&(n.content=l[10].t("Delete")),s[1]&1024&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function eo(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(n){e=I(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(e)!=="svelte-1r7mjym"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1 rounded dark:hover:text-white hover:text-black transition")},m(n,i){C(n,e,i),l||(s=me(e,"click",r[35]),l=!0)},p:ve,d(n){n&&g(e),l=!1,s()}}}function Fs(r){let e,t=r[1].length>1&&Js(r);return{c(){t&&t.c(),e=ue()},l(l){t&&t.l(l),e=ue()},m(l,s){t&&t.m(l,s),C(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=Js(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&g(e),t&&t.d(l)}}}function Js(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[6].id)+1+"",a,o,f=r[1].length+"",u,d,c,m='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',v,M;return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=j(),n=y("div"),a=U(i),o=U("/"),u=U(f),d=j(),c=y("button"),c.innerHTML=m,this.h()},l(p){e=I(p,"DIV",{class:!0,dir:!0});var E=k(e);t=I(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=H(E),n=I(E,"DIV",{class:!0});var w=k(n);a=W(w,i),o=W(w,"/"),u=W(w,f),w.forEach(g),d=H(E),c=I(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Pe(c)!=="svelte-107ksnk"&&(c.innerHTML=m),E.forEach(g),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),h(c,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(p,E){C(p,e,E),_(e,t),_(e,s),_(e,n),_(n,a),_(n,o),_(n,u),_(e,d),_(e,c),v||(M=[me(t,"click",r[36]),me(c,"click",r[37])],v=!0)},p(p,E){E[0]&66&&i!==(i=p[1].indexOf(p[6].id)+1+"")&&G(a,i),E[0]&2&&f!==(f=p[1].length+"")&&G(u,f)},d(p){p&&g(e),v=!1,Ye(M)}}}function to(r){var R,T;let e,t,l,s,n,i,a,o,f,u,d,c,m=!(((R=r[11])==null?void 0:R.chatBubble)??!0)&&Ss(r),v=!(((T=r[11])==null?void 0:T.chatBubble)??!0)&&Ls(r),M=r[6].files&&js(r);const p=[Ya,Xa],E=[];function w(B,V){return B[7]===!0?0:1}return a=w(r),o=E[a]=p[a](r),{c(){e=y("div"),m&&m.c(),t=j(),l=y("div"),v&&v.c(),s=j(),n=y("div"),M&&M.c(),i=j(),o.c(),this.h()},l(B){e=I(B,"DIV",{class:!0,dir:!0,id:!0});var V=k(e);m&&m.l(V),t=H(V),l=I(V,"DIV",{class:!0});var L=k(l);v&&v.l(L),s=H(L),n=I(L,"DIV",{class:!0});var O=k(n);M&&M.l(O),i=H(O),o.l(O),O.forEach(g),L.forEach(g),V.forEach(g),this.h()},h(){h(n,"class",f="chat-"+r[6].role+" w-full min-w-full markdown-prose"),h(l,"class","flex-auto w-0 max-w-full pl-1"),h(e,"class","flex w-full user-message"),h(e,"dir",u=r[11].chatDirection),h(e,"id",d="message-"+r[6].id)},m(B,V){C(B,e,V),m&&m.m(e,null),_(e,t),_(e,l),v&&v.m(l,null),_(l,s),_(l,n),M&&M.m(n,null),_(n,i),E[a].m(n,null),c=!0},p(B,V){var O,N;((O=B[11])==null?void 0:O.chatBubble)??!0?m&&(te(),D(m,1,1,()=>{m=null}),le()):m?(m.p(B,V),V[0]&2048&&b(m,1)):(m=Ss(B),m.c(),b(m,1),m.m(e,t)),((N=B[11])==null?void 0:N.chatBubble)??!0?v&&(te(),D(v,1,1,()=>{v=null}),le()):v?(v.p(B,V),V[0]&2048&&b(v,1)):(v=Ls(B),v.c(),b(v,1),v.m(l,s)),B[6].files?M?(M.p(B,V),V[0]&64&&b(M,1)):(M=js(B),M.c(),b(M,1),M.m(n,i)):M&&(te(),D(M,1,1,()=>{M=null}),le());let L=a;a=w(B),a===L?E[a].p(B,V):(te(),D(E[L],1,1,()=>{E[L]=null}),le(),o=E[a],o?o.p(B,V):(o=E[a]=p[a](B),o.c()),b(o,1),o.m(n,null)),(!c||V[0]&64&&f!==(f="chat-"+B[6].role+" w-full min-w-full markdown-prose"))&&h(n,"class",f),(!c||V[0]&2048&&u!==(u=B[11].chatDirection))&&h(e,"dir",u),(!c||V[0]&64&&d!==(d="message-"+B[6].id))&&h(e,"id",d)},i(B){c||(b(m),b(v),b(M),b(o),c=!0)},o(B){D(m),D(v),D(M),D(o),c=!1},d(B){B&&g(e),m&&m.d(),v&&v.d(),M&&M.d(),E[a].d()}}}const lo=r=>{r.target.style.height="",r.target.style.height=`${r.target.scrollHeight}px`};function so(r,e,t){let l,s,n,i;Me(r,Pt,Q=>t(11,s=Q)),Me(r,Lt,Q=>t(12,n=Q)),Me(r,jt,Q=>t(13,i=Q));const a=qe("i18n");Me(r,a,Q=>t(10,l=Q)),rt.extend(hn);let{user:o}=e,{history:f}=e,{messageId:u}=e,{siblings:d}=e,{showPreviousMessage:c}=e,{showNextMessage:m}=e,{editMessage:v}=e,{deleteMessage:M}=e,{isFirstMessage:p}=e,{readOnly:E}=e,w=!1,R="",T,B=JSON.parse(JSON.stringify(f.messages[u]));const V=async Q=>{await dn(Q)&&Le.success(l.t("Copying to clipboard was successful!"))},L=async()=>{t(7,w=!0),t(8,R=B.content),await Ne(),t(9,T.style.height="",T),t(9,T.style.height=`${T.scrollHeight}px`,T),T==null||T.focus()},O=async(Q=!0)=>{v(B.id,R,Q),t(7,w=!1),t(8,R="")},N=()=>{t(7,w=!1),t(8,R="")},S=async()=>{M(B.id)};vt(()=>{});const z=Q=>Q.id===B.user;function q(Q){ze[Q?"unshift":"push"](()=>{T=Q,t(9,T)})}function ie(){R=this.value,t(8,R)}const ae=Q=>{var he,ce;Q.key==="Escape"&&((he=document.getElementById("close-edit-message-button"))==null||he.click());const P=Q.metaKey||Q.ctrlKey,Z=Q.key==="Enter";P&&Z&&((ce=document.getElementById("confirm-edit-message-button"))==null||ce.click())},se=()=>{O(!1)},oe=()=>{N()},J=()=>{O()},ee=()=>{c(B)},ge=()=>{m(B)},_e=()=>{L()},K=()=>{V(B.content)},A=()=>{S()},de=()=>{c(B)},re=()=>{m(B)};return r.$$set=Q=>{"user"in Q&&t(0,o=Q.user),"history"in Q&&t(20,f=Q.history),"messageId"in Q&&t(21,u=Q.messageId),"siblings"in Q&&t(1,d=Q.siblings),"showPreviousMessage"in Q&&t(2,c=Q.showPreviousMessage),"showNextMessage"in Q&&t(3,m=Q.showNextMessage),"editMessage"in Q&&t(22,v=Q.editMessage),"deleteMessage"in Q&&t(23,M=Q.deleteMessage),"isFirstMessage"in Q&&t(4,p=Q.isFirstMessage),"readOnly"in Q&&t(5,E=Q.readOnly)},r.$$.update=()=>{r.$$.dirty[0]&3145792&&f.messages&&JSON.stringify(B)!==JSON.stringify(f.messages[u])&&t(6,B=JSON.parse(JSON.stringify(f.messages[u])))},[o,d,c,m,p,E,B,w,R,T,l,s,n,i,a,V,L,O,N,S,f,u,v,M,z,q,ie,ae,se,oe,J,ee,ge,_e,K,A,de,re]}class no extends Be{constructor(e){super(),Te(this,e,so,to,De,{user:0,history:20,messageId:21,siblings:1,showPreviousMessage:2,showNextMessage:3,editMessage:22,deleteMessage:23,isFirstMessage:4,readOnly:5},null,[-1,-1])}}function Gs(r){let e,t,l,s;const n=[ao,io,ro],i=[];function a(o,f){var u,d;return o[0].messages[o[3]].role==="user"?0:(((d=(u=o[0].messages[o[0].messages[o[3]].parentId])==null?void 0:u.models)==null?void 0:d.length)??1)===1?1:2}return e=a(r),t=i[e]=n[e](r),{c(){t.c(),l=ue()},l(o){t.l(o),l=ue()},m(o,f){i[e].m(o,f),C(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(te(),D(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t?t.p(o,f):(t=i[e]=n[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&g(l),i[e].d(o)}}}function ro(r){var i;let e,t,l;function s(a){r[21](a)}let n={chatId:r[1],messageId:r[3],isLastMessage:r[3]===((i=r[0])==null?void 0:i.currentId),updateChat:r[7],editMessage:r[8],saveMessage:r[9],rateMessage:r[11],actionMessage:r[12],submitMessage:r[13],deleteMessage:r[10],continueResponse:r[15],regenerateResponse:r[14],mergeResponses:r[16],triggerScroll:r[18],addMessages:r[17],readOnly:r[19]};return r[0]!==void 0&&(n.history=r[0]),e=new Wa({props:n}),ze.push(()=>Qe(e,"history",s)),{c(){X(e.$$.fragment)},l(a){Y(e.$$.fragment,a)},m(a,o){$(e,a,o),l=!0},p(a,o){var u;const f={};o&2&&(f.chatId=a[1]),o&8&&(f.messageId=a[3]),o&9&&(f.isLastMessage=a[3]===((u=a[0])==null?void 0:u.currentId)),o&128&&(f.updateChat=a[7]),o&256&&(f.editMessage=a[8]),o&512&&(f.saveMessage=a[9]),o&2048&&(f.rateMessage=a[11]),o&4096&&(f.actionMessage=a[12]),o&8192&&(f.submitMessage=a[13]),o&1024&&(f.deleteMessage=a[10]),o&32768&&(f.continueResponse=a[15]),o&16384&&(f.regenerateResponse=a[14]),o&65536&&(f.mergeResponses=a[16]),o&262144&&(f.triggerScroll=a[18]),o&131072&&(f.addMessages=a[17]),o&524288&&(f.readOnly=a[19]),!t&&o&1&&(t=!0,f.history=a[0],Ke(()=>t=!1)),e.$set(f)},i(a){l||(b(e.$$.fragment,a),l=!0)},o(a){D(e.$$.fragment,a),l=!1},d(a){x(e,a)}}}function io(r){var l;let e,t;return e=new kn({props:{chatId:r[1],history:r[0],messageId:r[3],isLastMessage:r[3]===r[0].currentId,siblings:((l=r[0].messages[r[0].messages[r[3]].parentId])==null?void 0:l.childrenIds)??[],showPreviousMessage:r[5],showNextMessage:r[6],updateChat:r[7],editMessage:r[8],saveMessage:r[9],rateMessage:r[11],actionMessage:r[12],submitMessage:r[13],deleteMessage:r[10],continueResponse:r[15],regenerateResponse:r[14],addMessages:r[17],readOnly:r[19]}}),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,n){$(e,s,n),t=!0},p(s,n){var a;const i={};n&2&&(i.chatId=s[1]),n&1&&(i.history=s[0]),n&8&&(i.messageId=s[3]),n&9&&(i.isLastMessage=s[3]===s[0].currentId),n&9&&(i.siblings=((a=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:a.childrenIds)??[]),n&32&&(i.showPreviousMessage=s[5]),n&64&&(i.showNextMessage=s[6]),n&128&&(i.updateChat=s[7]),n&256&&(i.editMessage=s[8]),n&512&&(i.saveMessage=s[9]),n&2048&&(i.rateMessage=s[11]),n&4096&&(i.actionMessage=s[12]),n&8192&&(i.submitMessage=s[13]),n&1024&&(i.deleteMessage=s[10]),n&32768&&(i.continueResponse=s[15]),n&16384&&(i.regenerateResponse=s[14]),n&131072&&(i.addMessages=s[17]),n&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function ao(r){var l;let e,t;return e=new no({props:{user:r[4],history:r[0],messageId:r[3],isFirstMessage:r[2]===0,siblings:r[0].messages[r[3]].parentId!==null?((l=r[0].messages[r[0].messages[r[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(r[0].messages).filter(Zs).map(Ks)??[],showPreviousMessage:r[5],showNextMessage:r[6],editMessage:r[8],deleteMessage:r[10],readOnly:r[19]}}),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,n){$(e,s,n),t=!0},p(s,n){var a;const i={};n&16&&(i.user=s[4]),n&1&&(i.history=s[0]),n&8&&(i.messageId=s[3]),n&4&&(i.isFirstMessage=s[2]===0),n&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((a=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:a.childrenIds)??[]:Object.values(s[0].messages).filter(Zs).map(Ks)??[]),n&32&&(i.showPreviousMessage=s[5]),n&64&&(i.showNextMessage=s[6]),n&256&&(i.editMessage=s[8]),n&1024&&(i.deleteMessage=s[10]),n&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function oo(r){let e,t,l,s=r[0].messages[r[3]]&&Gs(r);return{c(){e=y("div"),s&&s.c(),this.h()},l(n){e=I(n,"DIV",{class:!0});var i=k(e);s&&s.l(i),i.forEach(g),this.h()},h(){var n;h(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((n=r[20])==null?void 0:n.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(n,i){C(n,e,i),s&&s.m(e,null),l=!0},p(n,[i]){var a;n[0].messages[n[3]]?s?(s.p(n,i),i&9&&b(s,1)):(s=Gs(n),s.c(),b(s,1),s.m(e,null)):s&&(te(),D(s,1,1,()=>{s=null}),le()),(!l||i&1048576&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((a=n[20])==null?void 0:a.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&h(e,"class",t)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&g(e),s&&s.d()}}}const Zs=r=>r.parentId===null,Ks=r=>r.id;function fo(r,e,t){let l;Me(r,Pt,N=>t(20,l=N)),mt(),qe("i18n");let{chatId:s}=e,{idx:n=0}=e,{history:i}=e,{messageId:a}=e,{user:o}=e,{showPreviousMessage:f}=e,{showNextMessage:u}=e,{updateChat:d}=e,{editMessage:c}=e,{saveMessage:m}=e,{deleteMessage:v}=e,{rateMessage:M}=e,{actionMessage:p}=e,{submitMessage:E}=e,{regenerateResponse:w}=e,{continueResponse:R}=e,{mergeResponses:T}=e,{addMessages:B}=e,{triggerScroll:V}=e,{readOnly:L=!1}=e;function O(N){i=N,t(0,i)}return r.$$set=N=>{"chatId"in N&&t(1,s=N.chatId),"idx"in N&&t(2,n=N.idx),"history"in N&&t(0,i=N.history),"messageId"in N&&t(3,a=N.messageId),"user"in N&&t(4,o=N.user),"showPreviousMessage"in N&&t(5,f=N.showPreviousMessage),"showNextMessage"in N&&t(6,u=N.showNextMessage),"updateChat"in N&&t(7,d=N.updateChat),"editMessage"in N&&t(8,c=N.editMessage),"saveMessage"in N&&t(9,m=N.saveMessage),"deleteMessage"in N&&t(10,v=N.deleteMessage),"rateMessage"in N&&t(11,M=N.rateMessage),"actionMessage"in N&&t(12,p=N.actionMessage),"submitMessage"in N&&t(13,E=N.submitMessage),"regenerateResponse"in N&&t(14,w=N.regenerateResponse),"continueResponse"in N&&t(15,R=N.continueResponse),"mergeResponses"in N&&t(16,T=N.mergeResponses),"addMessages"in N&&t(17,B=N.addMessages),"triggerScroll"in N&&t(18,V=N.triggerScroll),"readOnly"in N&&t(19,L=N.readOnly)},[i,s,n,a,o,f,u,d,c,m,v,M,p,E,w,R,T,B,V,L,l,O]}class uo extends Be{constructor(e){super(),Te(this,e,fo,oo,De,{chatId:1,idx:2,history:0,messageId:3,user:4,showPreviousMessage:5,showNextMessage:6,updateChat:7,editMessage:8,saveMessage:9,deleteMessage:10,rateMessage:11,actionMessage:12,submitMessage:13,regenerateResponse:14,continueResponse:15,mergeResponses:16,addMessages:17,triggerScroll:18,readOnly:19})}}function co(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function ho(r,e,t){let{className:l="size-3"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class mo extends Be{constructor(e){super(),Te(this,e,ho,co,De,{className:0,strokeWidth:1})}}function Qs(r,e,t){const l=r.slice();return l[13]=e[t],l[15]=t,l}function go(r){let e,t,l,s;return{c(){e=y("div"),t=U(r[3]),l=U("  v"),s=U(xt),this.h()},l(n){e=I(n,"DIV",{class:!0});var i=k(e);t=W(i,r[3]),l=W(i,"  v"),s=W(i,xt),i.forEach(g),this.h()},h(){h(e,"class","flex w-full text-center items-center justify-center self-start text-gray-400 dark:text-gray-600")},m(n,i){C(n,e,i),_(e,t),_(e,l),_(e,s)},p(n,i){i&8&&G(t,n[3])},i:ve,o:ve,d(n){n&&g(e)}}}function _o(r){let e,t,l=r[2].t("Suggested")+"",s,n;return e=new mo({}),{c(){X(e.$$.fragment),t=j(),s=U(l)},l(i){Y(e.$$.fragment,i),t=H(i),s=W(i,l)},m(i,a){$(e,i,a),C(i,t,a),C(i,s,a),n=!0},p(i,a){(!n||a&4)&&l!==(l=i[2].t("Suggested")+"")&&G(s,l)},i(i){n||(b(e.$$.fragment,i),n=!0)},o(i){D(e.$$.fragment,i),n=!1},d(i){i&&(g(t),g(s)),x(e,i)}}}function Xs(r){let e=[],t=new Map,l,s=ye(r[1]);const n=i=>i[13].id||i[13].content;for(let i=0;i<s.length;i+=1){let a=Qs(r,s,i),o=n(a);t.set(o,e[i]=Ys(o,a))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=ue()},l(i){for(let a=0;a<e.length;a+=1)e[a].l(i);l=ue()},m(i,a){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(i,a);C(i,l,a)},p(i,a){a&38&&(s=ye(i[1]),e=qt(e,a,n,1,i,s,t,l.parentNode,Ln,Ys,l,Qs))},d(i){i&&g(l);for(let a=0;a<e.length;a+=1)e[a].d(i)}}}function vo(r){let e,t=r[13].content+"",l,s,n,i=r[2].t("Prompt")+"",a;return{c(){e=y("div"),l=U(t),s=j(),n=y("div"),a=U(i),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);l=W(f,t),f.forEach(g),s=H(o),n=I(o,"DIV",{class:!0});var u=k(n);a=W(u,i),u.forEach(g),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(n,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(o,f){C(o,e,f),_(e,l),C(o,s,f),C(o,n,f),_(n,a)},p(o,f){f&2&&t!==(t=o[13].content+"")&&G(l,t),f&4&&i!==(i=o[2].t("Prompt")+"")&&G(a,i)},d(o){o&&(g(e),g(s),g(n))}}}function po(r){let e,t=r[13].title[0]+"",l,s,n,i=r[13].title[1]+"",a;return{c(){e=y("div"),l=U(t),s=j(),n=y("div"),a=U(i),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);l=W(f,t),f.forEach(g),s=H(o),n=I(o,"DIV",{class:!0});var u=k(n);a=W(u,i),u.forEach(g),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(n,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(o,f){C(o,e,f),_(e,l),C(o,s,f),C(o,n,f),_(n,a)},p(o,f){f&2&&t!==(t=o[13].title[0]+"")&&G(l,t),f&2&&i!==(i=o[13].title[1]+"")&&G(a,i)},d(o){o&&(g(e),g(s),g(n))}}}function Ys(r,e){let t,l,s,n,i;function a(d,c){return d[13].title&&d[13].title[0]!==""?po:vo}let o=a(e),f=o(e);function u(){return e[9](e[13])}return{key:r,first:null,c(){t=y("button"),l=y("div"),f.c(),s=j(),this.h()},l(d){t=I(d,"BUTTON",{class:!0,style:!0});var c=k(t);l=I(c,"DIV",{class:!0});var m=k(l);f.l(m),m.forEach(g),s=H(c),c.forEach(g),this.h()},h(){h(l,"class","flex flex-col text-left"),h(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),Bt(t,"animation-delay",e[15]*60+"ms"),this.first=t},m(d,c){C(d,t,c),_(t,l),f.m(l,null),_(t,s),n||(i=me(t,"click",u),n=!0)},p(d,c){e=d,o===(o=a(e))&&f?f.p(e,c):(f.d(1),f=o(e),f&&(f.c(),f.m(l,null))),c&2&&Bt(t,"animation-delay",e[15]*60+"ms")},d(d){d&&g(t),f.d(),n=!1,i()}}}function bo(r){let e,t,l,s,n,i,a;const o=[_o,go],f=[];function u(c,m){return c[1].length>0?0:1}t=u(r),l=f[t]=o[t](r);let d=r[1].length>0&&Xs(r);return{c(){e=y("div"),l.c(),s=j(),n=y("div"),d&&d.c(),this.h()},l(c){e=I(c,"DIV",{class:!0});var m=k(e);l.l(m),m.forEach(g),s=H(c),n=I(c,"DIV",{class:!0});var v=k(n);d&&d.l(v),v.forEach(g),this.h()},h(){h(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-400 dark:text-gray-600"),h(n,"class",i="h-40 overflow-auto scrollbar-none "+r[0]+" items-start svelte-1co34if")},m(c,m){C(c,e,m),f[t].m(e,null),C(c,s,m),C(c,n,m),d&&d.m(n,null),a=!0},p(c,[m]){let v=t;t=u(c),t===v?f[t].p(c,m):(te(),D(f[v],1,1,()=>{f[v]=null}),le(),l=f[t],l?l.p(c,m):(l=f[t]=o[t](c),l.c()),b(l,1),l.m(e,null)),c[1].length>0?d?d.p(c,m):(d=Xs(c),d.c(),d.m(n,null)):d&&(d.d(1),d=null),(!a||m&1&&i!==(i="h-40 overflow-auto scrollbar-none "+c[0]+" items-start svelte-1co34if"))&&h(n,"class",i)},i(c){a||(b(l),a=!0)},o(c){D(l),a=!1},d(c){c&&(g(e),g(s),g(n)),f[t].d(),d&&d.d()}}}function ko(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if((r[t].id??r[t].content)!==(e[t].id??e[t].content))return!1;return!0}function wo(r,e,t){let l,s;Me(r,An,p=>t(3,s=p));const n=qe("i18n");Me(r,n,p=>t(2,l=p));const i=mt();let{suggestionPrompts:a=[]}=e,{className:o=""}=e,{inputValue:f=""}=e,u=[];const d={keys:["content","title"],threshold:.5};let c,m=[];const v=p=>{const E=p.trim()?c.search(p.trim()).map(w=>w.item):u;ko(m,E)||t(1,m=E)},M=p=>i("select",p.content);return r.$$set=p=>{"suggestionPrompts"in p&&t(6,a=p.suggestionPrompts),"className"in p&&t(0,o=p.className),"inputValue"in p&&t(7,f=p.inputValue)},r.$$.update=()=>{r.$$.dirty&192&&a&&(t(8,u=[...a??[]].sort(()=>Math.random()-.5)),v(f)),r.$$.dirty&256&&(c=new rr(u,d)),r.$$.dirty&128&&v(f)},[o,m,l,s,n,i,a,f,u,M]}class yo extends Be{constructor(e){super(),Te(this,e,wo,bo,De,{suggestionPrompts:6,className:0,inputValue:7})}}function Io(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function Mo(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Eo extends Be{constructor(e){super(),Te(this,e,Mo,Io,De,{className:0,strokeWidth:1})}}function $s(r,e,t){const l=r.slice();return l[13]=e[t],l[15]=t,l}function No(r){let e,t;return{c(){e=y("img"),this.h()},l(l){e=I(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,n;h(e,"crossorigin","anonymous"),Tt(e.src,t=((n=(s=(l=r[13])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:n.profile_image_url)??(r[4].language==="dg-DG"?"/doge.png":`${Ot}/static/favicon.png`))||h(e,"src",t),h(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none"),h(e,"alt","logo"),h(e,"draggable","false")},m(l,s){C(l,e,s)},p(l,s){var n,i,a;s&17&&!Tt(e.src,t=((a=(i=(n=l[13])==null?void 0:n.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??(l[4].language==="dg-DG"?"/doge.png":`${Ot}/static/favicon.png`))&&h(e,"src",t)},d(l){l&&g(e)}}}function xs(r){var o,f,u;let e,t,l,s,n,i;t=new Oe({props:{content:St.parse(_t(((u=(f=(o=r[0][r[3]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[No]},$$scope:{ctx:r}}});function a(){return r[11](r[15])}return{c(){e=y("button"),X(t.$$.fragment),l=j()},l(d){e=I(d,"BUTTON",{});var c=k(e);Y(t.$$.fragment,c),l=H(c),c.forEach(g)},m(d,c){C(d,e,c),$(t,e,null),_(e,l),s=!0,n||(i=me(e,"click",a),n=!0)},p(d,c){var v,M,p;r=d;const m={};c&9&&(m.content=St.parse(_t(((p=(M=(v=r[0][r[3]])==null?void 0:v.info)==null?void 0:M.meta)==null?void 0:p.description)??""))),c&65553&&(m.$$scope={dirty:c,ctx:r}),t.$set(m)},i(d){s||(b(t.$$.fragment,d),s=!0)},o(d){D(t.$$.fragment,d),s=!1},d(d){d&&g(e),x(t),n=!1,i()}}}function en(r){let e,t;return e=new Oe({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-fit",placement:"top-start",$$slots:{default:[Do]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Do(r){let e,t,l,s;return t=new Eo({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=y("div"),X(t.$$.fragment),l=U(" Temporary Chat"),this.h()},l(n){e=I(n,"DIV",{class:!0});var i=k(e);Y(t.$$.fragment,i),l=W(i," Temporary Chat"),i.forEach(g),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(n,i){C(n,e,i),$(t,e,null),_(e,l),s=!0},p:ve,i(n){s||(b(t.$$.fragment,n),s=!0)},o(n){D(t.$$.fragment,n),s=!1},d(n){n&&g(e),x(t)}}}function Vo(r){let e=r[4].t("Hello, {{name}}",{name:r[6].name})+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&80&&e!==(e=l[4].t("Hello, {{name}}",{name:l[6].name})+"")&&G(t,e)},d(l){l&&g(t)}}}function Co(r){var l;let e=((l=r[0][r[3]])==null?void 0:l.name)+"",t;return{c(){t=U(e)},l(s){t=W(s,e)},m(s,n){C(s,t,n)},p(s,n){var i;n&9&&e!==(e=((i=s[0][s[3]])==null?void 0:i.name)+"")&&G(t,e)},d(s){s&&g(t)}}}function Bo(r){let e,t=r[4].t("How can I help you today?")+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(g),this.h()},h(){h(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&16&&t!==(t=s[4].t("How can I help you today?")+"")&&G(l,t)},d(s){s&&g(e)}}}function To(r){var a,o,f,u,d,c;let e,t,l=St.parse(_t((f=(o=(a=r[0][r[3]])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:f.description))+"",s,n,i=((c=(d=(u=r[0][r[3]])==null?void 0:u.info)==null?void 0:d.meta)==null?void 0:c.user)&&tn(r);return{c(){e=y("div"),t=new Rn(!1),s=j(),i&&i.c(),n=ue(),this.h()},l(m){e=I(m,"DIV",{class:!0});var v=k(e);t=Sn(v,!1),v.forEach(g),s=H(m),i&&i.l(m),n=ue(),this.h()},h(){t.a=null,h(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(m,v){C(m,e,v),t.m(l,e),C(m,s,v),i&&i.m(m,v),C(m,n,v)},p(m,v){var M,p,E,w,R,T;v&9&&l!==(l=St.parse(_t((E=(p=(M=m[0][m[3]])==null?void 0:M.info)==null?void 0:p.meta)==null?void 0:E.description))+"")&&t.p(l),(T=(R=(w=m[0][m[3]])==null?void 0:w.info)==null?void 0:R.meta)!=null&&T.user?i?i.p(m,v):(i=tn(m),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(m){m&&(g(e),g(s),g(n)),i&&i.d(m)}}}function tn(r){let e,t;function l(i,a){var o,f,u;return(u=(f=(o=i[0][i[3]])==null?void 0:o.info)==null?void 0:f.meta)!=null&&u.user.community?Ro:Oo}let s=l(r),n=s(r);return{c(){e=y("div"),t=U(`By
								`),n.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);t=W(a,`By
								`),n.l(a),a.forEach(g),this.h()},h(){h(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,a){C(i,e,a),_(e,t),n.m(e,null)},p(i,a){s===(s=l(i))&&n?n.p(i,a):(n.d(1),n=s(i),n&&(n.c(),n.m(e,null)))},d(i){i&&g(e),n.d()}}}function Oo(r){var l,s,n;let e=((n=(s=(l=r[0][r[3]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:n.user.name)+"",t;return{c(){t=U(e)},l(i){t=W(i,e)},m(i,a){C(i,t,a)},p(i,a){var o,f,u;a&9&&e!==(e=((u=(f=(o=i[0][i[3]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&G(t,e)},d(i){i&&g(t)}}}function Ro(r){var n,i,a,o,f,u,d,c,m;let e,t=((a=(i=(n=r[0][r[3]])==null?void 0:n.info)==null?void 0:i.meta)!=null&&a.user.name?(u=(f=(o=r[0][r[3]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(m=(c=(d=r[0][r[3]])==null?void 0:d.info)==null?void 0:c.meta)==null?void 0:m.user.username}`)+"",l,s;return{c(){e=y("a"),l=U(t),this.h()},l(v){e=I(v,"A",{href:!0});var M=k(e);l=W(M,t),M.forEach(g),this.h()},h(){var v,M,p;h(e,"href",s="https://openwebui.com/m/"+((p=(M=(v=r[0][r[3]])==null?void 0:v.info)==null?void 0:M.meta)==null?void 0:p.user.username))},m(v,M){C(v,e,M),_(e,l)},p(v,M){var p,E,w,R,T,B,V,L,O,N,S,z;M&9&&t!==(t=((w=(E=(p=v[0][v[3]])==null?void 0:p.info)==null?void 0:E.meta)!=null&&w.user.name?(B=(T=(R=v[0][v[3]])==null?void 0:R.info)==null?void 0:T.meta)==null?void 0:B.user.name:`@${(O=(L=(V=v[0][v[3]])==null?void 0:V.info)==null?void 0:L.meta)==null?void 0:O.user.username}`)+"")&&G(l,t),M&9&&s!==(s="https://openwebui.com/m/"+((z=(S=(N=v[0][v[3]])==null?void 0:N.info)==null?void 0:S.meta)==null?void 0:z.user.username))&&h(e,"href",s)},d(v){v&&g(e)}}}function ln(r){var ie,ae,se,oe;let e,t,l,s,n,i,a,o,f,u,d,c,m,v,M,p,E,w,R=ye(r[0]),T=[];for(let J=0;J<R.length;J+=1)T[J]=xs($s(r,R,J));const B=J=>D(T[J],1,1,()=>{T[J]=null});let V=r[5]&&en(r);function L(J,ee){var ge;return(ge=J[0][J[3]])!=null&&ge.name?Co:Vo}let O=L(r),N=O(r);function S(J,ee){var ge,_e,K;return((K=(_e=(ge=J[0][J[3]])==null?void 0:ge.info)==null?void 0:_e.meta)==null?void 0:K.description)??null?To:Bo}let z=S(r),q=z(r);return p=new yo({props:{className:"grid grid-cols-2",suggestionPrompts:((se=(ae=(ie=r[0][r[3]])==null?void 0:ie.info)==null?void 0:ae.meta)==null?void 0:se.suggestion_prompts)??((oe=r[7])==null?void 0:oe.default_prompt_suggestions)??[]}}),p.$on("select",r[12]),{c(){e=y("div"),t=y("div"),l=y("div");for(let J=0;J<T.length;J+=1)T[J].c();n=j(),V&&V.c(),i=j(),a=y("div"),o=y("div"),f=y("div"),N.c(),d=j(),c=y("div"),q.c(),v=j(),M=y("div"),X(p.$$.fragment),this.h()},l(J){e=I(J,"DIV",{class:!0});var ee=k(e);t=I(ee,"DIV",{class:!0});var ge=k(t);l=I(ge,"DIV",{class:!0});var _e=k(l);for(let P=0;P<T.length;P+=1)T[P].l(_e);_e.forEach(g),ge.forEach(g),n=H(ee),V&&V.l(ee),i=H(ee),a=I(ee,"DIV",{class:!0});var K=k(a);o=I(K,"DIV",{});var A=k(o);f=I(A,"DIV",{class:!0});var de=k(f);N.l(de),de.forEach(g),d=H(A),c=I(A,"DIV",{});var re=k(c);q.l(re),re.forEach(g),A.forEach(g),K.forEach(g),v=H(ee),M=I(ee,"DIV",{class:!0});var Q=k(M);Y(p.$$.fragment,Q),Q.forEach(g),ee.forEach(g),this.h()},h(){h(l,"class","flex -space-x-4 mb-0.5"),h(t,"class","flex justify-start"),h(f,"class","capitalize line-clamp-1"),h(a,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),h(M,"class","w-full font-primary"),h(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(J,ee){C(J,e,ee),_(e,t),_(t,l);for(let ge=0;ge<T.length;ge+=1)T[ge]&&T[ge].m(l,null);_(e,n),V&&V.m(e,null),_(e,i),_(e,a),_(a,o),_(o,f),N.m(f,null),_(o,d),_(o,c),q.m(c,null),_(e,v),_(e,M),$(p,M,null),w=!0},p(J,ee){var _e,K,A,de;if(ee&25){R=ye(J[0]);let re;for(re=0;re<R.length;re+=1){const Q=$s(J,R,re);T[re]?(T[re].p(Q,ee),b(T[re],1)):(T[re]=xs(Q),T[re].c(),b(T[re],1),T[re].m(l,null))}for(te(),re=R.length;re<T.length;re+=1)B(re);le()}J[5]?V?ee&32&&b(V,1):(V=en(J),V.c(),b(V,1),V.m(e,i)):V&&(te(),D(V,1,1,()=>{V=null}),le()),O===(O=L(J))&&N?N.p(J,ee):(N.d(1),N=O(J),N&&(N.c(),N.m(f,null))),z===(z=S(J))&&q?q.p(J,ee):(q.d(1),q=z(J),q&&(q.c(),q.m(c,null)));const ge={};ee&137&&(ge.suggestionPrompts=((A=(K=(_e=J[0][J[3]])==null?void 0:_e.info)==null?void 0:K.meta)==null?void 0:A.suggestion_prompts)??((de=J[7])==null?void 0:de.default_prompt_suggestions)??[]),p.$set(ge)},i(J){if(!w){for(let ee=0;ee<R.length;ee+=1)b(T[ee]);J&&(s||Dt(()=>{s=Vt(l,Ct,{duration:200}),s.start()})),b(V),J&&(u||Dt(()=>{u=Vt(f,Ct,{duration:200}),u.start()})),J&&(m||Dt(()=>{m=Vt(c,Ct,{duration:200,delay:200}),m.start()})),b(p.$$.fragment,J),J&&(E||Dt(()=>{E=Vt(M,Ct,{duration:200,delay:300}),E.start()})),w=!0}},o(J){T=T.filter(Boolean);for(let ee=0;ee<T.length;ee+=1)D(T[ee]);D(V),D(p.$$.fragment,J),w=!1},d(J){J&&g(e),We(T,J),V&&V.d(),N.d(),q.d(),x(p)}}}function So(r){let e=r[2],t,l,s=ln(r);return{c(){s.c(),t=ue()},l(n){s.l(n),t=ue()},m(n,i){s.m(n,i),C(n,t,i),l=!0},p(n,[i]){i&4&&De(e,e=n[2])?(te(),D(s,1,1,ve),le(),s=ln(n),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(n,i)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&g(t),s.d(n)}}}function Lo(r,e,t){let l,s,n,i,a;Me(r,Lt,p=>t(10,l=p)),Me(r,zn,p=>t(5,n=p)),Me(r,jt,p=>t(6,i=p)),Me(r,cn,p=>t(7,a=p));const o=qe("i18n");Me(r,o,p=>t(4,s=p));let{modelIds:f=[]}=e,{models:u=[]}=e,{submitPrompt:d}=e,c=!1,m=0;vt(()=>{t(2,c=!0)});const v=p=>{t(3,m=p)},M=p=>{d(p.detail)};return r.$$set=p=>{"modelIds"in p&&t(9,f=p.modelIds),"models"in p&&t(0,u=p.models),"submitPrompt"in p&&t(1,d=p.submitPrompt)},r.$$.update=()=>{r.$$.dirty&1536&&t(0,u=f.map(p=>l.find(E=>E.id===p))),r.$$.dirty&513&&f.length>0&&t(3,m=u.length-1)},[u,d,c,m,s,n,i,a,o,f,l,v,M]}class Po extends Be{constructor(e){super(),Te(this,e,Lo,So,De,{modelIds:9,models:0,submitPrompt:1})}}function sn(r,e,t){const l=r.slice();return l[40]=e[t],l[42]=t,l}function jo(r){let e,t=r[3],l,s=on(r);return{c(){e=y("div"),s.c(),this.h()},l(n){e=I(n,"DIV",{class:!0});var i=k(e);s.l(i),i.forEach(g),this.h()},h(){h(e,"class","w-full pt-2")},m(n,i){C(n,e,i),s.m(e,null),l=!0},p(n,i){i[0]&8&&De(t,t=n[3])?(te(),D(s,1,1,ve),le(),s=on(n),s.c(),b(s,1),s.m(e,null)):s.p(n,i)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&g(e),s.d(n)}}}function Ho(r){let e,t;return e=new Po({props:{modelIds:r[5],submitPrompt:r[32]}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&32&&(n.modelIds=l[5]),s[0]&32770&&(n.submitPrompt=l[32]),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function nn(r){let e,t;return e=new nr({props:{$$slots:{default:[Ao]},$$scope:{ctx:r}}}),e.$on("visible",r[33]),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[1]&4096&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ao(r){let e,t,l,s,n="Loading...",i;return t=new Ht({props:{className:" size-4"}}),{c(){e=y("div"),X(t.$$.fragment),l=j(),s=y("div"),s.textContent=n,this.h()},l(a){e=I(a,"DIV",{class:!0});var o=k(e);Y(t.$$.fragment,o),l=H(o),s=I(o,"DIV",{class:!0,"data-svelte-h":!0}),Pe(s)!=="svelte-17uns3n"&&(s.textContent=n),o.forEach(g),this.h()},h(){h(s,"class",""),h(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(a,o){C(a,e,o),$(t,e,null),_(e,l),_(e,s),i=!0},p:ve,i(a){i||(b(t.$$.fragment,a),i=!0)},o(a){D(t.$$.fragment,a),i=!1},d(a){a&&g(e),x(t)}}}function rn(r,e){let t,l,s,n;function i(o){e[34](o)}let a={chatId:e[3],messageId:e[40].id,idx:e[42],user:e[4],showPreviousMessage:e[19],showNextMessage:e[20],updateChat:e[18],editMessage:e[22],deleteMessage:e[25],rateMessage:e[21],actionMessage:e[23],saveMessage:e[24],submitMessage:e[9],regenerateResponse:e[7],continueResponse:e[6],mergeResponses:e[8],addMessages:e[10],triggerScroll:e[26],readOnly:e[11]};return e[0]!==void 0&&(a.history=e[0]),l=new uo({props:a}),ze.push(()=>Qe(l,"history",i)),{key:r,first:null,c(){t=ue(),X(l.$$.fragment),this.h()},l(o){t=ue(),Y(l.$$.fragment,o),this.h()},h(){this.first=t},m(o,f){C(o,t,f),$(l,o,f),n=!0},p(o,f){e=o;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&8192&&(u.messageId=e[40].id),f[0]&8192&&(u.idx=e[42]),f[0]&16&&(u.user=e[4]),f[0]&512&&(u.submitMessage=e[9]),f[0]&128&&(u.regenerateResponse=e[7]),f[0]&64&&(u.continueResponse=e[6]),f[0]&256&&(u.mergeResponses=e[8]),f[0]&1024&&(u.addMessages=e[10]),f[0]&2048&&(u.readOnly=e[11]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ke(()=>s=!1)),l.$set(u)},i(o){n||(b(l.$$.fragment,o),n=!0)},o(o){D(l.$$.fragment,o),n=!1},d(o){o&&g(t),x(l,o)}}}function an(r){let e;return{c(){e=y("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),k(e).forEach(g),this.h()},h(){h(e,"class","pb-6")},m(t,l){C(t,e,l)},d(t){t&&g(e)}}}function on(r){var M;let e,t=((M=r[13].at(0))==null?void 0:M.parentId)!==null,l,s=[],n=new Map,i,a,o,f,u,d=t&&nn(r),c=ye(r[13]);const m=p=>p[40].id;for(let p=0;p<c.length;p+=1){let E=sn(r,c,p),w=m(E);n.set(w,s[p]=rn(w,E))}let v=r[12]&&an();return{c(){e=y("div"),d&&d.c(),l=j();for(let p=0;p<s.length;p+=1)s[p].c();i=j(),a=y("div"),o=j(),v&&v.c(),f=ue(),this.h()},l(p){e=I(p,"DIV",{class:!0});var E=k(e);d&&d.l(E),l=H(E);for(let w=0;w<s.length;w+=1)s[w].l(E);E.forEach(g),i=H(p),a=I(p,"DIV",{class:!0}),k(a).forEach(g),o=H(p),v&&v.l(p),f=ue(),this.h()},h(){h(e,"class","w-full"),h(a,"class","pb-12")},m(p,E){C(p,e,E),d&&d.m(e,null),_(e,l);for(let w=0;w<s.length;w+=1)s[w]&&s[w].m(e,null);C(p,i,E),C(p,a,E),C(p,o,E),v&&v.m(p,E),C(p,f,E),u=!0},p(p,E){var w;E[0]&8192&&(t=((w=p[13].at(0))==null?void 0:w.parentId)!==null),t?d?(d.p(p,E),E[0]&8192&&b(d,1)):(d=nn(p),d.c(),b(d,1),d.m(e,l)):d&&(te(),D(d,1,1,()=>{d=null}),le()),E[0]&133967833&&(c=ye(p[13]),te(),s=qt(s,E,m,1,p,c,n,e,fn,rn,null,sn),le()),p[12]?v||(v=an(),v.c(),v.m(f.parentNode,f)):v&&(v.d(1),v=null)},i(p){if(!u){b(d);for(let E=0;E<c.length;E+=1)b(s[E]);u=!0}},o(p){D(d);for(let E=0;E<s.length;E+=1)D(s[E]);u=!1},d(p){p&&(g(e),g(i),g(a),g(o),g(f)),d&&d.d();for(let E=0;E<s.length;E+=1)s[E].d();v&&v.d(p)}}}function zo(r){let e,t,l,s,n;const i=[Ho,jo],a=[];function o(f,u){var d;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((d=f[0])==null?void 0:d.messages)??{}).length==0),t?0:1}return l=o(r,[-1,-1]),s=a[l]=i[l](r),{c(){e=y("div"),s.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);s.l(u),u.forEach(g),this.h()},h(){h(e,"class",r[2])},m(f,u){C(f,e,u),a[l].m(e,null),n=!0},p(f,u){let d=l;l=o(f,u),l===d?a[l].p(f,u):(te(),D(a[d],1,1,()=>{a[d]=null}),le(),s=a[l],s?s.p(f,u):(s=a[l]=i[l](f),s.c()),b(s,1),s.m(e,null)),(!n||u[0]&4)&&h(e,"class",f[2])},i(f){n||(b(s),n=!0)},o(f){D(s),n=!1},d(f){f&&g(e),a[l].d()}}}function Uo(r,e,t){let l,s,n,i;Me(r,Pt,P=>t(35,l=P)),Me(r,el,P=>t(36,s=P)),Me(r,jt,P=>t(37,n=P)),mt();const a=qe("i18n");Me(r,a,P=>t(15,i=P));let{className:o="h-full flex pt-8"}=e,{chatId:f=""}=e,{user:u=n}=e,{prompt:d}=e,{history:c={}}=e,{selectedModels:m}=e,v=[],{sendPrompt:M}=e,{continueResponse:p}=e,{regenerateResponse:E}=e,{mergeResponses:w}=e,{chatActionHandler:R}=e,{showMessage:T=()=>{}}=e,{submitMessage:B=()=>{}}=e,{addMessages:V=()=>{}}=e,{readOnly:L=!1}=e,{bottomPadding:O=!1}=e,{autoScroll:N}=e,S=20,z=!1;const q=async()=>{const P=document.getElementById("messages-container");P.scrollTop=P.scrollTop+100,t(14,z=!0),t(31,S+=20),await Ne(),t(14,z=!1)},ie=()=>{const P=document.getElementById("messages-container");P.scrollTop=P.scrollHeight},ae=async()=>{t(0,c),await Ne(),await qn(localStorage.token,f,{history:c,messages:v}),el.set(1),await Un.set(await Fn(localStorage.token,s))},se=async P=>{if(P.parentId!==null){let Z=c.messages[P.parentId].childrenIds[Math.max(c.messages[P.parentId].childrenIds.indexOf(P.id)-1,0)];if(P.id!==Z){let he=c.messages[Z].childrenIds;for(;he.length!==0;)Z=he.at(-1),he=c.messages[Z].childrenIds;t(0,c.currentId=Z,c)}}else{let Z=Object.values(c.messages).filter(ce=>ce.parentId===null).map(ce=>ce.id),he=Z[Math.max(Z.indexOf(P.id)-1,0)];if(P.id!==he){let ce=c.messages[he].childrenIds;for(;ce.length!==0;)he=ce.at(-1),ce=c.messages[he].childrenIds;t(0,c.currentId=he,c)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const Z=document.getElementById("messages-container");t(27,N=Z.scrollHeight-Z.scrollTop<=Z.clientHeight+50),setTimeout(()=>{ie()},100)}},oe=async P=>{if(P.parentId!==null){let Z=c.messages[P.parentId].childrenIds[Math.min(c.messages[P.parentId].childrenIds.indexOf(P.id)+1,c.messages[P.parentId].childrenIds.length-1)];if(P.id!==Z){let he=c.messages[Z].childrenIds;for(;he.length!==0;)Z=he.at(-1),he=c.messages[Z].childrenIds;t(0,c.currentId=Z,c)}}else{let Z=Object.values(c.messages).filter(ce=>ce.parentId===null).map(ce=>ce.id),he=Z[Math.min(Z.indexOf(P.id)+1,Z.length-1)];if(P.id!==he){let ce=c.messages[he].childrenIds;for(;ce.length!==0;)he=ce.at(-1),ce=c.messages[he].childrenIds;t(0,c.currentId=he,c)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const Z=document.getElementById("messages-container");t(27,N=Z.scrollHeight-Z.scrollTop<=Z.clientHeight+50),setTimeout(()=>{ie()},100)}},J=async(P,Z)=>{t(0,c.messages[P].annotation={...c.messages[P].annotation,rating:Z},c),await ae()},ee=async(P,Z,he=!0)=>{if(c.messages[P].role==="user")if(he){let ce=Z,we=tl(),fe={id:we,parentId:c.messages[P].parentId,childrenIds:[],role:"user",content:ce,...c.messages[P].files&&{files:c.messages[P].files},models:m},ne=c.messages[P].parentId;ne!==null&&t(0,c.messages[ne].childrenIds=[...c.messages[ne].childrenIds,we],c),t(0,c.messages[we]=fe,c),t(0,c.currentId=we,c),await Ne(),await M(c,ce,we)}else t(0,c.messages[P].content=Z,c),await ae();else if(he){const ce=tl(),we=c.messages[P],fe=we.parentId,ne={...we,id:ce,parentId:fe,childrenIds:[],files:void 0,content:Z,timestamp:Math.floor(Date.now()/1e3)};t(0,c.messages[ce]=ne,c),t(0,c.currentId=ce,c),fe!==null&&t(0,c.messages[fe].childrenIds=[...c.messages[fe].childrenIds,ce],c),await ae()}else t(0,c.messages[P].originalContent=c.messages[P].content,c),t(0,c.messages[P].content=Z,c),await ae()},ge=async(P,Z,he=null)=>{await R(f,P,Z.model,Z.id,he)},_e=async(P,Z)=>{t(0,c.messages[P]=Z,c),await ae()},K=async P=>{const Z=c.messages[P],he=Z.parentId,ce=Z.childrenIds??[],we=ce.flatMap(fe=>{var ne;return((ne=c.messages[fe])==null?void 0:ne.childrenIds)??[]});he&&c.messages[he]&&t(0,c.messages[he].childrenIds=[...c.messages[he].childrenIds.filter(fe=>fe!==P),...we],c),we.forEach(fe=>{c.messages[fe]&&t(0,c.messages[fe].parentId=he,c)}),[P,...ce].forEach(fe=>{delete c.messages[fe]}),await Ne(),T({id:he}),await ae()},A=()=>{if(N){const P=document.getElementById("messages-container");t(27,N=P.scrollHeight-P.scrollTop<=P.clientHeight+50),setTimeout(()=>{ie()},100)}},de=async P=>{let Z=P;if(P.includes("{{CLIPBOARD}}")){const ce=await navigator.clipboard.readText().catch(we=>(Le.error(i.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));Z=P.replaceAll("{{CLIPBOARD}}",ce)}t(1,d=Z),await Ne();const he=document.getElementById("chat-input-container");he&&(t(1,d=P),he.style.height="",he.style.height=Math.min(he.scrollHeight,200)+"px",he.focus()),await Ne()},re=P=>{console.log("visible"),z||q()};function Q(P){c=P,t(0,c)}return r.$$set=P=>{"className"in P&&t(2,o=P.className),"chatId"in P&&t(3,f=P.chatId),"user"in P&&t(4,u=P.user),"prompt"in P&&t(1,d=P.prompt),"history"in P&&t(0,c=P.history),"selectedModels"in P&&t(5,m=P.selectedModels),"sendPrompt"in P&&t(28,M=P.sendPrompt),"continueResponse"in P&&t(6,p=P.continueResponse),"regenerateResponse"in P&&t(7,E=P.regenerateResponse),"mergeResponses"in P&&t(8,w=P.mergeResponses),"chatActionHandler"in P&&t(29,R=P.chatActionHandler),"showMessage"in P&&t(30,T=P.showMessage),"submitMessage"in P&&t(9,B=P.submitMessage),"addMessages"in P&&t(10,V=P.addMessages),"readOnly"in P&&t(11,L=P.readOnly),"bottomPadding"in P&&t(12,O=P.bottomPadding),"autoScroll"in P&&t(27,N=P.autoScroll)},r.$$.update=()=>{if(r.$$.dirty[0]&1|r.$$.dirty[1]&1)if(c.currentId){let P=[],Z=c.messages[c.currentId];for(;Z&&P.length<=S;)P.unshift({...Z}),Z=Z.parentId!==null?c.messages[Z.parentId]:null;t(13,v=P)}else t(13,v=[]);r.$$.dirty[0]&134221824&&N&&O&&(async()=>(await Ne(),ie()))()},[c,d,o,f,u,m,p,E,w,B,V,L,O,v,z,i,a,q,ae,se,oe,J,ee,ge,_e,K,A,N,M,R,T,S,de,re,Q]}class kf extends Be{constructor(e){super(),Te(this,e,Uo,zo,De,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,sendPrompt:28,continueResponse:6,regenerateResponse:7,mergeResponses:8,chatActionHandler:29,showMessage:30,submitMessage:9,addMessages:10,readOnly:11,bottomPadding:12,autoScroll:27},null,[-1,-1])}}export{Eo as E,kf as M,yo as S};
//# sourceMappingURL=Messages.D1_5Ykrn.js.map
